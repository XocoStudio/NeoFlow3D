var fN=Object.defineProperty;var hN=(s,e,t)=>e in s?fN(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var Ja=(s,e,t)=>hN(s,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();function ny(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var wb={exports:{}},mm={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rM;function dN(){if(rM)return mm;rM=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(n,i,a){var o=null;if(a!==void 0&&(o=""+a),i.key!==void 0&&(o=""+i.key),"key"in i){a={};for(var c in i)c!=="key"&&(a[c]=i[c])}else a=i;return i=a.ref,{$$typeof:s,type:n,key:o,ref:i!==void 0?i:null,props:a}}return mm.Fragment=e,mm.jsx=t,mm.jsxs=t,mm}var oM;function pN(){return oM||(oM=1,wb.exports=dN()),wb.exports}var y=pN(),Eb={exports:{}},Kn={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lM;function mN(){if(lM)return Kn;lM=1;var s=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),o=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),x=Symbol.for("react.activity"),g=Symbol.iterator;function b(I){return I===null||typeof I!="object"?null:(I=g&&I[g]||I["@@iterator"],typeof I=="function"?I:null)}var S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C=Object.assign,M={};function A(I,W,fe){this.props=I,this.context=W,this.refs=M,this.updater=fe||S}A.prototype.isReactComponent={},A.prototype.setState=function(I,W){if(typeof I!="object"&&typeof I!="function"&&I!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,I,W,"setState")},A.prototype.forceUpdate=function(I){this.updater.enqueueForceUpdate(this,I,"forceUpdate")};function R(){}R.prototype=A.prototype;function N(I,W,fe){this.props=I,this.context=W,this.refs=M,this.updater=fe||S}var B=N.prototype=new R;B.constructor=N,C(B,A.prototype),B.isPureReactComponent=!0;var F=Array.isArray;function U(){}var z={H:null,A:null,T:null,S:null},P=Object.prototype.hasOwnProperty;function L(I,W,fe){var Z=fe.ref;return{$$typeof:s,type:I,key:W,ref:Z!==void 0?Z:null,props:fe}}function O(I,W){return L(I.type,W,I.props)}function ee(I){return typeof I=="object"&&I!==null&&I.$$typeof===s}function Q(I){var W={"=":"=0",":":"=2"};return"$"+I.replace(/[=:]/g,function(fe){return W[fe]})}var te=/\/+/g;function ne(I,W){return typeof I=="object"&&I!==null&&I.key!=null?Q(""+I.key):W.toString(36)}function re(I){switch(I.status){case"fulfilled":return I.value;case"rejected":throw I.reason;default:switch(typeof I.status=="string"?I.then(U,U):(I.status="pending",I.then(function(W){I.status==="pending"&&(I.status="fulfilled",I.value=W)},function(W){I.status==="pending"&&(I.status="rejected",I.reason=W)})),I.status){case"fulfilled":return I.value;case"rejected":throw I.reason}}throw I}function j(I,W,fe,Z,me){var $=typeof I;($==="undefined"||$==="boolean")&&(I=null);var pe=!1;if(I===null)pe=!0;else switch($){case"bigint":case"string":case"number":pe=!0;break;case"object":switch(I.$$typeof){case s:case e:pe=!0;break;case m:return pe=I._init,j(pe(I._payload),W,fe,Z,me)}}if(pe)return me=me(I),pe=Z===""?"."+ne(I,0):Z,F(me)?(fe="",pe!=null&&(fe=pe.replace(te,"$&/")+"/"),j(me,W,fe,"",function(Ge){return Ge})):me!=null&&(ee(me)&&(me=O(me,fe+(me.key==null||I&&I.key===me.key?"":(""+me.key).replace(te,"$&/")+"/")+pe)),W.push(me)),1;pe=0;var ve=Z===""?".":Z+":";if(F(I))for(var ze=0;ze<I.length;ze++)Z=I[ze],$=ve+ne(Z,ze),pe+=j(Z,W,fe,$,me);else if(ze=b(I),typeof ze=="function")for(I=ze.call(I),ze=0;!(Z=I.next()).done;)Z=Z.value,$=ve+ne(Z,ze++),pe+=j(Z,W,fe,$,me);else if($==="object"){if(typeof I.then=="function")return j(re(I),W,fe,Z,me);throw W=String(I),Error("Objects are not valid as a React child (found: "+(W==="[object Object]"?"object with keys {"+Object.keys(I).join(", ")+"}":W)+"). If you meant to render a collection of children, use an array instead.")}return pe}function ae(I,W,fe){if(I==null)return I;var Z=[],me=0;return j(I,Z,"","",function($){return W.call(fe,$,me++)}),Z}function J(I){if(I._status===-1){var W=I._result;W=W(),W.then(function(fe){(I._status===0||I._status===-1)&&(I._status=1,I._result=fe)},function(fe){(I._status===0||I._status===-1)&&(I._status=2,I._result=fe)}),I._status===-1&&(I._status=0,I._result=W)}if(I._status===1)return I._result.default;throw I._result}var ie=typeof reportError=="function"?reportError:function(I){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var W=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof I=="object"&&I!==null&&typeof I.message=="string"?String(I.message):String(I),error:I});if(!window.dispatchEvent(W))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",I);return}console.error(I)},se={map:ae,forEach:function(I,W,fe){ae(I,function(){W.apply(this,arguments)},fe)},count:function(I){var W=0;return ae(I,function(){W++}),W},toArray:function(I){return ae(I,function(W){return W})||[]},only:function(I){if(!ee(I))throw Error("React.Children.only expected to receive a single React element child.");return I}};return Kn.Activity=x,Kn.Children=se,Kn.Component=A,Kn.Fragment=t,Kn.Profiler=i,Kn.PureComponent=N,Kn.StrictMode=n,Kn.Suspense=u,Kn.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=z,Kn.__COMPILER_RUNTIME={__proto__:null,c:function(I){return z.H.useMemoCache(I)}},Kn.cache=function(I){return function(){return I.apply(null,arguments)}},Kn.cacheSignal=function(){return null},Kn.cloneElement=function(I,W,fe){if(I==null)throw Error("The argument must be a React element, but you passed "+I+".");var Z=C({},I.props),me=I.key;if(W!=null)for($ in W.key!==void 0&&(me=""+W.key),W)!P.call(W,$)||$==="key"||$==="__self"||$==="__source"||$==="ref"&&W.ref===void 0||(Z[$]=W[$]);var $=arguments.length-2;if($===1)Z.children=fe;else if(1<$){for(var pe=Array($),ve=0;ve<$;ve++)pe[ve]=arguments[ve+2];Z.children=pe}return L(I.type,me,Z)},Kn.createContext=function(I){return I={$$typeof:o,_currentValue:I,_currentValue2:I,_threadCount:0,Provider:null,Consumer:null},I.Provider=I,I.Consumer={$$typeof:a,_context:I},I},Kn.createElement=function(I,W,fe){var Z,me={},$=null;if(W!=null)for(Z in W.key!==void 0&&($=""+W.key),W)P.call(W,Z)&&Z!=="key"&&Z!=="__self"&&Z!=="__source"&&(me[Z]=W[Z]);var pe=arguments.length-2;if(pe===1)me.children=fe;else if(1<pe){for(var ve=Array(pe),ze=0;ze<pe;ze++)ve[ze]=arguments[ze+2];me.children=ve}if(I&&I.defaultProps)for(Z in pe=I.defaultProps,pe)me[Z]===void 0&&(me[Z]=pe[Z]);return L(I,$,me)},Kn.createRef=function(){return{current:null}},Kn.forwardRef=function(I){return{$$typeof:c,render:I}},Kn.isValidElement=ee,Kn.lazy=function(I){return{$$typeof:m,_payload:{_status:-1,_result:I},_init:J}},Kn.memo=function(I,W){return{$$typeof:h,type:I,compare:W===void 0?null:W}},Kn.startTransition=function(I){var W=z.T,fe={};z.T=fe;try{var Z=I(),me=z.S;me!==null&&me(fe,Z),typeof Z=="object"&&Z!==null&&typeof Z.then=="function"&&Z.then(U,ie)}catch($){ie($)}finally{W!==null&&fe.types!==null&&(W.types=fe.types),z.T=W}},Kn.unstable_useCacheRefresh=function(){return z.H.useCacheRefresh()},Kn.use=function(I){return z.H.use(I)},Kn.useActionState=function(I,W,fe){return z.H.useActionState(I,W,fe)},Kn.useCallback=function(I,W){return z.H.useCallback(I,W)},Kn.useContext=function(I){return z.H.useContext(I)},Kn.useDebugValue=function(){},Kn.useDeferredValue=function(I,W){return z.H.useDeferredValue(I,W)},Kn.useEffect=function(I,W){return z.H.useEffect(I,W)},Kn.useEffectEvent=function(I){return z.H.useEffectEvent(I)},Kn.useId=function(){return z.H.useId()},Kn.useImperativeHandle=function(I,W,fe){return z.H.useImperativeHandle(I,W,fe)},Kn.useInsertionEffect=function(I,W){return z.H.useInsertionEffect(I,W)},Kn.useLayoutEffect=function(I,W){return z.H.useLayoutEffect(I,W)},Kn.useMemo=function(I,W){return z.H.useMemo(I,W)},Kn.useOptimistic=function(I,W){return z.H.useOptimistic(I,W)},Kn.useReducer=function(I,W,fe){return z.H.useReducer(I,W,fe)},Kn.useRef=function(I){return z.H.useRef(I)},Kn.useState=function(I){return z.H.useState(I)},Kn.useSyncExternalStore=function(I,W,fe){return z.H.useSyncExternalStore(I,W,fe)},Kn.useTransition=function(){return z.H.useTransition()},Kn.version="19.2.1",Kn}var cM;function t0(){return cM||(cM=1,Eb.exports=mN()),Eb.exports}var Y=t0();const v3=ny(Y);var Cb={exports:{}},xm={},Tb={exports:{}},Rb={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uM;function xN(){return uM||(uM=1,(function(s){function e(j,ae){var J=j.length;j.push(ae);e:for(;0<J;){var ie=J-1>>>1,se=j[ie];if(0<i(se,ae))j[ie]=ae,j[J]=se,J=ie;else break e}}function t(j){return j.length===0?null:j[0]}function n(j){if(j.length===0)return null;var ae=j[0],J=j.pop();if(J!==ae){j[0]=J;e:for(var ie=0,se=j.length,I=se>>>1;ie<I;){var W=2*(ie+1)-1,fe=j[W],Z=W+1,me=j[Z];if(0>i(fe,J))Z<se&&0>i(me,fe)?(j[ie]=me,j[Z]=J,ie=Z):(j[ie]=fe,j[W]=J,ie=W);else if(Z<se&&0>i(me,J))j[ie]=me,j[Z]=J,ie=Z;else break e}}return ae}function i(j,ae){var J=j.sortIndex-ae.sortIndex;return J!==0?J:j.id-ae.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;s.unstable_now=function(){return a.now()}}else{var o=Date,c=o.now();s.unstable_now=function(){return o.now()-c}}var u=[],h=[],m=1,x=null,g=3,b=!1,S=!1,C=!1,M=!1,A=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,N=typeof setImmediate<"u"?setImmediate:null;function B(j){for(var ae=t(h);ae!==null;){if(ae.callback===null)n(h);else if(ae.startTime<=j)n(h),ae.sortIndex=ae.expirationTime,e(u,ae);else break;ae=t(h)}}function F(j){if(C=!1,B(j),!S)if(t(u)!==null)S=!0,U||(U=!0,Q());else{var ae=t(h);ae!==null&&re(F,ae.startTime-j)}}var U=!1,z=-1,P=5,L=-1;function O(){return M?!0:!(s.unstable_now()-L<P)}function ee(){if(M=!1,U){var j=s.unstable_now();L=j;var ae=!0;try{e:{S=!1,C&&(C=!1,R(z),z=-1),b=!0;var J=g;try{t:{for(B(j),x=t(u);x!==null&&!(x.expirationTime>j&&O());){var ie=x.callback;if(typeof ie=="function"){x.callback=null,g=x.priorityLevel;var se=ie(x.expirationTime<=j);if(j=s.unstable_now(),typeof se=="function"){x.callback=se,B(j),ae=!0;break t}x===t(u)&&n(u),B(j)}else n(u);x=t(u)}if(x!==null)ae=!0;else{var I=t(h);I!==null&&re(F,I.startTime-j),ae=!1}}break e}finally{x=null,g=J,b=!1}ae=void 0}}finally{ae?Q():U=!1}}}var Q;if(typeof N=="function")Q=function(){N(ee)};else if(typeof MessageChannel<"u"){var te=new MessageChannel,ne=te.port2;te.port1.onmessage=ee,Q=function(){ne.postMessage(null)}}else Q=function(){A(ee,0)};function re(j,ae){z=A(function(){j(s.unstable_now())},ae)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(j){j.callback=null},s.unstable_forceFrameRate=function(j){0>j||125<j?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<j?Math.floor(1e3/j):5},s.unstable_getCurrentPriorityLevel=function(){return g},s.unstable_next=function(j){switch(g){case 1:case 2:case 3:var ae=3;break;default:ae=g}var J=g;g=ae;try{return j()}finally{g=J}},s.unstable_requestPaint=function(){M=!0},s.unstable_runWithPriority=function(j,ae){switch(j){case 1:case 2:case 3:case 4:case 5:break;default:j=3}var J=g;g=j;try{return ae()}finally{g=J}},s.unstable_scheduleCallback=function(j,ae,J){var ie=s.unstable_now();switch(typeof J=="object"&&J!==null?(J=J.delay,J=typeof J=="number"&&0<J?ie+J:ie):J=ie,j){case 1:var se=-1;break;case 2:se=250;break;case 5:se=1073741823;break;case 4:se=1e4;break;default:se=5e3}return se=J+se,j={id:m++,callback:ae,priorityLevel:j,startTime:J,expirationTime:se,sortIndex:-1},J>ie?(j.sortIndex=J,e(h,j),t(u)===null&&j===t(h)&&(C?(R(z),z=-1):C=!0,re(F,J-ie))):(j.sortIndex=se,e(u,j),S||b||(S=!0,U||(U=!0,Q()))),j},s.unstable_shouldYield=O,s.unstable_wrapCallback=function(j){var ae=g;return function(){var J=g;g=ae;try{return j.apply(this,arguments)}finally{g=J}}}})(Rb)),Rb}var fM;function gN(){return fM||(fM=1,Tb.exports=xN()),Tb.exports}var Nb={exports:{}},Nr={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hM;function vN(){if(hM)return Nr;hM=1;var s=t0();function e(u){var h="https://react.dev/errors/"+u;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)h+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+u+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var n={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},i=Symbol.for("react.portal");function a(u,h,m){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:x==null?null:""+x,children:u,containerInfo:h,implementation:m}}var o=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(u,h){if(u==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return Nr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,Nr.createPortal=function(u,h){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(e(299));return a(u,h,null,m)},Nr.flushSync=function(u){var h=o.T,m=n.p;try{if(o.T=null,n.p=2,u)return u()}finally{o.T=h,n.p=m,n.d.f()}},Nr.preconnect=function(u,h){typeof u=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,n.d.C(u,h))},Nr.prefetchDNS=function(u){typeof u=="string"&&n.d.D(u)},Nr.preinit=function(u,h){if(typeof u=="string"&&h&&typeof h.as=="string"){var m=h.as,x=c(m,h.crossOrigin),g=typeof h.integrity=="string"?h.integrity:void 0,b=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;m==="style"?n.d.S(u,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:x,integrity:g,fetchPriority:b}):m==="script"&&n.d.X(u,{crossOrigin:x,integrity:g,fetchPriority:b,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},Nr.preinitModule=function(u,h){if(typeof u=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var m=c(h.as,h.crossOrigin);n.d.M(u,{crossOrigin:m,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&n.d.M(u)},Nr.preload=function(u,h){if(typeof u=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var m=h.as,x=c(m,h.crossOrigin);n.d.L(u,m,{crossOrigin:x,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},Nr.preloadModule=function(u,h){if(typeof u=="string")if(h){var m=c(h.as,h.crossOrigin);n.d.m(u,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:m,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else n.d.m(u)},Nr.requestFormReset=function(u){n.d.r(u)},Nr.unstable_batchedUpdates=function(u,h){return u(h)},Nr.useFormState=function(u,h,m){return o.H.useFormState(u,h,m)},Nr.useFormStatus=function(){return o.H.useHostTransitionStatus()},Nr.version="19.2.1",Nr}var dM;function yN(){if(dM)return Nb.exports;dM=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),Nb.exports=vN(),Nb.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pM;function bN(){if(pM)return xm;pM=1;var s=gN(),e=t0(),t=yN();function n(r){var l="https://react.dev/errors/"+r;if(1<arguments.length){l+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)l+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+r+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function a(r){var l=r,p=r;if(r.alternate)for(;l.return;)l=l.return;else{r=l;do l=r,(l.flags&4098)!==0&&(p=l.return),r=l.return;while(r)}return l.tag===3?p:null}function o(r){if(r.tag===13){var l=r.memoizedState;if(l===null&&(r=r.alternate,r!==null&&(l=r.memoizedState)),l!==null)return l.dehydrated}return null}function c(r){if(r.tag===31){var l=r.memoizedState;if(l===null&&(r=r.alternate,r!==null&&(l=r.memoizedState)),l!==null)return l.dehydrated}return null}function u(r){if(a(r)!==r)throw Error(n(188))}function h(r){var l=r.alternate;if(!l){if(l=a(r),l===null)throw Error(n(188));return l!==r?null:r}for(var p=r,v=l;;){var w=p.return;if(w===null)break;var T=w.alternate;if(T===null){if(v=w.return,v!==null){p=v;continue}break}if(w.child===T.child){for(T=w.child;T;){if(T===p)return u(w),r;if(T===v)return u(w),l;T=T.sibling}throw Error(n(188))}if(p.return!==v.return)p=w,v=T;else{for(var H=!1,ue=w.child;ue;){if(ue===p){H=!0,p=w,v=T;break}if(ue===v){H=!0,v=w,p=T;break}ue=ue.sibling}if(!H){for(ue=T.child;ue;){if(ue===p){H=!0,p=T,v=w;break}if(ue===v){H=!0,v=T,p=w;break}ue=ue.sibling}if(!H)throw Error(n(189))}}if(p.alternate!==v)throw Error(n(190))}if(p.tag!==3)throw Error(n(188));return p.stateNode.current===p?r:l}function m(r){var l=r.tag;if(l===5||l===26||l===27||l===6)return r;for(r=r.child;r!==null;){if(l=m(r),l!==null)return l;r=r.sibling}return null}var x=Object.assign,g=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),S=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),M=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),R=Symbol.for("react.consumer"),N=Symbol.for("react.context"),B=Symbol.for("react.forward_ref"),F=Symbol.for("react.suspense"),U=Symbol.for("react.suspense_list"),z=Symbol.for("react.memo"),P=Symbol.for("react.lazy"),L=Symbol.for("react.activity"),O=Symbol.for("react.memo_cache_sentinel"),ee=Symbol.iterator;function Q(r){return r===null||typeof r!="object"?null:(r=ee&&r[ee]||r["@@iterator"],typeof r=="function"?r:null)}var te=Symbol.for("react.client.reference");function ne(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===te?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case C:return"Fragment";case A:return"Profiler";case M:return"StrictMode";case F:return"Suspense";case U:return"SuspenseList";case L:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case S:return"Portal";case N:return r.displayName||"Context";case R:return(r._context.displayName||"Context")+".Consumer";case B:var l=r.render;return r=r.displayName,r||(r=l.displayName||l.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case z:return l=r.displayName||null,l!==null?l:ne(r.type)||"Memo";case P:l=r._payload,r=r._init;try{return ne(r(l))}catch{}}return null}var re=Array.isArray,j=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ae=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,J={pending:!1,data:null,method:null,action:null},ie=[],se=-1;function I(r){return{current:r}}function W(r){0>se||(r.current=ie[se],ie[se]=null,se--)}function fe(r,l){se++,ie[se]=r.current,r.current=l}var Z=I(null),me=I(null),$=I(null),pe=I(null);function ve(r,l){switch(fe($,l),fe(me,r),fe(Z,null),l.nodeType){case 9:case 11:r=(r=l.documentElement)&&(r=r.namespaceURI)?RA(r):0;break;default:if(r=l.tagName,l=l.namespaceURI)l=RA(l),r=NA(l,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}W(Z),fe(Z,r)}function ze(){W(Z),W(me),W($)}function Ge(r){r.memoizedState!==null&&fe(pe,r);var l=Z.current,p=NA(l,r.type);l!==p&&(fe(me,r),fe(Z,p))}function Fe(r){me.current===r&&(W(Z),W(me)),pe.current===r&&(W(pe),fm._currentValue=J)}var Qe,lt;function De(r){if(Qe===void 0)try{throw Error()}catch(p){var l=p.stack.trim().match(/\n( *(at )?)/);Qe=l&&l[1]||"",lt=-1<p.stack.indexOf(`
    at`)?" (<anonymous>)":-1<p.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Qe+r+lt}var le=!1;function Ye(r,l){if(!r||le)return"";le=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var v={DetermineComponentFrameRoot:function(){try{if(l){var Bt=function(){throw Error()};if(Object.defineProperty(Bt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Bt,[])}catch(xt){var rt=xt}Reflect.construct(r,[],Bt)}else{try{Bt.call()}catch(xt){rt=xt}r.call(Bt.prototype)}}else{try{throw Error()}catch(xt){rt=xt}(Bt=r())&&typeof Bt.catch=="function"&&Bt.catch(function(){})}}catch(xt){if(xt&&rt&&typeof xt.stack=="string")return[xt.stack,rt.stack]}return[null,null]}};v.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var w=Object.getOwnPropertyDescriptor(v.DetermineComponentFrameRoot,"name");w&&w.configurable&&Object.defineProperty(v.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var T=v.DetermineComponentFrameRoot(),H=T[0],ue=T[1];if(H&&ue){var Te=H.split(`
`),it=ue.split(`
`);for(w=v=0;v<Te.length&&!Te[v].includes("DetermineComponentFrameRoot");)v++;for(;w<it.length&&!it[w].includes("DetermineComponentFrameRoot");)w++;if(v===Te.length||w===it.length)for(v=Te.length-1,w=it.length-1;1<=v&&0<=w&&Te[v]!==it[w];)w--;for(;1<=v&&0<=w;v--,w--)if(Te[v]!==it[w]){if(v!==1||w!==1)do if(v--,w--,0>w||Te[v]!==it[w]){var At=`
`+Te[v].replace(" at new "," at ");return r.displayName&&At.includes("<anonymous>")&&(At=At.replace("<anonymous>",r.displayName)),At}while(1<=v&&0<=w);break}}}finally{le=!1,Error.prepareStackTrace=p}return(p=r?r.displayName||r.name:"")?De(p):""}function Ze(r,l){switch(r.tag){case 26:case 27:case 5:return De(r.type);case 16:return De("Lazy");case 13:return r.child!==l&&l!==null?De("Suspense Fallback"):De("Suspense");case 19:return De("SuspenseList");case 0:case 15:return Ye(r.type,!1);case 11:return Ye(r.type.render,!1);case 1:return Ye(r.type,!0);case 31:return De("Activity");default:return""}}function je(r){try{var l="",p=null;do l+=Ze(r,p),p=r,r=r.return;while(r);return l}catch(v){return`
Error generating stack: `+v.message+`
`+v.stack}}var He=Object.prototype.hasOwnProperty,et=s.unstable_scheduleCallback,Ne=s.unstable_cancelCallback,st=s.unstable_shouldYield,oe=s.unstable_requestPaint,X=s.unstable_now,Ae=s.unstable_getCurrentPriorityLevel,Pe=s.unstable_ImmediatePriority,Ue=s.unstable_UserBlockingPriority,Be=s.unstable_NormalPriority,bt=s.unstable_LowPriority,vt=s.unstable_IdlePriority,It=s.log,zt=s.unstable_setDisableYieldValue,qe=null,We=null;function ft(r){if(typeof It=="function"&&zt(r),We&&typeof We.setStrictMode=="function")try{We.setStrictMode(qe,r)}catch{}}var ge=Math.clz32?Math.clz32:ye,Ie=Math.log,ht=Math.LN2;function ye(r){return r>>>=0,r===0?32:31-(Ie(r)/ht|0)|0}var Re=256,pt=262144,Rt=4194304;function dt(r){var l=r&42;if(l!==0)return l;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function Ke(r,l,p){var v=r.pendingLanes;if(v===0)return 0;var w=0,T=r.suspendedLanes,H=r.pingedLanes;r=r.warmLanes;var ue=v&134217727;return ue!==0?(v=ue&~T,v!==0?w=dt(v):(H&=ue,H!==0?w=dt(H):p||(p=ue&~r,p!==0&&(w=dt(p))))):(ue=v&~T,ue!==0?w=dt(ue):H!==0?w=dt(H):p||(p=v&~r,p!==0&&(w=dt(p)))),w===0?0:l!==0&&l!==w&&(l&T)===0&&(T=w&-w,p=l&-l,T>=p||T===32&&(p&4194048)!==0)?l:w}function Lt(r,l){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&l)===0}function Vt(r,l){switch(r){case 1:case 2:case 4:case 8:case 64:return l+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Kt(){var r=Rt;return Rt<<=1,(Rt&62914560)===0&&(Rt=4194304),r}function on(r){for(var l=[],p=0;31>p;p++)l.push(r);return l}function Gn(r,l){r.pendingLanes|=l,l!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function En(r,l,p,v,w,T){var H=r.pendingLanes;r.pendingLanes=p,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=p,r.entangledLanes&=p,r.errorRecoveryDisabledLanes&=p,r.shellSuspendCounter=0;var ue=r.entanglements,Te=r.expirationTimes,it=r.hiddenUpdates;for(p=H&~p;0<p;){var At=31-ge(p),Bt=1<<At;ue[At]=0,Te[At]=-1;var rt=it[At];if(rt!==null)for(it[At]=null,At=0;At<rt.length;At++){var xt=rt[At];xt!==null&&(xt.lane&=-536870913)}p&=~Bt}v!==0&&li(r,v,0),T!==0&&w===0&&r.tag!==0&&(r.suspendedLanes|=T&~(H&~l))}function li(r,l,p){r.pendingLanes|=l,r.suspendedLanes&=~l;var v=31-ge(l);r.entangledLanes|=l,r.entanglements[v]=r.entanglements[v]|1073741824|p&261930}function qi(r,l){var p=r.entangledLanes|=l;for(r=r.entanglements;p;){var v=31-ge(p),w=1<<v;w&l|r[v]&l&&(r[v]|=l),p&=~w}}function la(r,l){var p=l&-l;return p=(p&42)!==0?1:di(p),(p&(r.suspendedLanes|l))!==0?0:p}function di(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function Qi(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function Mi(){var r=ae.p;return r!==0?r:(r=window.event,r===void 0?32:$A(r.type))}function mn(r,l){var p=ae.p;try{return ae.p=r,l()}finally{ae.p=p}}var jn=Math.random().toString(36).slice(2),bn="__reactFiber$"+jn,q="__reactProps$"+jn,he="__reactContainer$"+jn,we="__reactEvents$"+jn,Je="__reactListeners$"+jn,ot="__reactHandles$"+jn,ct="__reactResources$"+jn,Ot="__reactMarker$"+jn;function Dt(r){delete r[bn],delete r[q],delete r[we],delete r[Je],delete r[ot]}function Nt(r){var l=r[bn];if(l)return l;for(var p=r.parentNode;p;){if(l=p[he]||p[bn]){if(p=l.alternate,l.child!==null||p!==null&&p.child!==null)for(r=zA(r);r!==null;){if(p=r[bn])return p;r=zA(r)}return l}r=p,p=r.parentNode}return null}function K(r){if(r=r[bn]||r[he]){var l=r.tag;if(l===5||l===6||l===13||l===31||l===26||l===27||l===3)return r}return null}function be(r){var l=r.tag;if(l===5||l===26||l===27||l===6)return r.stateNode;throw Error(n(33))}function xe(r){var l=r[ct];return l||(l=r[ct]={hoistableStyles:new Map,hoistableScripts:new Map}),l}function Oe(r){r[Ot]=!0}var Me=new Set,$e={};function yt(r,l){Mt(r,l),Mt(r+"Capture",l)}function Mt(r,l){for($e[r]=l,r=0;r<l.length;r++)Me.add(l[r])}var Ft=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),mt={},Pt={};function en(r){return He.call(Pt,r)?!0:He.call(mt,r)?!1:Ft.test(r)?Pt[r]=!0:(mt[r]=!0,!1)}function Qt(r,l,p){if(en(l))if(p===null)r.removeAttribute(l);else{switch(typeof p){case"undefined":case"function":case"symbol":r.removeAttribute(l);return;case"boolean":var v=l.toLowerCase().slice(0,5);if(v!=="data-"&&v!=="aria-"){r.removeAttribute(l);return}}r.setAttribute(l,""+p)}}function yn(r,l,p){if(p===null)r.removeAttribute(l);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(l);return}r.setAttribute(l,""+p)}}function ln(r,l,p,v){if(v===null)r.removeAttribute(p);else{switch(typeof v){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(p);return}r.setAttributeNS(l,p,""+v)}}function xn(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function Un(r){var l=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function an(r,l,p){var v=Object.getOwnPropertyDescriptor(r.constructor.prototype,l);if(!r.hasOwnProperty(l)&&typeof v<"u"&&typeof v.get=="function"&&typeof v.set=="function"){var w=v.get,T=v.set;return Object.defineProperty(r,l,{configurable:!0,get:function(){return w.call(this)},set:function(H){p=""+H,T.call(this,H)}}),Object.defineProperty(r,l,{enumerable:v.enumerable}),{getValue:function(){return p},setValue:function(H){p=""+H},stopTracking:function(){r._valueTracker=null,delete r[l]}}}}function Bn(r){if(!r._valueTracker){var l=Un(r)?"checked":"value";r._valueTracker=an(r,l,""+r[l])}}function tn(r){if(!r)return!1;var l=r._valueTracker;if(!l)return!0;var p=l.getValue(),v="";return r&&(v=Un(r)?r.checked?"true":"false":r.value),r=v,r!==p?(l.setValue(r),!0):!1}function Hn(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var kn=/[\n"\\]/g;function hn(r){return r.replace(kn,function(l){return"\\"+l.charCodeAt(0).toString(16)+" "})}function Ni(r,l,p,v,w,T,H,ue){r.name="",H!=null&&typeof H!="function"&&typeof H!="symbol"&&typeof H!="boolean"?r.type=H:r.removeAttribute("type"),l!=null?H==="number"?(l===0&&r.value===""||r.value!=l)&&(r.value=""+xn(l)):r.value!==""+xn(l)&&(r.value=""+xn(l)):H!=="submit"&&H!=="reset"||r.removeAttribute("value"),l!=null?Wn(r,H,xn(l)):p!=null?Wn(r,H,xn(p)):v!=null&&r.removeAttribute("value"),w==null&&T!=null&&(r.defaultChecked=!!T),w!=null&&(r.checked=w&&typeof w!="function"&&typeof w!="symbol"),ue!=null&&typeof ue!="function"&&typeof ue!="symbol"&&typeof ue!="boolean"?r.name=""+xn(ue):r.removeAttribute("name")}function Yn(r,l,p,v,w,T,H,ue){if(T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(r.type=T),l!=null||p!=null){if(!(T!=="submit"&&T!=="reset"||l!=null)){Bn(r);return}p=p!=null?""+xn(p):"",l=l!=null?""+xn(l):p,ue||l===r.value||(r.value=l),r.defaultValue=l}v=v??w,v=typeof v!="function"&&typeof v!="symbol"&&!!v,r.checked=ue?r.checked:!!v,r.defaultChecked=!!v,H!=null&&typeof H!="function"&&typeof H!="symbol"&&typeof H!="boolean"&&(r.name=H),Bn(r)}function Wn(r,l,p){l==="number"&&Hn(r.ownerDocument)===r||r.defaultValue===""+p||(r.defaultValue=""+p)}function xi(r,l,p,v){if(r=r.options,l){l={};for(var w=0;w<p.length;w++)l["$"+p[w]]=!0;for(p=0;p<r.length;p++)w=l.hasOwnProperty("$"+r[p].value),r[p].selected!==w&&(r[p].selected=w),w&&v&&(r[p].defaultSelected=!0)}else{for(p=""+xn(p),l=null,w=0;w<r.length;w++){if(r[w].value===p){r[w].selected=!0,v&&(r[w].defaultSelected=!0);return}l!==null||r[w].disabled||(l=r[w])}l!==null&&(l.selected=!0)}}function ki(r,l,p){if(l!=null&&(l=""+xn(l),l!==r.value&&(r.value=l),p==null)){r.defaultValue!==l&&(r.defaultValue=l);return}r.defaultValue=p!=null?""+xn(p):""}function Di(r,l,p,v){if(l==null){if(v!=null){if(p!=null)throw Error(n(92));if(re(v)){if(1<v.length)throw Error(n(93));v=v[0]}p=v}p==null&&(p=""),l=p}p=xn(l),r.defaultValue=p,v=r.textContent,v===p&&v!==""&&v!==null&&(r.value=v),Bn(r)}function Ga(r,l){if(l){var p=r.firstChild;if(p&&p===r.lastChild&&p.nodeType===3){p.nodeValue=l;return}}r.textContent=l}var Ka=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function hr(r,l,p){var v=l.indexOf("--")===0;p==null||typeof p=="boolean"||p===""?v?r.setProperty(l,""):l==="float"?r.cssFloat="":r[l]="":v?r.setProperty(l,p):typeof p!="number"||p===0||Ka.has(l)?l==="float"?r.cssFloat=p:r[l]=(""+p).trim():r[l]=p+"px"}function To(r,l,p){if(l!=null&&typeof l!="object")throw Error(n(62));if(r=r.style,p!=null){for(var v in p)!p.hasOwnProperty(v)||l!=null&&l.hasOwnProperty(v)||(v.indexOf("--")===0?r.setProperty(v,""):v==="float"?r.cssFloat="":r[v]="");for(var w in l)v=l[w],l.hasOwnProperty(w)&&p[w]!==v&&hr(r,w,v)}else for(var T in l)l.hasOwnProperty(T)&&hr(r,T,l[T])}function vs(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Nl=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),dr=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ys(r){return dr.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function da(){}var qs=null;function ho(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var bs=null,ja=null;function Or(r){var l=K(r);if(l&&(r=l.stateNode)){var p=r[q]||null;e:switch(r=l.stateNode,l.type){case"input":if(Ni(r,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name),l=p.name,p.type==="radio"&&l!=null){for(p=r;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll('input[name="'+hn(""+l)+'"][type="radio"]'),l=0;l<p.length;l++){var v=p[l];if(v!==r&&v.form===r.form){var w=v[q]||null;if(!w)throw Error(n(90));Ni(v,w.value,w.defaultValue,w.defaultValue,w.checked,w.defaultChecked,w.type,w.name)}}for(l=0;l<p.length;l++)v=p[l],v.form===r.form&&tn(v)}break e;case"textarea":ki(r,p.value,p.defaultValue);break e;case"select":l=p.value,l!=null&&xi(r,!!p.multiple,l,!1)}}}var Ir=!1;function pr(r,l,p){if(Ir)return r(l,p);Ir=!0;try{var v=r(l);return v}finally{if(Ir=!1,(bs!==null||ja!==null)&&(de(),bs&&(l=bs,r=ja,ja=bs=null,Or(l),r)))for(l=0;l<r.length;l++)Or(r[l])}}function Ha(r,l){var p=r.stateNode;if(p===null)return null;var v=p[q]||null;if(v===null)return null;p=v[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(v=!v.disabled)||(r=r.type,v=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!v;break e;default:r=!1}if(r)return null;if(p&&typeof p!="function")throw Error(n(231,l,typeof p));return p}var pa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),gn=!1;if(pa)try{var zr={};Object.defineProperty(zr,"passive",{get:function(){gn=!0}}),window.addEventListener("test",zr,zr),window.removeEventListener("test",zr,zr)}catch{gn=!1}var _s=null,Ro=null,Ns=null;function No(){if(Ns)return Ns;var r,l=Ro,p=l.length,v,w="value"in _s?_s.value:_s.textContent,T=w.length;for(r=0;r<p&&l[r]===w[r];r++);var H=p-r;for(v=1;v<=H&&l[p-v]===w[T-v];v++);return Ns=w.slice(r,1<v?1-v:void 0)}function mr(r){var l=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&l===13&&(r=13)):r=l,r===10&&(r=13),32<=r||r===13?r:0}function Js(){return!0}function Fr(){return!1}function Vi(r){function l(p,v,w,T,H){this._reactName=p,this._targetInst=w,this.type=v,this.nativeEvent=T,this.target=H,this.currentTarget=null;for(var ue in r)r.hasOwnProperty(ue)&&(p=r[ue],this[ue]=p?p(T):T[ue]);return this.isDefaultPrevented=(T.defaultPrevented!=null?T.defaultPrevented:T.returnValue===!1)?Js:Fr,this.isPropagationStopped=Fr,this}return x(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=Js)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=Js)},persist:function(){},isPersistent:Js}),l}var Bs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ma=Vi(Bs),ka=x({},Bs,{view:0,detail:0}),xr=Vi(ka),Pr,Zs,gr,xa=x({},ka,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Bo,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==gr&&(gr&&r.type==="mousemove"?(Pr=r.screenX-gr.screenX,Zs=r.screenY-gr.screenY):Zs=Pr=0,gr=r),Pr)},movementY:function(r){return"movementY"in r?r.movementY:Zs}}),hc=Vi(xa),na=x({},xa,{dataTransfer:0}),Gr=Vi(na),Bl=x({},ka,{relatedTarget:0}),jr=Vi(Bl),ga=x({},Bs,{animationName:0,elapsedTime:0,pseudoElement:0}),Qa=Vi(ga),ca=x({},Bs,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),Ds=Vi(ca),Zo=x({},Bs,{data:0}),tu=Vi(Zo),vr={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},nu={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},zi={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ss(r){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(r):(r=zi[r])?!!l[r]:!1}function Bo(){return Ss}var iu=x({},ka,{key:function(r){if(r.key){var l=vr[r.key]||r.key;if(l!=="Unidentified")return l}return r.type==="keypress"?(r=mr(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?nu[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Bo,charCode:function(r){return r.type==="keypress"?mr(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?mr(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),Dl=Vi(iu),qn=x({},xa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ko=Vi(qn),fi=x({},ka,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Bo}),Va=Vi(fi),po=x({},Bs,{propertyName:0,elapsedTime:0,pseudoElement:0}),kf=Vi(po),dc=x({},xa,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),mo=Vi(dc),Ks=x({},Bs,{newState:0,oldState:0}),ua=Vi(Ks),Qo=[9,13,27,32],xo=pa&&"CompositionEvent"in window,Hr=null;pa&&"documentMode"in document&&(Hr=document.documentMode);var Do=pa&&"TextEvent"in window&&!Hr,va=pa&&(!xo||Hr&&8<Hr&&11>=Hr),$o=" ",au=!1;function Ul(r,l){switch(r){case"keyup":return Qo.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Uo(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var kr=!1;function Xa(r,l){switch(r){case"compositionend":return Uo(l);case"keypress":return l.which!==32?null:(au=!0,$o);case"textInput":return r=l.data,r===$o&&au?null:r;default:return null}}function su(r,l){if(kr)return r==="compositionend"||!xo&&Ul(r,l)?(r=No(),Ns=Ro=_s=null,kr=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return va&&l.locale!=="ko"?null:l.data;default:return null}}var V={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wt(r){var l=r&&r.nodeName&&r.nodeName.toLowerCase();return l==="input"?!!V[r.type]:l==="textarea"}function Ui(r,l,p,v){bs?ja?ja.push(v):ja=[v]:bs=v,l=yg(l,"onChange"),0<l.length&&(p=new ma("onChange","change",null,p,v),r.push({event:p,listeners:l}))}var Ji=null,pc=null;function Vf(r){AA(r,0)}function mc(r){var l=be(r);if(tn(l))return r}function Xf(r,l){if(r==="change")return l}var ru=!1;if(pa){var Ll;if(pa){var $i="oninput"in document;if(!$i){var fd=document.createElement("div");fd.setAttribute("oninput","return;"),$i=typeof fd.oninput=="function"}Ll=$i}else Ll=!1;ru=Ll&&(!document.documentMode||9<document.documentMode)}function ce(){Ji&&(Ji.detachEvent("onpropertychange",Se),pc=Ji=null)}function Se(r){if(r.propertyName==="value"&&mc(pc)){var l=[];Ui(l,pc,r,ho(r)),pr(Vf,l)}}function _e(r,l,p){r==="focusin"?(ce(),Ji=l,pc=p,Ji.attachEvent("onpropertychange",Se)):r==="focusout"&&ce()}function Ee(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return mc(pc)}function tt(r,l){if(r==="click")return mc(l)}function St(r,l){if(r==="input"||r==="change")return mc(l)}function Ut(r,l){return r===l&&(r!==0||1/r===1/l)||r!==r&&l!==l}var wt=typeof Object.is=="function"?Object.is:Ut;function fn(r,l){if(wt(r,l))return!0;if(typeof r!="object"||r===null||typeof l!="object"||l===null)return!1;var p=Object.keys(r),v=Object.keys(l);if(p.length!==v.length)return!1;for(v=0;v<p.length;v++){var w=p[v];if(!He.call(l,w)||!wt(r[w],l[w]))return!1}return!0}function Ht(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function Et(r,l){var p=Ht(r);r=0;for(var v;p;){if(p.nodeType===3){if(v=r+p.textContent.length,r<=l&&v>=l)return{node:p,offset:l-r};r=v}e:{for(;p;){if(p.nextSibling){p=p.nextSibling;break e}p=p.parentNode}p=void 0}p=Ht(p)}}function dn(r,l){return r&&l?r===l?!0:r&&r.nodeType===3?!1:l&&l.nodeType===3?dn(r,l.parentNode):"contains"in r?r.contains(l):r.compareDocumentPosition?!!(r.compareDocumentPosition(l)&16):!1:!1}function Xt(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var l=Hn(r.document);l instanceof r.HTMLIFrameElement;){try{var p=typeof l.contentWindow.location.href=="string"}catch{p=!1}if(p)r=l.contentWindow;else break;l=Hn(r.document)}return l}function Zt(r){var l=r&&r.nodeName&&r.nodeName.toLowerCase();return l&&(l==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||l==="textarea"||r.contentEditable==="true")}var Gt=pa&&"documentMode"in document&&11>=document.documentMode,_n=null,nn=null,kt=null,An=!1;function Zn(r,l,p){var v=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;An||_n==null||_n!==Hn(v)||(v=_n,"selectionStart"in v&&Zt(v)?v={start:v.selectionStart,end:v.selectionEnd}:(v=(v.ownerDocument&&v.ownerDocument.defaultView||window).getSelection(),v={anchorNode:v.anchorNode,anchorOffset:v.anchorOffset,focusNode:v.focusNode,focusOffset:v.focusOffset}),kt&&fn(kt,v)||(kt=v,v=yg(nn,"onSelect"),0<v.length&&(l=new ma("onSelect","select",null,l,p),r.push({event:l,listeners:v}),l.target=_n)))}function ya(r,l){var p={};return p[r.toLowerCase()]=l.toLowerCase(),p["Webkit"+r]="webkit"+l,p["Moz"+r]="moz"+l,p}var ls={animationend:ya("Animation","AnimationEnd"),animationiteration:ya("Animation","AnimationIteration"),animationstart:ya("Animation","AnimationStart"),transitionrun:ya("Transition","TransitionRun"),transitionstart:ya("Transition","TransitionStart"),transitioncancel:ya("Transition","TransitionCancel"),transitionend:ya("Transition","TransitionEnd")},Vr={},cs={};pa&&(cs=document.createElement("div").style,"AnimationEvent"in window||(delete ls.animationend.animation,delete ls.animationiteration.animation,delete ls.animationstart.animation),"TransitionEvent"in window||delete ls.transitionend.transition);function xc(r){if(Vr[r])return Vr[r];if(!ls[r])return r;var l=ls[r],p;for(p in l)if(l.hasOwnProperty(p)&&p in cs)return Vr[r]=l[p];return r}var yr=xc("animationend"),f0=xc("animationiteration"),el=xc("animationstart"),ju=xc("transitionrun"),gc=xc("transitionstart"),h0=xc("transitioncancel"),hd=xc("transitionend"),Ol=new Map,dd="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");dd.push("scrollEnd");function Us(r,l){Ol.set(r,l),yt(l,[r])}var vc=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var l=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(l))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},us=[],ou=0,pd=0;function yc(){for(var r=ou,l=pd=ou=0;l<r;){var p=us[l];us[l++]=null;var v=us[l];us[l++]=null;var w=us[l];us[l++]=null;var T=us[l];if(us[l++]=null,v!==null&&w!==null){var H=v.pending;H===null?w.next=w:(w.next=H.next,H.next=w),v.pending=w}T!==0&&md(p,w,T)}}function Yf(r,l,p,v){us[ou++]=r,us[ou++]=l,us[ou++]=p,us[ou++]=v,pd|=v,r.lanes|=v,r=r.alternate,r!==null&&(r.lanes|=v)}function Hu(r,l,p,v){return Yf(r,l,p,v),ku(r)}function bc(r,l){return Yf(r,null,null,l),ku(r)}function md(r,l,p){r.lanes|=p;var v=r.alternate;v!==null&&(v.lanes|=p);for(var w=!1,T=r.return;T!==null;)T.childLanes|=p,v=T.alternate,v!==null&&(v.childLanes|=p),T.tag===22&&(r=T.stateNode,r===null||r._visibility&1||(w=!0)),r=T,T=T.return;return r.tag===3?(T=r.stateNode,w&&l!==null&&(w=31-ge(p),r=T.hiddenUpdates,v=r[w],v===null?r[w]=[l]:v.push(l),l.lane=p|536870912),T):null}function ku(r){if(50<Mu)throw Mu=0,wu=null,Error(n(185));for(var l=r.return;l!==null;)r=l,l=r.return;return r.tag===3?r.stateNode:null}var _c={};function Lx(r,l,p,v){this.tag=r,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=v,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Qs(r,l,p,v){return new Lx(r,l,p,v)}function $s(r){return r=r.prototype,!(!r||!r.isReactComponent)}function tl(r,l){var p=r.alternate;return p===null?(p=Qs(r.tag,l,r.key,r.mode),p.elementType=r.elementType,p.type=r.type,p.stateNode=r.stateNode,p.alternate=r,r.alternate=p):(p.pendingProps=l,p.type=r.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=r.flags&65011712,p.childLanes=r.childLanes,p.lanes=r.lanes,p.child=r.child,p.memoizedProps=r.memoizedProps,p.memoizedState=r.memoizedState,p.updateQueue=r.updateQueue,l=r.dependencies,p.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},p.sibling=r.sibling,p.index=r.index,p.ref=r.ref,p.refCleanup=r.refCleanup,p}function Ls(r,l){r.flags&=65011714;var p=r.alternate;return p===null?(r.childLanes=0,r.lanes=l,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=p.childLanes,r.lanes=p.lanes,r.child=p.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=p.memoizedProps,r.memoizedState=p.memoizedState,r.updateQueue=p.updateQueue,r.type=p.type,l=p.dependencies,r.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),r}function Wf(r,l,p,v,w,T){var H=0;if(v=r,typeof r=="function")$s(r)&&(H=1);else if(typeof r=="string")H=$R(r,p,Z.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case L:return r=Qs(31,p,l,w),r.elementType=L,r.lanes=T,r;case C:return Il(p.children,w,T,l);case M:H=8,w|=24;break;case A:return r=Qs(12,p,l,w|2),r.elementType=A,r.lanes=T,r;case F:return r=Qs(13,p,l,w),r.elementType=F,r.lanes=T,r;case U:return r=Qs(19,p,l,w),r.elementType=U,r.lanes=T,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case N:H=10;break e;case R:H=9;break e;case B:H=11;break e;case z:H=14;break e;case P:H=16,v=null;break e}H=29,p=Error(n(130,r===null?"null":typeof r,"")),v=null}return l=Qs(H,p,l,w),l.elementType=r,l.type=v,l.lanes=T,l}function Il(r,l,p,v){return r=Qs(7,r,v,l),r.lanes=p,r}function xd(r,l,p){return r=Qs(6,r,null,l),r.lanes=p,r}function Ox(r){var l=Qs(18,null,null,0);return l.stateNode=r,l}function Lo(r,l,p){return l=Qs(4,r.children!==null?r.children:[],r.key,l),l.lanes=p,l.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},l}var d0=new WeakMap;function br(r,l){if(typeof r=="object"&&r!==null){var p=d0.get(r);return p!==void 0?p:(l={value:r,source:l,stack:je(l)},d0.set(r,l),l)}return{value:r,source:l,stack:je(l)}}var Oo=[],lu=0,qf=null,Vu=0,Xr=[],_r=0,nl=null,il=1,al="";function zl(r,l){Oo[lu++]=Vu,Oo[lu++]=qf,qf=r,Vu=l}function p0(r,l,p){Xr[_r++]=il,Xr[_r++]=al,Xr[_r++]=nl,nl=r;var v=il;r=al;var w=32-ge(v)-1;v&=~(1<<w),p+=1;var T=32-ge(l)+w;if(30<T){var H=w-w%5;T=(v&(1<<H)-1).toString(32),v>>=H,w-=H,il=1<<32-ge(l)+w|p<<w|v,al=T+r}else il=1<<T|p<<w|v,al=r}function gd(r){r.return!==null&&(zl(r,1),p0(r,1,0))}function Sc(r){for(;r===qf;)qf=Oo[--lu],Oo[lu]=null,Vu=Oo[--lu],Oo[lu]=null;for(;r===nl;)nl=Xr[--_r],Xr[_r]=null,al=Xr[--_r],Xr[_r]=null,il=Xr[--_r],Xr[_r]=null}function Jf(r,l){Xr[_r++]=il,Xr[_r++]=al,Xr[_r++]=nl,il=l.id,al=l.overflow,nl=r}var fs=null,ia=null,gi=!1,Fl=null,hs=!1,vd=Error(n(519));function pi(r){var l=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Zf(br(l,r)),vd}function yd(r){var l=r.stateNode,p=r.type,v=r.memoizedProps;switch(l[bn]=r,l[q]=v,p){case"dialog":vi("cancel",l),vi("close",l);break;case"iframe":case"object":case"embed":vi("load",l);break;case"video":case"audio":for(p=0;p<rm.length;p++)vi(rm[p],l);break;case"source":vi("error",l);break;case"img":case"image":case"link":vi("error",l),vi("load",l);break;case"details":vi("toggle",l);break;case"input":vi("invalid",l),Yn(l,v.value,v.defaultValue,v.checked,v.defaultChecked,v.type,v.name,!0);break;case"select":vi("invalid",l);break;case"textarea":vi("invalid",l),Di(l,v.value,v.defaultValue,v.children)}p=v.children,typeof p!="string"&&typeof p!="number"&&typeof p!="bigint"||l.textContent===""+p||v.suppressHydrationWarning===!0||CA(l.textContent,p)?(v.popover!=null&&(vi("beforetoggle",l),vi("toggle",l)),v.onScroll!=null&&vi("scroll",l),v.onScrollEnd!=null&&vi("scrollend",l),v.onClick!=null&&(l.onclick=da),l=!0):l=!1,l||pi(r,!0)}function Ix(r){for(fs=r.return;fs;)switch(fs.tag){case 5:case 31:case 13:hs=!1;return;case 27:case 3:hs=!0;return;default:fs=fs.return}}function cu(r){if(r!==fs)return!1;if(!gi)return Ix(r),gi=!0,!1;var l=r.tag,p;if((p=l!==3&&l!==27)&&((p=l===5)&&(p=r.type,p=!(p!=="form"&&p!=="button")||ub(r.type,r.memoizedProps)),p=!p),p&&ia&&pi(r),Ix(r),l===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(317));ia=IA(r)}else if(l===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(317));ia=IA(r)}else l===27?(l=ia,uf(r.type)?(r=mb,mb=null,ia=r):ia=l):ia=fs?ml(r.stateNode.nextSibling):null;return!0}function uu(){ia=fs=null,gi=!1}function m0(){var r=Fl;return r!==null&&(Gs===null?Gs=r:Gs.push.apply(Gs,r),Fl=null),r}function Zf(r){Fl===null?Fl=[r]:Fl.push(r)}var x0=I(null),Pl=null,Os=null;function Gl(r,l,p){fe(x0,l._currentValue),l._currentValue=p}function go(r){r._currentValue=x0.current,W(x0)}function jl(r,l,p){for(;r!==null;){var v=r.alternate;if((r.childLanes&l)!==l?(r.childLanes|=l,v!==null&&(v.childLanes|=l)):v!==null&&(v.childLanes&l)!==l&&(v.childLanes|=l),r===p)break;r=r.return}}function bd(r,l,p,v){var w=r.child;for(w!==null&&(w.return=r);w!==null;){var T=w.dependencies;if(T!==null){var H=w.child;T=T.firstContext;e:for(;T!==null;){var ue=T;T=w;for(var Te=0;Te<l.length;Te++)if(ue.context===l[Te]){T.lanes|=p,ue=T.alternate,ue!==null&&(ue.lanes|=p),jl(T.return,p,r),v||(H=null);break e}T=ue.next}}else if(w.tag===18){if(H=w.return,H===null)throw Error(n(341));H.lanes|=p,T=H.alternate,T!==null&&(T.lanes|=p),jl(H,p,r),H=null}else H=w.child;if(H!==null)H.return=w;else for(H=w;H!==null;){if(H===r){H=null;break}if(w=H.sibling,w!==null){w.return=H.return,H=w;break}H=H.return}w=H}}function Ac(r,l,p,v){r=null;for(var w=l,T=!1;w!==null;){if(!T){if((w.flags&524288)!==0)T=!0;else if((w.flags&262144)!==0)break}if(w.tag===10){var H=w.alternate;if(H===null)throw Error(n(387));if(H=H.memoizedProps,H!==null){var ue=w.type;wt(w.pendingProps.value,H.value)||(r!==null?r.push(ue):r=[ue])}}else if(w===pe.current){if(H=w.alternate,H===null)throw Error(n(387));H.memoizedState.memoizedState!==w.memoizedState.memoizedState&&(r!==null?r.push(fm):r=[fm])}w=w.return}r!==null&&bd(l,r,p,v),l.flags|=262144}function Xu(r){for(r=r.firstContext;r!==null;){if(!wt(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function fu(r){Pl=r,Os=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function ds(r){return g0(Pl,r)}function Kf(r,l){return Pl===null&&fu(r),g0(r,l)}function g0(r,l){var p=l._currentValue;if(l={context:l,memoizedValue:p,next:null},Os===null){if(r===null)throw Error(n(308));Os=l,r.dependencies={lanes:0,firstContext:l},r.flags|=524288}else Os=Os.next=l;return p}var zx=typeof AbortController<"u"?AbortController:function(){var r=[],l=this.signal={aborted:!1,addEventListener:function(p,v){r.push(v)}};this.abort=function(){l.aborted=!0,r.forEach(function(p){return p()})}},Fx=s.unstable_scheduleCallback,v0=s.unstable_NormalPriority,Cn={$$typeof:N,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function y0(){return{controller:new zx,data:new Map,refCount:0}}function As(r){r.refCount--,r.refCount===0&&Fx(v0,function(){r.controller.abort()})}var hu=null,b0=0,Hl=0,Io=null;function Yu(r,l){if(hu===null){var p=hu=[];b0=0,Hl=tb(),Io={status:"pending",value:void 0,then:function(v){p.push(v)}}}return b0++,l.then(_0,_0),l}function _0(){if(--b0===0&&hu!==null){Io!==null&&(Io.status="fulfilled");var r=hu;hu=null,Hl=0,Io=null;for(var l=0;l<r.length;l++)(0,r[l])()}}function S0(r,l){var p=[],v={status:"pending",value:null,reason:null,then:function(w){p.push(w)}};return r.then(function(){v.status="fulfilled",v.value=l;for(var w=0;w<p.length;w++)(0,p[w])(l)},function(w){for(v.status="rejected",v.reason=w,w=0;w<p.length;w++)(0,p[w])(void 0)}),v}var Px=j.S;j.S=function(r,l){of=X(),typeof l=="object"&&l!==null&&typeof l.then=="function"&&Yu(r,l),Px!==null&&Px(r,l)};var Mc=I(null);function sl(){var r=Mc.current;return r!==null?r:Pi.pooledCache}function Wu(r,l){l===null?fe(Mc,Mc.current):fe(Mc,l.pool)}function _d(){var r=sl();return r===null?null:{parent:Cn._currentValue,pool:r}}var wc=Error(n(460)),Qf=Error(n(474)),zo=Error(n(542)),$f={then:function(){}};function Gx(r){return r=r.status,r==="fulfilled"||r==="rejected"}function A0(r,l,p){switch(p=r[p],p===void 0?r.push(l):p!==l&&(l.then(da,da),l=p),l.status){case"fulfilled":return l.value;case"rejected":throw r=l.reason,M0(r),r;default:if(typeof l.status=="string")l.then(da,da);else{if(r=Pi,r!==null&&100<r.shellSuspendCounter)throw Error(n(482));r=l,r.status="pending",r.then(function(v){if(l.status==="pending"){var w=l;w.status="fulfilled",w.value=v}},function(v){if(l.status==="pending"){var w=l;w.status="rejected",w.reason=v}})}switch(l.status){case"fulfilled":return l.value;case"rejected":throw r=l.reason,M0(r),r}throw Dn=l,wc}}function du(r){try{var l=r._init;return l(r._payload)}catch(p){throw p!==null&&typeof p=="object"&&typeof p.then=="function"?(Dn=p,wc):p}}var Dn=null;function Sd(){if(Dn===null)throw Error(n(459));var r=Dn;return Dn=null,r}function M0(r){if(r===wc||r===zo)throw Error(n(483))}var Ec=null,Cc=0;function Ad(r){var l=Cc;return Cc+=1,Ec===null&&(Ec=[]),A0(Ec,r,l)}function eh(r,l){l=l.props.ref,r.ref=l!==void 0?l:null}function th(r,l){throw l.$$typeof===g?Error(n(525)):(r=Object.prototype.toString.call(l),Error(n(31,r==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":r)))}function qu(r){function l(Ve,Le){if(r){var nt=Ve.deletions;nt===null?(Ve.deletions=[Le],Ve.flags|=16):nt.push(Le)}}function p(Ve,Le){if(!r)return null;for(;Le!==null;)l(Ve,Le),Le=Le.sibling;return null}function v(Ve){for(var Le=new Map;Ve!==null;)Ve.key!==null?Le.set(Ve.key,Ve):Le.set(Ve.index,Ve),Ve=Ve.sibling;return Le}function w(Ve,Le){return Ve=tl(Ve,Le),Ve.index=0,Ve.sibling=null,Ve}function T(Ve,Le,nt){return Ve.index=nt,r?(nt=Ve.alternate,nt!==null?(nt=nt.index,nt<Le?(Ve.flags|=67108866,Le):nt):(Ve.flags|=67108866,Le)):(Ve.flags|=1048576,Le)}function H(Ve){return r&&Ve.alternate===null&&(Ve.flags|=67108866),Ve}function ue(Ve,Le,nt,Tt){return Le===null||Le.tag!==6?(Le=xd(nt,Ve.mode,Tt),Le.return=Ve,Le):(Le=w(Le,nt),Le.return=Ve,Le)}function Te(Ve,Le,nt,Tt){var Nn=nt.type;return Nn===C?At(Ve,Le,nt.props.children,Tt,nt.key):Le!==null&&(Le.elementType===Nn||typeof Nn=="object"&&Nn!==null&&Nn.$$typeof===P&&du(Nn)===Le.type)?(Le=w(Le,nt.props),eh(Le,nt),Le.return=Ve,Le):(Le=Wf(nt.type,nt.key,nt.props,null,Ve.mode,Tt),eh(Le,nt),Le.return=Ve,Le)}function it(Ve,Le,nt,Tt){return Le===null||Le.tag!==4||Le.stateNode.containerInfo!==nt.containerInfo||Le.stateNode.implementation!==nt.implementation?(Le=Lo(nt,Ve.mode,Tt),Le.return=Ve,Le):(Le=w(Le,nt.children||[]),Le.return=Ve,Le)}function At(Ve,Le,nt,Tt,Nn){return Le===null||Le.tag!==7?(Le=Il(nt,Ve.mode,Tt,Nn),Le.return=Ve,Le):(Le=w(Le,nt),Le.return=Ve,Le)}function Bt(Ve,Le,nt){if(typeof Le=="string"&&Le!==""||typeof Le=="number"||typeof Le=="bigint")return Le=xd(""+Le,Ve.mode,nt),Le.return=Ve,Le;if(typeof Le=="object"&&Le!==null){switch(Le.$$typeof){case b:return nt=Wf(Le.type,Le.key,Le.props,null,Ve.mode,nt),eh(nt,Le),nt.return=Ve,nt;case S:return Le=Lo(Le,Ve.mode,nt),Le.return=Ve,Le;case P:return Le=du(Le),Bt(Ve,Le,nt)}if(re(Le)||Q(Le))return Le=Il(Le,Ve.mode,nt,null),Le.return=Ve,Le;if(typeof Le.then=="function")return Bt(Ve,Ad(Le),nt);if(Le.$$typeof===N)return Bt(Ve,Kf(Ve,Le),nt);th(Ve,Le)}return null}function rt(Ve,Le,nt,Tt){var Nn=Le!==null?Le.key:null;if(typeof nt=="string"&&nt!==""||typeof nt=="number"||typeof nt=="bigint")return Nn!==null?null:ue(Ve,Le,""+nt,Tt);if(typeof nt=="object"&&nt!==null){switch(nt.$$typeof){case b:return nt.key===Nn?Te(Ve,Le,nt,Tt):null;case S:return nt.key===Nn?it(Ve,Le,nt,Tt):null;case P:return nt=du(nt),rt(Ve,Le,nt,Tt)}if(re(nt)||Q(nt))return Nn!==null?null:At(Ve,Le,nt,Tt,null);if(typeof nt.then=="function")return rt(Ve,Le,Ad(nt),Tt);if(nt.$$typeof===N)return rt(Ve,Le,Kf(Ve,nt),Tt);th(Ve,nt)}return null}function xt(Ve,Le,nt,Tt,Nn){if(typeof Tt=="string"&&Tt!==""||typeof Tt=="number"||typeof Tt=="bigint")return Ve=Ve.get(nt)||null,ue(Le,Ve,""+Tt,Nn);if(typeof Tt=="object"&&Tt!==null){switch(Tt.$$typeof){case b:return Ve=Ve.get(Tt.key===null?nt:Tt.key)||null,Te(Le,Ve,Tt,Nn);case S:return Ve=Ve.get(Tt.key===null?nt:Tt.key)||null,it(Le,Ve,Tt,Nn);case P:return Tt=du(Tt),xt(Ve,Le,nt,Tt,Nn)}if(re(Tt)||Q(Tt))return Ve=Ve.get(nt)||null,At(Le,Ve,Tt,Nn,null);if(typeof Tt.then=="function")return xt(Ve,Le,nt,Ad(Tt),Nn);if(Tt.$$typeof===N)return xt(Ve,Le,nt,Kf(Le,Tt),Nn);th(Le,Tt)}return null}function vn(Ve,Le,nt,Tt){for(var Nn=null,ji=null,Sn=Le,ri=Le=0,Ai=null;Sn!==null&&ri<nt.length;ri++){Sn.index>ri?(Ai=Sn,Sn=null):Ai=Sn.sibling;var Hi=rt(Ve,Sn,nt[ri],Tt);if(Hi===null){Sn===null&&(Sn=Ai);break}r&&Sn&&Hi.alternate===null&&l(Ve,Sn),Le=T(Hi,Le,ri),ji===null?Nn=Hi:ji.sibling=Hi,ji=Hi,Sn=Ai}if(ri===nt.length)return p(Ve,Sn),gi&&zl(Ve,ri),Nn;if(Sn===null){for(;ri<nt.length;ri++)Sn=Bt(Ve,nt[ri],Tt),Sn!==null&&(Le=T(Sn,Le,ri),ji===null?Nn=Sn:ji.sibling=Sn,ji=Sn);return gi&&zl(Ve,ri),Nn}for(Sn=v(Sn);ri<nt.length;ri++)Ai=xt(Sn,Ve,ri,nt[ri],Tt),Ai!==null&&(r&&Ai.alternate!==null&&Sn.delete(Ai.key===null?ri:Ai.key),Le=T(Ai,Le,ri),ji===null?Nn=Ai:ji.sibling=Ai,ji=Ai);return r&&Sn.forEach(function(mf){return l(Ve,mf)}),gi&&zl(Ve,ri),Nn}function On(Ve,Le,nt,Tt){if(nt==null)throw Error(n(151));for(var Nn=null,ji=null,Sn=Le,ri=Le=0,Ai=null,Hi=nt.next();Sn!==null&&!Hi.done;ri++,Hi=nt.next()){Sn.index>ri?(Ai=Sn,Sn=null):Ai=Sn.sibling;var mf=rt(Ve,Sn,Hi.value,Tt);if(mf===null){Sn===null&&(Sn=Ai);break}r&&Sn&&mf.alternate===null&&l(Ve,Sn),Le=T(mf,Le,ri),ji===null?Nn=mf:ji.sibling=mf,ji=mf,Sn=Ai}if(Hi.done)return p(Ve,Sn),gi&&zl(Ve,ri),Nn;if(Sn===null){for(;!Hi.done;ri++,Hi=nt.next())Hi=Bt(Ve,Hi.value,Tt),Hi!==null&&(Le=T(Hi,Le,ri),ji===null?Nn=Hi:ji.sibling=Hi,ji=Hi);return gi&&zl(Ve,ri),Nn}for(Sn=v(Sn);!Hi.done;ri++,Hi=nt.next())Hi=xt(Sn,Ve,ri,Hi.value,Tt),Hi!==null&&(r&&Hi.alternate!==null&&Sn.delete(Hi.key===null?ri:Hi.key),Le=T(Hi,Le,ri),ji===null?Nn=Hi:ji.sibling=Hi,ji=Hi);return r&&Sn.forEach(function(uN){return l(Ve,uN)}),gi&&zl(Ve,ri),Nn}function ra(Ve,Le,nt,Tt){if(typeof nt=="object"&&nt!==null&&nt.type===C&&nt.key===null&&(nt=nt.props.children),typeof nt=="object"&&nt!==null){switch(nt.$$typeof){case b:e:{for(var Nn=nt.key;Le!==null;){if(Le.key===Nn){if(Nn=nt.type,Nn===C){if(Le.tag===7){p(Ve,Le.sibling),Tt=w(Le,nt.props.children),Tt.return=Ve,Ve=Tt;break e}}else if(Le.elementType===Nn||typeof Nn=="object"&&Nn!==null&&Nn.$$typeof===P&&du(Nn)===Le.type){p(Ve,Le.sibling),Tt=w(Le,nt.props),eh(Tt,nt),Tt.return=Ve,Ve=Tt;break e}p(Ve,Le);break}else l(Ve,Le);Le=Le.sibling}nt.type===C?(Tt=Il(nt.props.children,Ve.mode,Tt,nt.key),Tt.return=Ve,Ve=Tt):(Tt=Wf(nt.type,nt.key,nt.props,null,Ve.mode,Tt),eh(Tt,nt),Tt.return=Ve,Ve=Tt)}return H(Ve);case S:e:{for(Nn=nt.key;Le!==null;){if(Le.key===Nn)if(Le.tag===4&&Le.stateNode.containerInfo===nt.containerInfo&&Le.stateNode.implementation===nt.implementation){p(Ve,Le.sibling),Tt=w(Le,nt.children||[]),Tt.return=Ve,Ve=Tt;break e}else{p(Ve,Le);break}else l(Ve,Le);Le=Le.sibling}Tt=Lo(nt,Ve.mode,Tt),Tt.return=Ve,Ve=Tt}return H(Ve);case P:return nt=du(nt),ra(Ve,Le,nt,Tt)}if(re(nt))return vn(Ve,Le,nt,Tt);if(Q(nt)){if(Nn=Q(nt),typeof Nn!="function")throw Error(n(150));return nt=Nn.call(nt),On(Ve,Le,nt,Tt)}if(typeof nt.then=="function")return ra(Ve,Le,Ad(nt),Tt);if(nt.$$typeof===N)return ra(Ve,Le,Kf(Ve,nt),Tt);th(Ve,nt)}return typeof nt=="string"&&nt!==""||typeof nt=="number"||typeof nt=="bigint"?(nt=""+nt,Le!==null&&Le.tag===6?(p(Ve,Le.sibling),Tt=w(Le,nt),Tt.return=Ve,Ve=Tt):(p(Ve,Le),Tt=xd(nt,Ve.mode,Tt),Tt.return=Ve,Ve=Tt),H(Ve)):p(Ve,Le)}return function(Ve,Le,nt,Tt){try{Cc=0;var Nn=ra(Ve,Le,nt,Tt);return Ec=null,Nn}catch(Sn){if(Sn===wc||Sn===zo)throw Sn;var ji=Qs(29,Sn,null,Ve.mode);return ji.lanes=Tt,ji.return=Ve,ji}finally{}}}var pu=qu(!0),jx=qu(!1),Tc=!1;function w0(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function E0(r,l){r=r.updateQueue,l.updateQueue===r&&(l.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function rl(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function kl(r,l,p){var v=r.updateQueue;if(v===null)return null;if(v=v.shared,(_i&2)!==0){var w=v.pending;return w===null?l.next=l:(l.next=w.next,w.next=l),v.pending=l,l=ku(r),md(r,null,p),l}return Yf(r,v,l,p),ku(r)}function Rc(r,l,p){if(l=l.updateQueue,l!==null&&(l=l.shared,(p&4194048)!==0)){var v=l.lanes;v&=r.pendingLanes,p|=v,l.lanes=p,qi(r,p)}}function Md(r,l){var p=r.updateQueue,v=r.alternate;if(v!==null&&(v=v.updateQueue,p===v)){var w=null,T=null;if(p=p.firstBaseUpdate,p!==null){do{var H={lane:p.lane,tag:p.tag,payload:p.payload,callback:null,next:null};T===null?w=T=H:T=T.next=H,p=p.next}while(p!==null);T===null?w=T=l:T=T.next=l}else w=T=l;p={baseState:v.baseState,firstBaseUpdate:w,lastBaseUpdate:T,shared:v.shared,callbacks:v.callbacks},r.updateQueue=p;return}r=p.lastBaseUpdate,r===null?p.firstBaseUpdate=l:r.next=l,p.lastBaseUpdate=l}var C0=!1;function nh(){if(C0){var r=Io;if(r!==null)throw r}}function mu(r,l,p,v){C0=!1;var w=r.updateQueue;Tc=!1;var T=w.firstBaseUpdate,H=w.lastBaseUpdate,ue=w.shared.pending;if(ue!==null){w.shared.pending=null;var Te=ue,it=Te.next;Te.next=null,H===null?T=it:H.next=it,H=Te;var At=r.alternate;At!==null&&(At=At.updateQueue,ue=At.lastBaseUpdate,ue!==H&&(ue===null?At.firstBaseUpdate=it:ue.next=it,At.lastBaseUpdate=Te))}if(T!==null){var Bt=w.baseState;H=0,At=it=Te=null,ue=T;do{var rt=ue.lane&-536870913,xt=rt!==ue.lane;if(xt?(mi&rt)===rt:(v&rt)===rt){rt!==0&&rt===Hl&&(C0=!0),At!==null&&(At=At.next={lane:0,tag:ue.tag,payload:ue.payload,callback:null,next:null});e:{var vn=r,On=ue;rt=l;var ra=p;switch(On.tag){case 1:if(vn=On.payload,typeof vn=="function"){Bt=vn.call(ra,Bt,rt);break e}Bt=vn;break e;case 3:vn.flags=vn.flags&-65537|128;case 0:if(vn=On.payload,rt=typeof vn=="function"?vn.call(ra,Bt,rt):vn,rt==null)break e;Bt=x({},Bt,rt);break e;case 2:Tc=!0}}rt=ue.callback,rt!==null&&(r.flags|=64,xt&&(r.flags|=8192),xt=w.callbacks,xt===null?w.callbacks=[rt]:xt.push(rt))}else xt={lane:rt,tag:ue.tag,payload:ue.payload,callback:ue.callback,next:null},At===null?(it=At=xt,Te=Bt):At=At.next=xt,H|=rt;if(ue=ue.next,ue===null){if(ue=w.shared.pending,ue===null)break;xt=ue,ue=xt.next,xt.next=null,w.lastBaseUpdate=xt,w.shared.pending=null}}while(!0);At===null&&(Te=Bt),w.baseState=Te,w.firstBaseUpdate=it,w.lastBaseUpdate=At,T===null&&(w.shared.lanes=0),no|=H,r.lanes=H,r.memoizedState=Bt}}function ol(r,l){if(typeof r!="function")throw Error(n(191,r));r.call(l)}function Ms(r,l){var p=r.callbacks;if(p!==null)for(r.callbacks=null,r=0;r<p.length;r++)ol(p[r],l)}var Yr=I(null),er=I(0);function T0(r,l){r=za,fe(er,r),fe(Yr,l),za=r|l.baseLanes}function R0(){fe(er,za),fe(Yr,Yr.current)}function Is(){za=er.current,W(Yr),W(er)}var $a=I(null),vo=null;function Nc(r){var l=r.alternate;fe(Aa,Aa.current&1),fe($a,r),vo===null&&(l===null||Yr.current!==null||l.memoizedState!==null)&&(vo=r)}function N0(r){fe(Aa,Aa.current),fe($a,r),vo===null&&(vo=r)}function Hx(r){r.tag===22?(fe(Aa,Aa.current),fe($a,r),vo===null&&(vo=r)):Vl()}function Vl(){fe(Aa,Aa.current),fe($a,$a.current)}function Wr(r){W($a),vo===r&&(vo=null),W(Aa)}var Aa=I(0);function wd(r){for(var l=r;l!==null;){if(l.tag===13){var p=l.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||db(p)||pb(p)))return l}else if(l.tag===19&&(l.memoizedProps.revealOrder==="forwards"||l.memoizedProps.revealOrder==="backwards"||l.memoizedProps.revealOrder==="unstable_legacy-backwards"||l.memoizedProps.revealOrder==="together")){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===r)break;for(;l.sibling===null;){if(l.return===null||l.return===r)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var Sr=0,In=null,Zi=null,Ya=null,Ed=!1,ll=!1,xu=!1,Cd=0,ih=0,cl=null,Xy=0;function Ma(){throw Error(n(321))}function B0(r,l){if(l===null)return!1;for(var p=0;p<l.length&&p<r.length;p++)if(!wt(r[p],l[p]))return!1;return!0}function D0(r,l,p,v,w,T){return Sr=T,In=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,j.H=r===null||r.memoizedState===null?lg:Ku,xu=!1,T=p(v,w),xu=!1,ll&&(T=Vx(l,p,v,w)),kx(r),T}function kx(r){j.H=lh;var l=Zi!==null&&Zi.next!==null;if(Sr=0,Ya=Zi=In=null,Ed=!1,ih=0,cl=null,l)throw Error(n(300));r===null||fa||(r=r.dependencies,r!==null&&Xu(r)&&(fa=!0))}function Vx(r,l,p,v){In=r;var w=0;do{if(ll&&(cl=null),ih=0,ll=!1,25<=w)throw Error(n(301));if(w+=1,Ya=Zi=null,r.updateQueue!=null){var T=r.updateQueue;T.lastEffect=null,T.events=null,T.stores=null,T.memoCache!=null&&(T.memoCache.index=0)}j.H=ch,T=l(p,v)}while(ll);return T}function Yy(){var r=j.H,l=r.useState()[0];return l=typeof l.then=="function"?sh(l):l,r=r.useState()[0],(Zi!==null?Zi.memoizedState:null)!==r&&(In.flags|=1024),l}function U0(){var r=Cd!==0;return Cd=0,r}function L0(r,l,p){l.updateQueue=r.updateQueue,l.flags&=-2053,r.lanes&=~p}function O0(r){if(Ed){for(r=r.memoizedState;r!==null;){var l=r.queue;l!==null&&(l.pending=null),r=r.next}Ed=!1}Sr=0,Ya=Zi=In=null,ll=!1,ih=Cd=0,cl=null}function tr(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ya===null?In.memoizedState=Ya=r:Ya=Ya.next=r,Ya}function Ua(){if(Zi===null){var r=In.alternate;r=r!==null?r.memoizedState:null}else r=Zi.next;var l=Ya===null?In.memoizedState:Ya.next;if(l!==null)Ya=l,Zi=r;else{if(r===null)throw In.alternate===null?Error(n(467)):Error(n(310));Zi=r,r={memoizedState:Zi.memoizedState,baseState:Zi.baseState,baseQueue:Zi.baseQueue,queue:Zi.queue,next:null},Ya===null?In.memoizedState=Ya=r:Ya=Ya.next=r}return Ya}function ah(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function sh(r){var l=ih;return ih+=1,cl===null&&(cl=[]),r=A0(cl,r,l),l=In,(Ya===null?l.memoizedState:Ya.next)===null&&(l=l.alternate,j.H=l===null||l.memoizedState===null?lg:Ku),r}function Td(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return sh(r);if(r.$$typeof===N)return ds(r)}throw Error(n(438,String(r)))}function I0(r){var l=null,p=In.updateQueue;if(p!==null&&(l=p.memoCache),l==null){var v=In.alternate;v!==null&&(v=v.updateQueue,v!==null&&(v=v.memoCache,v!=null&&(l={data:v.data.map(function(w){return w.slice()}),index:0})))}if(l==null&&(l={data:[],index:0}),p===null&&(p=ah(),In.updateQueue=p),p.memoCache=l,p=l.data[l.index],p===void 0)for(p=l.data[l.index]=Array(r),v=0;v<r;v++)p[v]=O;return l.index++,p}function Xl(r,l){return typeof l=="function"?l(r):l}function Rd(r){var l=Ua();return z0(l,Zi,r)}function z0(r,l,p){var v=r.queue;if(v===null)throw Error(n(311));v.lastRenderedReducer=p;var w=r.baseQueue,T=v.pending;if(T!==null){if(w!==null){var H=w.next;w.next=T.next,T.next=H}l.baseQueue=w=T,v.pending=null}if(T=r.baseState,w===null)r.memoizedState=T;else{l=w.next;var ue=H=null,Te=null,it=l,At=!1;do{var Bt=it.lane&-536870913;if(Bt!==it.lane?(mi&Bt)===Bt:(Sr&Bt)===Bt){var rt=it.revertLane;if(rt===0)Te!==null&&(Te=Te.next={lane:0,revertLane:0,gesture:null,action:it.action,hasEagerState:it.hasEagerState,eagerState:it.eagerState,next:null}),Bt===Hl&&(At=!0);else if((Sr&rt)===rt){it=it.next,rt===Hl&&(At=!0);continue}else Bt={lane:0,revertLane:it.revertLane,gesture:null,action:it.action,hasEagerState:it.hasEagerState,eagerState:it.eagerState,next:null},Te===null?(ue=Te=Bt,H=T):Te=Te.next=Bt,In.lanes|=rt,no|=rt;Bt=it.action,xu&&p(T,Bt),T=it.hasEagerState?it.eagerState:p(T,Bt)}else rt={lane:Bt,revertLane:it.revertLane,gesture:it.gesture,action:it.action,hasEagerState:it.hasEagerState,eagerState:it.eagerState,next:null},Te===null?(ue=Te=rt,H=T):Te=Te.next=rt,In.lanes|=Bt,no|=Bt;it=it.next}while(it!==null&&it!==l);if(Te===null?H=T:Te.next=ue,!wt(T,r.memoizedState)&&(fa=!0,At&&(p=Io,p!==null)))throw p;r.memoizedState=T,r.baseState=H,r.baseQueue=Te,v.lastRenderedState=T}return w===null&&(v.lanes=0),[r.memoizedState,v.dispatch]}function Nd(r){var l=Ua(),p=l.queue;if(p===null)throw Error(n(311));p.lastRenderedReducer=r;var v=p.dispatch,w=p.pending,T=l.memoizedState;if(w!==null){p.pending=null;var H=w=w.next;do T=r(T,H.action),H=H.next;while(H!==w);wt(T,l.memoizedState)||(fa=!0),l.memoizedState=T,l.baseQueue===null&&(l.baseState=T),p.lastRenderedState=T}return[T,v]}function F0(r,l,p){var v=In,w=Ua(),T=gi;if(T){if(p===void 0)throw Error(n(407));p=p()}else p=l();var H=!wt((Zi||w).memoizedState,p);if(H&&(w.memoizedState=p,fa=!0),w=w.queue,k0(G0.bind(null,v,w,r),[r]),w.getSnapshot!==l||H||Ya!==null&&Ya.memoizedState.tag&1){if(v.flags|=2048,Ju(9,{destroy:void 0},P0.bind(null,v,w,p,l),null),Pi===null)throw Error(n(349));T||(Sr&127)!==0||Xx(v,l,p)}return p}function Xx(r,l,p){r.flags|=16384,r={getSnapshot:l,value:p},l=In.updateQueue,l===null?(l=ah(),In.updateQueue=l,l.stores=[r]):(p=l.stores,p===null?l.stores=[r]:p.push(r))}function P0(r,l,p,v){l.value=p,l.getSnapshot=v,j0(l)&&Bd(r)}function G0(r,l,p){return p(function(){j0(l)&&Bd(r)})}function j0(r){var l=r.getSnapshot;r=r.value;try{var p=l();return!wt(r,p)}catch{return!0}}function Bd(r){var l=bc(r,2);l!==null&&d(l,r,2)}function rh(r){var l=tr();if(typeof r=="function"){var p=r;if(r=p(),xu){ft(!0);try{p()}finally{ft(!1)}}}return l.memoizedState=l.baseState=r,l.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xl,lastRenderedState:r},l}function Yx(r,l,p,v){return r.baseState=p,z0(r,Zi,typeof v=="function"?v:Xl)}function Wy(r,l,p,v,w){if(Yl(r))throw Error(n(485));if(r=l.action,r!==null){var T={payload:w,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(H){T.listeners.push(H)}};j.T!==null?p(!0):T.isTransition=!1,v(T),p=l.pending,p===null?(T.next=l.pending=T,Wx(l,T)):(T.next=p.next,l.pending=p.next=T)}}function Wx(r,l){var p=l.action,v=l.payload,w=r.state;if(l.isTransition){var T=j.T,H={};j.T=H;try{var ue=p(w,v),Te=j.S;Te!==null&&Te(H,ue),qx(r,l,ue)}catch(it){Dd(r,l,it)}finally{T!==null&&H.types!==null&&(T.types=H.types),j.T=T}}else try{T=p(w,v),qx(r,l,T)}catch(it){Dd(r,l,it)}}function qx(r,l,p){p!==null&&typeof p=="object"&&typeof p.then=="function"?p.then(function(v){H0(r,l,v)},function(v){return Dd(r,l,v)}):H0(r,l,p)}function H0(r,l,p){l.status="fulfilled",l.value=p,Jx(l),r.state=p,l=r.pending,l!==null&&(p=l.next,p===l?r.pending=null:(p=p.next,l.next=p,Wx(r,p)))}function Dd(r,l,p){var v=r.pending;if(r.pending=null,v!==null){v=v.next;do l.status="rejected",l.reason=p,Jx(l),l=l.next;while(l!==v)}r.action=null}function Jx(r){r=r.listeners;for(var l=0;l<r.length;l++)(0,r[l])()}function Zx(r,l){return l}function Kx(r,l){if(gi){var p=Pi.formState;if(p!==null){e:{var v=In;if(gi){if(ia){t:{for(var w=ia,T=hs;w.nodeType!==8;){if(!T){w=null;break t}if(w=ml(w.nextSibling),w===null){w=null;break t}}T=w.data,w=T==="F!"||T==="F"?w:null}if(w){ia=ml(w.nextSibling),v=w.data==="F!";break e}}pi(v)}v=!1}v&&(l=p[0])}}return p=tr(),p.memoizedState=p.baseState=l,v={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Zx,lastRenderedState:l},p.queue=v,p=og.bind(null,In,v),v.dispatch=p,v=rh(!1),T=oh.bind(null,In,!1,v.queue),v=tr(),w={state:l,dispatch:null,action:r,pending:null},v.queue=w,p=Wy.bind(null,In,w,T,p),w.dispatch=p,v.memoizedState=r,[l,p,!1]}function Qx(r){var l=Ua();return $x(l,Zi,r)}function $x(r,l,p){if(l=z0(r,l,Zx)[0],r=Rd(Xl)[0],typeof l=="object"&&l!==null&&typeof l.then=="function")try{var v=sh(l)}catch(H){throw H===wc?zo:H}else v=l;l=Ua();var w=l.queue,T=w.dispatch;return p!==l.memoizedState&&(In.flags|=2048,Ju(9,{destroy:void 0},qy.bind(null,w,p),null)),[v,T,r]}function qy(r,l){r.action=l}function eg(r){var l=Ua(),p=Zi;if(p!==null)return $x(l,p,r);Ua(),l=l.memoizedState,p=Ua();var v=p.queue.dispatch;return p.memoizedState=r,[l,v,!1]}function Ju(r,l,p,v){return r={tag:r,create:p,deps:v,inst:l,next:null},l=In.updateQueue,l===null&&(l=ah(),In.updateQueue=l),p=l.lastEffect,p===null?l.lastEffect=r.next=r:(v=p.next,p.next=r,r.next=v,l.lastEffect=r),r}function tg(){return Ua().memoizedState}function Ud(r,l,p,v){var w=tr();In.flags|=r,w.memoizedState=Ju(1|l,{destroy:void 0},p,v===void 0?null:v)}function Ld(r,l,p,v){var w=Ua();v=v===void 0?null:v;var T=w.memoizedState.inst;Zi!==null&&v!==null&&B0(v,Zi.memoizedState.deps)?w.memoizedState=Ju(l,T,p,v):(In.flags|=r,w.memoizedState=Ju(1|l,T,p,v))}function ng(r,l){Ud(8390656,8,r,l)}function k0(r,l){Ld(2048,8,r,l)}function ig(r){In.flags|=4;var l=In.updateQueue;if(l===null)l=ah(),In.updateQueue=l,l.events=[r];else{var p=l.events;p===null?l.events=[r]:p.push(r)}}function ag(r){var l=Ua().memoizedState;return ig({ref:l,nextImpl:r}),function(){if((_i&2)!==0)throw Error(n(440));return l.impl.apply(void 0,arguments)}}function sg(r,l){return Ld(4,2,r,l)}function qr(r,l){return Ld(4,4,r,l)}function V0(r,l){if(typeof l=="function"){r=r();var p=l(r);return function(){typeof p=="function"?p():l(null)}}if(l!=null)return r=r(),l.current=r,function(){l.current=null}}function Od(r,l,p){p=p!=null?p.concat([r]):null,Ld(4,4,V0.bind(null,l,r),p)}function Id(){}function X0(r,l){var p=Ua();l=l===void 0?null:l;var v=p.memoizedState;return l!==null&&B0(l,v[1])?v[0]:(p.memoizedState=[r,l],r)}function Y0(r,l){var p=Ua();l=l===void 0?null:l;var v=p.memoizedState;if(l!==null&&B0(l,v[1]))return v[0];if(v=r(),xu){ft(!0);try{r()}finally{ft(!1)}}return p.memoizedState=[v,l],v}function W0(r,l,p){return p===void 0||(Sr&1073741824)!==0&&(mi&261930)===0?r.memoizedState=l:(r.memoizedState=p,r=f(),In.lanes|=r,no|=r,p)}function q0(r,l,p,v){return wt(p,l)?p:Yr.current!==null?(r=W0(r,p,v),wt(r,l)||(fa=!0),r):(Sr&42)===0||(Sr&1073741824)!==0&&(mi&261930)===0?(fa=!0,r.memoizedState=p):(r=f(),In.lanes|=r,no|=r,l)}function J0(r,l,p,v,w){var T=ae.p;ae.p=T!==0&&8>T?T:8;var H=j.T,ue={};j.T=ue,oh(r,!1,l,p);try{var Te=w(),it=j.S;if(it!==null&&it(ue,Te),Te!==null&&typeof Te=="object"&&typeof Te.then=="function"){var At=S0(Te,v);Zu(r,l,At,ir(r))}else Zu(r,l,v,ir(r))}catch(Bt){Zu(r,l,{then:function(){},status:"rejected",reason:Bt},ir())}finally{ae.p=T,H!==null&&ue.types!==null&&(H.types=ue.types),j.T=H}}function Jy(){}function Z0(r,l,p,v){if(r.tag!==5)throw Error(n(476));var w=rg(r).queue;J0(r,w,l,J,p===null?Jy:function(){return K0(r),p(v)})}function rg(r){var l=r.memoizedState;if(l!==null)return l;l={memoizedState:J,baseState:J,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xl,lastRenderedState:J},next:null};var p={};return l.next={memoizedState:p,baseState:p,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xl,lastRenderedState:p},next:null},r.memoizedState=l,r=r.alternate,r!==null&&(r.memoizedState=l),l}function K0(r){var l=rg(r);l.next===null&&(l=r.alternate.memoizedState),Zu(r,l.next.queue,{},ir())}function Q0(){return ds(fm)}function ws(){return Ua().memoizedState}function $0(){return Ua().memoizedState}function Zy(r){for(var l=r.return;l!==null;){switch(l.tag){case 24:case 3:var p=ir();r=rl(p);var v=kl(l,r,p);v!==null&&(d(v,l,p),Rc(v,l,p)),l={cache:y0()},r.payload=l;return}l=l.return}}function Ky(r,l,p){var v=ir();p={lane:v,revertLane:0,gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null},Yl(r)?gu(l,p):(p=Hu(r,l,p,v),p!==null&&(d(p,r,v),Ar(p,l,v)))}function og(r,l,p){var v=ir();Zu(r,l,p,v)}function Zu(r,l,p,v){var w={lane:v,revertLane:0,gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null};if(Yl(r))gu(l,w);else{var T=r.alternate;if(r.lanes===0&&(T===null||T.lanes===0)&&(T=l.lastRenderedReducer,T!==null))try{var H=l.lastRenderedState,ue=T(H,p);if(w.hasEagerState=!0,w.eagerState=ue,wt(ue,H))return Yf(r,l,w,0),Pi===null&&yc(),!1}catch{}finally{}if(p=Hu(r,l,w,v),p!==null)return d(p,r,v),Ar(p,l,v),!0}return!1}function oh(r,l,p,v){if(v={lane:2,revertLane:tb(),gesture:null,action:v,hasEagerState:!1,eagerState:null,next:null},Yl(r)){if(l)throw Error(n(479))}else l=Hu(r,p,v,2),l!==null&&d(l,r,2)}function Yl(r){var l=r.alternate;return r===In||l!==null&&l===In}function gu(r,l){ll=Ed=!0;var p=r.pending;p===null?l.next=l:(l.next=p.next,p.next=l),r.pending=l}function Ar(r,l,p){if((p&4194048)!==0){var v=l.lanes;v&=r.pendingLanes,p|=v,l.lanes=p,qi(r,p)}}var lh={readContext:ds,use:Td,useCallback:Ma,useContext:Ma,useEffect:Ma,useImperativeHandle:Ma,useLayoutEffect:Ma,useInsertionEffect:Ma,useMemo:Ma,useReducer:Ma,useRef:Ma,useState:Ma,useDebugValue:Ma,useDeferredValue:Ma,useTransition:Ma,useSyncExternalStore:Ma,useId:Ma,useHostTransitionStatus:Ma,useFormState:Ma,useActionState:Ma,useOptimistic:Ma,useMemoCache:Ma,useCacheRefresh:Ma};lh.useEffectEvent=Ma;var lg={readContext:ds,use:Td,useCallback:function(r,l){return tr().memoizedState=[r,l===void 0?null:l],r},useContext:ds,useEffect:ng,useImperativeHandle:function(r,l,p){p=p!=null?p.concat([r]):null,Ud(4194308,4,V0.bind(null,l,r),p)},useLayoutEffect:function(r,l){return Ud(4194308,4,r,l)},useInsertionEffect:function(r,l){Ud(4,2,r,l)},useMemo:function(r,l){var p=tr();l=l===void 0?null:l;var v=r();if(xu){ft(!0);try{r()}finally{ft(!1)}}return p.memoizedState=[v,l],v},useReducer:function(r,l,p){var v=tr();if(p!==void 0){var w=p(l);if(xu){ft(!0);try{p(l)}finally{ft(!1)}}}else w=l;return v.memoizedState=v.baseState=w,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:w},v.queue=r,r=r.dispatch=Ky.bind(null,In,r),[v.memoizedState,r]},useRef:function(r){var l=tr();return r={current:r},l.memoizedState=r},useState:function(r){r=rh(r);var l=r.queue,p=og.bind(null,In,l);return l.dispatch=p,[r.memoizedState,p]},useDebugValue:Id,useDeferredValue:function(r,l){var p=tr();return W0(p,r,l)},useTransition:function(){var r=rh(!1);return r=J0.bind(null,In,r.queue,!0,!1),tr().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,l,p){var v=In,w=tr();if(gi){if(p===void 0)throw Error(n(407));p=p()}else{if(p=l(),Pi===null)throw Error(n(349));(mi&127)!==0||Xx(v,l,p)}w.memoizedState=p;var T={value:p,getSnapshot:l};return w.queue=T,ng(G0.bind(null,v,T,r),[r]),v.flags|=2048,Ju(9,{destroy:void 0},P0.bind(null,v,T,p,l),null),p},useId:function(){var r=tr(),l=Pi.identifierPrefix;if(gi){var p=al,v=il;p=(v&~(1<<32-ge(v)-1)).toString(32)+p,l="_"+l+"R_"+p,p=Cd++,0<p&&(l+="H"+p.toString(32)),l+="_"}else p=Xy++,l="_"+l+"r_"+p.toString(32)+"_";return r.memoizedState=l},useHostTransitionStatus:Q0,useFormState:Kx,useActionState:Kx,useOptimistic:function(r){var l=tr();l.memoizedState=l.baseState=r;var p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return l.queue=p,l=oh.bind(null,In,!0,p),p.dispatch=l,[r,l]},useMemoCache:I0,useCacheRefresh:function(){return tr().memoizedState=Zy.bind(null,In)},useEffectEvent:function(r){var l=tr(),p={impl:r};return l.memoizedState=p,function(){if((_i&2)!==0)throw Error(n(440));return p.impl.apply(void 0,arguments)}}},Ku={readContext:ds,use:Td,useCallback:X0,useContext:ds,useEffect:k0,useImperativeHandle:Od,useInsertionEffect:sg,useLayoutEffect:qr,useMemo:Y0,useReducer:Rd,useRef:tg,useState:function(){return Rd(Xl)},useDebugValue:Id,useDeferredValue:function(r,l){var p=Ua();return q0(p,Zi.memoizedState,r,l)},useTransition:function(){var r=Rd(Xl)[0],l=Ua().memoizedState;return[typeof r=="boolean"?r:sh(r),l]},useSyncExternalStore:F0,useId:ws,useHostTransitionStatus:Q0,useFormState:Qx,useActionState:Qx,useOptimistic:function(r,l){var p=Ua();return Yx(p,Zi,r,l)},useMemoCache:I0,useCacheRefresh:$0};Ku.useEffectEvent=ag;var ch={readContext:ds,use:Td,useCallback:X0,useContext:ds,useEffect:k0,useImperativeHandle:Od,useInsertionEffect:sg,useLayoutEffect:qr,useMemo:Y0,useReducer:Nd,useRef:tg,useState:function(){return Nd(Xl)},useDebugValue:Id,useDeferredValue:function(r,l){var p=Ua();return Zi===null?W0(p,r,l):q0(p,Zi.memoizedState,r,l)},useTransition:function(){var r=Nd(Xl)[0],l=Ua().memoizedState;return[typeof r=="boolean"?r:sh(r),l]},useSyncExternalStore:F0,useId:ws,useHostTransitionStatus:Q0,useFormState:eg,useActionState:eg,useOptimistic:function(r,l){var p=Ua();return Zi!==null?Yx(p,Zi,r,l):(p.baseState=r,[r,p.queue.dispatch])},useMemoCache:I0,useCacheRefresh:$0};ch.useEffectEvent=ag;function Qu(r,l,p,v){l=r.memoizedState,p=p(v,l),p=p==null?l:x({},l,p),r.memoizedState=p,r.lanes===0&&(r.updateQueue.baseState=p)}var uh={enqueueSetState:function(r,l,p){r=r._reactInternals;var v=ir(),w=rl(v);w.payload=l,p!=null&&(w.callback=p),l=kl(r,w,v),l!==null&&(d(l,r,v),Rc(l,r,v))},enqueueReplaceState:function(r,l,p){r=r._reactInternals;var v=ir(),w=rl(v);w.tag=1,w.payload=l,p!=null&&(w.callback=p),l=kl(r,w,v),l!==null&&(d(l,r,v),Rc(l,r,v))},enqueueForceUpdate:function(r,l){r=r._reactInternals;var p=ir(),v=rl(p);v.tag=2,l!=null&&(v.callback=l),l=kl(r,v,p),l!==null&&(d(l,r,p),Rc(l,r,p))}};function cg(r,l,p,v,w,T,H){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(v,T,H):l.prototype&&l.prototype.isPureReactComponent?!fn(p,v)||!fn(w,T):!0}function ug(r,l,p,v){r=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(p,v),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(p,v),l.state!==r&&uh.enqueueReplaceState(l,l.state,null)}function Es(r,l){var p=l;if("ref"in l){p={};for(var v in l)v!=="ref"&&(p[v]=l[v])}if(r=r.defaultProps){p===l&&(p=x({},p));for(var w in r)p[w]===void 0&&(p[w]=r[w])}return p}function em(r){vc(r)}function fg(r){console.error(r)}function zd(r){vc(r)}function Fd(r,l){try{var p=r.onUncaughtError;p(l.value,{componentStack:l.stack})}catch(v){setTimeout(function(){throw v})}}function hg(r,l,p){try{var v=r.onCaughtError;v(p.value,{componentStack:p.stack,errorBoundary:l.tag===1?l.stateNode:null})}catch(w){setTimeout(function(){throw w})}}function tm(r,l,p){return p=rl(p),p.tag=3,p.payload={element:null},p.callback=function(){Fd(r,l)},p}function $u(r){return r=rl(r),r.tag=3,r}function Mr(r,l,p,v){var w=p.type.getDerivedStateFromError;if(typeof w=="function"){var T=v.value;r.payload=function(){return w(T)},r.callback=function(){hg(l,p,v)}}var H=p.stateNode;H!==null&&typeof H.componentDidCatch=="function"&&(r.callback=function(){hg(l,p,v),typeof w!="function"&&(pl===null?pl=new Set([this]):pl.add(this));var ue=v.stack;this.componentDidCatch(v.value,{componentStack:ue!==null?ue:""})})}function Jr(r,l,p,v,w){if(p.flags|=32768,v!==null&&typeof v=="object"&&typeof v.then=="function"){if(l=p.alternate,l!==null&&Ac(l,p,w,!0),p=$a.current,p!==null){switch(p.tag){case 31:case 13:return vo===null?Vn():p.alternate===null&&Gi===0&&(Gi=3),p.flags&=-257,p.flags|=65536,p.lanes=w,v===$f?p.flags|=16384:(l=p.updateQueue,l===null?p.updateQueue=new Set([v]):l.add(v),Qy(r,v,w)),!1;case 22:return p.flags|=65536,v===$f?p.flags|=16384:(l=p.updateQueue,l===null?(l={transitions:null,markerInstances:null,retryQueue:new Set([v])},p.updateQueue=l):(p=l.retryQueue,p===null?l.retryQueue=new Set([v]):p.add(v)),Qy(r,v,w)),!1}throw Error(n(435,p.tag))}return Qy(r,v,w),Vn(),!1}if(gi)return l=$a.current,l!==null?((l.flags&65536)===0&&(l.flags|=256),l.flags|=65536,l.lanes=w,v!==vd&&(r=Error(n(422),{cause:v}),Zf(br(r,p)))):(v!==vd&&(l=Error(n(423),{cause:v}),Zf(br(l,p))),r=r.current.alternate,r.flags|=65536,w&=-w,r.lanes|=w,v=br(v,p),w=tm(r.stateNode,v,w),Md(r,w),Gi!==4&&(Gi=2)),!1;var T=Error(n(520),{cause:v});if(T=br(T,p),Ho===null?Ho=[T]:Ho.push(T),Gi!==4&&(Gi=2),l===null)return!0;v=br(v,p),p=l;do{switch(p.tag){case 3:return p.flags|=65536,r=w&-w,p.lanes|=r,r=tm(p.stateNode,v,r),Md(p,r),!1;case 1:if(l=p.type,T=p.stateNode,(p.flags&128)===0&&(typeof l.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(pl===null||!pl.has(T))))return p.flags|=65536,w&=-w,p.lanes|=w,w=$u(w),Mr(w,r,p,v),Md(p,w),!1}p=p.return}while(p!==null);return!1}var Pd=Error(n(461)),fa=!1;function wa(r,l,p,v){l.child=r===null?jx(l,null,p,v):pu(l,r.child,p,v)}function fh(r,l,p,v,w){p=p.render;var T=l.ref;if("ref"in v){var H={};for(var ue in v)ue!=="ref"&&(H[ue]=v[ue])}else H=v;return fu(l),v=D0(r,l,p,H,T,w),ue=U0(),r!==null&&!fa?(L0(r,l,w),Go(r,l,w)):(gi&&ue&&gd(l),l.flags|=1,wa(r,l,v,w),l.child)}function hh(r,l,p,v,w){if(r===null){var T=p.type;return typeof T=="function"&&!$s(T)&&T.defaultProps===void 0&&p.compare===null?(l.tag=15,l.type=T,Zr(r,l,T,v,w)):(r=Wf(p.type,null,v,l,l.mode,w),r.ref=l.ref,r.return=l,l.child=r)}if(T=r.child,!Dc(r,w)){var H=T.memoizedProps;if(p=p.compare,p=p!==null?p:fn,p(H,v)&&r.ref===l.ref)return Go(r,l,w)}return l.flags|=1,r=tl(T,v),r.ref=l.ref,r.return=l,l.child=r}function Zr(r,l,p,v,w){if(r!==null){var T=r.memoizedProps;if(fn(T,v)&&r.ref===l.ref)if(fa=!1,l.pendingProps=v=T,Dc(r,w))(r.flags&131072)!==0&&(fa=!0);else return l.lanes=r.lanes,Go(r,l,w)}return ef(r,l,p,v,w)}function Kr(r,l,p,v){var w=v.children,T=r!==null?r.memoizedState:null;if(r===null&&l.stateNode===null&&(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),v.mode==="hidden"){if((l.flags&128)!==0){if(T=T!==null?T.baseLanes|p:p,r!==null){for(v=l.child=r.child,w=0;v!==null;)w=w|v.lanes|v.childLanes,v=v.sibling;v=w&~T}else v=0,l.child=null;return ul(r,l,T,p,v)}if((p&536870912)!==0)l.memoizedState={baseLanes:0,cachePool:null},r!==null&&Wu(l,T!==null?T.cachePool:null),T!==null?T0(l,T):R0(),Hx(l);else return v=l.lanes=536870912,ul(r,l,T!==null?T.baseLanes|p:p,p,v)}else T!==null?(Wu(l,T.cachePool),T0(l,T),Vl(),l.memoizedState=null):(r!==null&&Wu(l,null),R0(),Vl());return wa(r,l,w,p),l.child}function Fo(r,l){return r!==null&&r.tag===22||l.stateNode!==null||(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.sibling}function ul(r,l,p,v,w){var T=sl();return T=T===null?null:{parent:Cn._currentValue,pool:T},l.memoizedState={baseLanes:p,cachePool:T},r!==null&&Wu(l,null),R0(),Hx(l),r!==null&&Ac(r,l,v,!0),l.childLanes=w,null}function yo(r,l){return l=tf({mode:l.mode,children:l.children},r.mode),l.ref=r.ref,r.child=l,l.return=r,l}function ps(r,l,p){return pu(l,r.child,null,p),r=yo(l,l.pendingProps),r.flags|=2,Wr(l),l.memoizedState=null,r}function dh(r,l,p){var v=l.pendingProps,w=(l.flags&128)!==0;if(l.flags&=-129,r===null){if(gi){if(v.mode==="hidden")return r=yo(l,v),l.lanes=536870912,Fo(null,r);if(N0(l),(r=ia)?(r=OA(r,hs),r=r!==null&&r.data==="&"?r:null,r!==null&&(l.memoizedState={dehydrated:r,treeContext:nl!==null?{id:il,overflow:al}:null,retryLane:536870912,hydrationErrors:null},p=Ox(r),p.return=l,l.child=p,fs=l,ia=null)):r=null,r===null)throw pi(l);return l.lanes=536870912,null}return yo(l,v)}var T=r.memoizedState;if(T!==null){var H=T.dehydrated;if(N0(l),w)if(l.flags&256)l.flags&=-257,l=ps(r,l,p);else if(l.memoizedState!==null)l.child=r.child,l.flags|=128,l=null;else throw Error(n(558));else if(fa||Ac(r,l,p,!1),w=(p&r.childLanes)!==0,fa||w){if(v=Pi,v!==null&&(H=la(v,p),H!==0&&H!==T.retryLane))throw T.retryLane=H,bc(r,H),d(v,r,H),Pd;Vn(),l=ps(r,l,p)}else r=T.treeContext,ia=ml(H.nextSibling),fs=l,gi=!0,Fl=null,hs=!1,r!==null&&Jf(l,r),l=yo(l,v),l.flags|=4096;return l}return r=tl(r.child,{mode:v.mode,children:v.children}),r.ref=l.ref,l.child=r,r.return=l,r}function Po(r,l){var p=l.ref;if(p===null)r!==null&&r.ref!==null&&(l.flags|=4194816);else{if(typeof p!="function"&&typeof p!="object")throw Error(n(284));(r===null||r.ref!==p)&&(l.flags|=4194816)}}function ef(r,l,p,v,w){return fu(l),p=D0(r,l,p,v,void 0,w),v=U0(),r!==null&&!fa?(L0(r,l,w),Go(r,l,w)):(gi&&v&&gd(l),l.flags|=1,wa(r,l,p,w),l.child)}function zs(r,l,p,v,w,T){return fu(l),l.updateQueue=null,p=Vx(l,v,p,w),kx(r),v=U0(),r!==null&&!fa?(L0(r,l,T),Go(r,l,T)):(gi&&v&&gd(l),l.flags|=1,wa(r,l,p,T),l.child)}function Cs(r,l,p,v,w){if(fu(l),l.stateNode===null){var T=_c,H=p.contextType;typeof H=="object"&&H!==null&&(T=ds(H)),T=new p(v,T),l.memoizedState=T.state!==null&&T.state!==void 0?T.state:null,T.updater=uh,l.stateNode=T,T._reactInternals=l,T=l.stateNode,T.props=v,T.state=l.memoizedState,T.refs={},w0(l),H=p.contextType,T.context=typeof H=="object"&&H!==null?ds(H):_c,T.state=l.memoizedState,H=p.getDerivedStateFromProps,typeof H=="function"&&(Qu(l,p,H,v),T.state=l.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof T.getSnapshotBeforeUpdate=="function"||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(H=T.state,typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount(),H!==T.state&&uh.enqueueReplaceState(T,T.state,null),mu(l,v,T,w),nh(),T.state=l.memoizedState),typeof T.componentDidMount=="function"&&(l.flags|=4194308),v=!0}else if(r===null){T=l.stateNode;var ue=l.memoizedProps,Te=Es(p,ue);T.props=Te;var it=T.context,At=p.contextType;H=_c,typeof At=="object"&&At!==null&&(H=ds(At));var Bt=p.getDerivedStateFromProps;At=typeof Bt=="function"||typeof T.getSnapshotBeforeUpdate=="function",ue=l.pendingProps!==ue,At||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(ue||it!==H)&&ug(l,T,v,H),Tc=!1;var rt=l.memoizedState;T.state=rt,mu(l,v,T,w),nh(),it=l.memoizedState,ue||rt!==it||Tc?(typeof Bt=="function"&&(Qu(l,p,Bt,v),it=l.memoizedState),(Te=Tc||cg(l,p,Te,v,rt,it,H))?(At||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount()),typeof T.componentDidMount=="function"&&(l.flags|=4194308)):(typeof T.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=v,l.memoizedState=it),T.props=v,T.state=it,T.context=H,v=Te):(typeof T.componentDidMount=="function"&&(l.flags|=4194308),v=!1)}else{T=l.stateNode,E0(r,l),H=l.memoizedProps,At=Es(p,H),T.props=At,Bt=l.pendingProps,rt=T.context,it=p.contextType,Te=_c,typeof it=="object"&&it!==null&&(Te=ds(it)),ue=p.getDerivedStateFromProps,(it=typeof ue=="function"||typeof T.getSnapshotBeforeUpdate=="function")||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(H!==Bt||rt!==Te)&&ug(l,T,v,Te),Tc=!1,rt=l.memoizedState,T.state=rt,mu(l,v,T,w),nh();var xt=l.memoizedState;H!==Bt||rt!==xt||Tc||r!==null&&r.dependencies!==null&&Xu(r.dependencies)?(typeof ue=="function"&&(Qu(l,p,ue,v),xt=l.memoizedState),(At=Tc||cg(l,p,At,v,rt,xt,Te)||r!==null&&r.dependencies!==null&&Xu(r.dependencies))?(it||typeof T.UNSAFE_componentWillUpdate!="function"&&typeof T.componentWillUpdate!="function"||(typeof T.componentWillUpdate=="function"&&T.componentWillUpdate(v,xt,Te),typeof T.UNSAFE_componentWillUpdate=="function"&&T.UNSAFE_componentWillUpdate(v,xt,Te)),typeof T.componentDidUpdate=="function"&&(l.flags|=4),typeof T.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof T.componentDidUpdate!="function"||H===r.memoizedProps&&rt===r.memoizedState||(l.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||H===r.memoizedProps&&rt===r.memoizedState||(l.flags|=1024),l.memoizedProps=v,l.memoizedState=xt),T.props=v,T.state=xt,T.context=Te,v=At):(typeof T.componentDidUpdate!="function"||H===r.memoizedProps&&rt===r.memoizedState||(l.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||H===r.memoizedProps&&rt===r.memoizedState||(l.flags|=1024),v=!1)}return T=v,Po(r,l),v=(l.flags&128)!==0,T||v?(T=l.stateNode,p=v&&typeof p.getDerivedStateFromError!="function"?null:T.render(),l.flags|=1,r!==null&&v?(l.child=pu(l,r.child,null,w),l.child=pu(l,null,p,w)):wa(r,l,p,w),l.memoizedState=T.state,r=l.child):r=Go(r,l,w),r}function wi(r,l,p,v){return uu(),l.flags|=256,wa(r,l,p,v),l.child}var Qr={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function bo(r){return{baseLanes:r,cachePool:_d()}}function ph(r,l,p){return r=r!==null?r.childLanes&~p:0,l&&(r|=Si),r}function $r(r,l,p){var v=l.pendingProps,w=!1,T=(l.flags&128)!==0,H;if((H=T)||(H=r!==null&&r.memoizedState===null?!1:(Aa.current&2)!==0),H&&(w=!0,l.flags&=-129),H=(l.flags&32)!==0,l.flags&=-33,r===null){if(gi){if(w?Nc(l):Vl(),(r=ia)?(r=OA(r,hs),r=r!==null&&r.data!=="&"?r:null,r!==null&&(l.memoizedState={dehydrated:r,treeContext:nl!==null?{id:il,overflow:al}:null,retryLane:536870912,hydrationErrors:null},p=Ox(r),p.return=l,l.child=p,fs=l,ia=null)):r=null,r===null)throw pi(l);return pb(r)?l.lanes=32:l.lanes=536870912,null}var ue=v.children;return v=v.fallback,w?(Vl(),w=l.mode,ue=tf({mode:"hidden",children:ue},w),v=Il(v,w,p,null),ue.return=l,v.return=l,ue.sibling=v,l.child=ue,v=l.child,v.memoizedState=bo(p),v.childLanes=ph(r,H,p),l.memoizedState=Qr,Fo(null,v)):(Nc(l),Bc(l,ue))}var Te=r.memoizedState;if(Te!==null&&(ue=Te.dehydrated,ue!==null)){if(T)l.flags&256?(Nc(l),l.flags&=-257,l=nf(r,l,p)):l.memoizedState!==null?(Vl(),l.child=r.child,l.flags|=128,l=null):(Vl(),ue=v.fallback,w=l.mode,v=tf({mode:"visible",children:v.children},w),ue=Il(ue,w,p,null),ue.flags|=2,v.return=l,ue.return=l,v.sibling=ue,l.child=v,pu(l,r.child,null,p),v=l.child,v.memoizedState=bo(p),v.childLanes=ph(r,H,p),l.memoizedState=Qr,l=Fo(null,v));else if(Nc(l),pb(ue)){if(H=ue.nextSibling&&ue.nextSibling.dataset,H)var it=H.dgst;H=it,v=Error(n(419)),v.stack="",v.digest=H,Zf({value:v,source:null,stack:null}),l=nf(r,l,p)}else if(fa||Ac(r,l,p,!1),H=(p&r.childLanes)!==0,fa||H){if(H=Pi,H!==null&&(v=la(H,p),v!==0&&v!==Te.retryLane))throw Te.retryLane=v,bc(r,v),d(H,r,v),Pd;db(ue)||Vn(),l=nf(r,l,p)}else db(ue)?(l.flags|=192,l.child=r.child,l=null):(r=Te.treeContext,ia=ml(ue.nextSibling),fs=l,gi=!0,Fl=null,hs=!1,r!==null&&Jf(l,r),l=Bc(l,v.children),l.flags|=4096);return l}return w?(Vl(),ue=v.fallback,w=l.mode,Te=r.child,it=Te.sibling,v=tl(Te,{mode:"hidden",children:v.children}),v.subtreeFlags=Te.subtreeFlags&65011712,it!==null?ue=tl(it,ue):(ue=Il(ue,w,p,null),ue.flags|=2),ue.return=l,v.return=l,v.sibling=ue,l.child=v,Fo(null,v),v=l.child,ue=r.child.memoizedState,ue===null?ue=bo(p):(w=ue.cachePool,w!==null?(Te=Cn._currentValue,w=w.parent!==Te?{parent:Te,pool:Te}:w):w=_d(),ue={baseLanes:ue.baseLanes|p,cachePool:w}),v.memoizedState=ue,v.childLanes=ph(r,H,p),l.memoizedState=Qr,Fo(r.child,v)):(Nc(l),p=r.child,r=p.sibling,p=tl(p,{mode:"visible",children:v.children}),p.return=l,p.sibling=null,r!==null&&(H=l.deletions,H===null?(l.deletions=[r],l.flags|=16):H.push(r)),l.child=p,l.memoizedState=null,p)}function Bc(r,l){return l=tf({mode:"visible",children:l},r.mode),l.return=r,r.child=l}function tf(r,l){return r=Qs(22,r,null,l),r.lanes=0,r}function nf(r,l,p){return pu(l,r.child,null,p),r=Bc(l,l.pendingProps.children),r.flags|=2,l.memoizedState=null,r}function vu(r,l,p){r.lanes|=l;var v=r.alternate;v!==null&&(v.lanes|=l),jl(r.return,l,p)}function mh(r,l,p,v,w,T){var H=r.memoizedState;H===null?r.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:v,tail:p,tailMode:w,treeForkCount:T}:(H.isBackwards=l,H.rendering=null,H.renderingStartTime=0,H.last=v,H.tail=p,H.tailMode=w,H.treeForkCount=T)}function xh(r,l,p){var v=l.pendingProps,w=v.revealOrder,T=v.tail;v=v.children;var H=Aa.current,ue=(H&2)!==0;if(ue?(H=H&1|2,l.flags|=128):H&=1,fe(Aa,H),wa(r,l,v,p),v=gi?Vu:0,!ue&&r!==null&&(r.flags&128)!==0)e:for(r=l.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&vu(r,p,l);else if(r.tag===19)vu(r,p,l);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===l)break e;for(;r.sibling===null;){if(r.return===null||r.return===l)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(w){case"forwards":for(p=l.child,w=null;p!==null;)r=p.alternate,r!==null&&wd(r)===null&&(w=p),p=p.sibling;p=w,p===null?(w=l.child,l.child=null):(w=p.sibling,p.sibling=null),mh(l,!1,w,p,T,v);break;case"backwards":case"unstable_legacy-backwards":for(p=null,w=l.child,l.child=null;w!==null;){if(r=w.alternate,r!==null&&wd(r)===null){l.child=w;break}r=w.sibling,w.sibling=p,p=w,w=r}mh(l,!0,p,null,T,v);break;case"together":mh(l,!1,null,null,void 0,v);break;default:l.memoizedState=null}return l.child}function Go(r,l,p){if(r!==null&&(l.dependencies=r.dependencies),no|=l.lanes,(p&l.childLanes)===0)if(r!==null){if(Ac(r,l,p,!1),(p&l.childLanes)===0)return null}else return null;if(r!==null&&l.child!==r.child)throw Error(n(153));if(l.child!==null){for(r=l.child,p=tl(r,r.pendingProps),l.child=p,p.return=l;r.sibling!==null;)r=r.sibling,p=p.sibling=tl(r,r.pendingProps),p.return=l;p.sibling=null}return l.child}function Dc(r,l){return(r.lanes&l)!==0?!0:(r=r.dependencies,!!(r!==null&&Xu(r)))}function gh(r,l,p){switch(l.tag){case 3:ve(l,l.stateNode.containerInfo),Gl(l,Cn,r.memoizedState.cache),uu();break;case 27:case 5:Ge(l);break;case 4:ve(l,l.stateNode.containerInfo);break;case 10:Gl(l,l.type,l.memoizedProps.value);break;case 31:if(l.memoizedState!==null)return l.flags|=128,N0(l),null;break;case 13:var v=l.memoizedState;if(v!==null)return v.dehydrated!==null?(Nc(l),l.flags|=128,null):(p&l.child.childLanes)!==0?$r(r,l,p):(Nc(l),r=Go(r,l,p),r!==null?r.sibling:null);Nc(l);break;case 19:var w=(r.flags&128)!==0;if(v=(p&l.childLanes)!==0,v||(Ac(r,l,p,!1),v=(p&l.childLanes)!==0),w){if(v)return xh(r,l,p);l.flags|=128}if(w=l.memoizedState,w!==null&&(w.rendering=null,w.tail=null,w.lastEffect=null),fe(Aa,Aa.current),v)break;return null;case 22:return l.lanes=0,Kr(r,l,p,l.pendingProps);case 24:Gl(l,Cn,r.memoizedState.cache)}return Go(r,l,p)}function Gd(r,l,p){if(r!==null)if(r.memoizedProps!==l.pendingProps)fa=!0;else{if(!Dc(r,p)&&(l.flags&128)===0)return fa=!1,gh(r,l,p);fa=(r.flags&131072)!==0}else fa=!1,gi&&(l.flags&1048576)!==0&&p0(l,Vu,l.index);switch(l.lanes=0,l.tag){case 16:e:{var v=l.pendingProps;if(r=du(l.elementType),l.type=r,typeof r=="function")$s(r)?(v=Es(r,v),l.tag=1,l=Cs(null,l,r,v,p)):(l.tag=0,l=ef(null,l,r,v,p));else{if(r!=null){var w=r.$$typeof;if(w===B){l.tag=11,l=fh(null,l,r,v,p);break e}else if(w===z){l.tag=14,l=hh(null,l,r,v,p);break e}}throw l=ne(r)||r,Error(n(306,l,""))}}return l;case 0:return ef(r,l,l.type,l.pendingProps,p);case 1:return v=l.type,w=Es(v,l.pendingProps),Cs(r,l,v,w,p);case 3:e:{if(ve(l,l.stateNode.containerInfo),r===null)throw Error(n(387));v=l.pendingProps;var T=l.memoizedState;w=T.element,E0(r,l),mu(l,v,null,p);var H=l.memoizedState;if(v=H.cache,Gl(l,Cn,v),v!==T.cache&&bd(l,[Cn],p,!0),nh(),v=H.element,T.isDehydrated)if(T={element:v,isDehydrated:!1,cache:H.cache},l.updateQueue.baseState=T,l.memoizedState=T,l.flags&256){l=wi(r,l,v,p);break e}else if(v!==w){w=br(Error(n(424)),l),Zf(w),l=wi(r,l,v,p);break e}else{switch(r=l.stateNode.containerInfo,r.nodeType){case 9:r=r.body;break;default:r=r.nodeName==="HTML"?r.ownerDocument.body:r}for(ia=ml(r.firstChild),fs=l,gi=!0,Fl=null,hs=!0,p=jx(l,null,v,p),l.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling}else{if(uu(),v===w){l=Go(r,l,p);break e}wa(r,l,v,p)}l=l.child}return l;case 26:return Po(r,l),r===null?(p=jA(l.type,null,l.pendingProps,null))?l.memoizedState=p:gi||(p=l.type,r=l.pendingProps,v=bg($.current).createElement(p),v[bn]=l,v[q]=r,ar(v,p,r),Oe(v),l.stateNode=v):l.memoizedState=jA(l.type,r.memoizedProps,l.pendingProps,r.memoizedState),null;case 27:return Ge(l),r===null&&gi&&(v=l.stateNode=FA(l.type,l.pendingProps,$.current),fs=l,hs=!0,w=ia,uf(l.type)?(mb=w,ia=ml(v.firstChild)):ia=w),wa(r,l,l.pendingProps.children,p),Po(r,l),r===null&&(l.flags|=4194304),l.child;case 5:return r===null&&gi&&((w=v=ia)&&(v=GR(v,l.type,l.pendingProps,hs),v!==null?(l.stateNode=v,fs=l,ia=ml(v.firstChild),hs=!1,w=!0):w=!1),w||pi(l)),Ge(l),w=l.type,T=l.pendingProps,H=r!==null?r.memoizedProps:null,v=T.children,ub(w,T)?v=null:H!==null&&ub(w,H)&&(l.flags|=32),l.memoizedState!==null&&(w=D0(r,l,Yy,null,null,p),fm._currentValue=w),Po(r,l),wa(r,l,v,p),l.child;case 6:return r===null&&gi&&((r=p=ia)&&(p=jR(p,l.pendingProps,hs),p!==null?(l.stateNode=p,fs=l,ia=null,r=!0):r=!1),r||pi(l)),null;case 13:return $r(r,l,p);case 4:return ve(l,l.stateNode.containerInfo),v=l.pendingProps,r===null?l.child=pu(l,null,v,p):wa(r,l,v,p),l.child;case 11:return fh(r,l,l.type,l.pendingProps,p);case 7:return wa(r,l,l.pendingProps,p),l.child;case 8:return wa(r,l,l.pendingProps.children,p),l.child;case 12:return wa(r,l,l.pendingProps.children,p),l.child;case 10:return v=l.pendingProps,Gl(l,l.type,v.value),wa(r,l,v.children,p),l.child;case 9:return w=l.type._context,v=l.pendingProps.children,fu(l),w=ds(w),v=v(w),l.flags|=1,wa(r,l,v,p),l.child;case 14:return hh(r,l,l.type,l.pendingProps,p);case 15:return Zr(r,l,l.type,l.pendingProps,p);case 19:return xh(r,l,p);case 31:return dh(r,l,p);case 22:return Kr(r,l,p,l.pendingProps);case 24:return fu(l),v=ds(Cn),r===null?(w=sl(),w===null&&(w=Pi,T=y0(),w.pooledCache=T,T.refCount++,T!==null&&(w.pooledCacheLanes|=p),w=T),l.memoizedState={parent:v,cache:w},w0(l),Gl(l,Cn,w)):((r.lanes&p)!==0&&(E0(r,l),mu(l,null,null,p),nh()),w=r.memoizedState,T=l.memoizedState,w.parent!==v?(w={parent:v,cache:v},l.memoizedState=w,l.lanes===0&&(l.memoizedState=l.updateQueue.baseState=w),Gl(l,Cn,v)):(v=T.cache,Gl(l,Cn,v),v!==w.cache&&bd(l,[Cn],p,!0))),wa(r,l,l.pendingProps.children,p),l.child;case 29:throw l.pendingProps}throw Error(n(156,l.tag))}function wr(r){r.flags|=4}function Uc(r,l,p,v,w){if((l=(r.mode&32)!==0)&&(l=!1),l){if(r.flags|=16777216,(w&335544128)===w)if(r.stateNode.complete)r.flags|=8192;else if(Jt())r.flags|=8192;else throw Dn=$f,Qf}else r.flags&=-16777217}function Wl(r,l){if(l.type!=="stylesheet"||(l.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!YA(l))if(Jt())r.flags|=8192;else throw Dn=$f,Qf}function af(r,l){l!==null&&(r.flags|=4),r.flags&16384&&(l=r.tag!==22?Kt():536870912,r.lanes|=l,io|=l)}function vh(r,l){if(!gi)switch(r.tailMode){case"hidden":l=r.tail;for(var p=null;l!==null;)l.alternate!==null&&(p=l),l=l.sibling;p===null?r.tail=null:p.sibling=null;break;case"collapsed":p=r.tail;for(var v=null;p!==null;)p.alternate!==null&&(v=p),p=p.sibling;v===null?l||r.tail===null?r.tail=null:r.tail.sibling=null:v.sibling=null}}function Xi(r){var l=r.alternate!==null&&r.alternate.child===r.child,p=0,v=0;if(l)for(var w=r.child;w!==null;)p|=w.lanes|w.childLanes,v|=w.subtreeFlags&65011712,v|=w.flags&65011712,w.return=r,w=w.sibling;else for(w=r.child;w!==null;)p|=w.lanes|w.childLanes,v|=w.subtreeFlags,v|=w.flags,w.return=r,w=w.sibling;return r.subtreeFlags|=v,r.childLanes=p,l}function nm(r,l,p){var v=l.pendingProps;switch(Sc(l),l.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Xi(l),null;case 1:return Xi(l),null;case 3:return p=l.stateNode,v=null,r!==null&&(v=r.memoizedState.cache),l.memoizedState.cache!==v&&(l.flags|=2048),go(Cn),ze(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(r===null||r.child===null)&&(cu(l)?wr(l):r===null||r.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,m0())),Xi(l),null;case 26:var w=l.type,T=l.memoizedState;return r===null?(wr(l),T!==null?(Xi(l),Wl(l,T)):(Xi(l),Uc(l,w,null,v,p))):T?T!==r.memoizedState?(wr(l),Xi(l),Wl(l,T)):(Xi(l),l.flags&=-16777217):(r=r.memoizedProps,r!==v&&wr(l),Xi(l),Uc(l,w,r,v,p)),null;case 27:if(Fe(l),p=$.current,w=l.type,r!==null&&l.stateNode!=null)r.memoizedProps!==v&&wr(l);else{if(!v){if(l.stateNode===null)throw Error(n(166));return Xi(l),null}r=Z.current,cu(l)?yd(l):(r=FA(w,v,p),l.stateNode=r,wr(l))}return Xi(l),null;case 5:if(Fe(l),w=l.type,r!==null&&l.stateNode!=null)r.memoizedProps!==v&&wr(l);else{if(!v){if(l.stateNode===null)throw Error(n(166));return Xi(l),null}if(T=Z.current,cu(l))yd(l);else{var H=bg($.current);switch(T){case 1:T=H.createElementNS("http://www.w3.org/2000/svg",w);break;case 2:T=H.createElementNS("http://www.w3.org/1998/Math/MathML",w);break;default:switch(w){case"svg":T=H.createElementNS("http://www.w3.org/2000/svg",w);break;case"math":T=H.createElementNS("http://www.w3.org/1998/Math/MathML",w);break;case"script":T=H.createElement("div"),T.innerHTML="<script><\/script>",T=T.removeChild(T.firstChild);break;case"select":T=typeof v.is=="string"?H.createElement("select",{is:v.is}):H.createElement("select"),v.multiple?T.multiple=!0:v.size&&(T.size=v.size);break;default:T=typeof v.is=="string"?H.createElement(w,{is:v.is}):H.createElement(w)}}T[bn]=l,T[q]=v;e:for(H=l.child;H!==null;){if(H.tag===5||H.tag===6)T.appendChild(H.stateNode);else if(H.tag!==4&&H.tag!==27&&H.child!==null){H.child.return=H,H=H.child;continue}if(H===l)break e;for(;H.sibling===null;){if(H.return===null||H.return===l)break e;H=H.return}H.sibling.return=H.return,H=H.sibling}l.stateNode=T;e:switch(ar(T,w,v),w){case"button":case"input":case"select":case"textarea":v=!!v.autoFocus;break e;case"img":v=!0;break e;default:v=!1}v&&wr(l)}}return Xi(l),Uc(l,l.type,r===null?null:r.memoizedProps,l.pendingProps,p),null;case 6:if(r&&l.stateNode!=null)r.memoizedProps!==v&&wr(l);else{if(typeof v!="string"&&l.stateNode===null)throw Error(n(166));if(r=$.current,cu(l)){if(r=l.stateNode,p=l.memoizedProps,v=null,w=fs,w!==null)switch(w.tag){case 27:case 5:v=w.memoizedProps}r[bn]=l,r=!!(r.nodeValue===p||v!==null&&v.suppressHydrationWarning===!0||CA(r.nodeValue,p)),r||pi(l,!0)}else r=bg(r).createTextNode(v),r[bn]=l,l.stateNode=r}return Xi(l),null;case 31:if(p=l.memoizedState,r===null||r.memoizedState!==null){if(v=cu(l),p!==null){if(r===null){if(!v)throw Error(n(318));if(r=l.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(557));r[bn]=l}else uu(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;Xi(l),r=!1}else p=m0(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=p),r=!0;if(!r)return l.flags&256?(Wr(l),l):(Wr(l),null);if((l.flags&128)!==0)throw Error(n(558))}return Xi(l),null;case 13:if(v=l.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(w=cu(l),v!==null&&v.dehydrated!==null){if(r===null){if(!w)throw Error(n(318));if(w=l.memoizedState,w=w!==null?w.dehydrated:null,!w)throw Error(n(317));w[bn]=l}else uu(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;Xi(l),w=!1}else w=m0(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=w),w=!0;if(!w)return l.flags&256?(Wr(l),l):(Wr(l),null)}return Wr(l),(l.flags&128)!==0?(l.lanes=p,l):(p=v!==null,r=r!==null&&r.memoizedState!==null,p&&(v=l.child,w=null,v.alternate!==null&&v.alternate.memoizedState!==null&&v.alternate.memoizedState.cachePool!==null&&(w=v.alternate.memoizedState.cachePool.pool),T=null,v.memoizedState!==null&&v.memoizedState.cachePool!==null&&(T=v.memoizedState.cachePool.pool),T!==w&&(v.flags|=2048)),p!==r&&p&&(l.child.flags|=8192),af(l,l.updateQueue),Xi(l),null);case 4:return ze(),r===null&&sb(l.stateNode.containerInfo),Xi(l),null;case 10:return go(l.type),Xi(l),null;case 19:if(W(Aa),v=l.memoizedState,v===null)return Xi(l),null;if(w=(l.flags&128)!==0,T=v.rendering,T===null)if(w)vh(v,!1);else{if(Gi!==0||r!==null&&(r.flags&128)!==0)for(r=l.child;r!==null;){if(T=wd(r),T!==null){for(l.flags|=128,vh(v,!1),r=T.updateQueue,l.updateQueue=r,af(l,r),l.subtreeFlags=0,r=p,p=l.child;p!==null;)Ls(p,r),p=p.sibling;return fe(Aa,Aa.current&1|2),gi&&zl(l,v.treeForkCount),l.child}r=r.sibling}v.tail!==null&&X()>ao&&(l.flags|=128,w=!0,vh(v,!1),l.lanes=4194304)}else{if(!w)if(r=wd(T),r!==null){if(l.flags|=128,w=!0,r=r.updateQueue,l.updateQueue=r,af(l,r),vh(v,!0),v.tail===null&&v.tailMode==="hidden"&&!T.alternate&&!gi)return Xi(l),null}else 2*X()-v.renderingStartTime>ao&&p!==536870912&&(l.flags|=128,w=!0,vh(v,!1),l.lanes=4194304);v.isBackwards?(T.sibling=l.child,l.child=T):(r=v.last,r!==null?r.sibling=T:l.child=T,v.last=T)}return v.tail!==null?(r=v.tail,v.rendering=r,v.tail=r.sibling,v.renderingStartTime=X(),r.sibling=null,p=Aa.current,fe(Aa,w?p&1|2:p&1),gi&&zl(l,v.treeForkCount),r):(Xi(l),null);case 22:case 23:return Wr(l),Is(),v=l.memoizedState!==null,r!==null?r.memoizedState!==null!==v&&(l.flags|=8192):v&&(l.flags|=8192),v?(p&536870912)!==0&&(l.flags&128)===0&&(Xi(l),l.subtreeFlags&6&&(l.flags|=8192)):Xi(l),p=l.updateQueue,p!==null&&af(l,p.retryQueue),p=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(p=r.memoizedState.cachePool.pool),v=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(v=l.memoizedState.cachePool.pool),v!==p&&(l.flags|=2048),r!==null&&W(Mc),null;case 24:return p=null,r!==null&&(p=r.memoizedState.cache),l.memoizedState.cache!==p&&(l.flags|=2048),go(Cn),Xi(l),null;case 25:return null;case 30:return null}throw Error(n(156,l.tag))}function jd(r,l){switch(Sc(l),l.tag){case 1:return r=l.flags,r&65536?(l.flags=r&-65537|128,l):null;case 3:return go(Cn),ze(),r=l.flags,(r&65536)!==0&&(r&128)===0?(l.flags=r&-65537|128,l):null;case 26:case 27:case 5:return Fe(l),null;case 31:if(l.memoizedState!==null){if(Wr(l),l.alternate===null)throw Error(n(340));uu()}return r=l.flags,r&65536?(l.flags=r&-65537|128,l):null;case 13:if(Wr(l),r=l.memoizedState,r!==null&&r.dehydrated!==null){if(l.alternate===null)throw Error(n(340));uu()}return r=l.flags,r&65536?(l.flags=r&-65537|128,l):null;case 19:return W(Aa),null;case 4:return ze(),null;case 10:return go(l.type),null;case 22:case 23:return Wr(l),Is(),r!==null&&W(Mc),r=l.flags,r&65536?(l.flags=r&-65537|128,l):null;case 24:return go(Cn),null;case 25:return null;default:return null}}function yu(r,l){switch(Sc(l),l.tag){case 3:go(Cn),ze();break;case 26:case 27:case 5:Fe(l);break;case 4:ze();break;case 31:l.memoizedState!==null&&Wr(l);break;case 13:Wr(l);break;case 19:W(Aa);break;case 10:go(l.type);break;case 22:case 23:Wr(l),Is(),r!==null&&W(Mc);break;case 24:go(Cn)}}function fl(r,l){try{var p=l.updateQueue,v=p!==null?p.lastEffect:null;if(v!==null){var w=v.next;p=w;do{if((p.tag&r)===r){v=void 0;var T=p.create,H=p.inst;v=T(),H.destroy=v}p=p.next}while(p!==w)}}catch(ue){ea(l,l.return,ue)}}function _o(r,l,p){try{var v=l.updateQueue,w=v!==null?v.lastEffect:null;if(w!==null){var T=w.next;v=T;do{if((v.tag&r)===r){var H=v.inst,ue=H.destroy;if(ue!==void 0){H.destroy=void 0,w=l;var Te=p,it=ue;try{it()}catch(At){ea(w,Te,At)}}}v=v.next}while(v!==T)}}catch(At){ea(l,l.return,At)}}function Lc(r){var l=r.updateQueue;if(l!==null){var p=r.stateNode;try{Ms(l,p)}catch(v){ea(r,r.return,v)}}}function im(r,l,p){p.props=Es(r.type,r.memoizedProps),p.state=r.memoizedState;try{p.componentWillUnmount()}catch(v){ea(r,l,v)}}function hl(r,l){try{var p=r.ref;if(p!==null){switch(r.tag){case 26:case 27:case 5:var v=r.stateNode;break;case 30:v=r.stateNode;break;default:v=r.stateNode}typeof p=="function"?r.refCleanup=p(v):p.current=v}}catch(w){ea(r,l,w)}}function eo(r,l){var p=r.ref,v=r.refCleanup;if(p!==null)if(typeof v=="function")try{v()}catch(w){ea(r,l,w)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof p=="function")try{p(null)}catch(w){ea(r,l,w)}else p.current=null}function to(r){var l=r.type,p=r.memoizedProps,v=r.stateNode;try{e:switch(l){case"button":case"input":case"select":case"textarea":p.autoFocus&&v.focus();break e;case"img":p.src?v.src=p.src:p.srcSet&&(v.srcset=p.srcSet)}}catch(w){ea(r,r.return,w)}}function So(r,l,p){try{var v=r.stateNode;LR(v,r.type,p,l),v[q]=l}catch(w){ea(r,r.return,w)}}function Wa(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&uf(r.type)||r.tag===4}function dl(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||Wa(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&uf(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function $n(r,l,p){var v=r.tag;if(v===5||v===6)r=r.stateNode,l?(p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p).insertBefore(r,l):(l=p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p,l.appendChild(r),p=p._reactRootContainer,p!=null||l.onclick!==null||(l.onclick=da));else if(v!==4&&(v===27&&uf(r.type)&&(p=r.stateNode,l=null),r=r.child,r!==null))for($n(r,l,p),r=r.sibling;r!==null;)$n(r,l,p),r=r.sibling}function Li(r,l,p){var v=r.tag;if(v===5||v===6)r=r.stateNode,l?p.insertBefore(r,l):p.appendChild(r);else if(v!==4&&(v===27&&uf(r.type)&&(p=r.stateNode),r=r.child,r!==null))for(Li(r,l,p),r=r.sibling;r!==null;)Li(r,l,p),r=r.sibling}function La(r){var l=r.stateNode,p=r.memoizedProps;try{for(var v=r.type,w=l.attributes;w.length;)l.removeAttributeNode(w[0]);ar(l,v,p),l[bn]=r,l[q]=p}catch(T){ea(r,r.return,T)}}var Ao=!1,ha=!1,ql=!1,yh=typeof WeakSet=="function"?WeakSet:Set,Ea=null;function sf(r,l){if(r=r.containerInfo,lb=Cg,r=Xt(r),Zt(r)){if("selectionStart"in r)var p={start:r.selectionStart,end:r.selectionEnd};else e:{p=(p=r.ownerDocument)&&p.defaultView||window;var v=p.getSelection&&p.getSelection();if(v&&v.rangeCount!==0){p=v.anchorNode;var w=v.anchorOffset,T=v.focusNode;v=v.focusOffset;try{p.nodeType,T.nodeType}catch{p=null;break e}var H=0,ue=-1,Te=-1,it=0,At=0,Bt=r,rt=null;t:for(;;){for(var xt;Bt!==p||w!==0&&Bt.nodeType!==3||(ue=H+w),Bt!==T||v!==0&&Bt.nodeType!==3||(Te=H+v),Bt.nodeType===3&&(H+=Bt.nodeValue.length),(xt=Bt.firstChild)!==null;)rt=Bt,Bt=xt;for(;;){if(Bt===r)break t;if(rt===p&&++it===w&&(ue=H),rt===T&&++At===v&&(Te=H),(xt=Bt.nextSibling)!==null)break;Bt=rt,rt=Bt.parentNode}Bt=xt}p=ue===-1||Te===-1?null:{start:ue,end:Te}}else p=null}p=p||{start:0,end:0}}else p=null;for(cb={focusedElem:r,selectionRange:p},Cg=!1,Ea=l;Ea!==null;)if(l=Ea,r=l.child,(l.subtreeFlags&1028)!==0&&r!==null)r.return=l,Ea=r;else for(;Ea!==null;){switch(l=Ea,T=l.alternate,r=l.flags,l.tag){case 0:if((r&4)!==0&&(r=l.updateQueue,r=r!==null?r.events:null,r!==null))for(p=0;p<r.length;p++)w=r[p],w.ref.impl=w.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&T!==null){r=void 0,p=l,w=T.memoizedProps,T=T.memoizedState,v=p.stateNode;try{var vn=Es(p.type,w);r=v.getSnapshotBeforeUpdate(vn,T),v.__reactInternalSnapshotBeforeUpdate=r}catch(On){ea(p,p.return,On)}}break;case 3:if((r&1024)!==0){if(r=l.stateNode.containerInfo,p=r.nodeType,p===9)hb(r);else if(p===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":hb(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(n(163))}if(r=l.sibling,r!==null){r.return=l.return,Ea=r;break}Ea=l.return}}function dg(r,l,p){var v=p.flags;switch(p.tag){case 0:case 11:case 15:Jl(r,p),v&4&&fl(5,p);break;case 1:if(Jl(r,p),v&4)if(r=p.stateNode,l===null)try{r.componentDidMount()}catch(H){ea(p,p.return,H)}else{var w=Es(p.type,l.memoizedProps);l=l.memoizedState;try{r.componentDidUpdate(w,l,r.__reactInternalSnapshotBeforeUpdate)}catch(H){ea(p,p.return,H)}}v&64&&Lc(p),v&512&&hl(p,p.return);break;case 3:if(Jl(r,p),v&64&&(r=p.updateQueue,r!==null)){if(l=null,p.child!==null)switch(p.child.tag){case 27:case 5:l=p.child.stateNode;break;case 1:l=p.child.stateNode}try{Ms(r,l)}catch(H){ea(p,p.return,H)}}break;case 27:l===null&&v&4&&La(p);case 26:case 5:Jl(r,p),l===null&&v&4&&to(p),v&512&&hl(p,p.return);break;case 12:Jl(r,p);break;case 31:Jl(r,p),v&4&&kd(r,p);break;case 13:Jl(r,p),v&4&&am(r,p),v&64&&(r=p.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(p=SR.bind(null,p),HR(r,p))));break;case 22:if(v=p.memoizedState!==null||Ao,!v){l=l!==null&&l.memoizedState!==null||ha,w=Ao;var T=ha;Ao=v,(ha=l)&&!T?Fi(r,p,(p.subtreeFlags&8772)!==0):Jl(r,p),Ao=w,ha=T}break;case 30:break;default:Jl(r,p)}}function Hd(r){var l=r.alternate;l!==null&&(r.alternate=null,Hd(l)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(l=r.stateNode,l!==null&&Dt(l)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var Ei=null,qa=!1;function Fs(r,l,p){for(p=p.child;p!==null;)Oc(r,l,p),p=p.sibling}function Oc(r,l,p){if(We&&typeof We.onCommitFiberUnmount=="function")try{We.onCommitFiberUnmount(qe,p)}catch{}switch(p.tag){case 26:ha||eo(p,l),Fs(r,l,p),p.memoizedState?p.memoizedState.count--:p.stateNode&&(p=p.stateNode,p.parentNode.removeChild(p));break;case 27:ha||eo(p,l);var v=Ei,w=qa;uf(p.type)&&(Ei=p.stateNode,qa=!1),Fs(r,l,p),lm(p.stateNode),Ei=v,qa=w;break;case 5:ha||eo(p,l);case 6:if(v=Ei,w=qa,Ei=null,Fs(r,l,p),Ei=v,qa=w,Ei!==null)if(qa)try{(Ei.nodeType===9?Ei.body:Ei.nodeName==="HTML"?Ei.ownerDocument.body:Ei).removeChild(p.stateNode)}catch(T){ea(p,l,T)}else try{Ei.removeChild(p.stateNode)}catch(T){ea(p,l,T)}break;case 18:Ei!==null&&(qa?(r=Ei,UA(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,p.stateNode),ep(r)):UA(Ei,p.stateNode));break;case 4:v=Ei,w=qa,Ei=p.stateNode.containerInfo,qa=!0,Fs(r,l,p),Ei=v,qa=w;break;case 0:case 11:case 14:case 15:_o(2,p,l),ha||_o(4,p,l),Fs(r,l,p);break;case 1:ha||(eo(p,l),v=p.stateNode,typeof v.componentWillUnmount=="function"&&im(p,l,v)),Fs(r,l,p);break;case 21:Fs(r,l,p);break;case 22:ha=(v=ha)||p.memoizedState!==null,Fs(r,l,p),ha=v;break;default:Fs(r,l,p)}}function kd(r,l){if(l.memoizedState===null&&(r=l.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{ep(r)}catch(p){ea(l,l.return,p)}}}function am(r,l){if(l.memoizedState===null&&(r=l.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{ep(r)}catch(p){ea(l,l.return,p)}}function pg(r){switch(r.tag){case 31:case 13:case 19:var l=r.stateNode;return l===null&&(l=r.stateNode=new yh),l;case 22:return r=r.stateNode,l=r._retryCache,l===null&&(l=r._retryCache=new yh),l;default:throw Error(n(435,r.tag))}}function Oa(r,l){var p=pg(r);l.forEach(function(v){if(!p.has(v)){p.add(v);var w=AR.bind(null,r,v);v.then(w,w)}})}function Ps(r,l){var p=l.deletions;if(p!==null)for(var v=0;v<p.length;v++){var w=p[v],T=r,H=l,ue=H;e:for(;ue!==null;){switch(ue.tag){case 27:if(uf(ue.type)){Ei=ue.stateNode,qa=!1;break e}break;case 5:Ei=ue.stateNode,qa=!1;break e;case 3:case 4:Ei=ue.stateNode.containerInfo,qa=!0;break e}ue=ue.return}if(Ei===null)throw Error(n(160));Oc(T,H,w),Ei=null,qa=!1,T=w.alternate,T!==null&&(T.return=null),w.return=null}if(l.subtreeFlags&13886)for(l=l.child;l!==null;)Ic(l,r),l=l.sibling}var Er=null;function Ic(r,l){var p=r.alternate,v=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:Ps(l,r),Ca(r),v&4&&(_o(3,r,r.return),fl(3,r),_o(5,r,r.return));break;case 1:Ps(l,r),Ca(r),v&512&&(ha||p===null||eo(p,p.return)),v&64&&Ao&&(r=r.updateQueue,r!==null&&(v=r.callbacks,v!==null&&(p=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=p===null?v:p.concat(v))));break;case 26:var w=Er;if(Ps(l,r),Ca(r),v&512&&(ha||p===null||eo(p,p.return)),v&4){var T=p!==null?p.memoizedState:null;if(v=r.memoizedState,p===null)if(v===null)if(r.stateNode===null){e:{v=r.type,p=r.memoizedProps,w=w.ownerDocument||w;t:switch(v){case"title":T=w.getElementsByTagName("title")[0],(!T||T[Ot]||T[bn]||T.namespaceURI==="http://www.w3.org/2000/svg"||T.hasAttribute("itemprop"))&&(T=w.createElement(v),w.head.insertBefore(T,w.querySelector("head > title"))),ar(T,v,p),T[bn]=r,Oe(T),v=T;break e;case"link":var H=VA("link","href",w).get(v+(p.href||""));if(H){for(var ue=0;ue<H.length;ue++)if(T=H[ue],T.getAttribute("href")===(p.href==null||p.href===""?null:p.href)&&T.getAttribute("rel")===(p.rel==null?null:p.rel)&&T.getAttribute("title")===(p.title==null?null:p.title)&&T.getAttribute("crossorigin")===(p.crossOrigin==null?null:p.crossOrigin)){H.splice(ue,1);break t}}T=w.createElement(v),ar(T,v,p),w.head.appendChild(T);break;case"meta":if(H=VA("meta","content",w).get(v+(p.content||""))){for(ue=0;ue<H.length;ue++)if(T=H[ue],T.getAttribute("content")===(p.content==null?null:""+p.content)&&T.getAttribute("name")===(p.name==null?null:p.name)&&T.getAttribute("property")===(p.property==null?null:p.property)&&T.getAttribute("http-equiv")===(p.httpEquiv==null?null:p.httpEquiv)&&T.getAttribute("charset")===(p.charSet==null?null:p.charSet)){H.splice(ue,1);break t}}T=w.createElement(v),ar(T,v,p),w.head.appendChild(T);break;default:throw Error(n(468,v))}T[bn]=r,Oe(T),v=T}r.stateNode=v}else XA(w,r.type,r.stateNode);else r.stateNode=kA(w,v,r.memoizedProps);else T!==v?(T===null?p.stateNode!==null&&(p=p.stateNode,p.parentNode.removeChild(p)):T.count--,v===null?XA(w,r.type,r.stateNode):kA(w,v,r.memoizedProps)):v===null&&r.stateNode!==null&&So(r,r.memoizedProps,p.memoizedProps)}break;case 27:Ps(l,r),Ca(r),v&512&&(ha||p===null||eo(p,p.return)),p!==null&&v&4&&So(r,r.memoizedProps,p.memoizedProps);break;case 5:if(Ps(l,r),Ca(r),v&512&&(ha||p===null||eo(p,p.return)),r.flags&32){w=r.stateNode;try{Ga(w,"")}catch(vn){ea(r,r.return,vn)}}v&4&&r.stateNode!=null&&(w=r.memoizedProps,So(r,w,p!==null?p.memoizedProps:w)),v&1024&&(ql=!0);break;case 6:if(Ps(l,r),Ca(r),v&4){if(r.stateNode===null)throw Error(n(162));v=r.memoizedProps,p=r.stateNode;try{p.nodeValue=v}catch(vn){ea(r,r.return,vn)}}break;case 3:if(Ag=null,w=Er,Er=_g(l.containerInfo),Ps(l,r),Er=w,Ca(r),v&4&&p!==null&&p.memoizedState.isDehydrated)try{ep(l.containerInfo)}catch(vn){ea(r,r.return,vn)}ql&&(ql=!1,mg(r));break;case 4:v=Er,Er=_g(r.stateNode.containerInfo),Ps(l,r),Ca(r),Er=v;break;case 12:Ps(l,r),Ca(r);break;case 31:Ps(l,r),Ca(r),v&4&&(v=r.updateQueue,v!==null&&(r.updateQueue=null,Oa(r,v)));break;case 13:Ps(l,r),Ca(r),r.child.flags&8192&&r.memoizedState!==null!=(p!==null&&p.memoizedState!==null)&&(Ql=X()),v&4&&(v=r.updateQueue,v!==null&&(r.updateQueue=null,Oa(r,v)));break;case 22:w=r.memoizedState!==null;var Te=p!==null&&p.memoizedState!==null,it=Ao,At=ha;if(Ao=it||w,ha=At||Te,Ps(l,r),ha=At,Ao=it,Ca(r),v&8192)e:for(l=r.stateNode,l._visibility=w?l._visibility&-2:l._visibility|1,w&&(p===null||Te||Ao||ha||bu(r)),p=null,l=r;;){if(l.tag===5||l.tag===26){if(p===null){Te=p=l;try{if(T=Te.stateNode,w)H=T.style,typeof H.setProperty=="function"?H.setProperty("display","none","important"):H.display="none";else{ue=Te.stateNode;var Bt=Te.memoizedProps.style,rt=Bt!=null&&Bt.hasOwnProperty("display")?Bt.display:null;ue.style.display=rt==null||typeof rt=="boolean"?"":(""+rt).trim()}}catch(vn){ea(Te,Te.return,vn)}}}else if(l.tag===6){if(p===null){Te=l;try{Te.stateNode.nodeValue=w?"":Te.memoizedProps}catch(vn){ea(Te,Te.return,vn)}}}else if(l.tag===18){if(p===null){Te=l;try{var xt=Te.stateNode;w?LA(xt,!0):LA(Te.stateNode,!1)}catch(vn){ea(Te,Te.return,vn)}}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===r)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===r)break e;for(;l.sibling===null;){if(l.return===null||l.return===r)break e;p===l&&(p=null),l=l.return}p===l&&(p=null),l.sibling.return=l.return,l=l.sibling}v&4&&(v=r.updateQueue,v!==null&&(p=v.retryQueue,p!==null&&(v.retryQueue=null,Oa(r,p))));break;case 19:Ps(l,r),Ca(r),v&4&&(v=r.updateQueue,v!==null&&(r.updateQueue=null,Oa(r,v)));break;case 30:break;case 21:break;default:Ps(l,r),Ca(r)}}function Ca(r){var l=r.flags;if(l&2){try{for(var p,v=r.return;v!==null;){if(Wa(v)){p=v;break}v=v.return}if(p==null)throw Error(n(160));switch(p.tag){case 27:var w=p.stateNode,T=dl(r);Li(r,T,w);break;case 5:var H=p.stateNode;p.flags&32&&(Ga(H,""),p.flags&=-33);var ue=dl(r);Li(r,ue,H);break;case 3:case 4:var Te=p.stateNode.containerInfo,it=dl(r);$n(r,it,Te);break;default:throw Error(n(161))}}catch(At){ea(r,r.return,At)}r.flags&=-3}l&4096&&(r.flags&=-4097)}function mg(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var l=r;mg(l),l.tag===5&&l.flags&1024&&l.stateNode.reset(),r=r.sibling}}function Jl(r,l){if(l.subtreeFlags&8772)for(l=l.child;l!==null;)dg(r,l.alternate,l),l=l.sibling}function bu(r){for(r=r.child;r!==null;){var l=r;switch(l.tag){case 0:case 11:case 14:case 15:_o(4,l,l.return),bu(l);break;case 1:eo(l,l.return);var p=l.stateNode;typeof p.componentWillUnmount=="function"&&im(l,l.return,p),bu(l);break;case 27:lm(l.stateNode);case 26:case 5:eo(l,l.return),bu(l);break;case 22:l.memoizedState===null&&bu(l);break;case 30:bu(l);break;default:bu(l)}r=r.sibling}}function Fi(r,l,p){for(p=p&&(l.subtreeFlags&8772)!==0,l=l.child;l!==null;){var v=l.alternate,w=r,T=l,H=T.flags;switch(T.tag){case 0:case 11:case 15:Fi(w,T,p),fl(4,T);break;case 1:if(Fi(w,T,p),v=T,w=v.stateNode,typeof w.componentDidMount=="function")try{w.componentDidMount()}catch(it){ea(v,v.return,it)}if(v=T,w=v.updateQueue,w!==null){var ue=v.stateNode;try{var Te=w.shared.hiddenCallbacks;if(Te!==null)for(w.shared.hiddenCallbacks=null,w=0;w<Te.length;w++)ol(Te[w],ue)}catch(it){ea(v,v.return,it)}}p&&H&64&&Lc(T),hl(T,T.return);break;case 27:La(T);case 26:case 5:Fi(w,T,p),p&&v===null&&H&4&&to(T),hl(T,T.return);break;case 12:Fi(w,T,p);break;case 31:Fi(w,T,p),p&&H&4&&kd(w,T);break;case 13:Fi(w,T,p),p&&H&4&&am(w,T);break;case 22:T.memoizedState===null&&Fi(w,T,p),hl(T,T.return);break;case 30:break;default:Fi(w,T,p)}l=l.sibling}}function Vd(r,l){var p=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(p=r.memoizedState.cachePool.pool),r=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(r=l.memoizedState.cachePool.pool),r!==p&&(r!=null&&r.refCount++,p!=null&&As(p))}function Zl(r,l){r=null,l.alternate!==null&&(r=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==r&&(l.refCount++,r!=null&&As(r))}function es(r,l,p,v){if(l.subtreeFlags&10256)for(l=l.child;l!==null;)ba(r,l,p,v),l=l.sibling}function ba(r,l,p,v){var w=l.flags;switch(l.tag){case 0:case 11:case 15:es(r,l,p,v),w&2048&&fl(9,l);break;case 1:es(r,l,p,v);break;case 3:es(r,l,p,v),w&2048&&(r=null,l.alternate!==null&&(r=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==r&&(l.refCount++,r!=null&&As(r)));break;case 12:if(w&2048){es(r,l,p,v),r=l.stateNode;try{var T=l.memoizedProps,H=T.id,ue=T.onPostCommit;typeof ue=="function"&&ue(H,l.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(Te){ea(l,l.return,Te)}}else es(r,l,p,v);break;case 31:es(r,l,p,v);break;case 13:es(r,l,p,v);break;case 23:break;case 22:T=l.stateNode,H=l.alternate,l.memoizedState!==null?T._visibility&2?es(r,l,p,v):rf(r,l):T._visibility&2?es(r,l,p,v):(T._visibility|=2,zc(r,l,p,v,(l.subtreeFlags&10256)!==0||!1)),w&2048&&Vd(H,l);break;case 24:es(r,l,p,v),w&2048&&Zl(l.alternate,l);break;default:es(r,l,p,v)}}function zc(r,l,p,v,w){for(w=w&&((l.subtreeFlags&10256)!==0||!1),l=l.child;l!==null;){var T=r,H=l,ue=p,Te=v,it=H.flags;switch(H.tag){case 0:case 11:case 15:zc(T,H,ue,Te,w),fl(8,H);break;case 23:break;case 22:var At=H.stateNode;H.memoizedState!==null?At._visibility&2?zc(T,H,ue,Te,w):rf(T,H):(At._visibility|=2,zc(T,H,ue,Te,w)),w&&it&2048&&Vd(H.alternate,H);break;case 24:zc(T,H,ue,Te,w),w&&it&2048&&Zl(H.alternate,H);break;default:zc(T,H,ue,Te,w)}l=l.sibling}}function rf(r,l){if(l.subtreeFlags&10256)for(l=l.child;l!==null;){var p=r,v=l,w=v.flags;switch(v.tag){case 22:rf(p,v),w&2048&&Vd(v.alternate,v);break;case 24:rf(p,v),w&2048&&Zl(v.alternate,v);break;default:rf(p,v)}l=l.sibling}}var Ta=8192;function _u(r,l,p){if(r.subtreeFlags&Ta)for(r=r.child;r!==null;)Ia(r,l,p),r=r.sibling}function Ia(r,l,p){switch(r.tag){case 26:_u(r,l,p),r.flags&Ta&&r.memoizedState!==null&&eN(p,Er,r.memoizedState,r.memoizedProps);break;case 5:_u(r,l,p);break;case 3:case 4:var v=Er;Er=_g(r.stateNode.containerInfo),_u(r,l,p),Er=v;break;case 22:r.memoizedState===null&&(v=r.alternate,v!==null&&v.memoizedState!==null?(v=Ta,Ta=16777216,_u(r,l,p),Ta=v):_u(r,l,p));break;default:_u(r,l,p)}}function Cr(r){var l=r.alternate;if(l!==null&&(r=l.child,r!==null)){l.child=null;do l=r.sibling,r.sibling=null,r=l;while(r!==null)}}function nr(r){var l=r.deletions;if((r.flags&16)!==0){if(l!==null)for(var p=0;p<l.length;p++){var v=l[p];Ea=v,bh(v,r)}Cr(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)Su(r),r=r.sibling}function Su(r){switch(r.tag){case 0:case 11:case 15:nr(r),r.flags&2048&&_o(9,r,r.return);break;case 3:nr(r);break;case 12:nr(r);break;case 22:var l=r.stateNode;r.memoizedState!==null&&l._visibility&2&&(r.return===null||r.return.tag!==13)?(l._visibility&=-3,Xd(r)):nr(r);break;default:nr(r)}}function Xd(r){var l=r.deletions;if((r.flags&16)!==0){if(l!==null)for(var p=0;p<l.length;p++){var v=l[p];Ea=v,bh(v,r)}Cr(r)}for(r=r.child;r!==null;){switch(l=r,l.tag){case 0:case 11:case 15:_o(8,l,l.return),Xd(l);break;case 22:p=l.stateNode,p._visibility&2&&(p._visibility&=-3,Xd(l));break;default:Xd(l)}r=r.sibling}}function bh(r,l){for(;Ea!==null;){var p=Ea;switch(p.tag){case 0:case 11:case 15:_o(8,p,l);break;case 23:case 22:if(p.memoizedState!==null&&p.memoizedState.cachePool!==null){var v=p.memoizedState.cachePool.pool;v!=null&&v.refCount++}break;case 24:As(p.memoizedState.cache)}if(v=p.child,v!==null)v.return=p,Ea=v;else e:for(p=r;Ea!==null;){v=Ea;var w=v.sibling,T=v.return;if(Hd(v),v===p){Ea=null;break e}if(w!==null){w.return=T,Ea=w;break e}Ea=T}}}var Yd={getCacheForType:function(r){var l=ds(Cn),p=l.data.get(r);return p===void 0&&(p=r(),l.data.set(r,p)),p},cacheSignal:function(){return ds(Cn).controller.signal}},Wd=typeof WeakMap=="function"?WeakMap:Map,_i=0,Pi=null,ei=null,mi=0,Tn=0,ci=null,Jn=!1,si=!1,Ki=!1,za=0,Gi=0,no=0,Kl=0,jo=0,Si=0,io=0,Ho=null,Gs=null,Tr=!1,Ql=0,of=0,ao=1/0,lf=null,pl=null,_a=0,ko=null,so=null,Mo=0,$l=0,Au=null,qd=null,Mu=0,wu=null;function ir(){return(_i&2)!==0&&mi!==0?mi&-mi:j.T!==null?tb():Mi()}function f(){if(Si===0)if((mi&536870912)===0||gi){var r=pt;pt<<=1,(pt&3932160)===0&&(pt=262144),Si=r}else Si=536870912;return r=$a.current,r!==null&&(r.flags|=32),Si}function d(r,l,p){(r===Pi&&(Tn===2||Tn===9)||r.cancelPendingCommit!==null)&&(Xe(r,0),G(r,mi,Si,!1)),Gn(r,p),((_i&2)===0||r!==Pi)&&(r===Pi&&((_i&2)===0&&(Kl|=p),Gi===4&&G(r,mi,Si,!1)),Fc(r))}function _(r,l,p){if((_i&6)!==0)throw Error(n(327));var v=!p&&(l&127)===0&&(l&r.expiredLanes)===0||Lt(r,l),w=v?Eu(r,l):Rr(r,l,!0),T=v;do{if(w===0){si&&!v&&G(r,l,0,!1);break}else{if(p=r.current.alternate,T&&!D(p)){w=Rr(r,l,!1),T=!1;continue}if(w===2){if(T=l,r.errorRecoveryDisabledLanes&T)var H=0;else H=r.pendingLanes&-536870913,H=H!==0?H:H&536870912?536870912:0;if(H!==0){l=H;e:{var ue=r;w=Ho;var Te=ue.current.memoizedState.isDehydrated;if(Te&&(Xe(ue,H).flags|=256),H=Rr(ue,H,!1),H!==2){if(Ki&&!Te){ue.errorRecoveryDisabledLanes|=T,Kl|=T,w=4;break e}T=Gs,Gs=w,T!==null&&(Gs===null?Gs=T:Gs.push.apply(Gs,T))}w=H}if(T=!1,w!==2)continue}}if(w===1){Xe(r,0),G(r,l,0,!0);break}e:{switch(v=r,T=w,T){case 0:case 1:throw Error(n(345));case 4:if((l&4194048)!==l)break;case 6:G(v,l,Si,!Jn);break e;case 2:Gs=null;break;case 3:case 5:break;default:throw Error(n(329))}if((l&62914560)===l&&(w=Ql+300-X(),10<w)){if(G(v,l,Si,!Jn),Ke(v,0,!0)!==0)break e;Mo=l,v.timeoutHandle=BA(E.bind(null,v,p,Gs,lf,Tr,l,Si,Kl,io,Jn,T,"Throttled",-0,0),w);break e}E(v,p,Gs,lf,Tr,l,Si,Kl,io,Jn,T,null,-0,0)}}break}while(!0);Fc(r)}function E(r,l,p,v,w,T,H,ue,Te,it,At,Bt,rt,xt){if(r.timeoutHandle=-1,Bt=l.subtreeFlags,Bt&8192||(Bt&16785408)===16785408){Bt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:da},Ia(l,T,Bt);var vn=(T&62914560)===T?Ql-X():(T&4194048)===T?of-X():0;if(vn=tN(Bt,vn),vn!==null){Mo=T,r.cancelPendingCommit=vn(zn.bind(null,r,l,T,p,v,w,H,ue,Te,At,Bt,null,rt,xt)),G(r,T,H,!it);return}}zn(r,l,T,p,v,w,H,ue,Te)}function D(r){for(var l=r;;){var p=l.tag;if((p===0||p===11||p===15)&&l.flags&16384&&(p=l.updateQueue,p!==null&&(p=p.stores,p!==null)))for(var v=0;v<p.length;v++){var w=p[v],T=w.getSnapshot;w=w.value;try{if(!wt(T(),w))return!1}catch{return!1}}if(p=l.child,l.subtreeFlags&16384&&p!==null)p.return=l,l=p;else{if(l===r)break;for(;l.sibling===null;){if(l.return===null||l.return===r)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function G(r,l,p,v){l&=~jo,l&=~Kl,r.suspendedLanes|=l,r.pingedLanes&=~l,v&&(r.warmLanes|=l),v=r.expirationTimes;for(var w=l;0<w;){var T=31-ge(w),H=1<<T;v[T]=-1,w&=~H}p!==0&&li(r,p,l)}function de(){return(_i&6)===0?(sm(0),!1):!0}function Ce(){if(ei!==null){if(Tn===0)var r=ei.return;else r=ei,Os=Pl=null,O0(r),Ec=null,Cc=0,r=ei;for(;r!==null;)yu(r.alternate,r),r=r.return;ei=null}}function Xe(r,l){var p=r.timeoutHandle;p!==-1&&(r.timeoutHandle=-1,zR(p)),p=r.cancelPendingCommit,p!==null&&(r.cancelPendingCommit=null,p()),Mo=0,Ce(),Pi=r,ei=p=tl(r.current,null),mi=l,Tn=0,ci=null,Jn=!1,si=Lt(r,l),Ki=!1,io=Si=jo=Kl=no=Gi=0,Gs=Ho=null,Tr=!1,(l&8)!==0&&(l|=l&32);var v=r.entangledLanes;if(v!==0)for(r=r.entanglements,v&=l;0<v;){var w=31-ge(v),T=1<<w;l|=r[w],v&=~T}return za=l,yc(),p}function Ct(r,l){In=null,j.H=lh,l===wc||l===zo?(l=Sd(),Tn=3):l===Qf?(l=Sd(),Tn=4):Tn=l===Pd?8:l!==null&&typeof l=="object"&&typeof l.then=="function"?6:1,ci=l,ei===null&&(Gi=1,Fd(r,br(l,r.current)))}function Jt(){var r=$a.current;return r===null?!0:(mi&4194048)===mi?vo===null:(mi&62914560)===mi||(mi&536870912)!==0?r===vo:!1}function cn(){var r=j.H;return j.H=lh,r===null?lh:r}function pn(){var r=j.A;return j.A=Yd,r}function Vn(){Gi=4,Jn||(mi&4194048)!==mi&&$a.current!==null||(si=!0),(no&134217727)===0&&(Kl&134217727)===0||Pi===null||G(Pi,mi,Si,!1)}function Rr(r,l,p){var v=_i;_i|=2;var w=cn(),T=pn();(Pi!==r||mi!==l)&&(lf=null,Xe(r,l)),l=!1;var H=Gi;e:do try{if(Tn!==0&&ei!==null){var ue=ei,Te=ci;switch(Tn){case 8:Ce(),H=6;break e;case 3:case 2:case 9:case 6:$a.current===null&&(l=!0);var it=Tn;if(Tn=0,ci=null,jt(r,ue,Te,it),p&&si){H=0;break e}break;default:it=Tn,Tn=0,ci=null,jt(r,ue,Te,it)}}_h(),H=Gi;break}catch(At){Ct(r,At)}while(!0);return l&&r.shellSuspendCounter++,Os=Pl=null,_i=v,j.H=w,j.A=T,ei===null&&(Pi=null,mi=0,yc()),H}function _h(){for(;ei!==null;)ke(ei)}function Eu(r,l){var p=_i;_i|=2;var v=cn(),w=pn();Pi!==r||mi!==l?(lf=null,ao=X()+500,Xe(r,l)):si=Lt(r,l);e:do try{if(Tn!==0&&ei!==null){l=ei;var T=ci;t:switch(Tn){case 1:Tn=0,ci=null,jt(r,l,T,1);break;case 2:case 9:if(Gx(T)){Tn=0,ci=null,ut(l);break}l=function(){Tn!==2&&Tn!==9||Pi!==r||(Tn=7),Fc(r)},T.then(l,l);break e;case 3:Tn=7;break e;case 4:Tn=5;break e;case 7:Gx(T)?(Tn=0,ci=null,ut(l)):(Tn=0,ci=null,jt(r,l,T,7));break;case 5:var H=null;switch(ei.tag){case 26:H=ei.memoizedState;case 5:case 27:var ue=ei;if(H?YA(H):ue.stateNode.complete){Tn=0,ci=null;var Te=ue.sibling;if(Te!==null)ei=Te;else{var it=ue.return;it!==null?(ei=it,Mn(it)):ei=null}break t}}Tn=0,ci=null,jt(r,l,T,5);break;case 6:Tn=0,ci=null,jt(r,l,T,6);break;case 8:Ce(),Gi=6;break e;default:throw Error(n(462))}}at();break}catch(At){Ct(r,At)}while(!0);return Os=Pl=null,j.H=v,j.A=w,_i=p,ei!==null?0:(Pi=null,mi=0,yc(),Gi)}function at(){for(;ei!==null&&!st();)ke(ei)}function ke(r){var l=Gd(r.alternate,r,za);r.memoizedProps=r.pendingProps,l===null?Mn(r):ei=l}function ut(r){var l=r,p=l.alternate;switch(l.tag){case 15:case 0:l=zs(p,l,l.pendingProps,l.type,void 0,mi);break;case 11:l=zs(p,l,l.pendingProps,l.type.render,l.ref,mi);break;case 5:O0(l);default:yu(p,l),l=ei=Ls(l,za),l=Gd(p,l,za)}r.memoizedProps=r.pendingProps,l===null?Mn(r):ei=l}function jt(r,l,p,v){Os=Pl=null,O0(l),Ec=null,Cc=0;var w=l.return;try{if(Jr(r,w,l,p,mi)){Gi=1,Fd(r,br(p,r.current)),ei=null;return}}catch(T){if(w!==null)throw ei=w,T;Gi=1,Fd(r,br(p,r.current)),ei=null;return}l.flags&32768?(gi||v===1?r=!0:si||(mi&536870912)!==0?r=!1:(Jn=r=!0,(v===2||v===9||v===3||v===6)&&(v=$a.current,v!==null&&v.tag===13&&(v.flags|=16384))),aa(l,r)):Mn(l)}function Mn(r){var l=r;do{if((l.flags&32768)!==0){aa(l,Jn);return}r=l.return;var p=nm(l.alternate,l,za);if(p!==null){ei=p;return}if(l=l.sibling,l!==null){ei=l;return}ei=l=r}while(l!==null);Gi===0&&(Gi=5)}function aa(r,l){do{var p=jd(r.alternate,r);if(p!==null){p.flags&=32767,ei=p;return}if(p=r.return,p!==null&&(p.flags|=32768,p.subtreeFlags=0,p.deletions=null),!l&&(r=r.sibling,r!==null)){ei=r;return}ei=r=p}while(r!==null);Gi=6,ei=null}function zn(r,l,p,v,w,T,H,ue,Te){r.cancelPendingCommit=null;do Jd();while(_a!==0);if((_i&6)!==0)throw Error(n(327));if(l!==null){if(l===r.current)throw Error(n(177));if(T=l.lanes|l.childLanes,T|=pd,En(r,p,T,H,ue,Te),r===Pi&&(ei=Pi=null,mi=0),so=l,ko=r,Mo=p,$l=T,Au=w,qd=v,(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,MR(Be,function(){return pA(),null})):(r.callbackNode=null,r.callbackPriority=0),v=(l.flags&13878)!==0,(l.subtreeFlags&13878)!==0||v){v=j.T,j.T=null,w=ae.p,ae.p=2,H=_i,_i|=4;try{sf(r,l,p)}finally{_i=H,ae.p=w,j.T=v}}_a=1,Ci(),ts(),Ti()}}function Ci(){if(_a===1){_a=0;var r=ko,l=so,p=(l.flags&13878)!==0;if((l.subtreeFlags&13878)!==0||p){p=j.T,j.T=null;var v=ae.p;ae.p=2;var w=_i;_i|=4;try{Ic(l,r);var T=cb,H=Xt(r.containerInfo),ue=T.focusedElem,Te=T.selectionRange;if(H!==ue&&ue&&ue.ownerDocument&&dn(ue.ownerDocument.documentElement,ue)){if(Te!==null&&Zt(ue)){var it=Te.start,At=Te.end;if(At===void 0&&(At=it),"selectionStart"in ue)ue.selectionStart=it,ue.selectionEnd=Math.min(At,ue.value.length);else{var Bt=ue.ownerDocument||document,rt=Bt&&Bt.defaultView||window;if(rt.getSelection){var xt=rt.getSelection(),vn=ue.textContent.length,On=Math.min(Te.start,vn),ra=Te.end===void 0?On:Math.min(Te.end,vn);!xt.extend&&On>ra&&(H=ra,ra=On,On=H);var Ve=Et(ue,On),Le=Et(ue,ra);if(Ve&&Le&&(xt.rangeCount!==1||xt.anchorNode!==Ve.node||xt.anchorOffset!==Ve.offset||xt.focusNode!==Le.node||xt.focusOffset!==Le.offset)){var nt=Bt.createRange();nt.setStart(Ve.node,Ve.offset),xt.removeAllRanges(),On>ra?(xt.addRange(nt),xt.extend(Le.node,Le.offset)):(nt.setEnd(Le.node,Le.offset),xt.addRange(nt))}}}}for(Bt=[],xt=ue;xt=xt.parentNode;)xt.nodeType===1&&Bt.push({element:xt,left:xt.scrollLeft,top:xt.scrollTop});for(typeof ue.focus=="function"&&ue.focus(),ue=0;ue<Bt.length;ue++){var Tt=Bt[ue];Tt.element.scrollLeft=Tt.left,Tt.element.scrollTop=Tt.top}}Cg=!!lb,cb=lb=null}finally{_i=w,ae.p=v,j.T=p}}r.current=l,_a=2}}function ts(){if(_a===2){_a=0;var r=ko,l=so,p=(l.flags&8772)!==0;if((l.subtreeFlags&8772)!==0||p){p=j.T,j.T=null;var v=ae.p;ae.p=2;var w=_i;_i|=4;try{dg(r,l.alternate,l)}finally{_i=w,ae.p=v,j.T=p}}_a=3}}function Ti(){if(_a===4||_a===3){_a=0,oe();var r=ko,l=so,p=Mo,v=qd;(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?_a=5:(_a=0,so=ko=null,ec(r,r.pendingLanes));var w=r.pendingLanes;if(w===0&&(pl=null),Qi(p),l=l.stateNode,We&&typeof We.onCommitFiberRoot=="function")try{We.onCommitFiberRoot(qe,l,void 0,(l.current.flags&128)===128)}catch{}if(v!==null){l=j.T,w=ae.p,ae.p=2,j.T=null;try{for(var T=r.onRecoverableError,H=0;H<v.length;H++){var ue=v[H];T(ue.value,{componentStack:ue.stack})}}finally{j.T=l,ae.p=w}}(Mo&3)!==0&&Jd(),Fc(r),w=r.pendingLanes,(p&261930)!==0&&(w&42)!==0?r===wu?Mu++:(Mu=0,wu=r):Mu=0,sm(0)}}function ec(r,l){(r.pooledCacheLanes&=l)===0&&(l=r.pooledCache,l!=null&&(r.pooledCache=null,As(l)))}function Jd(){return Ci(),ts(),Ti(),pA()}function pA(){if(_a!==5)return!1;var r=ko,l=$l;$l=0;var p=Qi(Mo),v=j.T,w=ae.p;try{ae.p=32>p?32:p,j.T=null,p=Au,Au=null;var T=ko,H=Mo;if(_a=0,so=ko=null,Mo=0,(_i&6)!==0)throw Error(n(331));var ue=_i;if(_i|=4,Su(T.current),ba(T,T.current,H,p),_i=ue,sm(0,!1),We&&typeof We.onPostCommitFiberRoot=="function")try{We.onPostCommitFiberRoot(qe,T)}catch{}return!0}finally{ae.p=w,j.T=v,ec(r,l)}}function mA(r,l,p){l=br(p,l),l=tm(r.stateNode,l,2),r=kl(r,l,2),r!==null&&(Gn(r,2),Fc(r))}function ea(r,l,p){if(r.tag===3)mA(r,r,p);else for(;l!==null;){if(l.tag===3){mA(l,r,p);break}else if(l.tag===1){var v=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof v.componentDidCatch=="function"&&(pl===null||!pl.has(v))){r=br(p,r),p=$u(2),v=kl(l,p,2),v!==null&&(Mr(p,v,l,r),Gn(v,2),Fc(v));break}}l=l.return}}function Qy(r,l,p){var v=r.pingCache;if(v===null){v=r.pingCache=new Wd;var w=new Set;v.set(l,w)}else w=v.get(l),w===void 0&&(w=new Set,v.set(l,w));w.has(p)||(Ki=!0,w.add(p),r=_R.bind(null,r,l,p),l.then(r,r))}function _R(r,l,p){var v=r.pingCache;v!==null&&v.delete(l),r.pingedLanes|=r.suspendedLanes&p,r.warmLanes&=~p,Pi===r&&(mi&p)===p&&(Gi===4||Gi===3&&(mi&62914560)===mi&&300>X()-Ql?(_i&2)===0&&Xe(r,0):jo|=p,io===mi&&(io=0)),Fc(r)}function xA(r,l){l===0&&(l=Kt()),r=bc(r,l),r!==null&&(Gn(r,l),Fc(r))}function SR(r){var l=r.memoizedState,p=0;l!==null&&(p=l.retryLane),xA(r,p)}function AR(r,l){var p=0;switch(r.tag){case 31:case 13:var v=r.stateNode,w=r.memoizedState;w!==null&&(p=w.retryLane);break;case 19:v=r.stateNode;break;case 22:v=r.stateNode._retryCache;break;default:throw Error(n(314))}v!==null&&v.delete(l),xA(r,p)}function MR(r,l){return et(r,l)}var xg=null,Zd=null,$y=!1,gg=!1,eb=!1,cf=0;function Fc(r){r!==Zd&&r.next===null&&(Zd===null?xg=Zd=r:Zd=Zd.next=r),gg=!0,$y||($y=!0,ER())}function sm(r,l){if(!eb&&gg){eb=!0;do for(var p=!1,v=xg;v!==null;){if(r!==0){var w=v.pendingLanes;if(w===0)var T=0;else{var H=v.suspendedLanes,ue=v.pingedLanes;T=(1<<31-ge(42|r)+1)-1,T&=w&~(H&~ue),T=T&201326741?T&201326741|1:T?T|2:0}T!==0&&(p=!0,bA(v,T))}else T=mi,T=Ke(v,v===Pi?T:0,v.cancelPendingCommit!==null||v.timeoutHandle!==-1),(T&3)===0||Lt(v,T)||(p=!0,bA(v,T));v=v.next}while(p);eb=!1}}function wR(){gA()}function gA(){gg=$y=!1;var r=0;cf!==0&&IR()&&(r=cf);for(var l=X(),p=null,v=xg;v!==null;){var w=v.next,T=vA(v,l);T===0?(v.next=null,p===null?xg=w:p.next=w,w===null&&(Zd=p)):(p=v,(r!==0||(T&3)!==0)&&(gg=!0)),v=w}_a!==0&&_a!==5||sm(r),cf!==0&&(cf=0)}function vA(r,l){for(var p=r.suspendedLanes,v=r.pingedLanes,w=r.expirationTimes,T=r.pendingLanes&-62914561;0<T;){var H=31-ge(T),ue=1<<H,Te=w[H];Te===-1?((ue&p)===0||(ue&v)!==0)&&(w[H]=Vt(ue,l)):Te<=l&&(r.expiredLanes|=ue),T&=~ue}if(l=Pi,p=mi,p=Ke(r,r===l?p:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),v=r.callbackNode,p===0||r===l&&(Tn===2||Tn===9)||r.cancelPendingCommit!==null)return v!==null&&v!==null&&Ne(v),r.callbackNode=null,r.callbackPriority=0;if((p&3)===0||Lt(r,p)){if(l=p&-p,l===r.callbackPriority)return l;switch(v!==null&&Ne(v),Qi(p)){case 2:case 8:p=Ue;break;case 32:p=Be;break;case 268435456:p=vt;break;default:p=Be}return v=yA.bind(null,r),p=et(p,v),r.callbackPriority=l,r.callbackNode=p,l}return v!==null&&v!==null&&Ne(v),r.callbackPriority=2,r.callbackNode=null,2}function yA(r,l){if(_a!==0&&_a!==5)return r.callbackNode=null,r.callbackPriority=0,null;var p=r.callbackNode;if(Jd()&&r.callbackNode!==p)return null;var v=mi;return v=Ke(r,r===Pi?v:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),v===0?null:(_(r,v,l),vA(r,X()),r.callbackNode!=null&&r.callbackNode===p?yA.bind(null,r):null)}function bA(r,l){if(Jd())return null;_(r,l,!0)}function ER(){FR(function(){(_i&6)!==0?et(Pe,wR):gA()})}function tb(){if(cf===0){var r=Hl;r===0&&(r=Re,Re<<=1,(Re&261888)===0&&(Re=256)),cf=r}return cf}function _A(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:ys(""+r)}function SA(r,l){var p=l.ownerDocument.createElement("input");return p.name=l.name,p.value=l.value,r.id&&p.setAttribute("form",r.id),l.parentNode.insertBefore(p,l),r=new FormData(r),p.parentNode.removeChild(p),r}function CR(r,l,p,v,w){if(l==="submit"&&p&&p.stateNode===w){var T=_A((w[q]||null).action),H=v.submitter;H&&(l=(l=H[q]||null)?_A(l.formAction):H.getAttribute("formAction"),l!==null&&(T=l,H=null));var ue=new ma("action","action",null,v,w);r.push({event:ue,listeners:[{instance:null,listener:function(){if(v.defaultPrevented){if(cf!==0){var Te=H?SA(w,H):new FormData(w);Z0(p,{pending:!0,data:Te,method:w.method,action:T},null,Te)}}else typeof T=="function"&&(ue.preventDefault(),Te=H?SA(w,H):new FormData(w),Z0(p,{pending:!0,data:Te,method:w.method,action:T},T,Te))},currentTarget:w}]})}}for(var nb=0;nb<dd.length;nb++){var ib=dd[nb],TR=ib.toLowerCase(),RR=ib[0].toUpperCase()+ib.slice(1);Us(TR,"on"+RR)}Us(yr,"onAnimationEnd"),Us(f0,"onAnimationIteration"),Us(el,"onAnimationStart"),Us("dblclick","onDoubleClick"),Us("focusin","onFocus"),Us("focusout","onBlur"),Us(ju,"onTransitionRun"),Us(gc,"onTransitionStart"),Us(h0,"onTransitionCancel"),Us(hd,"onTransitionEnd"),Mt("onMouseEnter",["mouseout","mouseover"]),Mt("onMouseLeave",["mouseout","mouseover"]),Mt("onPointerEnter",["pointerout","pointerover"]),Mt("onPointerLeave",["pointerout","pointerover"]),yt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),yt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),yt("onBeforeInput",["compositionend","keypress","textInput","paste"]),yt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),yt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),yt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var rm="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),NR=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(rm));function AA(r,l){l=(l&4)!==0;for(var p=0;p<r.length;p++){var v=r[p],w=v.event;v=v.listeners;e:{var T=void 0;if(l)for(var H=v.length-1;0<=H;H--){var ue=v[H],Te=ue.instance,it=ue.currentTarget;if(ue=ue.listener,Te!==T&&w.isPropagationStopped())break e;T=ue,w.currentTarget=it;try{T(w)}catch(At){vc(At)}w.currentTarget=null,T=Te}else for(H=0;H<v.length;H++){if(ue=v[H],Te=ue.instance,it=ue.currentTarget,ue=ue.listener,Te!==T&&w.isPropagationStopped())break e;T=ue,w.currentTarget=it;try{T(w)}catch(At){vc(At)}w.currentTarget=null,T=Te}}}}function vi(r,l){var p=l[we];p===void 0&&(p=l[we]=new Set);var v=r+"__bubble";p.has(v)||(MA(l,r,2,!1),p.add(v))}function ab(r,l,p){var v=0;l&&(v|=4),MA(p,r,v,l)}var vg="_reactListening"+Math.random().toString(36).slice(2);function sb(r){if(!r[vg]){r[vg]=!0,Me.forEach(function(p){p!=="selectionchange"&&(NR.has(p)||ab(p,!1,r),ab(p,!0,r))});var l=r.nodeType===9?r:r.ownerDocument;l===null||l[vg]||(l[vg]=!0,ab("selectionchange",!1,l))}}function MA(r,l,p,v){switch($A(l)){case 2:var w=aN;break;case 8:w=sN;break;default:w=bb}p=w.bind(null,l,p,r),w=void 0,!gn||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(w=!0),v?w!==void 0?r.addEventListener(l,p,{capture:!0,passive:w}):r.addEventListener(l,p,!0):w!==void 0?r.addEventListener(l,p,{passive:w}):r.addEventListener(l,p,!1)}function rb(r,l,p,v,w){var T=v;if((l&1)===0&&(l&2)===0&&v!==null)e:for(;;){if(v===null)return;var H=v.tag;if(H===3||H===4){var ue=v.stateNode.containerInfo;if(ue===w)break;if(H===4)for(H=v.return;H!==null;){var Te=H.tag;if((Te===3||Te===4)&&H.stateNode.containerInfo===w)return;H=H.return}for(;ue!==null;){if(H=Nt(ue),H===null)return;if(Te=H.tag,Te===5||Te===6||Te===26||Te===27){v=T=H;continue e}ue=ue.parentNode}}v=v.return}pr(function(){var it=T,At=ho(p),Bt=[];e:{var rt=Ol.get(r);if(rt!==void 0){var xt=ma,vn=r;switch(r){case"keypress":if(mr(p)===0)break e;case"keydown":case"keyup":xt=Dl;break;case"focusin":vn="focus",xt=jr;break;case"focusout":vn="blur",xt=jr;break;case"beforeblur":case"afterblur":xt=jr;break;case"click":if(p.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":xt=hc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":xt=Gr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":xt=Va;break;case yr:case f0:case el:xt=Qa;break;case hd:xt=kf;break;case"scroll":case"scrollend":xt=xr;break;case"wheel":xt=mo;break;case"copy":case"cut":case"paste":xt=Ds;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":xt=Ko;break;case"toggle":case"beforetoggle":xt=ua}var On=(l&4)!==0,ra=!On&&(r==="scroll"||r==="scrollend"),Ve=On?rt!==null?rt+"Capture":null:rt;On=[];for(var Le=it,nt;Le!==null;){var Tt=Le;if(nt=Tt.stateNode,Tt=Tt.tag,Tt!==5&&Tt!==26&&Tt!==27||nt===null||Ve===null||(Tt=Ha(Le,Ve),Tt!=null&&On.push(om(Le,Tt,nt))),ra)break;Le=Le.return}0<On.length&&(rt=new xt(rt,vn,null,p,At),Bt.push({event:rt,listeners:On}))}}if((l&7)===0){e:{if(rt=r==="mouseover"||r==="pointerover",xt=r==="mouseout"||r==="pointerout",rt&&p!==qs&&(vn=p.relatedTarget||p.fromElement)&&(Nt(vn)||vn[he]))break e;if((xt||rt)&&(rt=At.window===At?At:(rt=At.ownerDocument)?rt.defaultView||rt.parentWindow:window,xt?(vn=p.relatedTarget||p.toElement,xt=it,vn=vn?Nt(vn):null,vn!==null&&(ra=a(vn),On=vn.tag,vn!==ra||On!==5&&On!==27&&On!==6)&&(vn=null)):(xt=null,vn=it),xt!==vn)){if(On=hc,Tt="onMouseLeave",Ve="onMouseEnter",Le="mouse",(r==="pointerout"||r==="pointerover")&&(On=Ko,Tt="onPointerLeave",Ve="onPointerEnter",Le="pointer"),ra=xt==null?rt:be(xt),nt=vn==null?rt:be(vn),rt=new On(Tt,Le+"leave",xt,p,At),rt.target=ra,rt.relatedTarget=nt,Tt=null,Nt(At)===it&&(On=new On(Ve,Le+"enter",vn,p,At),On.target=nt,On.relatedTarget=ra,Tt=On),ra=Tt,xt&&vn)t:{for(On=BR,Ve=xt,Le=vn,nt=0,Tt=Ve;Tt;Tt=On(Tt))nt++;Tt=0;for(var Nn=Le;Nn;Nn=On(Nn))Tt++;for(;0<nt-Tt;)Ve=On(Ve),nt--;for(;0<Tt-nt;)Le=On(Le),Tt--;for(;nt--;){if(Ve===Le||Le!==null&&Ve===Le.alternate){On=Ve;break t}Ve=On(Ve),Le=On(Le)}On=null}else On=null;xt!==null&&wA(Bt,rt,xt,On,!1),vn!==null&&ra!==null&&wA(Bt,ra,vn,On,!0)}}e:{if(rt=it?be(it):window,xt=rt.nodeName&&rt.nodeName.toLowerCase(),xt==="select"||xt==="input"&&rt.type==="file")var ji=Xf;else if(Wt(rt))if(ru)ji=St;else{ji=Ee;var Sn=_e}else xt=rt.nodeName,!xt||xt.toLowerCase()!=="input"||rt.type!=="checkbox"&&rt.type!=="radio"?it&&vs(it.elementType)&&(ji=Xf):ji=tt;if(ji&&(ji=ji(r,it))){Ui(Bt,ji,p,At);break e}Sn&&Sn(r,rt,it),r==="focusout"&&it&&rt.type==="number"&&it.memoizedProps.value!=null&&Wn(rt,"number",rt.value)}switch(Sn=it?be(it):window,r){case"focusin":(Wt(Sn)||Sn.contentEditable==="true")&&(_n=Sn,nn=it,kt=null);break;case"focusout":kt=nn=_n=null;break;case"mousedown":An=!0;break;case"contextmenu":case"mouseup":case"dragend":An=!1,Zn(Bt,p,At);break;case"selectionchange":if(Gt)break;case"keydown":case"keyup":Zn(Bt,p,At)}var ri;if(xo)e:{switch(r){case"compositionstart":var Ai="onCompositionStart";break e;case"compositionend":Ai="onCompositionEnd";break e;case"compositionupdate":Ai="onCompositionUpdate";break e}Ai=void 0}else kr?Ul(r,p)&&(Ai="onCompositionEnd"):r==="keydown"&&p.keyCode===229&&(Ai="onCompositionStart");Ai&&(va&&p.locale!=="ko"&&(kr||Ai!=="onCompositionStart"?Ai==="onCompositionEnd"&&kr&&(ri=No()):(_s=At,Ro="value"in _s?_s.value:_s.textContent,kr=!0)),Sn=yg(it,Ai),0<Sn.length&&(Ai=new tu(Ai,r,null,p,At),Bt.push({event:Ai,listeners:Sn}),ri?Ai.data=ri:(ri=Uo(p),ri!==null&&(Ai.data=ri)))),(ri=Do?Xa(r,p):su(r,p))&&(Ai=yg(it,"onBeforeInput"),0<Ai.length&&(Sn=new tu("onBeforeInput","beforeinput",null,p,At),Bt.push({event:Sn,listeners:Ai}),Sn.data=ri)),CR(Bt,r,it,p,At)}AA(Bt,l)})}function om(r,l,p){return{instance:r,listener:l,currentTarget:p}}function yg(r,l){for(var p=l+"Capture",v=[];r!==null;){var w=r,T=w.stateNode;if(w=w.tag,w!==5&&w!==26&&w!==27||T===null||(w=Ha(r,p),w!=null&&v.unshift(om(r,w,T)),w=Ha(r,l),w!=null&&v.push(om(r,w,T))),r.tag===3)return v;r=r.return}return[]}function BR(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function wA(r,l,p,v,w){for(var T=l._reactName,H=[];p!==null&&p!==v;){var ue=p,Te=ue.alternate,it=ue.stateNode;if(ue=ue.tag,Te!==null&&Te===v)break;ue!==5&&ue!==26&&ue!==27||it===null||(Te=it,w?(it=Ha(p,T),it!=null&&H.unshift(om(p,it,Te))):w||(it=Ha(p,T),it!=null&&H.push(om(p,it,Te)))),p=p.return}H.length!==0&&r.push({event:l,listeners:H})}var DR=/\r\n?/g,UR=/\u0000|\uFFFD/g;function EA(r){return(typeof r=="string"?r:""+r).replace(DR,`
`).replace(UR,"")}function CA(r,l){return l=EA(l),EA(r)===l}function sa(r,l,p,v,w,T){switch(p){case"children":typeof v=="string"?l==="body"||l==="textarea"&&v===""||Ga(r,v):(typeof v=="number"||typeof v=="bigint")&&l!=="body"&&Ga(r,""+v);break;case"className":yn(r,"class",v);break;case"tabIndex":yn(r,"tabindex",v);break;case"dir":case"role":case"viewBox":case"width":case"height":yn(r,p,v);break;case"style":To(r,v,T);break;case"data":if(l!=="object"){yn(r,"data",v);break}case"src":case"href":if(v===""&&(l!=="a"||p!=="href")){r.removeAttribute(p);break}if(v==null||typeof v=="function"||typeof v=="symbol"||typeof v=="boolean"){r.removeAttribute(p);break}v=ys(""+v),r.setAttribute(p,v);break;case"action":case"formAction":if(typeof v=="function"){r.setAttribute(p,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof T=="function"&&(p==="formAction"?(l!=="input"&&sa(r,l,"name",w.name,w,null),sa(r,l,"formEncType",w.formEncType,w,null),sa(r,l,"formMethod",w.formMethod,w,null),sa(r,l,"formTarget",w.formTarget,w,null)):(sa(r,l,"encType",w.encType,w,null),sa(r,l,"method",w.method,w,null),sa(r,l,"target",w.target,w,null)));if(v==null||typeof v=="symbol"||typeof v=="boolean"){r.removeAttribute(p);break}v=ys(""+v),r.setAttribute(p,v);break;case"onClick":v!=null&&(r.onclick=da);break;case"onScroll":v!=null&&vi("scroll",r);break;case"onScrollEnd":v!=null&&vi("scrollend",r);break;case"dangerouslySetInnerHTML":if(v!=null){if(typeof v!="object"||!("__html"in v))throw Error(n(61));if(p=v.__html,p!=null){if(w.children!=null)throw Error(n(60));r.innerHTML=p}}break;case"multiple":r.multiple=v&&typeof v!="function"&&typeof v!="symbol";break;case"muted":r.muted=v&&typeof v!="function"&&typeof v!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(v==null||typeof v=="function"||typeof v=="boolean"||typeof v=="symbol"){r.removeAttribute("xlink:href");break}p=ys(""+v),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",p);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":v!=null&&typeof v!="function"&&typeof v!="symbol"?r.setAttribute(p,""+v):r.removeAttribute(p);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":v&&typeof v!="function"&&typeof v!="symbol"?r.setAttribute(p,""):r.removeAttribute(p);break;case"capture":case"download":v===!0?r.setAttribute(p,""):v!==!1&&v!=null&&typeof v!="function"&&typeof v!="symbol"?r.setAttribute(p,v):r.removeAttribute(p);break;case"cols":case"rows":case"size":case"span":v!=null&&typeof v!="function"&&typeof v!="symbol"&&!isNaN(v)&&1<=v?r.setAttribute(p,v):r.removeAttribute(p);break;case"rowSpan":case"start":v==null||typeof v=="function"||typeof v=="symbol"||isNaN(v)?r.removeAttribute(p):r.setAttribute(p,v);break;case"popover":vi("beforetoggle",r),vi("toggle",r),Qt(r,"popover",v);break;case"xlinkActuate":ln(r,"http://www.w3.org/1999/xlink","xlink:actuate",v);break;case"xlinkArcrole":ln(r,"http://www.w3.org/1999/xlink","xlink:arcrole",v);break;case"xlinkRole":ln(r,"http://www.w3.org/1999/xlink","xlink:role",v);break;case"xlinkShow":ln(r,"http://www.w3.org/1999/xlink","xlink:show",v);break;case"xlinkTitle":ln(r,"http://www.w3.org/1999/xlink","xlink:title",v);break;case"xlinkType":ln(r,"http://www.w3.org/1999/xlink","xlink:type",v);break;case"xmlBase":ln(r,"http://www.w3.org/XML/1998/namespace","xml:base",v);break;case"xmlLang":ln(r,"http://www.w3.org/XML/1998/namespace","xml:lang",v);break;case"xmlSpace":ln(r,"http://www.w3.org/XML/1998/namespace","xml:space",v);break;case"is":Qt(r,"is",v);break;case"innerText":case"textContent":break;default:(!(2<p.length)||p[0]!=="o"&&p[0]!=="O"||p[1]!=="n"&&p[1]!=="N")&&(p=Nl.get(p)||p,Qt(r,p,v))}}function ob(r,l,p,v,w,T){switch(p){case"style":To(r,v,T);break;case"dangerouslySetInnerHTML":if(v!=null){if(typeof v!="object"||!("__html"in v))throw Error(n(61));if(p=v.__html,p!=null){if(w.children!=null)throw Error(n(60));r.innerHTML=p}}break;case"children":typeof v=="string"?Ga(r,v):(typeof v=="number"||typeof v=="bigint")&&Ga(r,""+v);break;case"onScroll":v!=null&&vi("scroll",r);break;case"onScrollEnd":v!=null&&vi("scrollend",r);break;case"onClick":v!=null&&(r.onclick=da);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!$e.hasOwnProperty(p))e:{if(p[0]==="o"&&p[1]==="n"&&(w=p.endsWith("Capture"),l=p.slice(2,w?p.length-7:void 0),T=r[q]||null,T=T!=null?T[p]:null,typeof T=="function"&&r.removeEventListener(l,T,w),typeof v=="function")){typeof T!="function"&&T!==null&&(p in r?r[p]=null:r.hasAttribute(p)&&r.removeAttribute(p)),r.addEventListener(l,v,w);break e}p in r?r[p]=v:v===!0?r.setAttribute(p,""):Qt(r,p,v)}}}function ar(r,l,p){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":vi("error",r),vi("load",r);var v=!1,w=!1,T;for(T in p)if(p.hasOwnProperty(T)){var H=p[T];if(H!=null)switch(T){case"src":v=!0;break;case"srcSet":w=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,l));default:sa(r,l,T,H,p,null)}}w&&sa(r,l,"srcSet",p.srcSet,p,null),v&&sa(r,l,"src",p.src,p,null);return;case"input":vi("invalid",r);var ue=T=H=w=null,Te=null,it=null;for(v in p)if(p.hasOwnProperty(v)){var At=p[v];if(At!=null)switch(v){case"name":w=At;break;case"type":H=At;break;case"checked":Te=At;break;case"defaultChecked":it=At;break;case"value":T=At;break;case"defaultValue":ue=At;break;case"children":case"dangerouslySetInnerHTML":if(At!=null)throw Error(n(137,l));break;default:sa(r,l,v,At,p,null)}}Yn(r,T,ue,Te,it,H,w,!1);return;case"select":vi("invalid",r),v=H=T=null;for(w in p)if(p.hasOwnProperty(w)&&(ue=p[w],ue!=null))switch(w){case"value":T=ue;break;case"defaultValue":H=ue;break;case"multiple":v=ue;default:sa(r,l,w,ue,p,null)}l=T,p=H,r.multiple=!!v,l!=null?xi(r,!!v,l,!1):p!=null&&xi(r,!!v,p,!0);return;case"textarea":vi("invalid",r),T=w=v=null;for(H in p)if(p.hasOwnProperty(H)&&(ue=p[H],ue!=null))switch(H){case"value":v=ue;break;case"defaultValue":w=ue;break;case"children":T=ue;break;case"dangerouslySetInnerHTML":if(ue!=null)throw Error(n(91));break;default:sa(r,l,H,ue,p,null)}Di(r,v,w,T);return;case"option":for(Te in p)if(p.hasOwnProperty(Te)&&(v=p[Te],v!=null))switch(Te){case"selected":r.selected=v&&typeof v!="function"&&typeof v!="symbol";break;default:sa(r,l,Te,v,p,null)}return;case"dialog":vi("beforetoggle",r),vi("toggle",r),vi("cancel",r),vi("close",r);break;case"iframe":case"object":vi("load",r);break;case"video":case"audio":for(v=0;v<rm.length;v++)vi(rm[v],r);break;case"image":vi("error",r),vi("load",r);break;case"details":vi("toggle",r);break;case"embed":case"source":case"link":vi("error",r),vi("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(it in p)if(p.hasOwnProperty(it)&&(v=p[it],v!=null))switch(it){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,l));default:sa(r,l,it,v,p,null)}return;default:if(vs(l)){for(At in p)p.hasOwnProperty(At)&&(v=p[At],v!==void 0&&ob(r,l,At,v,p,void 0));return}}for(ue in p)p.hasOwnProperty(ue)&&(v=p[ue],v!=null&&sa(r,l,ue,v,p,null))}function LR(r,l,p,v){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var w=null,T=null,H=null,ue=null,Te=null,it=null,At=null;for(xt in p){var Bt=p[xt];if(p.hasOwnProperty(xt)&&Bt!=null)switch(xt){case"checked":break;case"value":break;case"defaultValue":Te=Bt;default:v.hasOwnProperty(xt)||sa(r,l,xt,null,v,Bt)}}for(var rt in v){var xt=v[rt];if(Bt=p[rt],v.hasOwnProperty(rt)&&(xt!=null||Bt!=null))switch(rt){case"type":T=xt;break;case"name":w=xt;break;case"checked":it=xt;break;case"defaultChecked":At=xt;break;case"value":H=xt;break;case"defaultValue":ue=xt;break;case"children":case"dangerouslySetInnerHTML":if(xt!=null)throw Error(n(137,l));break;default:xt!==Bt&&sa(r,l,rt,xt,v,Bt)}}Ni(r,H,ue,Te,it,At,T,w);return;case"select":xt=H=ue=rt=null;for(T in p)if(Te=p[T],p.hasOwnProperty(T)&&Te!=null)switch(T){case"value":break;case"multiple":xt=Te;default:v.hasOwnProperty(T)||sa(r,l,T,null,v,Te)}for(w in v)if(T=v[w],Te=p[w],v.hasOwnProperty(w)&&(T!=null||Te!=null))switch(w){case"value":rt=T;break;case"defaultValue":ue=T;break;case"multiple":H=T;default:T!==Te&&sa(r,l,w,T,v,Te)}l=ue,p=H,v=xt,rt!=null?xi(r,!!p,rt,!1):!!v!=!!p&&(l!=null?xi(r,!!p,l,!0):xi(r,!!p,p?[]:"",!1));return;case"textarea":xt=rt=null;for(ue in p)if(w=p[ue],p.hasOwnProperty(ue)&&w!=null&&!v.hasOwnProperty(ue))switch(ue){case"value":break;case"children":break;default:sa(r,l,ue,null,v,w)}for(H in v)if(w=v[H],T=p[H],v.hasOwnProperty(H)&&(w!=null||T!=null))switch(H){case"value":rt=w;break;case"defaultValue":xt=w;break;case"children":break;case"dangerouslySetInnerHTML":if(w!=null)throw Error(n(91));break;default:w!==T&&sa(r,l,H,w,v,T)}ki(r,rt,xt);return;case"option":for(var vn in p)if(rt=p[vn],p.hasOwnProperty(vn)&&rt!=null&&!v.hasOwnProperty(vn))switch(vn){case"selected":r.selected=!1;break;default:sa(r,l,vn,null,v,rt)}for(Te in v)if(rt=v[Te],xt=p[Te],v.hasOwnProperty(Te)&&rt!==xt&&(rt!=null||xt!=null))switch(Te){case"selected":r.selected=rt&&typeof rt!="function"&&typeof rt!="symbol";break;default:sa(r,l,Te,rt,v,xt)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var On in p)rt=p[On],p.hasOwnProperty(On)&&rt!=null&&!v.hasOwnProperty(On)&&sa(r,l,On,null,v,rt);for(it in v)if(rt=v[it],xt=p[it],v.hasOwnProperty(it)&&rt!==xt&&(rt!=null||xt!=null))switch(it){case"children":case"dangerouslySetInnerHTML":if(rt!=null)throw Error(n(137,l));break;default:sa(r,l,it,rt,v,xt)}return;default:if(vs(l)){for(var ra in p)rt=p[ra],p.hasOwnProperty(ra)&&rt!==void 0&&!v.hasOwnProperty(ra)&&ob(r,l,ra,void 0,v,rt);for(At in v)rt=v[At],xt=p[At],!v.hasOwnProperty(At)||rt===xt||rt===void 0&&xt===void 0||ob(r,l,At,rt,v,xt);return}}for(var Ve in p)rt=p[Ve],p.hasOwnProperty(Ve)&&rt!=null&&!v.hasOwnProperty(Ve)&&sa(r,l,Ve,null,v,rt);for(Bt in v)rt=v[Bt],xt=p[Bt],!v.hasOwnProperty(Bt)||rt===xt||rt==null&&xt==null||sa(r,l,Bt,rt,v,xt)}function TA(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function OR(){if(typeof performance.getEntriesByType=="function"){for(var r=0,l=0,p=performance.getEntriesByType("resource"),v=0;v<p.length;v++){var w=p[v],T=w.transferSize,H=w.initiatorType,ue=w.duration;if(T&&ue&&TA(H)){for(H=0,ue=w.responseEnd,v+=1;v<p.length;v++){var Te=p[v],it=Te.startTime;if(it>ue)break;var At=Te.transferSize,Bt=Te.initiatorType;At&&TA(Bt)&&(Te=Te.responseEnd,H+=At*(Te<ue?1:(ue-it)/(Te-it)))}if(--v,l+=8*(T+H)/(w.duration/1e3),r++,10<r)break}}if(0<r)return l/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var lb=null,cb=null;function bg(r){return r.nodeType===9?r:r.ownerDocument}function RA(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function NA(r,l){if(r===0)switch(l){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&l==="foreignObject"?0:r}function ub(r,l){return r==="textarea"||r==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.children=="bigint"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var fb=null;function IR(){var r=window.event;return r&&r.type==="popstate"?r===fb?!1:(fb=r,!0):(fb=null,!1)}var BA=typeof setTimeout=="function"?setTimeout:void 0,zR=typeof clearTimeout=="function"?clearTimeout:void 0,DA=typeof Promise=="function"?Promise:void 0,FR=typeof queueMicrotask=="function"?queueMicrotask:typeof DA<"u"?function(r){return DA.resolve(null).then(r).catch(PR)}:BA;function PR(r){setTimeout(function(){throw r})}function uf(r){return r==="head"}function UA(r,l){var p=l,v=0;do{var w=p.nextSibling;if(r.removeChild(p),w&&w.nodeType===8)if(p=w.data,p==="/$"||p==="/&"){if(v===0){r.removeChild(w),ep(l);return}v--}else if(p==="$"||p==="$?"||p==="$~"||p==="$!"||p==="&")v++;else if(p==="html")lm(r.ownerDocument.documentElement);else if(p==="head"){p=r.ownerDocument.head,lm(p);for(var T=p.firstChild;T;){var H=T.nextSibling,ue=T.nodeName;T[Ot]||ue==="SCRIPT"||ue==="STYLE"||ue==="LINK"&&T.rel.toLowerCase()==="stylesheet"||p.removeChild(T),T=H}}else p==="body"&&lm(r.ownerDocument.body);p=w}while(p);ep(l)}function LA(r,l){var p=r;r=0;do{var v=p.nextSibling;if(p.nodeType===1?l?(p._stashedDisplay=p.style.display,p.style.display="none"):(p.style.display=p._stashedDisplay||"",p.getAttribute("style")===""&&p.removeAttribute("style")):p.nodeType===3&&(l?(p._stashedText=p.nodeValue,p.nodeValue=""):p.nodeValue=p._stashedText||""),v&&v.nodeType===8)if(p=v.data,p==="/$"){if(r===0)break;r--}else p!=="$"&&p!=="$?"&&p!=="$~"&&p!=="$!"||r++;p=v}while(p)}function hb(r){var l=r.firstChild;for(l&&l.nodeType===10&&(l=l.nextSibling);l;){var p=l;switch(l=l.nextSibling,p.nodeName){case"HTML":case"HEAD":case"BODY":hb(p),Dt(p);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(p.rel.toLowerCase()==="stylesheet")continue}r.removeChild(p)}}function GR(r,l,p,v){for(;r.nodeType===1;){var w=p;if(r.nodeName.toLowerCase()!==l.toLowerCase()){if(!v&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(v){if(!r[Ot])switch(l){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(T=r.getAttribute("rel"),T==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(T!==w.rel||r.getAttribute("href")!==(w.href==null||w.href===""?null:w.href)||r.getAttribute("crossorigin")!==(w.crossOrigin==null?null:w.crossOrigin)||r.getAttribute("title")!==(w.title==null?null:w.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(T=r.getAttribute("src"),(T!==(w.src==null?null:w.src)||r.getAttribute("type")!==(w.type==null?null:w.type)||r.getAttribute("crossorigin")!==(w.crossOrigin==null?null:w.crossOrigin))&&T&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(l==="input"&&r.type==="hidden"){var T=w.name==null?null:""+w.name;if(w.type==="hidden"&&r.getAttribute("name")===T)return r}else return r;if(r=ml(r.nextSibling),r===null)break}return null}function jR(r,l,p){if(l==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!p||(r=ml(r.nextSibling),r===null))return null;return r}function OA(r,l){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!l||(r=ml(r.nextSibling),r===null))return null;return r}function db(r){return r.data==="$?"||r.data==="$~"}function pb(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function HR(r,l){var p=r.ownerDocument;if(r.data==="$~")r._reactRetry=l;else if(r.data!=="$?"||p.readyState!=="loading")l();else{var v=function(){l(),p.removeEventListener("DOMContentLoaded",v)};p.addEventListener("DOMContentLoaded",v),r._reactRetry=v}}function ml(r){for(;r!=null;r=r.nextSibling){var l=r.nodeType;if(l===1||l===3)break;if(l===8){if(l=r.data,l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"||l==="F!"||l==="F")break;if(l==="/$"||l==="/&")return null}}return r}var mb=null;function IA(r){r=r.nextSibling;for(var l=0;r;){if(r.nodeType===8){var p=r.data;if(p==="/$"||p==="/&"){if(l===0)return ml(r.nextSibling);l--}else p!=="$"&&p!=="$!"&&p!=="$?"&&p!=="$~"&&p!=="&"||l++}r=r.nextSibling}return null}function zA(r){r=r.previousSibling;for(var l=0;r;){if(r.nodeType===8){var p=r.data;if(p==="$"||p==="$!"||p==="$?"||p==="$~"||p==="&"){if(l===0)return r;l--}else p!=="/$"&&p!=="/&"||l++}r=r.previousSibling}return null}function FA(r,l,p){switch(l=bg(p),r){case"html":if(r=l.documentElement,!r)throw Error(n(452));return r;case"head":if(r=l.head,!r)throw Error(n(453));return r;case"body":if(r=l.body,!r)throw Error(n(454));return r;default:throw Error(n(451))}}function lm(r){for(var l=r.attributes;l.length;)r.removeAttributeNode(l[0]);Dt(r)}var xl=new Map,PA=new Set;function _g(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var Cu=ae.d;ae.d={f:kR,r:VR,D:XR,C:YR,L:WR,m:qR,X:ZR,S:JR,M:KR};function kR(){var r=Cu.f(),l=de();return r||l}function VR(r){var l=K(r);l!==null&&l.tag===5&&l.type==="form"?K0(l):Cu.r(r)}var Kd=typeof document>"u"?null:document;function GA(r,l,p){var v=Kd;if(v&&typeof l=="string"&&l){var w=hn(l);w='link[rel="'+r+'"][href="'+w+'"]',typeof p=="string"&&(w+='[crossorigin="'+p+'"]'),PA.has(w)||(PA.add(w),r={rel:r,crossOrigin:p,href:l},v.querySelector(w)===null&&(l=v.createElement("link"),ar(l,"link",r),Oe(l),v.head.appendChild(l)))}}function XR(r){Cu.D(r),GA("dns-prefetch",r,null)}function YR(r,l){Cu.C(r,l),GA("preconnect",r,l)}function WR(r,l,p){Cu.L(r,l,p);var v=Kd;if(v&&r&&l){var w='link[rel="preload"][as="'+hn(l)+'"]';l==="image"&&p&&p.imageSrcSet?(w+='[imagesrcset="'+hn(p.imageSrcSet)+'"]',typeof p.imageSizes=="string"&&(w+='[imagesizes="'+hn(p.imageSizes)+'"]')):w+='[href="'+hn(r)+'"]';var T=w;switch(l){case"style":T=Qd(r);break;case"script":T=$d(r)}xl.has(T)||(r=x({rel:"preload",href:l==="image"&&p&&p.imageSrcSet?void 0:r,as:l},p),xl.set(T,r),v.querySelector(w)!==null||l==="style"&&v.querySelector(cm(T))||l==="script"&&v.querySelector(um(T))||(l=v.createElement("link"),ar(l,"link",r),Oe(l),v.head.appendChild(l)))}}function qR(r,l){Cu.m(r,l);var p=Kd;if(p&&r){var v=l&&typeof l.as=="string"?l.as:"script",w='link[rel="modulepreload"][as="'+hn(v)+'"][href="'+hn(r)+'"]',T=w;switch(v){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":T=$d(r)}if(!xl.has(T)&&(r=x({rel:"modulepreload",href:r},l),xl.set(T,r),p.querySelector(w)===null)){switch(v){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(p.querySelector(um(T)))return}v=p.createElement("link"),ar(v,"link",r),Oe(v),p.head.appendChild(v)}}}function JR(r,l,p){Cu.S(r,l,p);var v=Kd;if(v&&r){var w=xe(v).hoistableStyles,T=Qd(r);l=l||"default";var H=w.get(T);if(!H){var ue={loading:0,preload:null};if(H=v.querySelector(cm(T)))ue.loading=5;else{r=x({rel:"stylesheet",href:r,"data-precedence":l},p),(p=xl.get(T))&&xb(r,p);var Te=H=v.createElement("link");Oe(Te),ar(Te,"link",r),Te._p=new Promise(function(it,At){Te.onload=it,Te.onerror=At}),Te.addEventListener("load",function(){ue.loading|=1}),Te.addEventListener("error",function(){ue.loading|=2}),ue.loading|=4,Sg(H,l,v)}H={type:"stylesheet",instance:H,count:1,state:ue},w.set(T,H)}}}function ZR(r,l){Cu.X(r,l);var p=Kd;if(p&&r){var v=xe(p).hoistableScripts,w=$d(r),T=v.get(w);T||(T=p.querySelector(um(w)),T||(r=x({src:r,async:!0},l),(l=xl.get(w))&&gb(r,l),T=p.createElement("script"),Oe(T),ar(T,"link",r),p.head.appendChild(T)),T={type:"script",instance:T,count:1,state:null},v.set(w,T))}}function KR(r,l){Cu.M(r,l);var p=Kd;if(p&&r){var v=xe(p).hoistableScripts,w=$d(r),T=v.get(w);T||(T=p.querySelector(um(w)),T||(r=x({src:r,async:!0,type:"module"},l),(l=xl.get(w))&&gb(r,l),T=p.createElement("script"),Oe(T),ar(T,"link",r),p.head.appendChild(T)),T={type:"script",instance:T,count:1,state:null},v.set(w,T))}}function jA(r,l,p,v){var w=(w=$.current)?_g(w):null;if(!w)throw Error(n(446));switch(r){case"meta":case"title":return null;case"style":return typeof p.precedence=="string"&&typeof p.href=="string"?(l=Qd(p.href),p=xe(w).hoistableStyles,v=p.get(l),v||(v={type:"style",instance:null,count:0,state:null},p.set(l,v)),v):{type:"void",instance:null,count:0,state:null};case"link":if(p.rel==="stylesheet"&&typeof p.href=="string"&&typeof p.precedence=="string"){r=Qd(p.href);var T=xe(w).hoistableStyles,H=T.get(r);if(H||(w=w.ownerDocument||w,H={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},T.set(r,H),(T=w.querySelector(cm(r)))&&!T._p&&(H.instance=T,H.state.loading=5),xl.has(r)||(p={rel:"preload",as:"style",href:p.href,crossOrigin:p.crossOrigin,integrity:p.integrity,media:p.media,hrefLang:p.hrefLang,referrerPolicy:p.referrerPolicy},xl.set(r,p),T||QR(w,r,p,H.state))),l&&v===null)throw Error(n(528,""));return H}if(l&&v!==null)throw Error(n(529,""));return null;case"script":return l=p.async,p=p.src,typeof p=="string"&&l&&typeof l!="function"&&typeof l!="symbol"?(l=$d(p),p=xe(w).hoistableScripts,v=p.get(l),v||(v={type:"script",instance:null,count:0,state:null},p.set(l,v)),v):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,r))}}function Qd(r){return'href="'+hn(r)+'"'}function cm(r){return'link[rel="stylesheet"]['+r+"]"}function HA(r){return x({},r,{"data-precedence":r.precedence,precedence:null})}function QR(r,l,p,v){r.querySelector('link[rel="preload"][as="style"]['+l+"]")?v.loading=1:(l=r.createElement("link"),v.preload=l,l.addEventListener("load",function(){return v.loading|=1}),l.addEventListener("error",function(){return v.loading|=2}),ar(l,"link",p),Oe(l),r.head.appendChild(l))}function $d(r){return'[src="'+hn(r)+'"]'}function um(r){return"script[async]"+r}function kA(r,l,p){if(l.count++,l.instance===null)switch(l.type){case"style":var v=r.querySelector('style[data-href~="'+hn(p.href)+'"]');if(v)return l.instance=v,Oe(v),v;var w=x({},p,{"data-href":p.href,"data-precedence":p.precedence,href:null,precedence:null});return v=(r.ownerDocument||r).createElement("style"),Oe(v),ar(v,"style",w),Sg(v,p.precedence,r),l.instance=v;case"stylesheet":w=Qd(p.href);var T=r.querySelector(cm(w));if(T)return l.state.loading|=4,l.instance=T,Oe(T),T;v=HA(p),(w=xl.get(w))&&xb(v,w),T=(r.ownerDocument||r).createElement("link"),Oe(T);var H=T;return H._p=new Promise(function(ue,Te){H.onload=ue,H.onerror=Te}),ar(T,"link",v),l.state.loading|=4,Sg(T,p.precedence,r),l.instance=T;case"script":return T=$d(p.src),(w=r.querySelector(um(T)))?(l.instance=w,Oe(w),w):(v=p,(w=xl.get(T))&&(v=x({},p),gb(v,w)),r=r.ownerDocument||r,w=r.createElement("script"),Oe(w),ar(w,"link",v),r.head.appendChild(w),l.instance=w);case"void":return null;default:throw Error(n(443,l.type))}else l.type==="stylesheet"&&(l.state.loading&4)===0&&(v=l.instance,l.state.loading|=4,Sg(v,p.precedence,r));return l.instance}function Sg(r,l,p){for(var v=p.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),w=v.length?v[v.length-1]:null,T=w,H=0;H<v.length;H++){var ue=v[H];if(ue.dataset.precedence===l)T=ue;else if(T!==w)break}T?T.parentNode.insertBefore(r,T.nextSibling):(l=p.nodeType===9?p.head:p,l.insertBefore(r,l.firstChild))}function xb(r,l){r.crossOrigin==null&&(r.crossOrigin=l.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=l.referrerPolicy),r.title==null&&(r.title=l.title)}function gb(r,l){r.crossOrigin==null&&(r.crossOrigin=l.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=l.referrerPolicy),r.integrity==null&&(r.integrity=l.integrity)}var Ag=null;function VA(r,l,p){if(Ag===null){var v=new Map,w=Ag=new Map;w.set(p,v)}else w=Ag,v=w.get(p),v||(v=new Map,w.set(p,v));if(v.has(r))return v;for(v.set(r,null),p=p.getElementsByTagName(r),w=0;w<p.length;w++){var T=p[w];if(!(T[Ot]||T[bn]||r==="link"&&T.getAttribute("rel")==="stylesheet")&&T.namespaceURI!=="http://www.w3.org/2000/svg"){var H=T.getAttribute(l)||"";H=r+H;var ue=v.get(H);ue?ue.push(T):v.set(H,[T])}}return v}function XA(r,l,p){r=r.ownerDocument||r,r.head.insertBefore(p,l==="title"?r.querySelector("head > title"):null)}function $R(r,l,p){if(p===1||l.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof l.precedence!="string"||typeof l.href!="string"||l.href==="")break;return!0;case"link":if(typeof l.rel!="string"||typeof l.href!="string"||l.href===""||l.onLoad||l.onError)break;switch(l.rel){case"stylesheet":return r=l.disabled,typeof l.precedence=="string"&&r==null;default:return!0}case"script":if(l.async&&typeof l.async!="function"&&typeof l.async!="symbol"&&!l.onLoad&&!l.onError&&l.src&&typeof l.src=="string")return!0}return!1}function YA(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function eN(r,l,p,v){if(p.type==="stylesheet"&&(typeof v.media!="string"||matchMedia(v.media).matches!==!1)&&(p.state.loading&4)===0){if(p.instance===null){var w=Qd(v.href),T=l.querySelector(cm(w));if(T){l=T._p,l!==null&&typeof l=="object"&&typeof l.then=="function"&&(r.count++,r=Mg.bind(r),l.then(r,r)),p.state.loading|=4,p.instance=T,Oe(T);return}T=l.ownerDocument||l,v=HA(v),(w=xl.get(w))&&xb(v,w),T=T.createElement("link"),Oe(T);var H=T;H._p=new Promise(function(ue,Te){H.onload=ue,H.onerror=Te}),ar(T,"link",v),p.instance=T}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(p,l),(l=p.state.preload)&&(p.state.loading&3)===0&&(r.count++,p=Mg.bind(r),l.addEventListener("load",p),l.addEventListener("error",p))}}var vb=0;function tN(r,l){return r.stylesheets&&r.count===0&&Eg(r,r.stylesheets),0<r.count||0<r.imgCount?function(p){var v=setTimeout(function(){if(r.stylesheets&&Eg(r,r.stylesheets),r.unsuspend){var T=r.unsuspend;r.unsuspend=null,T()}},6e4+l);0<r.imgBytes&&vb===0&&(vb=62500*OR());var w=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&Eg(r,r.stylesheets),r.unsuspend)){var T=r.unsuspend;r.unsuspend=null,T()}},(r.imgBytes>vb?50:800)+l);return r.unsuspend=p,function(){r.unsuspend=null,clearTimeout(v),clearTimeout(w)}}:null}function Mg(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Eg(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var wg=null;function Eg(r,l){r.stylesheets=null,r.unsuspend!==null&&(r.count++,wg=new Map,l.forEach(nN,r),wg=null,Mg.call(r))}function nN(r,l){if(!(l.state.loading&4)){var p=wg.get(r);if(p)var v=p.get(null);else{p=new Map,wg.set(r,p);for(var w=r.querySelectorAll("link[data-precedence],style[data-precedence]"),T=0;T<w.length;T++){var H=w[T];(H.nodeName==="LINK"||H.getAttribute("media")!=="not all")&&(p.set(H.dataset.precedence,H),v=H)}v&&p.set(null,v)}w=l.instance,H=w.getAttribute("data-precedence"),T=p.get(H)||v,T===v&&p.set(null,w),p.set(H,w),this.count++,v=Mg.bind(this),w.addEventListener("load",v),w.addEventListener("error",v),T?T.parentNode.insertBefore(w,T.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(w,r.firstChild)),l.state.loading|=4}}var fm={$$typeof:N,Provider:null,Consumer:null,_currentValue:J,_currentValue2:J,_threadCount:0};function iN(r,l,p,v,w,T,H,ue,Te){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=on(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=on(0),this.hiddenUpdates=on(null),this.identifierPrefix=v,this.onUncaughtError=w,this.onCaughtError=T,this.onRecoverableError=H,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Te,this.incompleteTransitions=new Map}function WA(r,l,p,v,w,T,H,ue,Te,it,At,Bt){return r=new iN(r,l,p,H,Te,it,At,Bt,ue),l=1,T===!0&&(l|=24),T=Qs(3,null,null,l),r.current=T,T.stateNode=r,l=y0(),l.refCount++,r.pooledCache=l,l.refCount++,T.memoizedState={element:v,isDehydrated:p,cache:l},w0(T),r}function qA(r){return r?(r=_c,r):_c}function JA(r,l,p,v,w,T){w=qA(w),v.context===null?v.context=w:v.pendingContext=w,v=rl(l),v.payload={element:p},T=T===void 0?null:T,T!==null&&(v.callback=T),p=kl(r,v,l),p!==null&&(d(p,r,l),Rc(p,r,l))}function ZA(r,l){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var p=r.retryLane;r.retryLane=p!==0&&p<l?p:l}}function yb(r,l){ZA(r,l),(r=r.alternate)&&ZA(r,l)}function KA(r){if(r.tag===13||r.tag===31){var l=bc(r,67108864);l!==null&&d(l,r,67108864),yb(r,67108864)}}function QA(r){if(r.tag===13||r.tag===31){var l=ir();l=di(l);var p=bc(r,l);p!==null&&d(p,r,l),yb(r,l)}}var Cg=!0;function aN(r,l,p,v){var w=j.T;j.T=null;var T=ae.p;try{ae.p=2,bb(r,l,p,v)}finally{ae.p=T,j.T=w}}function sN(r,l,p,v){var w=j.T;j.T=null;var T=ae.p;try{ae.p=8,bb(r,l,p,v)}finally{ae.p=T,j.T=w}}function bb(r,l,p,v){if(Cg){var w=_b(v);if(w===null)rb(r,l,v,Tg,p),eM(r,v);else if(oN(w,r,l,p,v))v.stopPropagation();else if(eM(r,v),l&4&&-1<rN.indexOf(r)){for(;w!==null;){var T=K(w);if(T!==null)switch(T.tag){case 3:if(T=T.stateNode,T.current.memoizedState.isDehydrated){var H=dt(T.pendingLanes);if(H!==0){var ue=T;for(ue.pendingLanes|=2,ue.entangledLanes|=2;H;){var Te=1<<31-ge(H);ue.entanglements[1]|=Te,H&=~Te}Fc(T),(_i&6)===0&&(ao=X()+500,sm(0))}}break;case 31:case 13:ue=bc(T,2),ue!==null&&d(ue,T,2),de(),yb(T,2)}if(T=_b(v),T===null&&rb(r,l,v,Tg,p),T===w)break;w=T}w!==null&&v.stopPropagation()}else rb(r,l,v,null,p)}}function _b(r){return r=ho(r),Sb(r)}var Tg=null;function Sb(r){if(Tg=null,r=Nt(r),r!==null){var l=a(r);if(l===null)r=null;else{var p=l.tag;if(p===13){if(r=o(l),r!==null)return r;r=null}else if(p===31){if(r=c(l),r!==null)return r;r=null}else if(p===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;r=null}else l!==r&&(r=null)}}return Tg=r,null}function $A(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ae()){case Pe:return 2;case Ue:return 8;case Be:case bt:return 32;case vt:return 268435456;default:return 32}default:return 32}}var Ab=!1,ff=null,hf=null,df=null,hm=new Map,dm=new Map,pf=[],rN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function eM(r,l){switch(r){case"focusin":case"focusout":ff=null;break;case"dragenter":case"dragleave":hf=null;break;case"mouseover":case"mouseout":df=null;break;case"pointerover":case"pointerout":hm.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":dm.delete(l.pointerId)}}function pm(r,l,p,v,w,T){return r===null||r.nativeEvent!==T?(r={blockedOn:l,domEventName:p,eventSystemFlags:v,nativeEvent:T,targetContainers:[w]},l!==null&&(l=K(l),l!==null&&KA(l)),r):(r.eventSystemFlags|=v,l=r.targetContainers,w!==null&&l.indexOf(w)===-1&&l.push(w),r)}function oN(r,l,p,v,w){switch(l){case"focusin":return ff=pm(ff,r,l,p,v,w),!0;case"dragenter":return hf=pm(hf,r,l,p,v,w),!0;case"mouseover":return df=pm(df,r,l,p,v,w),!0;case"pointerover":var T=w.pointerId;return hm.set(T,pm(hm.get(T)||null,r,l,p,v,w)),!0;case"gotpointercapture":return T=w.pointerId,dm.set(T,pm(dm.get(T)||null,r,l,p,v,w)),!0}return!1}function tM(r){var l=Nt(r.target);if(l!==null){var p=a(l);if(p!==null){if(l=p.tag,l===13){if(l=o(p),l!==null){r.blockedOn=l,mn(r.priority,function(){QA(p)});return}}else if(l===31){if(l=c(p),l!==null){r.blockedOn=l,mn(r.priority,function(){QA(p)});return}}else if(l===3&&p.stateNode.current.memoizedState.isDehydrated){r.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Rg(r){if(r.blockedOn!==null)return!1;for(var l=r.targetContainers;0<l.length;){var p=_b(r.nativeEvent);if(p===null){p=r.nativeEvent;var v=new p.constructor(p.type,p);qs=v,p.target.dispatchEvent(v),qs=null}else return l=K(p),l!==null&&KA(l),r.blockedOn=p,!1;l.shift()}return!0}function nM(r,l,p){Rg(r)&&p.delete(l)}function lN(){Ab=!1,ff!==null&&Rg(ff)&&(ff=null),hf!==null&&Rg(hf)&&(hf=null),df!==null&&Rg(df)&&(df=null),hm.forEach(nM),dm.forEach(nM)}function Ng(r,l){r.blockedOn===l&&(r.blockedOn=null,Ab||(Ab=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,lN)))}var Bg=null;function iM(r){Bg!==r&&(Bg=r,s.unstable_scheduleCallback(s.unstable_NormalPriority,function(){Bg===r&&(Bg=null);for(var l=0;l<r.length;l+=3){var p=r[l],v=r[l+1],w=r[l+2];if(typeof v!="function"){if(Sb(v||p)===null)continue;break}var T=K(p);T!==null&&(r.splice(l,3),l-=3,Z0(T,{pending:!0,data:w,method:p.method,action:v},v,w))}}))}function ep(r){function l(Te){return Ng(Te,r)}ff!==null&&Ng(ff,r),hf!==null&&Ng(hf,r),df!==null&&Ng(df,r),hm.forEach(l),dm.forEach(l);for(var p=0;p<pf.length;p++){var v=pf[p];v.blockedOn===r&&(v.blockedOn=null)}for(;0<pf.length&&(p=pf[0],p.blockedOn===null);)tM(p),p.blockedOn===null&&pf.shift();if(p=(r.ownerDocument||r).$$reactFormReplay,p!=null)for(v=0;v<p.length;v+=3){var w=p[v],T=p[v+1],H=w[q]||null;if(typeof T=="function")H||iM(p);else if(H){var ue=null;if(T&&T.hasAttribute("formAction")){if(w=T,H=T[q]||null)ue=H.formAction;else if(Sb(w)!==null)continue}else ue=H.action;typeof ue=="function"?p[v+1]=ue:(p.splice(v,3),v-=3),iM(p)}}}function aM(){function r(T){T.canIntercept&&T.info==="react-transition"&&T.intercept({handler:function(){return new Promise(function(H){return w=H})},focusReset:"manual",scroll:"manual"})}function l(){w!==null&&(w(),w=null),v||setTimeout(p,20)}function p(){if(!v&&!navigation.transition){var T=navigation.currentEntry;T&&T.url!=null&&navigation.navigate(T.url,{state:T.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var v=!1,w=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",l),navigation.addEventListener("navigateerror",l),setTimeout(p,100),function(){v=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",l),navigation.removeEventListener("navigateerror",l),w!==null&&(w(),w=null)}}}function Mb(r){this._internalRoot=r}Dg.prototype.render=Mb.prototype.render=function(r){var l=this._internalRoot;if(l===null)throw Error(n(409));var p=l.current,v=ir();JA(p,v,r,l,null,null)},Dg.prototype.unmount=Mb.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var l=r.containerInfo;JA(r.current,2,null,r,null,null),de(),l[he]=null}};function Dg(r){this._internalRoot=r}Dg.prototype.unstable_scheduleHydration=function(r){if(r){var l=Mi();r={blockedOn:null,target:r,priority:l};for(var p=0;p<pf.length&&l!==0&&l<pf[p].priority;p++);pf.splice(p,0,r),p===0&&tM(r)}};var sM=e.version;if(sM!=="19.2.1")throw Error(n(527,sM,"19.2.1"));ae.findDOMNode=function(r){var l=r._reactInternals;if(l===void 0)throw typeof r.render=="function"?Error(n(188)):(r=Object.keys(r).join(","),Error(n(268,r)));return r=h(l),r=r!==null?m(r):null,r=r===null?null:r.stateNode,r};var cN={bundleType:0,version:"19.2.1",rendererPackageName:"react-dom",currentDispatcherRef:j,reconcilerVersion:"19.2.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ug=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ug.isDisabled&&Ug.supportsFiber)try{qe=Ug.inject(cN),We=Ug}catch{}}return xm.createRoot=function(r,l){if(!i(r))throw Error(n(299));var p=!1,v="",w=em,T=fg,H=zd;return l!=null&&(l.unstable_strictMode===!0&&(p=!0),l.identifierPrefix!==void 0&&(v=l.identifierPrefix),l.onUncaughtError!==void 0&&(w=l.onUncaughtError),l.onCaughtError!==void 0&&(T=l.onCaughtError),l.onRecoverableError!==void 0&&(H=l.onRecoverableError)),l=WA(r,1,!1,null,null,p,v,null,w,T,H,aM),r[he]=l.current,sb(r),new Mb(l)},xm.hydrateRoot=function(r,l,p){if(!i(r))throw Error(n(299));var v=!1,w="",T=em,H=fg,ue=zd,Te=null;return p!=null&&(p.unstable_strictMode===!0&&(v=!0),p.identifierPrefix!==void 0&&(w=p.identifierPrefix),p.onUncaughtError!==void 0&&(T=p.onUncaughtError),p.onCaughtError!==void 0&&(H=p.onCaughtError),p.onRecoverableError!==void 0&&(ue=p.onRecoverableError),p.formState!==void 0&&(Te=p.formState)),l=WA(r,1,!0,l,p??null,v,w,Te,T,H,ue,aM),l.context=qA(null),p=l.current,v=ir(),v=di(v),w=rl(v),w.callback=null,kl(p,w,v),p=v,l.current.lanes=p,Gn(l,p),Fc(l),r[he]=l.current,sb(r),new Dg(l)},xm.version="19.2.1",xm}var mM;function _N(){if(mM)return Cb.exports;mM=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),Cb.exports=bN(),Cb.exports}var y3=_N();const SN=ny(y3),or=[];for(let s=0;s<256;++s)or.push((s+256).toString(16).slice(1));function AN(s,e=0){return(or[s[e+0]]+or[s[e+1]]+or[s[e+2]]+or[s[e+3]]+"-"+or[s[e+4]]+or[s[e+5]]+"-"+or[s[e+6]]+or[s[e+7]]+"-"+or[s[e+8]]+or[s[e+9]]+"-"+or[s[e+10]]+or[s[e+11]]+or[s[e+12]]+or[s[e+13]]+or[s[e+14]]+or[s[e+15]]).toLowerCase()}let Bb;const MN=new Uint8Array(16);function wN(){if(!Bb){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Bb=crypto.getRandomValues.bind(crypto)}return Bb(MN)}const EN=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),xM={randomUUID:EN};function CN(s,e,t){var i;s=s||{};const n=s.random??((i=s.rng)==null?void 0:i.call(s))??wN();if(n.length<16)throw new Error("Random bytes length must be >= 16");return n[6]=n[6]&15|64,n[8]=n[8]&63|128,AN(n)}function oa(s,e,t){return xM.randomUUID&&!s?xM.randomUUID():CN(s)}/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const n0="181",Gh={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},jh={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},b3=0,A_=1,_3=2,TN=3,S3=0,iy=1,Ym=2,sc=3,Zc=0,fr=1,Oi=2,cc=0,Kh=1,t1=2,M_=3,w_=4,A3=5,wf=100,M3=101,w3=102,E3=103,C3=104,T3=200,R3=201,N3=202,B3=203,n1=204,i1=205,D3=206,U3=207,L3=208,O3=209,I3=210,z3=211,F3=212,P3=213,G3=214,a1=0,s1=1,r1=2,td=3,o1=4,l1=5,c1=6,u1=7,bx=0,j3=1,H3=2,qc=0,k3=1,aS=2,V3=3,sS=4,X3=5,Y3=6,W3=7,E_="attached",q3="detached",Uf=300,Kc=301,Lf=302,zp=303,sx=304,i0=306,Of=1e3,Pa=1001,Fp=1002,Vs=1003,ay=1004,RN=1004,Vh=1005,NN=1005,bi=1006,Dp=1007,BN=1007,Al=1008,C_=1008,uo=1009,sy=1010,ry=1011,Pp=1012,_x=1013,Qc=1014,Da=1015,xs=1016,oy=1017,ly=1018,Gp=1020,rS=35902,oS=35899,lS=1021,cS=1022,ss=1023,jp=1026,Hp=1027,Sx=1028,Ax=1029,cy=1030,uy=1031,DN=1032,fy=1033,Wm=33776,qm=33777,Jm=33778,Zm=33779,f1=35840,h1=35841,d1=35842,p1=35843,m1=36196,x1=37492,g1=37496,v1=37808,y1=37809,b1=37810,_1=37811,S1=37812,A1=37813,M1=37814,w1=37815,E1=37816,C1=37817,T1=37818,R1=37819,N1=37820,B1=37821,D1=36492,U1=36494,L1=36495,O1=36283,I1=36284,z1=36285,F1=36286,J3=2200,Z3=2201,K3=2202,kp=2300,Vp=2301,qv=2302,Xh=2400,Yh=2401,rx=2402,hy=2500,uS=2501,Q3=0,fS=1,P1=2,$3=3200,hS=3201,UN=3202,LN=3203,Gf=0,eC=1,zu="",Hs="srgb",uc="srgb-linear",ox="linear",ta="srgb",ON=0,Hh=7680,IN=7681,zN=7682,FN=7683,PN=34055,GN=34056,jN=5386,HN=512,kN=513,VN=514,XN=515,YN=516,WN=517,qN=518,T_=519,tC=512,nC=513,iC=514,dS=515,aC=516,sC=517,rC=518,oC=519,lx=35044,JN=35048,ZN=35040,KN=35045,QN=35049,$N=35041,eB=35046,tB=35050,nB=35042,iB="100",R_="300 es",Yo=2e3,Xp=2001,aB={COMPUTE:"compute",RENDER:"render"},sB={PERSPECTIVE:"perspective",LINEAR:"linear",FLAT:"flat"},rB={NORMAL:"normal",CENTROID:"centroid",SAMPLE:"sample",FIRST:"first",EITHER:"either"};function lC(s){for(let e=s.length-1;e>=0;--e)if(s[e]>=65535)return!0;return!1}const oB={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Bp(s,e){return new oB[s](e)}function cx(s){return document.createElementNS("http://www.w3.org/1999/xhtml",s)}function cC(){const s=cx("canvas");return s.style.display="block",s}const gM={};let If=null;function lB(s){If=s}function cB(){return If}function ux(...s){const e="THREE."+s.shift();If?If("log",e,...s):console.log(e,...s)}function un(...s){const e="THREE."+s.shift();If?If("warn",e,...s):console.warn(e,...s)}function Xn(...s){const e="THREE."+s.shift();If?If("error",e,...s):console.error(e,...s)}function Yp(...s){const e=s.join(" ");e in gM||(gM[e]=!0,un(...s))}function uB(s,e,t){return new Promise(function(n,i){function a(){switch(s.clientWaitSync(e,s.SYNC_FLUSH_COMMANDS_BIT,0)){case s.WAIT_FAILED:i();break;case s.TIMEOUT_EXPIRED:setTimeout(a,t);break;default:n()}}setTimeout(a,t)})}let eu=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){const n=this._listeners;return n===void 0?!1:n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){const n=this._listeners;if(n===void 0)return;const i=n[e];if(i!==void 0){const a=i.indexOf(t);a!==-1&&i.splice(a,1)}}dispatchEvent(e){const t=this._listeners;if(t===void 0)return;const n=t[e.type];if(n!==void 0){e.target=this;const i=n.slice(0);for(let a=0,o=i.length;a<o;a++)i[a].call(this,e);e.target=null}}};const Br=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let vM=1234567;const Qh=Math.PI/180,Wp=180/Math.PI;function Wo(){const s=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(Br[s&255]+Br[s>>8&255]+Br[s>>16&255]+Br[s>>24&255]+"-"+Br[e&255]+Br[e>>8&255]+"-"+Br[e>>16&15|64]+Br[e>>24&255]+"-"+Br[t&63|128]+Br[t>>8&255]+"-"+Br[t>>16&255]+Br[t>>24&255]+Br[n&255]+Br[n>>8&255]+Br[n>>16&255]+Br[n>>24&255]).toLowerCase()}function Pn(s,e,t){return Math.max(e,Math.min(t,s))}function pS(s,e){return(s%e+e)%e}function fB(s,e,t,n,i){return n+(s-e)*(i-n)/(t-e)}function hB(s,e,t){return s!==e?(t-s)/(e-s):0}function Km(s,e,t){return(1-t)*s+t*e}function dB(s,e,t,n){return Km(s,e,1-Math.exp(-t*n))}function pB(s,e=1){return e-Math.abs(pS(s,e*2)-e)}function mB(s,e,t){return s<=e?0:s>=t?1:(s=(s-e)/(t-e),s*s*(3-2*s))}function xB(s,e,t){return s<=e?0:s>=t?1:(s=(s-e)/(t-e),s*s*s*(s*(s*6-15)+10))}function gB(s,e){return s+Math.floor(Math.random()*(e-s+1))}function vB(s,e){return s+Math.random()*(e-s)}function yB(s){return s*(.5-Math.random())}function bB(s){s!==void 0&&(vM=s);let e=vM+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function _B(s){return s*Qh}function SB(s){return s*Wp}function AB(s){return(s&s-1)===0&&s!==0}function MB(s){return Math.pow(2,Math.ceil(Math.log(s)/Math.LN2))}function wB(s){return Math.pow(2,Math.floor(Math.log(s)/Math.LN2))}function EB(s,e,t,n,i){const a=Math.cos,o=Math.sin,c=a(t/2),u=o(t/2),h=a((e+n)/2),m=o((e+n)/2),x=a((e-n)/2),g=o((e-n)/2),b=a((n-e)/2),S=o((n-e)/2);switch(i){case"XYX":s.set(c*m,u*x,u*g,c*h);break;case"YZY":s.set(u*g,c*m,u*x,c*h);break;case"ZXZ":s.set(u*x,u*g,c*m,c*h);break;case"XZX":s.set(c*m,u*S,u*b,c*h);break;case"YXY":s.set(u*b,c*m,u*S,c*h);break;case"ZYZ":s.set(u*S,u*b,c*m,c*h);break;default:un("MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}function co(s,e){switch(e.constructor){case Float32Array:return s;case Uint32Array:return s/4294967295;case Uint16Array:return s/65535;case Uint8Array:return s/255;case Int32Array:return Math.max(s/2147483647,-1);case Int16Array:return Math.max(s/32767,-1);case Int8Array:return Math.max(s/127,-1);default:throw new Error("Invalid component type.")}}function ii(s,e){switch(e.constructor){case Float32Array:return s;case Uint32Array:return Math.round(s*4294967295);case Uint16Array:return Math.round(s*65535);case Uint8Array:return Math.round(s*255);case Int32Array:return Math.round(s*2147483647);case Int16Array:return Math.round(s*32767);case Int8Array:return Math.round(s*127);default:throw new Error("Invalid component type.")}}const zf={DEG2RAD:Qh,RAD2DEG:Wp,generateUUID:Wo,clamp:Pn,euclideanModulo:pS,mapLinear:fB,inverseLerp:hB,lerp:Km,damp:dB,pingpong:pB,smoothstep:mB,smootherstep:xB,randInt:gB,randFloat:vB,randFloatSpread:yB,seededRandom:bB,degToRad:_B,radToDeg:SB,isPowerOfTwo:AB,ceilPowerOfTwo:MB,floorPowerOfTwo:wB,setQuaternionFromProperEuler:EB,normalize:ii,denormalize:co};class gt{constructor(e=0,t=0){gt.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6],this.y=i[1]*t+i[4]*n+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Pn(this.x,e.x,t.x),this.y=Pn(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=Pn(this.x,e,t),this.y=Pn(this.y,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Pn(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Pn(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),i=Math.sin(t),a=this.x-e.x,o=this.y-e.y;return this.x=a*n-o*i+e.x,this.y=a*i+o*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Fn{constructor(e=0,t=0,n=0,i=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=i}static slerpFlat(e,t,n,i,a,o,c){let u=n[i+0],h=n[i+1],m=n[i+2],x=n[i+3],g=a[o+0],b=a[o+1],S=a[o+2],C=a[o+3];if(c<=0){e[t+0]=u,e[t+1]=h,e[t+2]=m,e[t+3]=x;return}if(c>=1){e[t+0]=g,e[t+1]=b,e[t+2]=S,e[t+3]=C;return}if(x!==C||u!==g||h!==b||m!==S){let M=u*g+h*b+m*S+x*C;M<0&&(g=-g,b=-b,S=-S,C=-C,M=-M);let A=1-c;if(M<.9995){const R=Math.acos(M),N=Math.sin(R);A=Math.sin(A*R)/N,c=Math.sin(c*R)/N,u=u*A+g*c,h=h*A+b*c,m=m*A+S*c,x=x*A+C*c}else{u=u*A+g*c,h=h*A+b*c,m=m*A+S*c,x=x*A+C*c;const R=1/Math.sqrt(u*u+h*h+m*m+x*x);u*=R,h*=R,m*=R,x*=R}}e[t]=u,e[t+1]=h,e[t+2]=m,e[t+3]=x}static multiplyQuaternionsFlat(e,t,n,i,a,o){const c=n[i],u=n[i+1],h=n[i+2],m=n[i+3],x=a[o],g=a[o+1],b=a[o+2],S=a[o+3];return e[t]=c*S+m*x+u*b-h*g,e[t+1]=u*S+m*g+h*x-c*b,e[t+2]=h*S+m*b+c*g-u*x,e[t+3]=m*S-c*x-u*g-h*b,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,i){return this._x=e,this._y=t,this._z=n,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const n=e._x,i=e._y,a=e._z,o=e._order,c=Math.cos,u=Math.sin,h=c(n/2),m=c(i/2),x=c(a/2),g=u(n/2),b=u(i/2),S=u(a/2);switch(o){case"XYZ":this._x=g*m*x+h*b*S,this._y=h*b*x-g*m*S,this._z=h*m*S+g*b*x,this._w=h*m*x-g*b*S;break;case"YXZ":this._x=g*m*x+h*b*S,this._y=h*b*x-g*m*S,this._z=h*m*S-g*b*x,this._w=h*m*x+g*b*S;break;case"ZXY":this._x=g*m*x-h*b*S,this._y=h*b*x+g*m*S,this._z=h*m*S+g*b*x,this._w=h*m*x-g*b*S;break;case"ZYX":this._x=g*m*x-h*b*S,this._y=h*b*x+g*m*S,this._z=h*m*S-g*b*x,this._w=h*m*x+g*b*S;break;case"YZX":this._x=g*m*x+h*b*S,this._y=h*b*x+g*m*S,this._z=h*m*S-g*b*x,this._w=h*m*x-g*b*S;break;case"XZY":this._x=g*m*x-h*b*S,this._y=h*b*x-g*m*S,this._z=h*m*S+g*b*x,this._w=h*m*x+g*b*S;break;default:un("Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,i=Math.sin(n);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],i=t[4],a=t[8],o=t[1],c=t[5],u=t[9],h=t[2],m=t[6],x=t[10],g=n+c+x;if(g>0){const b=.5/Math.sqrt(g+1);this._w=.25/b,this._x=(m-u)*b,this._y=(a-h)*b,this._z=(o-i)*b}else if(n>c&&n>x){const b=2*Math.sqrt(1+n-c-x);this._w=(m-u)/b,this._x=.25*b,this._y=(i+o)/b,this._z=(a+h)/b}else if(c>x){const b=2*Math.sqrt(1+c-n-x);this._w=(a-h)/b,this._x=(i+o)/b,this._y=.25*b,this._z=(u+m)/b}else{const b=2*Math.sqrt(1+x-n-c);this._w=(o-i)/b,this._x=(a+h)/b,this._y=(u+m)/b,this._z=.25*b}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<1e-8?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Pn(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(n===0)return this;const i=Math.min(1,t/n);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,i=e._y,a=e._z,o=e._w,c=t._x,u=t._y,h=t._z,m=t._w;return this._x=n*m+o*c+i*h-a*u,this._y=i*m+o*u+a*c-n*h,this._z=a*m+o*h+n*u-i*c,this._w=o*m-n*c-i*u-a*h,this._onChangeCallback(),this}slerp(e,t){if(t<=0)return this;if(t>=1)return this.copy(e);let n=e._x,i=e._y,a=e._z,o=e._w,c=this.dot(e);c<0&&(n=-n,i=-i,a=-a,o=-o,c=-c);let u=1-t;if(c<.9995){const h=Math.acos(c),m=Math.sin(h);u=Math.sin(u*h)/m,t=Math.sin(t*h)/m,this._x=this._x*u+n*t,this._y=this._y*u+i*t,this._z=this._z*u+a*t,this._w=this._w*u+o*t,this._onChangeCallback()}else this._x=this._x*u+n*t,this._y=this._y*u+i*t,this._z=this._z*u+a*t,this._w=this._w*u+o*t,this.normalize();return this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),i=Math.sqrt(1-n),a=Math.sqrt(n);return this.set(i*Math.sin(e),i*Math.cos(e),a*Math.sin(t),a*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class k{constructor(e=0,t=0,n=0){k.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return n===void 0&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(yM.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(yM.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,i=this.z,a=e.elements;return this.x=a[0]*t+a[3]*n+a[6]*i,this.y=a[1]*t+a[4]*n+a[7]*i,this.z=a[2]*t+a[5]*n+a[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,i=this.z,a=e.elements,o=1/(a[3]*t+a[7]*n+a[11]*i+a[15]);return this.x=(a[0]*t+a[4]*n+a[8]*i+a[12])*o,this.y=(a[1]*t+a[5]*n+a[9]*i+a[13])*o,this.z=(a[2]*t+a[6]*n+a[10]*i+a[14])*o,this}applyQuaternion(e){const t=this.x,n=this.y,i=this.z,a=e.x,o=e.y,c=e.z,u=e.w,h=2*(o*i-c*n),m=2*(c*t-a*i),x=2*(a*n-o*t);return this.x=t+u*h+o*x-c*m,this.y=n+u*m+c*h-a*x,this.z=i+u*x+a*m-o*h,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,i=this.z,a=e.elements;return this.x=a[0]*t+a[4]*n+a[8]*i,this.y=a[1]*t+a[5]*n+a[9]*i,this.z=a[2]*t+a[6]*n+a[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Pn(this.x,e.x,t.x),this.y=Pn(this.y,e.y,t.y),this.z=Pn(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=Pn(this.x,e,t),this.y=Pn(this.y,e,t),this.z=Pn(this.z,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Pn(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,i=e.y,a=e.z,o=t.x,c=t.y,u=t.z;return this.x=i*u-a*c,this.y=a*o-n*u,this.z=n*c-i*o,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return Db.copy(this).projectOnVector(e),this.sub(Db)}reflect(e){return this.sub(Db.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Pn(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,i=this.z-e.z;return t*t+n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const i=Math.sin(t)*e;return this.x=i*Math.sin(n),this.y=Math.cos(t)*e,this.z=i*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Db=new k,yM=new Fn;class Qn{constructor(e,t,n,i,a,o,c,u,h){Qn.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,n,i,a,o,c,u,h)}set(e,t,n,i,a,o,c,u,h){const m=this.elements;return m[0]=e,m[1]=i,m[2]=c,m[3]=t,m[4]=a,m[5]=u,m[6]=n,m[7]=o,m[8]=h,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,i=t.elements,a=this.elements,o=n[0],c=n[3],u=n[6],h=n[1],m=n[4],x=n[7],g=n[2],b=n[5],S=n[8],C=i[0],M=i[3],A=i[6],R=i[1],N=i[4],B=i[7],F=i[2],U=i[5],z=i[8];return a[0]=o*C+c*R+u*F,a[3]=o*M+c*N+u*U,a[6]=o*A+c*B+u*z,a[1]=h*C+m*R+x*F,a[4]=h*M+m*N+x*U,a[7]=h*A+m*B+x*z,a[2]=g*C+b*R+S*F,a[5]=g*M+b*N+S*U,a[8]=g*A+b*B+S*z,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],i=e[2],a=e[3],o=e[4],c=e[5],u=e[6],h=e[7],m=e[8];return t*o*m-t*c*h-n*a*m+n*c*u+i*a*h-i*o*u}invert(){const e=this.elements,t=e[0],n=e[1],i=e[2],a=e[3],o=e[4],c=e[5],u=e[6],h=e[7],m=e[8],x=m*o-c*h,g=c*u-m*a,b=h*a-o*u,S=t*x+n*g+i*b;if(S===0)return this.set(0,0,0,0,0,0,0,0,0);const C=1/S;return e[0]=x*C,e[1]=(i*h-m*n)*C,e[2]=(c*n-i*o)*C,e[3]=g*C,e[4]=(m*t-i*u)*C,e[5]=(i*a-c*t)*C,e[6]=b*C,e[7]=(n*u-h*t)*C,e[8]=(o*t-n*a)*C,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,i,a,o,c){const u=Math.cos(a),h=Math.sin(a);return this.set(n*u,n*h,-n*(u*o+h*c)+o+e,-i*h,i*u,-i*(-h*o+u*c)+c+t,0,0,1),this}scale(e,t){return this.premultiply(Ub.makeScale(e,t)),this}rotate(e){return this.premultiply(Ub.makeRotation(-e)),this}translate(e,t){return this.premultiply(Ub.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let i=0;i<9;i++)if(t[i]!==n[i])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const Ub=new Qn,bM=new Qn().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),_M=new Qn().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function CB(){const s={enabled:!0,workingColorSpace:uc,spaces:{},convert:function(i,a,o){return this.enabled===!1||a===o||!a||!o||(this.spaces[a].transfer===ta&&(i.r=Pu(i.r),i.g=Pu(i.g),i.b=Pu(i.b)),this.spaces[a].primaries!==this.spaces[o].primaries&&(i.applyMatrix3(this.spaces[a].toXYZ),i.applyMatrix3(this.spaces[o].fromXYZ)),this.spaces[o].transfer===ta&&(i.r=Up(i.r),i.g=Up(i.g),i.b=Up(i.b))),i},workingToColorSpace:function(i,a){return this.convert(i,this.workingColorSpace,a)},colorSpaceToWorking:function(i,a){return this.convert(i,a,this.workingColorSpace)},getPrimaries:function(i){return this.spaces[i].primaries},getTransfer:function(i){return i===zu?ox:this.spaces[i].transfer},getToneMappingMode:function(i){return this.spaces[i].outputColorSpaceConfig.toneMappingMode||"standard"},getLuminanceCoefficients:function(i,a=this.workingColorSpace){return i.fromArray(this.spaces[a].luminanceCoefficients)},define:function(i){Object.assign(this.spaces,i)},_getMatrix:function(i,a,o){return i.copy(this.spaces[a].toXYZ).multiply(this.spaces[o].fromXYZ)},_getDrawingBufferColorSpace:function(i){return this.spaces[i].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(i=this.workingColorSpace){return this.spaces[i].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(i,a){return Yp("ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),s.workingToColorSpace(i,a)},toWorkingColorSpace:function(i,a){return Yp("ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),s.colorSpaceToWorking(i,a)}},e=[.64,.33,.3,.6,.15,.06],t=[.2126,.7152,.0722],n=[.3127,.329];return s.define({[uc]:{primaries:e,whitePoint:n,transfer:ox,toXYZ:bM,fromXYZ:_M,luminanceCoefficients:t,workingColorSpaceConfig:{unpackColorSpace:Hs},outputColorSpaceConfig:{drawingBufferColorSpace:Hs}},[Hs]:{primaries:e,whitePoint:n,transfer:ta,toXYZ:bM,fromXYZ:_M,luminanceCoefficients:t,outputColorSpaceConfig:{drawingBufferColorSpace:Hs}}}),s}const Ri=CB();function Pu(s){return s<.04045?s*.0773993808:Math.pow(s*.9478672986+.0521327014,2.4)}function Up(s){return s<.0031308?s*12.92:1.055*Math.pow(s,.41666)-.055}let tp;class uC{static getDataURL(e,t="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let n;if(e instanceof HTMLCanvasElement)n=e;else{tp===void 0&&(tp=cx("canvas")),tp.width=e.width,tp.height=e.height;const i=tp.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),n=tp}return n.toDataURL(t)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=cx("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const i=n.getImageData(0,0,e.width,e.height),a=i.data;for(let o=0;o<a.length;o++)a[o]=Pu(a[o]/255)*255;return n.putImageData(i,0,0),t}else if(e.data){const t=e.data.slice(0);for(let n=0;n<t.length;n++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[n]=Math.floor(Pu(t[n]/255)*255):t[n]=Pu(t[n]);return{data:t,width:e.width,height:e.height}}else return un("ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let TB=0;class Cf{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:TB++}),this.uuid=Wo(),this.data=e,this.dataReady=!0,this.version=0}getSize(e){const t=this.data;return typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement?e.set(t.videoWidth,t.videoHeight,0):t instanceof VideoFrame?e.set(t.displayHeight,t.displayWidth,0):t!==null?e.set(t.width,t.height,t.depth||0):e.set(0,0,0),e}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const n={uuid:this.uuid,url:""},i=this.data;if(i!==null){let a;if(Array.isArray(i)){a=[];for(let o=0,c=i.length;o<c;o++)i[o].isDataTexture?a.push(Lb(i[o].image)):a.push(Lb(i[o]))}else a=Lb(i);n.url=a}return t||(e.images[this.uuid]=n),n}}function Lb(s){return typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&s instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&s instanceof ImageBitmap?uC.getDataURL(s):s.data?{data:Array.from(s.data),width:s.width,height:s.height,type:s.data.constructor.name}:(un("Texture: Unable to serialize Texture."),{})}let RB=0;const Ob=new k;class Wi extends eu{constructor(e=Wi.DEFAULT_IMAGE,t=Wi.DEFAULT_MAPPING,n=Pa,i=Pa,a=bi,o=Al,c=ss,u=uo,h=Wi.DEFAULT_ANISOTROPY,m=zu){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:RB++}),this.uuid=Wo(),this.name="",this.source=new Cf(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=n,this.wrapT=i,this.magFilter=a,this.minFilter=o,this.anisotropy=h,this.format=c,this.internalFormat=null,this.type=u,this.offset=new gt(0,0),this.repeat=new gt(1,1),this.center=new gt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Qn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=m,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(e&&e.depth&&e.depth>1),this.pmremVersion=0}get width(){return this.source.getSize(Ob).x}get height(){return this.source.getSize(Ob).y}get depth(){return this.source.getSize(Ob).z}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isArrayTexture=e.isArrayTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}setValues(e){for(const t in e){const n=e[t];if(n===void 0){un(`Texture.setValues(): parameter '${t}' has value of undefined.`);continue}const i=this[t];if(i===void 0){un(`Texture.setValues(): property '${t}' does not exist.`);continue}i&&n&&i.isVector2&&n.isVector2||i&&n&&i.isVector3&&n.isVector3||i&&n&&i.isMatrix3&&n.isMatrix3?i.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const n={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==Uf)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Of:e.x=e.x-Math.floor(e.x);break;case Pa:e.x=e.x<0?0:1;break;case Fp:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Of:e.y=e.y-Math.floor(e.y);break;case Pa:e.y=e.y<0?0:1;break;case Fp:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}Wi.DEFAULT_IMAGE=null;Wi.DEFAULT_MAPPING=Uf;Wi.DEFAULT_ANISOTROPY=1;class oi{constructor(e=0,t=0,n=0,i=1){oi.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,i){return this.x=e,this.y=t,this.z=n,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,i=this.z,a=this.w,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*i+o[12]*a,this.y=o[1]*t+o[5]*n+o[9]*i+o[13]*a,this.z=o[2]*t+o[6]*n+o[10]*i+o[14]*a,this.w=o[3]*t+o[7]*n+o[11]*i+o[15]*a,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,i,a;const u=e.elements,h=u[0],m=u[4],x=u[8],g=u[1],b=u[5],S=u[9],C=u[2],M=u[6],A=u[10];if(Math.abs(m-g)<.01&&Math.abs(x-C)<.01&&Math.abs(S-M)<.01){if(Math.abs(m+g)<.1&&Math.abs(x+C)<.1&&Math.abs(S+M)<.1&&Math.abs(h+b+A-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const N=(h+1)/2,B=(b+1)/2,F=(A+1)/2,U=(m+g)/4,z=(x+C)/4,P=(S+M)/4;return N>B&&N>F?N<.01?(n=0,i=.707106781,a=.707106781):(n=Math.sqrt(N),i=U/n,a=z/n):B>F?B<.01?(n=.707106781,i=0,a=.707106781):(i=Math.sqrt(B),n=U/i,a=P/i):F<.01?(n=.707106781,i=.707106781,a=0):(a=Math.sqrt(F),n=z/a,i=P/a),this.set(n,i,a,t),this}let R=Math.sqrt((M-S)*(M-S)+(x-C)*(x-C)+(g-m)*(g-m));return Math.abs(R)<.001&&(R=1),this.x=(M-S)/R,this.y=(x-C)/R,this.z=(g-m)/R,this.w=Math.acos((h+b+A-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Pn(this.x,e.x,t.x),this.y=Pn(this.y,e.y,t.y),this.z=Pn(this.z,e.z,t.z),this.w=Pn(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=Pn(this.x,e,t),this.y=Pn(this.y,e,t),this.z=Pn(this.z,e,t),this.w=Pn(this.w,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Pn(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class mS extends eu{constructor(e=1,t=1,n={}){super(),n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:bi,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,depth:1,multiview:!1},n),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=n.depth,this.scissor=new oi(0,0,e,t),this.scissorTest=!1,this.viewport=new oi(0,0,e,t);const i={width:e,height:t,depth:n.depth},a=new Wi(i);this.textures=[];const o=n.count;for(let c=0;c<o;c++)this.textures[c]=a.clone(),this.textures[c].isRenderTargetTexture=!0,this.textures[c].renderTarget=this;this._setTextureOptions(n),this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=n.depthTexture,this.samples=n.samples,this.multiview=n.multiview}_setTextureOptions(e={}){const t={minFilter:bi,generateMipmaps:!1,flipY:!1,internalFormat:null};e.mapping!==void 0&&(t.mapping=e.mapping),e.wrapS!==void 0&&(t.wrapS=e.wrapS),e.wrapT!==void 0&&(t.wrapT=e.wrapT),e.wrapR!==void 0&&(t.wrapR=e.wrapR),e.magFilter!==void 0&&(t.magFilter=e.magFilter),e.minFilter!==void 0&&(t.minFilter=e.minFilter),e.format!==void 0&&(t.format=e.format),e.type!==void 0&&(t.type=e.type),e.anisotropy!==void 0&&(t.anisotropy=e.anisotropy),e.colorSpace!==void 0&&(t.colorSpace=e.colorSpace),e.flipY!==void 0&&(t.flipY=e.flipY),e.generateMipmaps!==void 0&&(t.generateMipmaps=e.generateMipmaps),e.internalFormat!==void 0&&(t.internalFormat=e.internalFormat);for(let n=0;n<this.textures.length;n++)this.textures[n].setValues(t)}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let i=0,a=this.textures.length;i<a;i++)this.textures[i].image.width=e,this.textures[i].image.height=t,this.textures[i].image.depth=n,this.textures[i].isData3DTexture!==!0&&(this.textures[i].isArrayTexture=this.textures[i].image.depth>1);this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,n=e.textures.length;t<n;t++){this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;const i=Object.assign({},e.textures[t].image);this.textures[t].source=new Cf(i)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class qo extends mS{constructor(e=1,t=1,n={}){super(e,t,n),this.isWebGLRenderTarget=!0}}class dy extends Wi{constructor(e=null,t=1,n=1,i=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:i},this.magFilter=Vs,this.minFilter=Vs,this.wrapR=Pa,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class NB extends qo{constructor(e=1,t=1,n=1,i={}){super(e,t,i),this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new dy(null,e,t,n),this._setTextureOptions(i),this.texture.isRenderTargetTexture=!0}}class py extends Wi{constructor(e=null,t=1,n=1,i=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:i},this.magFilter=Vs,this.minFilter=Vs,this.wrapR=Pa,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class BB extends qo{constructor(e=1,t=1,n=1,i={}){super(e,t,i),this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new py(null,e,t,n),this._setTextureOptions(i),this.texture.isRenderTargetTexture=!0}}class Yi{constructor(e=new k(1/0,1/0,1/0),t=new k(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(tc.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(tc.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=tc.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(n!==void 0){const a=n.getAttribute("position");if(t===!0&&a!==void 0&&e.isInstancedMesh!==!0)for(let o=0,c=a.count;o<c;o++)e.isMesh===!0?e.getVertexPosition(o,tc):tc.fromBufferAttribute(a,o),tc.applyMatrix4(e.matrixWorld),this.expandByPoint(tc);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),Lg.copy(e.boundingBox)):(n.boundingBox===null&&n.computeBoundingBox(),Lg.copy(n.boundingBox)),Lg.applyMatrix4(e.matrixWorld),this.union(Lg)}const i=e.children;for(let a=0,o=i.length;a<o;a++)this.expandByObject(i[a],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,tc),tc.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(gm),Og.subVectors(this.max,gm),np.subVectors(e.a,gm),ip.subVectors(e.b,gm),ap.subVectors(e.c,gm),xf.subVectors(ip,np),gf.subVectors(ap,ip),Sh.subVectors(np,ap);let t=[0,-xf.z,xf.y,0,-gf.z,gf.y,0,-Sh.z,Sh.y,xf.z,0,-xf.x,gf.z,0,-gf.x,Sh.z,0,-Sh.x,-xf.y,xf.x,0,-gf.y,gf.x,0,-Sh.y,Sh.x,0];return!Ib(t,np,ip,ap,Og)||(t=[1,0,0,0,1,0,0,0,1],!Ib(t,np,ip,ap,Og))?!1:(Ig.crossVectors(xf,gf),t=[Ig.x,Ig.y,Ig.z],Ib(t,np,ip,ap,Og))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,tc).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(tc).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Tu[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Tu[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Tu[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Tu[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Tu[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Tu[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Tu[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Tu[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Tu),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(e){return this.min.fromArray(e.min),this.max.fromArray(e.max),this}}const Tu=[new k,new k,new k,new k,new k,new k,new k,new k],tc=new k,Lg=new Yi,np=new k,ip=new k,ap=new k,xf=new k,gf=new k,Sh=new k,gm=new k,Og=new k,Ig=new k,Ah=new k;function Ib(s,e,t,n,i){for(let a=0,o=s.length-3;a<=o;a+=3){Ah.fromArray(s,a);const c=i.x*Math.abs(Ah.x)+i.y*Math.abs(Ah.y)+i.z*Math.abs(Ah.z),u=e.dot(Ah),h=t.dot(Ah),m=n.dot(Ah);if(Math.max(-Math.max(u,h,m),Math.min(u,h,m))>c)return!1}return!0}const DB=new Yi,vm=new k,zb=new k;class rs{constructor(e=new k,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;t!==void 0?n.copy(t):DB.setFromPoints(e).getCenter(n);let i=0;for(let a=0,o=e.length;a<o;a++)i=Math.max(i,n.distanceToSquared(e[a]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;vm.subVectors(e,this.center);const t=vm.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),i=(n-this.radius)*.5;this.center.addScaledVector(vm,i/n),this.radius+=i}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(zb.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(vm.copy(e.center).add(zb)),this.expandByPoint(vm.copy(e.center).sub(zb))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(e){return this.radius=e.radius,this.center.fromArray(e.center),this}}const Ru=new k,Fb=new k,zg=new k,vf=new k,Pb=new k,Fg=new k,Gb=new k;class ld{constructor(e=new k,t=new k(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Ru)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Ru.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Ru.copy(this.origin).addScaledVector(this.direction,t),Ru.distanceToSquared(e))}distanceSqToSegment(e,t,n,i){Fb.copy(e).add(t).multiplyScalar(.5),zg.copy(t).sub(e).normalize(),vf.copy(this.origin).sub(Fb);const a=e.distanceTo(t)*.5,o=-this.direction.dot(zg),c=vf.dot(this.direction),u=-vf.dot(zg),h=vf.lengthSq(),m=Math.abs(1-o*o);let x,g,b,S;if(m>0)if(x=o*u-c,g=o*c-u,S=a*m,x>=0)if(g>=-S)if(g<=S){const C=1/m;x*=C,g*=C,b=x*(x+o*g+2*c)+g*(o*x+g+2*u)+h}else g=a,x=Math.max(0,-(o*g+c)),b=-x*x+g*(g+2*u)+h;else g=-a,x=Math.max(0,-(o*g+c)),b=-x*x+g*(g+2*u)+h;else g<=-S?(x=Math.max(0,-(-o*a+c)),g=x>0?-a:Math.min(Math.max(-a,-u),a),b=-x*x+g*(g+2*u)+h):g<=S?(x=0,g=Math.min(Math.max(-a,-u),a),b=g*(g+2*u)+h):(x=Math.max(0,-(o*a+c)),g=x>0?a:Math.min(Math.max(-a,-u),a),b=-x*x+g*(g+2*u)+h);else g=o>0?-a:a,x=Math.max(0,-(o*g+c)),b=-x*x+g*(g+2*u)+h;return n&&n.copy(this.origin).addScaledVector(this.direction,x),i&&i.copy(Fb).addScaledVector(zg,g),b}intersectSphere(e,t){Ru.subVectors(e.center,this.origin);const n=Ru.dot(this.direction),i=Ru.dot(Ru)-n*n,a=e.radius*e.radius;if(i>a)return null;const o=Math.sqrt(a-i),c=n-o,u=n+o;return u<0?null:c<0?this.at(u,t):this.at(c,t)}intersectsSphere(e){return e.radius<0?!1:this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return n===null?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,i,a,o,c,u;const h=1/this.direction.x,m=1/this.direction.y,x=1/this.direction.z,g=this.origin;return h>=0?(n=(e.min.x-g.x)*h,i=(e.max.x-g.x)*h):(n=(e.max.x-g.x)*h,i=(e.min.x-g.x)*h),m>=0?(a=(e.min.y-g.y)*m,o=(e.max.y-g.y)*m):(a=(e.max.y-g.y)*m,o=(e.min.y-g.y)*m),n>o||a>i||((a>n||isNaN(n))&&(n=a),(o<i||isNaN(i))&&(i=o),x>=0?(c=(e.min.z-g.z)*x,u=(e.max.z-g.z)*x):(c=(e.max.z-g.z)*x,u=(e.min.z-g.z)*x),n>u||c>i)||((c>n||n!==n)&&(n=c),(u<i||i!==i)&&(i=u),i<0)?null:this.at(n>=0?n:i,t)}intersectsBox(e){return this.intersectBox(e,Ru)!==null}intersectTriangle(e,t,n,i,a){Pb.subVectors(t,e),Fg.subVectors(n,e),Gb.crossVectors(Pb,Fg);let o=this.direction.dot(Gb),c;if(o>0){if(i)return null;c=1}else if(o<0)c=-1,o=-o;else return null;vf.subVectors(this.origin,e);const u=c*this.direction.dot(Fg.crossVectors(vf,Fg));if(u<0)return null;const h=c*this.direction.dot(Pb.cross(vf));if(h<0||u+h>o)return null;const m=-c*vf.dot(Gb);return m<0?null:this.at(m/o,a)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class wn{constructor(e,t,n,i,a,o,c,u,h,m,x,g,b,S,C,M){wn.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,n,i,a,o,c,u,h,m,x,g,b,S,C,M)}set(e,t,n,i,a,o,c,u,h,m,x,g,b,S,C,M){const A=this.elements;return A[0]=e,A[4]=t,A[8]=n,A[12]=i,A[1]=a,A[5]=o,A[9]=c,A[13]=u,A[2]=h,A[6]=m,A[10]=x,A[14]=g,A[3]=b,A[7]=S,A[11]=C,A[15]=M,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new wn().fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,n=e.elements,i=1/sp.setFromMatrixColumn(e,0).length(),a=1/sp.setFromMatrixColumn(e,1).length(),o=1/sp.setFromMatrixColumn(e,2).length();return t[0]=n[0]*i,t[1]=n[1]*i,t[2]=n[2]*i,t[3]=0,t[4]=n[4]*a,t[5]=n[5]*a,t[6]=n[6]*a,t[7]=0,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,i=e.y,a=e.z,o=Math.cos(n),c=Math.sin(n),u=Math.cos(i),h=Math.sin(i),m=Math.cos(a),x=Math.sin(a);if(e.order==="XYZ"){const g=o*m,b=o*x,S=c*m,C=c*x;t[0]=u*m,t[4]=-u*x,t[8]=h,t[1]=b+S*h,t[5]=g-C*h,t[9]=-c*u,t[2]=C-g*h,t[6]=S+b*h,t[10]=o*u}else if(e.order==="YXZ"){const g=u*m,b=u*x,S=h*m,C=h*x;t[0]=g+C*c,t[4]=S*c-b,t[8]=o*h,t[1]=o*x,t[5]=o*m,t[9]=-c,t[2]=b*c-S,t[6]=C+g*c,t[10]=o*u}else if(e.order==="ZXY"){const g=u*m,b=u*x,S=h*m,C=h*x;t[0]=g-C*c,t[4]=-o*x,t[8]=S+b*c,t[1]=b+S*c,t[5]=o*m,t[9]=C-g*c,t[2]=-o*h,t[6]=c,t[10]=o*u}else if(e.order==="ZYX"){const g=o*m,b=o*x,S=c*m,C=c*x;t[0]=u*m,t[4]=S*h-b,t[8]=g*h+C,t[1]=u*x,t[5]=C*h+g,t[9]=b*h-S,t[2]=-h,t[6]=c*u,t[10]=o*u}else if(e.order==="YZX"){const g=o*u,b=o*h,S=c*u,C=c*h;t[0]=u*m,t[4]=C-g*x,t[8]=S*x+b,t[1]=x,t[5]=o*m,t[9]=-c*m,t[2]=-h*m,t[6]=b*x+S,t[10]=g-C*x}else if(e.order==="XZY"){const g=o*u,b=o*h,S=c*u,C=c*h;t[0]=u*m,t[4]=-x,t[8]=h*m,t[1]=g*x+C,t[5]=o*m,t[9]=b*x-S,t[2]=S*x-b,t[6]=c*m,t[10]=C*x+g}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(UB,e,LB)}lookAt(e,t,n){const i=this.elements;return Vo.subVectors(e,t),Vo.lengthSq()===0&&(Vo.z=1),Vo.normalize(),yf.crossVectors(n,Vo),yf.lengthSq()===0&&(Math.abs(n.z)===1?Vo.x+=1e-4:Vo.z+=1e-4,Vo.normalize(),yf.crossVectors(n,Vo)),yf.normalize(),Pg.crossVectors(Vo,yf),i[0]=yf.x,i[4]=Pg.x,i[8]=Vo.x,i[1]=yf.y,i[5]=Pg.y,i[9]=Vo.y,i[2]=yf.z,i[6]=Pg.z,i[10]=Vo.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,i=t.elements,a=this.elements,o=n[0],c=n[4],u=n[8],h=n[12],m=n[1],x=n[5],g=n[9],b=n[13],S=n[2],C=n[6],M=n[10],A=n[14],R=n[3],N=n[7],B=n[11],F=n[15],U=i[0],z=i[4],P=i[8],L=i[12],O=i[1],ee=i[5],Q=i[9],te=i[13],ne=i[2],re=i[6],j=i[10],ae=i[14],J=i[3],ie=i[7],se=i[11],I=i[15];return a[0]=o*U+c*O+u*ne+h*J,a[4]=o*z+c*ee+u*re+h*ie,a[8]=o*P+c*Q+u*j+h*se,a[12]=o*L+c*te+u*ae+h*I,a[1]=m*U+x*O+g*ne+b*J,a[5]=m*z+x*ee+g*re+b*ie,a[9]=m*P+x*Q+g*j+b*se,a[13]=m*L+x*te+g*ae+b*I,a[2]=S*U+C*O+M*ne+A*J,a[6]=S*z+C*ee+M*re+A*ie,a[10]=S*P+C*Q+M*j+A*se,a[14]=S*L+C*te+M*ae+A*I,a[3]=R*U+N*O+B*ne+F*J,a[7]=R*z+N*ee+B*re+F*ie,a[11]=R*P+N*Q+B*j+F*se,a[15]=R*L+N*te+B*ae+F*I,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],i=e[8],a=e[12],o=e[1],c=e[5],u=e[9],h=e[13],m=e[2],x=e[6],g=e[10],b=e[14],S=e[3],C=e[7],M=e[11],A=e[15];return S*(+a*u*x-i*h*x-a*c*g+n*h*g+i*c*b-n*u*b)+C*(+t*u*b-t*h*g+a*o*g-i*o*b+i*h*m-a*u*m)+M*(+t*h*x-t*c*b-a*o*x+n*o*b+a*c*m-n*h*m)+A*(-i*c*m-t*u*x+t*c*g+i*o*x-n*o*g+n*u*m)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],i=e[2],a=e[3],o=e[4],c=e[5],u=e[6],h=e[7],m=e[8],x=e[9],g=e[10],b=e[11],S=e[12],C=e[13],M=e[14],A=e[15],R=x*M*h-C*g*h+C*u*b-c*M*b-x*u*A+c*g*A,N=S*g*h-m*M*h-S*u*b+o*M*b+m*u*A-o*g*A,B=m*C*h-S*x*h+S*c*b-o*C*b-m*c*A+o*x*A,F=S*x*u-m*C*u-S*c*g+o*C*g+m*c*M-o*x*M,U=t*R+n*N+i*B+a*F;if(U===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const z=1/U;return e[0]=R*z,e[1]=(C*g*a-x*M*a-C*i*b+n*M*b+x*i*A-n*g*A)*z,e[2]=(c*M*a-C*u*a+C*i*h-n*M*h-c*i*A+n*u*A)*z,e[3]=(x*u*a-c*g*a-x*i*h+n*g*h+c*i*b-n*u*b)*z,e[4]=N*z,e[5]=(m*M*a-S*g*a+S*i*b-t*M*b-m*i*A+t*g*A)*z,e[6]=(S*u*a-o*M*a-S*i*h+t*M*h+o*i*A-t*u*A)*z,e[7]=(o*g*a-m*u*a+m*i*h-t*g*h-o*i*b+t*u*b)*z,e[8]=B*z,e[9]=(S*x*a-m*C*a-S*n*b+t*C*b+m*n*A-t*x*A)*z,e[10]=(o*C*a-S*c*a+S*n*h-t*C*h-o*n*A+t*c*A)*z,e[11]=(m*c*a-o*x*a-m*n*h+t*x*h+o*n*b-t*c*b)*z,e[12]=F*z,e[13]=(m*C*i-S*x*i+S*n*g-t*C*g-m*n*M+t*x*M)*z,e[14]=(S*c*i-o*C*i-S*n*u+t*C*u+o*n*M-t*c*M)*z,e[15]=(o*x*i-m*c*i+m*n*u-t*x*u-o*n*g+t*c*g)*z,this}scale(e){const t=this.elements,n=e.x,i=e.y,a=e.z;return t[0]*=n,t[4]*=i,t[8]*=a,t[1]*=n,t[5]*=i,t[9]*=a,t[2]*=n,t[6]*=i,t[10]*=a,t[3]*=n,t[7]*=i,t[11]*=a,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,i))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),i=Math.sin(t),a=1-n,o=e.x,c=e.y,u=e.z,h=a*o,m=a*c;return this.set(h*o+n,h*c-i*u,h*u+i*c,0,h*c+i*u,m*c+n,m*u-i*o,0,h*u-i*c,m*u+i*o,a*u*u+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,i,a,o){return this.set(1,n,a,0,e,1,o,0,t,i,1,0,0,0,0,1),this}compose(e,t,n){const i=this.elements,a=t._x,o=t._y,c=t._z,u=t._w,h=a+a,m=o+o,x=c+c,g=a*h,b=a*m,S=a*x,C=o*m,M=o*x,A=c*x,R=u*h,N=u*m,B=u*x,F=n.x,U=n.y,z=n.z;return i[0]=(1-(C+A))*F,i[1]=(b+B)*F,i[2]=(S-N)*F,i[3]=0,i[4]=(b-B)*U,i[5]=(1-(g+A))*U,i[6]=(M+R)*U,i[7]=0,i[8]=(S+N)*z,i[9]=(M-R)*z,i[10]=(1-(g+C))*z,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,n){const i=this.elements;let a=sp.set(i[0],i[1],i[2]).length();const o=sp.set(i[4],i[5],i[6]).length(),c=sp.set(i[8],i[9],i[10]).length();this.determinant()<0&&(a=-a),e.x=i[12],e.y=i[13],e.z=i[14],nc.copy(this);const h=1/a,m=1/o,x=1/c;return nc.elements[0]*=h,nc.elements[1]*=h,nc.elements[2]*=h,nc.elements[4]*=m,nc.elements[5]*=m,nc.elements[6]*=m,nc.elements[8]*=x,nc.elements[9]*=x,nc.elements[10]*=x,t.setFromRotationMatrix(nc),n.x=a,n.y=o,n.z=c,this}makePerspective(e,t,n,i,a,o,c=Yo,u=!1){const h=this.elements,m=2*a/(t-e),x=2*a/(n-i),g=(t+e)/(t-e),b=(n+i)/(n-i);let S,C;if(u)S=a/(o-a),C=o*a/(o-a);else if(c===Yo)S=-(o+a)/(o-a),C=-2*o*a/(o-a);else if(c===Xp)S=-o/(o-a),C=-o*a/(o-a);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+c);return h[0]=m,h[4]=0,h[8]=g,h[12]=0,h[1]=0,h[5]=x,h[9]=b,h[13]=0,h[2]=0,h[6]=0,h[10]=S,h[14]=C,h[3]=0,h[7]=0,h[11]=-1,h[15]=0,this}makeOrthographic(e,t,n,i,a,o,c=Yo,u=!1){const h=this.elements,m=2/(t-e),x=2/(n-i),g=-(t+e)/(t-e),b=-(n+i)/(n-i);let S,C;if(u)S=1/(o-a),C=o/(o-a);else if(c===Yo)S=-2/(o-a),C=-(o+a)/(o-a);else if(c===Xp)S=-1/(o-a),C=-a/(o-a);else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+c);return h[0]=m,h[4]=0,h[8]=0,h[12]=g,h[1]=0,h[5]=x,h[9]=0,h[13]=b,h[2]=0,h[6]=0,h[10]=S,h[14]=C,h[3]=0,h[7]=0,h[11]=0,h[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let i=0;i<16;i++)if(t[i]!==n[i])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const sp=new k,nc=new wn,UB=new k(0,0,0),LB=new k(1,1,1),yf=new k,Pg=new k,Vo=new k,SM=new wn,AM=new Fn;class hi{constructor(e=0,t=0,n=0,i=hi.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,i=this._order){return this._x=e,this._y=t,this._z=n,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const i=e.elements,a=i[0],o=i[4],c=i[8],u=i[1],h=i[5],m=i[9],x=i[2],g=i[6],b=i[10];switch(t){case"XYZ":this._y=Math.asin(Pn(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-m,b),this._z=Math.atan2(-o,a)):(this._x=Math.atan2(g,h),this._z=0);break;case"YXZ":this._x=Math.asin(-Pn(m,-1,1)),Math.abs(m)<.9999999?(this._y=Math.atan2(c,b),this._z=Math.atan2(u,h)):(this._y=Math.atan2(-x,a),this._z=0);break;case"ZXY":this._x=Math.asin(Pn(g,-1,1)),Math.abs(g)<.9999999?(this._y=Math.atan2(-x,b),this._z=Math.atan2(-o,h)):(this._y=0,this._z=Math.atan2(u,a));break;case"ZYX":this._y=Math.asin(-Pn(x,-1,1)),Math.abs(x)<.9999999?(this._x=Math.atan2(g,b),this._z=Math.atan2(u,a)):(this._x=0,this._z=Math.atan2(-o,h));break;case"YZX":this._z=Math.asin(Pn(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-m,h),this._y=Math.atan2(-x,a)):(this._x=0,this._y=Math.atan2(c,b));break;case"XZY":this._z=Math.asin(-Pn(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(g,h),this._y=Math.atan2(c,a)):(this._x=Math.atan2(-m,b),this._y=0);break;default:un("Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return SM.makeRotationFromQuaternion(e),this.setFromRotationMatrix(SM,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return AM.setFromEuler(this),this.setFromQuaternion(AM,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}hi.DEFAULT_ORDER="XYZ";let qp=class{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}},OB=0;const MM=new k,rp=new Fn,Nu=new wn,Gg=new k,ym=new k,IB=new k,zB=new Fn,wM=new k(1,0,0),EM=new k(0,1,0),CM=new k(0,0,1),TM={type:"added"},FB={type:"removed"},op={type:"childadded",child:null},jb={type:"childremoved",child:null};class ai extends eu{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:OB++}),this.uuid=Wo(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=ai.DEFAULT_UP.clone();const e=new k,t=new hi,n=new Fn,i=new k(1,1,1);function a(){n.setFromEuler(t,!1)}function o(){t.setFromQuaternion(n,void 0,!1)}t._onChange(a),n._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new wn},normalMatrix:{value:new Qn}}),this.matrix=new wn,this.matrixWorld=new wn,this.matrixAutoUpdate=ai.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=ai.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new qp,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return rp.setFromAxisAngle(e,t),this.quaternion.multiply(rp),this}rotateOnWorldAxis(e,t){return rp.setFromAxisAngle(e,t),this.quaternion.premultiply(rp),this}rotateX(e){return this.rotateOnAxis(wM,e)}rotateY(e){return this.rotateOnAxis(EM,e)}rotateZ(e){return this.rotateOnAxis(CM,e)}translateOnAxis(e,t){return MM.copy(e).applyQuaternion(this.quaternion),this.position.add(MM.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(wM,e)}translateY(e){return this.translateOnAxis(EM,e)}translateZ(e){return this.translateOnAxis(CM,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Nu.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?Gg.copy(e):Gg.set(e,t,n);const i=this.parent;this.updateWorldMatrix(!0,!1),ym.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Nu.lookAt(ym,Gg,this.up):Nu.lookAt(Gg,ym,this.up),this.quaternion.setFromRotationMatrix(Nu),i&&(Nu.extractRotation(i.matrixWorld),rp.setFromRotationMatrix(Nu),this.quaternion.premultiply(rp.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(Xn("Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(TM),op.child=e,this.dispatchEvent(op),op.child=null):Xn("Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(FB),jb.child=e,this.dispatchEvent(jb),jb.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),Nu.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Nu.multiply(e.parent.matrixWorld)),e.applyMatrix4(Nu),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(TM),op.child=e,this.dispatchEvent(op),op.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,i=this.children.length;n<i;n++){const o=this.children[n].getObjectByProperty(e,t);if(o!==void 0)return o}}getObjectsByProperty(e,t,n=[]){this[e]===t&&n.push(this);const i=this.children;for(let a=0,o=i.length;a<o;a++)i[a].getObjectsByProperty(e,t,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(ym,e,IB),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(ym,zB,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].updateMatrixWorld(e)}updateWorldMatrix(e,t){const n=this.parent;if(e===!0&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),t===!0){const i=this.children;for(let a=0,o=i.length;a<o;a++)i[a].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});const i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),i.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(i.type="BatchedMesh",i.perObjectFrustumCulled=this.perObjectFrustumCulled,i.sortObjects=this.sortObjects,i.drawRanges=this._drawRanges,i.reservedRanges=this._reservedRanges,i.geometryInfo=this._geometryInfo.map(c=>({...c,boundingBox:c.boundingBox?c.boundingBox.toJSON():void 0,boundingSphere:c.boundingSphere?c.boundingSphere.toJSON():void 0})),i.instanceInfo=this._instanceInfo.map(c=>({...c})),i.availableInstanceIds=this._availableInstanceIds.slice(),i.availableGeometryIds=this._availableGeometryIds.slice(),i.nextIndexStart=this._nextIndexStart,i.nextVertexStart=this._nextVertexStart,i.geometryCount=this._geometryCount,i.maxInstanceCount=this._maxInstanceCount,i.maxVertexCount=this._maxVertexCount,i.maxIndexCount=this._maxIndexCount,i.geometryInitialized=this._geometryInitialized,i.matricesTexture=this._matricesTexture.toJSON(e),i.indirectTexture=this._indirectTexture.toJSON(e),this._colorsTexture!==null&&(i.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(i.boundingSphere=this.boundingSphere.toJSON()),this.boundingBox!==null&&(i.boundingBox=this.boundingBox.toJSON()));function a(c,u){return c[u.uuid]===void 0&&(c[u.uuid]=u.toJSON(e)),u.uuid}if(this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=a(e.geometries,this.geometry);const c=this.geometry.parameters;if(c!==void 0&&c.shapes!==void 0){const u=c.shapes;if(Array.isArray(u))for(let h=0,m=u.length;h<m;h++){const x=u[h];a(e.shapes,x)}else a(e.shapes,u)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(a(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const c=[];for(let u=0,h=this.material.length;u<h;u++)c.push(a(e.materials,this.material[u]));i.material=c}else i.material=a(e.materials,this.material);if(this.children.length>0){i.children=[];for(let c=0;c<this.children.length;c++)i.children.push(this.children[c].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let c=0;c<this.animations.length;c++){const u=this.animations[c];i.animations.push(a(e.animations,u))}}if(t){const c=o(e.geometries),u=o(e.materials),h=o(e.textures),m=o(e.images),x=o(e.shapes),g=o(e.skeletons),b=o(e.animations),S=o(e.nodes);c.length>0&&(n.geometries=c),u.length>0&&(n.materials=u),h.length>0&&(n.textures=h),m.length>0&&(n.images=m),x.length>0&&(n.shapes=x),g.length>0&&(n.skeletons=g),b.length>0&&(n.animations=b),S.length>0&&(n.nodes=S)}return n.object=i,n;function o(c){const u=[];for(const h in c){const m=c[h];delete m.metadata,u.push(m)}return u}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let n=0;n<e.children.length;n++){const i=e.children[n];this.add(i.clone())}return this}}ai.DEFAULT_UP=new k(0,1,0);ai.DEFAULT_MATRIX_AUTO_UPDATE=!0;ai.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const ic=new k,Bu=new k,Hb=new k,Du=new k,lp=new k,cp=new k,RM=new k,kb=new k,Vb=new k,Xb=new k,Yb=new oi,Wb=new oi,qb=new oi;let Ef=class Np{constructor(e=new k,t=new k,n=new k){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,i){i.subVectors(n,t),ic.subVectors(e,t),i.cross(ic);const a=i.lengthSq();return a>0?i.multiplyScalar(1/Math.sqrt(a)):i.set(0,0,0)}static getBarycoord(e,t,n,i,a){ic.subVectors(i,t),Bu.subVectors(n,t),Hb.subVectors(e,t);const o=ic.dot(ic),c=ic.dot(Bu),u=ic.dot(Hb),h=Bu.dot(Bu),m=Bu.dot(Hb),x=o*h-c*c;if(x===0)return a.set(0,0,0),null;const g=1/x,b=(h*u-c*m)*g,S=(o*m-c*u)*g;return a.set(1-b-S,S,b)}static containsPoint(e,t,n,i){return this.getBarycoord(e,t,n,i,Du)===null?!1:Du.x>=0&&Du.y>=0&&Du.x+Du.y<=1}static getInterpolation(e,t,n,i,a,o,c,u){return this.getBarycoord(e,t,n,i,Du)===null?(u.x=0,u.y=0,"z"in u&&(u.z=0),"w"in u&&(u.w=0),null):(u.setScalar(0),u.addScaledVector(a,Du.x),u.addScaledVector(o,Du.y),u.addScaledVector(c,Du.z),u)}static getInterpolatedAttribute(e,t,n,i,a,o){return Yb.setScalar(0),Wb.setScalar(0),qb.setScalar(0),Yb.fromBufferAttribute(e,t),Wb.fromBufferAttribute(e,n),qb.fromBufferAttribute(e,i),o.setScalar(0),o.addScaledVector(Yb,a.x),o.addScaledVector(Wb,a.y),o.addScaledVector(qb,a.z),o}static isFrontFacing(e,t,n,i){return ic.subVectors(n,t),Bu.subVectors(e,t),ic.cross(Bu).dot(i)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,i){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,t,n,i){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return ic.subVectors(this.c,this.b),Bu.subVectors(this.a,this.b),ic.cross(Bu).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Np.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Np.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,i,a){return Np.getInterpolation(e,this.a,this.b,this.c,t,n,i,a)}containsPoint(e){return Np.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Np.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,i=this.b,a=this.c;let o,c;lp.subVectors(i,n),cp.subVectors(a,n),kb.subVectors(e,n);const u=lp.dot(kb),h=cp.dot(kb);if(u<=0&&h<=0)return t.copy(n);Vb.subVectors(e,i);const m=lp.dot(Vb),x=cp.dot(Vb);if(m>=0&&x<=m)return t.copy(i);const g=u*x-m*h;if(g<=0&&u>=0&&m<=0)return o=u/(u-m),t.copy(n).addScaledVector(lp,o);Xb.subVectors(e,a);const b=lp.dot(Xb),S=cp.dot(Xb);if(S>=0&&b<=S)return t.copy(a);const C=b*h-u*S;if(C<=0&&h>=0&&S<=0)return c=h/(h-S),t.copy(n).addScaledVector(cp,c);const M=m*S-b*x;if(M<=0&&x-m>=0&&b-S>=0)return RM.subVectors(a,i),c=(x-m)/(x-m+(b-S)),t.copy(i).addScaledVector(RM,c);const A=1/(M+C+g);return o=C*A,c=g*A,t.copy(n).addScaledVector(lp,o).addScaledVector(cp,c)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}};const fC={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},bf={h:0,s:0,l:0},jg={h:0,s:0,l:0};function Jb(s,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?s+(e-s)*6*t:t<1/2?e:t<2/3?s+(e-s)*6*(2/3-t):s}class qt{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(t===void 0&&n===void 0){const i=e;i&&i.isColor?this.copy(i):typeof i=="number"?this.setHex(i):typeof i=="string"&&this.setStyle(i)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Hs){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Ri.colorSpaceToWorking(this,t),this}setRGB(e,t,n,i=Ri.workingColorSpace){return this.r=e,this.g=t,this.b=n,Ri.colorSpaceToWorking(this,i),this}setHSL(e,t,n,i=Ri.workingColorSpace){if(e=pS(e,1),t=Pn(t,0,1),n=Pn(n,0,1),t===0)this.r=this.g=this.b=n;else{const a=n<=.5?n*(1+t):n+t-n*t,o=2*n-a;this.r=Jb(o,a,e+1/3),this.g=Jb(o,a,e),this.b=Jb(o,a,e-1/3)}return Ri.colorSpaceToWorking(this,i),this}setStyle(e,t=Hs){function n(a){a!==void 0&&parseFloat(a)<1&&un("Color: Alpha component of "+e+" will be ignored.")}let i;if(i=/^(\w+)\(([^\)]*)\)/.exec(e)){let a;const o=i[1],c=i[2];switch(o){case"rgb":case"rgba":if(a=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return n(a[4]),this.setRGB(Math.min(255,parseInt(a[1],10))/255,Math.min(255,parseInt(a[2],10))/255,Math.min(255,parseInt(a[3],10))/255,t);if(a=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return n(a[4]),this.setRGB(Math.min(100,parseInt(a[1],10))/100,Math.min(100,parseInt(a[2],10))/100,Math.min(100,parseInt(a[3],10))/100,t);break;case"hsl":case"hsla":if(a=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return n(a[4]),this.setHSL(parseFloat(a[1])/360,parseFloat(a[2])/100,parseFloat(a[3])/100,t);break;default:un("Color: Unknown color model "+e)}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(e)){const a=i[1],o=a.length;if(o===3)return this.setRGB(parseInt(a.charAt(0),16)/15,parseInt(a.charAt(1),16)/15,parseInt(a.charAt(2),16)/15,t);if(o===6)return this.setHex(parseInt(a,16),t);un("Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Hs){const n=fC[e.toLowerCase()];return n!==void 0?this.setHex(n,t):un("Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Pu(e.r),this.g=Pu(e.g),this.b=Pu(e.b),this}copyLinearToSRGB(e){return this.r=Up(e.r),this.g=Up(e.g),this.b=Up(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Hs){return Ri.workingToColorSpace(Dr.copy(this),e),Math.round(Pn(Dr.r*255,0,255))*65536+Math.round(Pn(Dr.g*255,0,255))*256+Math.round(Pn(Dr.b*255,0,255))}getHexString(e=Hs){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Ri.workingColorSpace){Ri.workingToColorSpace(Dr.copy(this),t);const n=Dr.r,i=Dr.g,a=Dr.b,o=Math.max(n,i,a),c=Math.min(n,i,a);let u,h;const m=(c+o)/2;if(c===o)u=0,h=0;else{const x=o-c;switch(h=m<=.5?x/(o+c):x/(2-o-c),o){case n:u=(i-a)/x+(i<a?6:0);break;case i:u=(a-n)/x+2;break;case a:u=(n-i)/x+4;break}u/=6}return e.h=u,e.s=h,e.l=m,e}getRGB(e,t=Ri.workingColorSpace){return Ri.workingToColorSpace(Dr.copy(this),t),e.r=Dr.r,e.g=Dr.g,e.b=Dr.b,e}getStyle(e=Hs){Ri.workingToColorSpace(Dr.copy(this),e);const t=Dr.r,n=Dr.g,i=Dr.b;return e!==Hs?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${i.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(n*255)},${Math.round(i*255)})`}offsetHSL(e,t,n){return this.getHSL(bf),this.setHSL(bf.h+e,bf.s+t,bf.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(bf),e.getHSL(jg);const n=Km(bf.h,jg.h,t),i=Km(bf.s,jg.s,t),a=Km(bf.l,jg.l,t);return this.setHSL(n,i,a),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,i=this.b,a=e.elements;return this.r=a[0]*t+a[3]*n+a[6]*i,this.g=a[1]*t+a[4]*n+a[7]*i,this.b=a[2]*t+a[5]*n+a[8]*i,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Dr=new qt;qt.NAMES=fC;let PB=0;class os extends eu{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:PB++}),this.uuid=Wo(),this.name="",this.type="Material",this.blending=Kh,this.side=Zc,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=n1,this.blendDst=i1,this.blendEquation=wf,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new qt(0,0,0),this.blendAlpha=0,this.depthFunc=td,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=T_,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Hh,this.stencilZFail=Hh,this.stencilZPass=Hh,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const n=e[t];if(n===void 0){un(`Material: parameter '${t}' has value of undefined.`);continue}const i=this[t];if(i===void 0){un(`Material: '${t}' is not a property of THREE.${this.type}.`);continue}i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const n={metadata:{version:4.7,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.sheenColorMap&&this.sheenColorMap.isTexture&&(n.sheenColorMap=this.sheenColorMap.toJSON(e).uuid),this.sheenRoughnessMap&&this.sheenRoughnessMap.isTexture&&(n.sheenRoughnessMap=this.sheenRoughnessMap.toJSON(e).uuid),this.dispersion!==void 0&&(n.dispersion=this.dispersion),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(n.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapRotation!==void 0&&(n.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==Kh&&(n.blending=this.blending),this.side!==Zc&&(n.side=this.side),this.vertexColors===!0&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=!0),this.blendSrc!==n1&&(n.blendSrc=this.blendSrc),this.blendDst!==i1&&(n.blendDst=this.blendDst),this.blendEquation!==wf&&(n.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(n.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(n.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==td&&(n.depthFunc=this.depthFunc),this.depthTest===!1&&(n.depthTest=this.depthTest),this.depthWrite===!1&&(n.depthWrite=this.depthWrite),this.colorWrite===!1&&(n.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==T_&&(n.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(n.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Hh&&(n.stencilFail=this.stencilFail),this.stencilZFail!==Hh&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==Hh&&(n.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(n.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaHash===!0&&(n.alphaHash=!0),this.alphaToCoverage===!0&&(n.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=!0),this.forceSinglePass===!0&&(n.forceSinglePass=!0),this.wireframe===!0&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=!0),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function i(a){const o=[];for(const c in a){const u=a[c];delete u.metadata,o.push(u)}return o}if(t){const a=i(e.textures),o=i(e.images);a.length>0&&(n.textures=a),o.length>0&&(n.images=o)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(t!==null){const i=t.length;n=new Array(i);for(let a=0;a!==i;++a)n[a]=t[a].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class ur extends os{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new qt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new hi,this.combine=bx,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Fu=GB();function GB(){const s=new ArrayBuffer(4),e=new Float32Array(s),t=new Uint32Array(s),n=new Uint32Array(512),i=new Uint32Array(512);for(let u=0;u<256;++u){const h=u-127;h<-27?(n[u]=0,n[u|256]=32768,i[u]=24,i[u|256]=24):h<-14?(n[u]=1024>>-h-14,n[u|256]=1024>>-h-14|32768,i[u]=-h-1,i[u|256]=-h-1):h<=15?(n[u]=h+15<<10,n[u|256]=h+15<<10|32768,i[u]=13,i[u|256]=13):h<128?(n[u]=31744,n[u|256]=64512,i[u]=24,i[u|256]=24):(n[u]=31744,n[u|256]=64512,i[u]=13,i[u|256]=13)}const a=new Uint32Array(2048),o=new Uint32Array(64),c=new Uint32Array(64);for(let u=1;u<1024;++u){let h=u<<13,m=0;for(;(h&8388608)===0;)h<<=1,m-=8388608;h&=-8388609,m+=947912704,a[u]=h|m}for(let u=1024;u<2048;++u)a[u]=939524096+(u-1024<<13);for(let u=1;u<31;++u)o[u]=u<<23;o[31]=1199570944,o[32]=2147483648;for(let u=33;u<63;++u)o[u]=2147483648+(u-32<<23);o[63]=3347054592;for(let u=1;u<64;++u)u!==32&&(c[u]=1024);return{floatView:e,uint32View:t,baseTable:n,shiftTable:i,mantissaTable:a,exponentTable:o,offsetTable:c}}function Eo(s){Math.abs(s)>65504&&un("DataUtils.toHalfFloat(): Value out of range."),s=Pn(s,-65504,65504),Fu.floatView[0]=s;const e=Fu.uint32View[0],t=e>>23&511;return Fu.baseTable[t]+((e&8388607)>>Fu.shiftTable[t])}function Gm(s){const e=s>>10;return Fu.uint32View[0]=Fu.mantissaTable[Fu.offsetTable[e]+(s&1023)]+Fu.exponentTable[e],Fu.floatView[0]}class Wh{static toHalfFloat(e){return Eo(e)}static fromHalfFloat(e){return Gm(e)}}const ms=new k,Hg=new gt;let jB=0;class Ii{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:jB++}),this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=n,this.usage=lx,this.updateRanges=[],this.gpuType=Da,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let i=0,a=this.itemSize;i<a;i++)this.array[e+i]=t.array[n+i];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,n=this.count;t<n;t++)Hg.fromBufferAttribute(this,t),Hg.applyMatrix3(e),this.setXY(t,Hg.x,Hg.y);else if(this.itemSize===3)for(let t=0,n=this.count;t<n;t++)ms.fromBufferAttribute(this,t),ms.applyMatrix3(e),this.setXYZ(t,ms.x,ms.y,ms.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)ms.fromBufferAttribute(this,t),ms.applyMatrix4(e),this.setXYZ(t,ms.x,ms.y,ms.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)ms.fromBufferAttribute(this,t),ms.applyNormalMatrix(e),this.setXYZ(t,ms.x,ms.y,ms.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)ms.fromBufferAttribute(this,t),ms.transformDirection(e),this.setXYZ(t,ms.x,ms.y,ms.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=co(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=ii(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=co(t,this.array)),t}setX(e,t){return this.normalized&&(t=ii(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=co(t,this.array)),t}setY(e,t){return this.normalized&&(t=ii(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=co(t,this.array)),t}setZ(e,t){return this.normalized&&(t=ii(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=co(t,this.array)),t}setW(e,t){return this.normalized&&(t=ii(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=ii(t,this.array),n=ii(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,i){return e*=this.itemSize,this.normalized&&(t=ii(t,this.array),n=ii(n,this.array),i=ii(i,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this}setXYZW(e,t,n,i,a){return e*=this.itemSize,this.normalized&&(t=ii(t,this.array),n=ii(n,this.array),i=ii(i,this.array),a=ii(a,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this.array[e+3]=a,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==lx&&(e.usage=this.usage),e}}class HB extends Ii{constructor(e,t,n){super(new Int8Array(e),t,n)}}class kB extends Ii{constructor(e,t,n){super(new Uint8Array(e),t,n)}}class VB extends Ii{constructor(e,t,n){super(new Uint8ClampedArray(e),t,n)}}class XB extends Ii{constructor(e,t,n){super(new Int16Array(e),t,n)}}class xS extends Ii{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class YB extends Ii{constructor(e,t,n){super(new Int32Array(e),t,n)}}class gS extends Ii{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class WB extends Ii{constructor(e,t,n){super(new Uint16Array(e),t,n),this.isFloat16BufferAttribute=!0}getX(e){let t=Gm(this.array[e*this.itemSize]);return this.normalized&&(t=co(t,this.array)),t}setX(e,t){return this.normalized&&(t=ii(t,this.array)),this.array[e*this.itemSize]=Eo(t),this}getY(e){let t=Gm(this.array[e*this.itemSize+1]);return this.normalized&&(t=co(t,this.array)),t}setY(e,t){return this.normalized&&(t=ii(t,this.array)),this.array[e*this.itemSize+1]=Eo(t),this}getZ(e){let t=Gm(this.array[e*this.itemSize+2]);return this.normalized&&(t=co(t,this.array)),t}setZ(e,t){return this.normalized&&(t=ii(t,this.array)),this.array[e*this.itemSize+2]=Eo(t),this}getW(e){let t=Gm(this.array[e*this.itemSize+3]);return this.normalized&&(t=co(t,this.array)),t}setW(e,t){return this.normalized&&(t=ii(t,this.array)),this.array[e*this.itemSize+3]=Eo(t),this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=ii(t,this.array),n=ii(n,this.array)),this.array[e+0]=Eo(t),this.array[e+1]=Eo(n),this}setXYZ(e,t,n,i){return e*=this.itemSize,this.normalized&&(t=ii(t,this.array),n=ii(n,this.array),i=ii(i,this.array)),this.array[e+0]=Eo(t),this.array[e+1]=Eo(n),this.array[e+2]=Eo(i),this}setXYZW(e,t,n,i,a){return e*=this.itemSize,this.normalized&&(t=ii(t,this.array),n=ii(n,this.array),i=ii(i,this.array),a=ii(a,this.array)),this.array[e+0]=Eo(t),this.array[e+1]=Eo(n),this.array[e+2]=Eo(i),this.array[e+3]=Eo(a),this}}class $t extends Ii{constructor(e,t,n){super(new Float32Array(e),t,n)}}let qB=0;const gl=new wn,Zb=new ai,up=new k,Xo=new Yi,bm=new Yi,js=new k;class Rn extends eu{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:qB++}),this.uuid=Wo(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(lC(e)?gS:xS)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const a=new Qn().getNormalMatrix(e);n.applyNormalMatrix(a),n.needsUpdate=!0}const i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(e),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return gl.makeRotationFromQuaternion(e),this.applyMatrix4(gl),this}rotateX(e){return gl.makeRotationX(e),this.applyMatrix4(gl),this}rotateY(e){return gl.makeRotationY(e),this.applyMatrix4(gl),this}rotateZ(e){return gl.makeRotationZ(e),this.applyMatrix4(gl),this}translate(e,t,n){return gl.makeTranslation(e,t,n),this.applyMatrix4(gl),this}scale(e,t,n){return gl.makeScale(e,t,n),this.applyMatrix4(gl),this}lookAt(e){return Zb.lookAt(e),Zb.updateMatrix(),this.applyMatrix4(Zb.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(up).negate(),this.translate(up.x,up.y,up.z),this}setFromPoints(e){const t=this.getAttribute("position");if(t===void 0){const n=[];for(let i=0,a=e.length;i<a;i++){const o=e[i];n.push(o.x,o.y,o.z||0)}this.setAttribute("position",new $t(n,3))}else{const n=Math.min(e.length,t.count);for(let i=0;i<n;i++){const a=e[i];t.setXYZ(i,a.x,a.y,a.z||0)}e.length>t.count&&un("BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Yi);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){Xn("BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new k(-1/0,-1/0,-1/0),new k(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,i=t.length;n<i;n++){const a=t[n];Xo.setFromBufferAttribute(a),this.morphTargetsRelative?(js.addVectors(this.boundingBox.min,Xo.min),this.boundingBox.expandByPoint(js),js.addVectors(this.boundingBox.max,Xo.max),this.boundingBox.expandByPoint(js)):(this.boundingBox.expandByPoint(Xo.min),this.boundingBox.expandByPoint(Xo.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&Xn('BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new rs);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){Xn("BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new k,1/0);return}if(e){const n=this.boundingSphere.center;if(Xo.setFromBufferAttribute(e),t)for(let a=0,o=t.length;a<o;a++){const c=t[a];bm.setFromBufferAttribute(c),this.morphTargetsRelative?(js.addVectors(Xo.min,bm.min),Xo.expandByPoint(js),js.addVectors(Xo.max,bm.max),Xo.expandByPoint(js)):(Xo.expandByPoint(bm.min),Xo.expandByPoint(bm.max))}Xo.getCenter(n);let i=0;for(let a=0,o=e.count;a<o;a++)js.fromBufferAttribute(e,a),i=Math.max(i,n.distanceToSquared(js));if(t)for(let a=0,o=t.length;a<o;a++){const c=t[a],u=this.morphTargetsRelative;for(let h=0,m=c.count;h<m;h++)js.fromBufferAttribute(c,h),u&&(up.fromBufferAttribute(e,h),js.add(up)),i=Math.max(i,n.distanceToSquared(js))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&Xn('BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){Xn("BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=t.position,i=t.normal,a=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Ii(new Float32Array(4*n.count),4));const o=this.getAttribute("tangent"),c=[],u=[];for(let P=0;P<n.count;P++)c[P]=new k,u[P]=new k;const h=new k,m=new k,x=new k,g=new gt,b=new gt,S=new gt,C=new k,M=new k;function A(P,L,O){h.fromBufferAttribute(n,P),m.fromBufferAttribute(n,L),x.fromBufferAttribute(n,O),g.fromBufferAttribute(a,P),b.fromBufferAttribute(a,L),S.fromBufferAttribute(a,O),m.sub(h),x.sub(h),b.sub(g),S.sub(g);const ee=1/(b.x*S.y-S.x*b.y);isFinite(ee)&&(C.copy(m).multiplyScalar(S.y).addScaledVector(x,-b.y).multiplyScalar(ee),M.copy(x).multiplyScalar(b.x).addScaledVector(m,-S.x).multiplyScalar(ee),c[P].add(C),c[L].add(C),c[O].add(C),u[P].add(M),u[L].add(M),u[O].add(M))}let R=this.groups;R.length===0&&(R=[{start:0,count:e.count}]);for(let P=0,L=R.length;P<L;++P){const O=R[P],ee=O.start,Q=O.count;for(let te=ee,ne=ee+Q;te<ne;te+=3)A(e.getX(te+0),e.getX(te+1),e.getX(te+2))}const N=new k,B=new k,F=new k,U=new k;function z(P){F.fromBufferAttribute(i,P),U.copy(F);const L=c[P];N.copy(L),N.sub(F.multiplyScalar(F.dot(L))).normalize(),B.crossVectors(U,L);const ee=B.dot(u[P])<0?-1:1;o.setXYZW(P,N.x,N.y,N.z,ee)}for(let P=0,L=R.length;P<L;++P){const O=R[P],ee=O.start,Q=O.count;for(let te=ee,ne=ee+Q;te<ne;te+=3)z(e.getX(te+0)),z(e.getX(te+1)),z(e.getX(te+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new Ii(new Float32Array(t.count*3),3),this.setAttribute("normal",n);else for(let g=0,b=n.count;g<b;g++)n.setXYZ(g,0,0,0);const i=new k,a=new k,o=new k,c=new k,u=new k,h=new k,m=new k,x=new k;if(e)for(let g=0,b=e.count;g<b;g+=3){const S=e.getX(g+0),C=e.getX(g+1),M=e.getX(g+2);i.fromBufferAttribute(t,S),a.fromBufferAttribute(t,C),o.fromBufferAttribute(t,M),m.subVectors(o,a),x.subVectors(i,a),m.cross(x),c.fromBufferAttribute(n,S),u.fromBufferAttribute(n,C),h.fromBufferAttribute(n,M),c.add(m),u.add(m),h.add(m),n.setXYZ(S,c.x,c.y,c.z),n.setXYZ(C,u.x,u.y,u.z),n.setXYZ(M,h.x,h.y,h.z)}else for(let g=0,b=t.count;g<b;g+=3)i.fromBufferAttribute(t,g+0),a.fromBufferAttribute(t,g+1),o.fromBufferAttribute(t,g+2),m.subVectors(o,a),x.subVectors(i,a),m.cross(x),n.setXYZ(g+0,m.x,m.y,m.z),n.setXYZ(g+1,m.x,m.y,m.z),n.setXYZ(g+2,m.x,m.y,m.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)js.fromBufferAttribute(e,t),js.normalize(),e.setXYZ(t,js.x,js.y,js.z)}toNonIndexed(){function e(c,u){const h=c.array,m=c.itemSize,x=c.normalized,g=new h.constructor(u.length*m);let b=0,S=0;for(let C=0,M=u.length;C<M;C++){c.isInterleavedBufferAttribute?b=u[C]*c.data.stride+c.offset:b=u[C]*m;for(let A=0;A<m;A++)g[S++]=h[b++]}return new Ii(g,m,x)}if(this.index===null)return un("BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Rn,n=this.index.array,i=this.attributes;for(const c in i){const u=i[c],h=e(u,n);t.setAttribute(c,h)}const a=this.morphAttributes;for(const c in a){const u=[],h=a[c];for(let m=0,x=h.length;m<x;m++){const g=h[m],b=e(g,n);u.push(b)}t.morphAttributes[c]=u}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let c=0,u=o.length;c<u;c++){const h=o[c];t.addGroup(h.start,h.count,h.materialIndex)}return t}toJSON(){const e={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const u=this.parameters;for(const h in u)u[h]!==void 0&&(e[h]=u[h]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const u in n){const h=n[u];e.data.attributes[u]=h.toJSON(e.data)}const i={};let a=!1;for(const u in this.morphAttributes){const h=this.morphAttributes[u],m=[];for(let x=0,g=h.length;x<g;x++){const b=h[x];m.push(b.toJSON(e.data))}m.length>0&&(i[u]=m,a=!0)}a&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const c=this.boundingSphere;return c!==null&&(e.data.boundingSphere=c.toJSON()),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;n!==null&&this.setIndex(n.clone());const i=e.attributes;for(const h in i){const m=i[h];this.setAttribute(h,m.clone(t))}const a=e.morphAttributes;for(const h in a){const m=[],x=a[h];for(let g=0,b=x.length;g<b;g++)m.push(x[g].clone(t));this.morphAttributes[h]=m}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let h=0,m=o.length;h<m;h++){const x=o[h];this.addGroup(x.start,x.count,x.materialIndex)}const c=e.boundingBox;c!==null&&(this.boundingBox=c.clone());const u=e.boundingSphere;return u!==null&&(this.boundingSphere=u.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const NM=new wn,Mh=new ld,kg=new rs,BM=new k,Vg=new k,Xg=new k,Yg=new k,Kb=new k,Wg=new k,DM=new k,qg=new k;class sn extends ai{constructor(e=new Rn,t=new ur){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const i=t[n[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,o=i.length;a<o;a++){const c=i[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=a}}}}getVertexPosition(e,t){const n=this.geometry,i=n.attributes.position,a=n.morphAttributes.position,o=n.morphTargetsRelative;t.fromBufferAttribute(i,e);const c=this.morphTargetInfluences;if(a&&c){Wg.set(0,0,0);for(let u=0,h=a.length;u<h;u++){const m=c[u],x=a[u];m!==0&&(Kb.fromBufferAttribute(x,e),o?Wg.addScaledVector(Kb,m):Wg.addScaledVector(Kb.sub(t),m))}t.add(Wg)}return t}raycast(e,t){const n=this.geometry,i=this.material,a=this.matrixWorld;i!==void 0&&(n.boundingSphere===null&&n.computeBoundingSphere(),kg.copy(n.boundingSphere),kg.applyMatrix4(a),Mh.copy(e.ray).recast(e.near),!(kg.containsPoint(Mh.origin)===!1&&(Mh.intersectSphere(kg,BM)===null||Mh.origin.distanceToSquared(BM)>(e.far-e.near)**2))&&(NM.copy(a).invert(),Mh.copy(e.ray).applyMatrix4(NM),!(n.boundingBox!==null&&Mh.intersectsBox(n.boundingBox)===!1)&&this._computeIntersections(e,t,Mh)))}_computeIntersections(e,t,n){let i;const a=this.geometry,o=this.material,c=a.index,u=a.attributes.position,h=a.attributes.uv,m=a.attributes.uv1,x=a.attributes.normal,g=a.groups,b=a.drawRange;if(c!==null)if(Array.isArray(o))for(let S=0,C=g.length;S<C;S++){const M=g[S],A=o[M.materialIndex],R=Math.max(M.start,b.start),N=Math.min(c.count,Math.min(M.start+M.count,b.start+b.count));for(let B=R,F=N;B<F;B+=3){const U=c.getX(B),z=c.getX(B+1),P=c.getX(B+2);i=Jg(this,A,e,n,h,m,x,U,z,P),i&&(i.faceIndex=Math.floor(B/3),i.face.materialIndex=M.materialIndex,t.push(i))}}else{const S=Math.max(0,b.start),C=Math.min(c.count,b.start+b.count);for(let M=S,A=C;M<A;M+=3){const R=c.getX(M),N=c.getX(M+1),B=c.getX(M+2);i=Jg(this,o,e,n,h,m,x,R,N,B),i&&(i.faceIndex=Math.floor(M/3),t.push(i))}}else if(u!==void 0)if(Array.isArray(o))for(let S=0,C=g.length;S<C;S++){const M=g[S],A=o[M.materialIndex],R=Math.max(M.start,b.start),N=Math.min(u.count,Math.min(M.start+M.count,b.start+b.count));for(let B=R,F=N;B<F;B+=3){const U=B,z=B+1,P=B+2;i=Jg(this,A,e,n,h,m,x,U,z,P),i&&(i.faceIndex=Math.floor(B/3),i.face.materialIndex=M.materialIndex,t.push(i))}}else{const S=Math.max(0,b.start),C=Math.min(u.count,b.start+b.count);for(let M=S,A=C;M<A;M+=3){const R=M,N=M+1,B=M+2;i=Jg(this,o,e,n,h,m,x,R,N,B),i&&(i.faceIndex=Math.floor(M/3),t.push(i))}}}}function JB(s,e,t,n,i,a,o,c){let u;if(e.side===fr?u=n.intersectTriangle(o,a,i,!0,c):u=n.intersectTriangle(i,a,o,e.side===Zc,c),u===null)return null;qg.copy(c),qg.applyMatrix4(s.matrixWorld);const h=t.ray.origin.distanceTo(qg);return h<t.near||h>t.far?null:{distance:h,point:qg.clone(),object:s}}function Jg(s,e,t,n,i,a,o,c,u,h){s.getVertexPosition(c,Vg),s.getVertexPosition(u,Xg),s.getVertexPosition(h,Yg);const m=JB(s,e,t,n,Vg,Xg,Yg,DM);if(m){const x=new k;Ef.getBarycoord(DM,Vg,Xg,Yg,x),i&&(m.uv=Ef.getInterpolatedAttribute(i,c,u,h,x,new gt)),a&&(m.uv1=Ef.getInterpolatedAttribute(a,c,u,h,x,new gt)),o&&(m.normal=Ef.getInterpolatedAttribute(o,c,u,h,x,new k),m.normal.dot(n.direction)>0&&m.normal.multiplyScalar(-1));const g={a:c,b:u,c:h,normal:new k,materialIndex:0};Ef.getNormal(Vg,Xg,Yg,g.normal),m.face=g,m.barycoord=x}return m}class ks extends Rn{constructor(e=1,t=1,n=1,i=1,a=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:i,heightSegments:a,depthSegments:o};const c=this;i=Math.floor(i),a=Math.floor(a),o=Math.floor(o);const u=[],h=[],m=[],x=[];let g=0,b=0;S("z","y","x",-1,-1,n,t,e,o,a,0),S("z","y","x",1,-1,n,t,-e,o,a,1),S("x","z","y",1,1,e,n,t,i,o,2),S("x","z","y",1,-1,e,n,-t,i,o,3),S("x","y","z",1,-1,e,t,n,i,a,4),S("x","y","z",-1,-1,e,t,-n,i,a,5),this.setIndex(u),this.setAttribute("position",new $t(h,3)),this.setAttribute("normal",new $t(m,3)),this.setAttribute("uv",new $t(x,2));function S(C,M,A,R,N,B,F,U,z,P,L){const O=B/z,ee=F/P,Q=B/2,te=F/2,ne=U/2,re=z+1,j=P+1;let ae=0,J=0;const ie=new k;for(let se=0;se<j;se++){const I=se*ee-te;for(let W=0;W<re;W++){const fe=W*O-Q;ie[C]=fe*R,ie[M]=I*N,ie[A]=ne,h.push(ie.x,ie.y,ie.z),ie[C]=0,ie[M]=0,ie[A]=U>0?1:-1,m.push(ie.x,ie.y,ie.z),x.push(W/z),x.push(1-se/P),ae+=1}}for(let se=0;se<P;se++)for(let I=0;I<z;I++){const W=g+I+re*se,fe=g+I+re*(se+1),Z=g+(I+1)+re*(se+1),me=g+(I+1)+re*se;u.push(W,fe,me),u.push(fe,Z,me),J+=6}c.addGroup(b,J,L),b+=J,g+=ae}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ks(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Jp(s){const e={};for(const t in s){e[t]={};for(const n in s[t]){const i=s[t][n];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?i.isRenderTargetTexture?(un("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][n]=null):e[t][n]=i.clone():Array.isArray(i)?e[t][n]=i.slice():e[t][n]=i}}return e}function oo(s){const e={};for(let t=0;t<s.length;t++){const n=Jp(s[t]);for(const i in n)e[i]=n[i]}return e}function ZB(s){const e=[];for(let t=0;t<s.length;t++)e.push(s[t].clone());return e}function hC(s){const e=s.getRenderTarget();return e===null?s.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:Ri.workingColorSpace}const Zp={clone:Jp,merge:oo};var KB=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,QB=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Ys extends os{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=KB,this.fragmentShader=QB,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Jp(e.uniforms),this.uniformsGroups=ZB(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const i in this.uniforms){const o=this.uniforms[i].value;o&&o.isTexture?t.uniforms[i]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?t.uniforms[i]={type:"c",value:o.getHex()}:o&&o.isVector2?t.uniforms[i]={type:"v2",value:o.toArray()}:o&&o.isVector3?t.uniforms[i]={type:"v3",value:o.toArray()}:o&&o.isVector4?t.uniforms[i]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?t.uniforms[i]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?t.uniforms[i]={type:"m4",value:o.toArray()}:t.uniforms[i]={value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const n={};for(const i in this.extensions)this.extensions[i]===!0&&(n[i]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}let my=class extends ai{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new wn,this.projectionMatrix=new wn,this.projectionMatrixInverse=new wn,this.coordinateSystem=Yo,this._reversedDepth=!1}get reversedDepth(){return this._reversedDepth}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}};const _f=new k,UM=new gt,LM=new gt;class Ba extends my{constructor(e=50,t=1,n=.1,i=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=Wp*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(Qh*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return Wp*2*Math.atan(Math.tan(Qh*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,n){_f.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(_f.x,_f.y).multiplyScalar(-e/_f.z),_f.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(_f.x,_f.y).multiplyScalar(-e/_f.z)}getViewSize(e,t){return this.getViewBounds(e,UM,LM),t.subVectors(LM,UM)}setViewOffset(e,t,n,i,a,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=a,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(Qh*.5*this.fov)/this.zoom,n=2*t,i=this.aspect*n,a=-.5*i;const o=this.view;if(this.view!==null&&this.view.enabled){const u=o.fullWidth,h=o.fullHeight;a+=o.offsetX*i/u,t-=o.offsetY*n/h,i*=o.width/u,n*=o.height/h}const c=this.filmOffset;c!==0&&(a+=e*c/this.getFilmWidth()),this.projectionMatrix.makePerspective(a,a+i,t,t-n,e,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const fp=-90,hp=1;class dC extends ai{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const i=new Ba(fp,hp,e,t);i.layers=this.layers,this.add(i);const a=new Ba(fp,hp,e,t);a.layers=this.layers,this.add(a);const o=new Ba(fp,hp,e,t);o.layers=this.layers,this.add(o);const c=new Ba(fp,hp,e,t);c.layers=this.layers,this.add(c);const u=new Ba(fp,hp,e,t);u.layers=this.layers,this.add(u);const h=new Ba(fp,hp,e,t);h.layers=this.layers,this.add(h)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[n,i,a,o,c,u]=t;for(const h of t)this.remove(h);if(e===Yo)n.up.set(0,1,0),n.lookAt(1,0,0),i.up.set(0,1,0),i.lookAt(-1,0,0),a.up.set(0,0,-1),a.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),c.up.set(0,1,0),c.lookAt(0,0,1),u.up.set(0,1,0),u.lookAt(0,0,-1);else if(e===Xp)n.up.set(0,-1,0),n.lookAt(-1,0,0),i.up.set(0,-1,0),i.lookAt(1,0,0),a.up.set(0,0,1),a.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),c.up.set(0,-1,0),c.lookAt(0,0,1),u.up.set(0,-1,0),u.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const h of t)this.add(h),h.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:i}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[a,o,c,u,h,m]=this.children,x=e.getRenderTarget(),g=e.getActiveCubeFace(),b=e.getActiveMipmapLevel(),S=e.xr.enabled;e.xr.enabled=!1;const C=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,i),e.render(t,a),e.setRenderTarget(n,1,i),e.render(t,o),e.setRenderTarget(n,2,i),e.render(t,c),e.setRenderTarget(n,3,i),e.render(t,u),e.setRenderTarget(n,4,i),e.render(t,h),n.texture.generateMipmaps=C,e.setRenderTarget(n,5,i),e.render(t,m),e.setRenderTarget(x,g,b),e.xr.enabled=S,n.texture.needsPMREMUpdate=!0}}class Mx extends Wi{constructor(e=[],t=Kc,n,i,a,o,c,u,h,m){super(e,t,n,i,a,o,c,u,h,m),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class vS extends qo{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},i=[n,n,n,n,n,n];this.texture=new Mx(i),this._setTextureOptions(t),this.texture.isRenderTargetTexture=!0}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},i=new ks(5,5,5),a=new Ys({name:"CubemapFromEquirect",uniforms:Jp(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:fr,blending:cc});a.uniforms.tEquirect.value=t;const o=new sn(i,a),c=t.minFilter;return t.minFilter===Al&&(t.minFilter=bi),new dC(1,10,this).update(e,o),t.minFilter=c,o.geometry.dispose(),o.material.dispose(),this}clear(e,t=!0,n=!0,i=!0){const a=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,n,i);e.setRenderTarget(a)}}class Yc extends ai{constructor(){super(),this.isGroup=!0,this.type="Group"}}const $B={type:"move"};class Jv{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Yc,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Yc,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new k,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new k),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Yc,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new k,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new k),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,n){let i=null,a=null,o=null;const c=this._targetRay,u=this._grip,h=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(h&&e.hand){o=!0;for(const C of e.hand.values()){const M=t.getJointPose(C,n),A=this._getHandJoint(h,C);M!==null&&(A.matrix.fromArray(M.transform.matrix),A.matrix.decompose(A.position,A.rotation,A.scale),A.matrixWorldNeedsUpdate=!0,A.jointRadius=M.radius),A.visible=M!==null}const m=h.joints["index-finger-tip"],x=h.joints["thumb-tip"],g=m.position.distanceTo(x.position),b=.02,S=.005;h.inputState.pinching&&g>b+S?(h.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!h.inputState.pinching&&g<=b-S&&(h.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else u!==null&&e.gripSpace&&(a=t.getPose(e.gripSpace,n),a!==null&&(u.matrix.fromArray(a.transform.matrix),u.matrix.decompose(u.position,u.rotation,u.scale),u.matrixWorldNeedsUpdate=!0,a.linearVelocity?(u.hasLinearVelocity=!0,u.linearVelocity.copy(a.linearVelocity)):u.hasLinearVelocity=!1,a.angularVelocity?(u.hasAngularVelocity=!0,u.angularVelocity.copy(a.angularVelocity)):u.hasAngularVelocity=!1));c!==null&&(i=t.getPose(e.targetRaySpace,n),i===null&&a!==null&&(i=a),i!==null&&(c.matrix.fromArray(i.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),c.matrixWorldNeedsUpdate=!0,i.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(i.linearVelocity)):c.hasLinearVelocity=!1,i.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(i.angularVelocity)):c.hasAngularVelocity=!1,this.dispatchEvent($B)))}return c!==null&&(c.visible=i!==null),u!==null&&(u.visible=a!==null),h!==null&&(h.visible=o!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const n=new Yc;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}class xy{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new qt(e),this.density=t}clone(){return new xy(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class gy{constructor(e,t=1,n=1e3){this.isFog=!0,this.name="",this.color=new qt(e),this.near=t,this.far=n}clone(){return new gy(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}let a0=class extends ai{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new hi,this.environmentIntensity=1,this.environmentRotation=new hi,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}};class wx{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=lx,this.updateRanges=[],this.version=0,this.uuid=Wo()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let i=0,a=this.stride;i<a;i++)this.array[e+i]=t.array[n+i];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Wo()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Wo()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const ro=new k;class Co{constructor(e,t,n,i=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)ro.fromBufferAttribute(this,t),ro.applyMatrix4(e),this.setXYZ(t,ro.x,ro.y,ro.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)ro.fromBufferAttribute(this,t),ro.applyNormalMatrix(e),this.setXYZ(t,ro.x,ro.y,ro.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)ro.fromBufferAttribute(this,t),ro.transformDirection(e),this.setXYZ(t,ro.x,ro.y,ro.z);return this}getComponent(e,t){let n=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(n=co(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=ii(n,this.array)),this.data.array[e*this.data.stride+this.offset+t]=n,this}setX(e,t){return this.normalized&&(t=ii(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=ii(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=ii(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=ii(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=co(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=co(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=co(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=co(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=ii(t,this.array),n=ii(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=ii(t,this.array),n=ii(n,this.array),i=ii(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this}setXYZW(e,t,n,i,a){return e=e*this.data.stride+this.offset,this.normalized&&(t=ii(t,this.array),n=ii(n,this.array),i=ii(i,this.array),a=ii(a,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this.data.array[e+3]=a,this}clone(e){if(e===void 0){ux("InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const i=n*this.data.stride+this.offset;for(let a=0;a<this.itemSize;a++)t.push(this.data.array[i+a])}return new Ii(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Co(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){ux("InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const i=n*this.data.stride+this.offset;for(let a=0;a<this.itemSize;a++)t.push(this.data.array[i+a])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class yS extends os{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new qt(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let dp;const _m=new k,pp=new k,mp=new k,xp=new gt,Sm=new gt,pC=new wn,Zg=new k,Am=new k,Kg=new k,OM=new gt,Qb=new gt,IM=new gt;class mC extends ai{constructor(e=new yS){if(super(),this.isSprite=!0,this.type="Sprite",dp===void 0){dp=new Rn;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new wx(t,5);dp.setIndex([0,1,2,0,2,3]),dp.setAttribute("position",new Co(n,3,0,!1)),dp.setAttribute("uv",new Co(n,2,3,!1))}this.geometry=dp,this.material=e,this.center=new gt(.5,.5),this.count=1}raycast(e,t){e.camera===null&&Xn('Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),pp.setFromMatrixScale(this.matrixWorld),pC.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),mp.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&pp.multiplyScalar(-mp.z);const n=this.material.rotation;let i,a;n!==0&&(a=Math.cos(n),i=Math.sin(n));const o=this.center;Qg(Zg.set(-.5,-.5,0),mp,o,pp,i,a),Qg(Am.set(.5,-.5,0),mp,o,pp,i,a),Qg(Kg.set(.5,.5,0),mp,o,pp,i,a),OM.set(0,0),Qb.set(1,0),IM.set(1,1);let c=e.ray.intersectTriangle(Zg,Am,Kg,!1,_m);if(c===null&&(Qg(Am.set(-.5,.5,0),mp,o,pp,i,a),Qb.set(0,1),c=e.ray.intersectTriangle(Zg,Kg,Am,!1,_m),c===null))return;const u=e.ray.origin.distanceTo(_m);u<e.near||u>e.far||t.push({distance:u,point:_m.clone(),uv:Ef.getInterpolation(_m,Zg,Am,Kg,OM,Qb,IM,new gt),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function Qg(s,e,t,n,i,a){xp.subVectors(s,t).addScalar(.5).multiply(n),i!==void 0?(Sm.x=a*xp.x-i*xp.y,Sm.y=i*xp.x+a*xp.y):Sm.copy(xp),s.copy(e),s.x+=Sm.x,s.y+=Sm.y,s.applyMatrix4(pC)}const $g=new k,zM=new k;class xC extends ai{constructor(){super(),this.isLOD=!0,this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let n=0,i=t.length;n<i;n++){const a=t[n];this.addLevel(a.object.clone(),a.distance,a.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,n=0){t=Math.abs(t);const i=this.levels;let a;for(a=0;a<i.length&&!(t<i[a].distance);a++);return i.splice(a,0,{distance:t,hysteresis:n,object:e}),this.add(e),this}removeLevel(e){const t=this.levels;for(let n=0;n<t.length;n++)if(t[n].distance===e){const i=t.splice(n,1);return this.remove(i[0].object),!0}return!1}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let n,i;for(n=1,i=t.length;n<i;n++){let a=t[n].distance;if(t[n].object.visible&&(a-=a*t[n].hysteresis),e<a)break}return t[n-1].object}return null}raycast(e,t){if(this.levels.length>0){$g.setFromMatrixPosition(this.matrixWorld);const i=e.ray.origin.distanceTo($g);this.getObjectForDistance(i).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){$g.setFromMatrixPosition(e.matrixWorld),zM.setFromMatrixPosition(this.matrixWorld);const n=$g.distanceTo(zM)/e.zoom;t[0].object.visible=!0;let i,a;for(i=1,a=t.length;i<a;i++){let o=t[i].distance;if(t[i].object.visible&&(o-=o*t[i].hysteresis),n>=o)t[i-1].object.visible=!1,t[i].object.visible=!0;else break}for(this._currentLevel=i-1;i<a;i++)t[i].object.visible=!1}}toJSON(e){const t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];const n=this.levels;for(let i=0,a=n.length;i<a;i++){const o=n[i];t.object.levels.push({object:o.object.uuid,distance:o.distance,hysteresis:o.hysteresis})}return t}}const FM=new k,PM=new oi,GM=new oi,eD=new k,jM=new wn,ev=new k,$b=new rs,HM=new wn,e2=new ld;class bS extends sn{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=E_,this.bindMatrix=new wn,this.bindMatrixInverse=new wn,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new Yi),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,ev),this.boundingBox.expandByPoint(ev)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new rs),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,ev),this.boundingSphere.expandByPoint(ev)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const n=this.material,i=this.matrixWorld;n!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),$b.copy(this.boundingSphere),$b.applyMatrix4(i),e.ray.intersectsSphere($b)!==!1&&(HM.copy(i).invert(),e2.copy(e.ray).applyMatrix4(HM),!(this.boundingBox!==null&&e2.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,e2)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new oi,t=this.geometry.attributes.skinWeight;for(let n=0,i=t.count;n<i;n++){e.fromBufferAttribute(t,n);const a=1/e.manhattanLength();a!==1/0?e.multiplyScalar(a):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===E_?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===q3?this.bindMatrixInverse.copy(this.bindMatrix).invert():un("SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const n=this.skeleton,i=this.geometry;PM.fromBufferAttribute(i.attributes.skinIndex,e),GM.fromBufferAttribute(i.attributes.skinWeight,e),FM.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let a=0;a<4;a++){const o=GM.getComponent(a);if(o!==0){const c=PM.getComponent(a);jM.multiplyMatrices(n.bones[c].matrixWorld,n.boneInverses[c]),t.addScaledVector(eD.copy(FM).applyMatrix4(jM),o)}}return t.applyMatrix4(this.bindMatrixInverse)}}class vy extends ai{constructor(){super(),this.isBone=!0,this.type="Bone"}}class wl extends Wi{constructor(e=null,t=1,n=1,i,a,o,c,u,h=Vs,m=Vs,x,g){super(null,o,c,u,h,m,i,a,x,g),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const kM=new wn,tD=new wn;class Ex{constructor(e=[],t=[]){this.uuid=Wo(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){un("Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,i=this.bones.length;n<i;n++)this.boneInverses.push(new wn)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const n=new wn;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,i=this.boneTexture;for(let a=0,o=e.length;a<o;a++){const c=e[a]?e[a].matrixWorld:tD;kM.multiplyMatrices(c,t[a]),kM.toArray(n,a*16)}i!==null&&(i.needsUpdate=!0)}clone(){return new Ex(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new wl(t,e,e,ss,Da);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const i=this.bones[t];if(i.name===e)return i}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,i=e.bones.length;n<i;n++){const a=e.bones[n];let o=t[a];o===void 0&&(un("Skeleton: No bone found with UUID:",a),o=new vy),this.bones.push(o),this.boneInverses.push(new wn().fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.7,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let i=0,a=t.length;i<a;i++){const o=t[i];e.bones.push(o.uuid);const c=n[i];e.boneInverses.push(c.toArray())}return e}}class Ff extends Ii{constructor(e,t,n,i=1){super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const gp=new wn,VM=new wn,tv=[],XM=new Yi,nD=new wn,Mm=new sn,wm=new rs;class _S extends sn{constructor(e,t,n){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new Ff(new Float32Array(n*16),16),this.instanceColor=null,this.morphTexture=null,this.count=n,this.boundingBox=null,this.boundingSphere=null;for(let i=0;i<n;i++)this.setMatrixAt(i,nD)}computeBoundingBox(){const e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new Yi),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,gp),XM.copy(e.boundingBox).applyMatrix4(gp),this.boundingBox.union(XM)}computeBoundingSphere(){const e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new rs),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,gp),wm.copy(e.boundingSphere).applyMatrix4(gp),this.boundingSphere.union(wm)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,t){const n=t.morphTargetInfluences,i=this.morphTexture.source.data.data,a=n.length+1,o=e*a+1;for(let c=0;c<n.length;c++)n[c]=i[o+c]}raycast(e,t){const n=this.matrixWorld,i=this.count;if(Mm.geometry=this.geometry,Mm.material=this.material,Mm.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),wm.copy(this.boundingSphere),wm.applyMatrix4(n),e.ray.intersectsSphere(wm)!==!1))for(let a=0;a<i;a++){this.getMatrixAt(a,gp),VM.multiplyMatrices(n,gp),Mm.matrixWorld=VM,Mm.raycast(e,tv);for(let o=0,c=tv.length;o<c;o++){const u=tv[o];u.instanceId=a,u.object=this,t.push(u)}tv.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new Ff(new Float32Array(this.instanceMatrix.count*3).fill(1),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,t){const n=t.morphTargetInfluences,i=n.length+1;this.morphTexture===null&&(this.morphTexture=new wl(new Float32Array(i*this.count),i,this.count,Sx,Da));const a=this.morphTexture.source.data.data;let o=0;for(let h=0;h<n.length;h++)o+=n[h];const c=this.geometry.morphTargetsRelative?1:1-o,u=i*e;a[u]=c,a.set(n,u+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null)}}const t2=new k,iD=new k,aD=new Qn;class rc{constructor(e=new k(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,i){return this.normal.set(e,t,n),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const i=t2.subVectors(n,t).cross(iD.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(t2),i=this.normal.dot(n);if(i===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const a=-(e.start.dot(this.normal)+this.constant)/i;return a<0||a>1?null:t.copy(e.start).addScaledVector(n,a)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||aD.getNormalMatrix(e),i=this.coplanarPoint(t2).applyMatrix4(e),a=this.normal.applyMatrix3(n).normalize();return this.constant=-i.dot(a),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const wh=new rs,sD=new gt(.5,.5),nv=new k;class s0{constructor(e=new rc,t=new rc,n=new rc,i=new rc,a=new rc,o=new rc){this.planes=[e,t,n,i,a,o]}set(e,t,n,i,a,o){const c=this.planes;return c[0].copy(e),c[1].copy(t),c[2].copy(n),c[3].copy(i),c[4].copy(a),c[5].copy(o),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,t=Yo,n=!1){const i=this.planes,a=e.elements,o=a[0],c=a[1],u=a[2],h=a[3],m=a[4],x=a[5],g=a[6],b=a[7],S=a[8],C=a[9],M=a[10],A=a[11],R=a[12],N=a[13],B=a[14],F=a[15];if(i[0].setComponents(h-o,b-m,A-S,F-R).normalize(),i[1].setComponents(h+o,b+m,A+S,F+R).normalize(),i[2].setComponents(h+c,b+x,A+C,F+N).normalize(),i[3].setComponents(h-c,b-x,A-C,F-N).normalize(),n)i[4].setComponents(u,g,M,B).normalize(),i[5].setComponents(h-u,b-g,A-M,F-B).normalize();else if(i[4].setComponents(h-u,b-g,A-M,F-B).normalize(),t===Yo)i[5].setComponents(h+u,b+g,A+M,F+B).normalize();else if(t===Xp)i[5].setComponents(u,g,M,B).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),wh.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),wh.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(wh)}intersectsSprite(e){wh.center.set(0,0,0);const t=sD.distanceTo(e.center);return wh.radius=.7071067811865476+t,wh.applyMatrix4(e.matrixWorld),this.intersectsSphere(wh)}intersectsSphere(e){const t=this.planes,n=e.center,i=-e.radius;for(let a=0;a<6;a++)if(t[a].distanceToPoint(n)<i)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const i=t[n];if(nv.x=i.normal.x>0?e.max.x:e.min.x,nv.y=i.normal.y>0?e.max.y:e.min.y,nv.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(nv)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}const Pc=new wn,Gc=new s0;class yy{constructor(){this.coordinateSystem=Yo}intersectsObject(e,t){if(!t.isArrayCamera||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const i=t.cameras[n];if(Pc.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),Gc.setFromProjectionMatrix(Pc,i.coordinateSystem,i.reversedDepth),Gc.intersectsObject(e))return!0}return!1}intersectsSprite(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const i=t.cameras[n];if(Pc.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),Gc.setFromProjectionMatrix(Pc,i.coordinateSystem,i.reversedDepth),Gc.intersectsSprite(e))return!0}return!1}intersectsSphere(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const i=t.cameras[n];if(Pc.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),Gc.setFromProjectionMatrix(Pc,i.coordinateSystem,i.reversedDepth),Gc.intersectsSphere(e))return!0}return!1}intersectsBox(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const i=t.cameras[n];if(Pc.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),Gc.setFromProjectionMatrix(Pc,i.coordinateSystem,i.reversedDepth),Gc.intersectsBox(e))return!0}return!1}containsPoint(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const i=t.cameras[n];if(Pc.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),Gc.setFromProjectionMatrix(Pc,i.coordinateSystem,i.reversedDepth),Gc.containsPoint(e))return!0}return!1}clone(){return new yy}}function n2(s,e){return s-e}function rD(s,e){return s.z-e.z}function oD(s,e){return e.z-s.z}class lD{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t,n,i){const a=this.pool,o=this.list;this.index>=a.length&&a.push({start:-1,count:-1,z:-1,index:-1});const c=a[this.index];o.push(c),this.index++,c.start=e,c.count=t,c.z=n,c.index=i}reset(){this.list.length=0,this.index=0}}const wo=new wn,cD=new qt(1,1,1),YM=new s0,uD=new yy,iv=new Yi,Eh=new rs,Em=new k,WM=new k,fD=new k,i2=new lD,Ur=new sn,av=[];function hD(s,e,t=0){const n=e.itemSize;if(s.isInterleavedBufferAttribute||s.array.constructor!==e.array.constructor){const i=s.count;for(let a=0;a<i;a++)for(let o=0;o<n;o++)e.setComponent(a+t,o,s.getComponent(a,o))}else e.array.set(s.array,t*n);e.needsUpdate=!0}function Ch(s,e){if(s.constructor!==e.constructor){const t=Math.min(s.length,e.length);for(let n=0;n<t;n++)e[n]=s[n]}else{const t=Math.min(s.length,e.length);e.set(new s.constructor(s.buffer,0,t))}}class gC extends sn{constructor(e,t,n=t*2,i){super(new Rn,i),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._instanceInfo=[],this._geometryInfo=[],this._availableInstanceIds=[],this._availableGeometryIds=[],this._nextIndexStart=0,this._nextVertexStart=0,this._geometryCount=0,this._visibilityChanged=!0,this._geometryInitialized=!1,this._maxInstanceCount=e,this._maxVertexCount=t,this._maxIndexCount=n,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}get maxInstanceCount(){return this._maxInstanceCount}get instanceCount(){return this._instanceInfo.length-this._availableInstanceIds.length}get unusedVertexCount(){return this._maxVertexCount-this._nextVertexStart}get unusedIndexCount(){return this._maxIndexCount-this._nextIndexStart}_initMatricesTexture(){let e=Math.sqrt(this._maxInstanceCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4),n=new wl(t,e,e,ss,Da);this._matricesTexture=n}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Uint32Array(e*e),n=new wl(t,e,e,Ax,Qc);this._indirectTexture=n}_initColorsTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Float32Array(e*e*4).fill(1),n=new wl(t,e,e,ss,Da);n.colorSpace=Ri.workingColorSpace,this._colorsTexture=n}_initializeGeometry(e){const t=this.geometry,n=this._maxVertexCount,i=this._maxIndexCount;if(this._geometryInitialized===!1){for(const a in e.attributes){const o=e.getAttribute(a),{array:c,itemSize:u,normalized:h}=o,m=new c.constructor(n*u),x=new Ii(m,u,h);t.setAttribute(a,x)}if(e.getIndex()!==null){const a=n>65535?new Uint32Array(i):new Uint16Array(i);t.setIndex(new Ii(a,1))}this._geometryInitialized=!0}}_validateGeometry(e){const t=this.geometry;if(!!e.getIndex()!=!!t.getIndex())throw new Error('THREE.BatchedMesh: All geometries must consistently have "index".');for(const n in t.attributes){if(!e.hasAttribute(n))throw new Error(`THREE.BatchedMesh: Added geometry missing "${n}". All geometries must have consistent attributes.`);const i=e.getAttribute(n),a=t.getAttribute(n);if(i.itemSize!==a.itemSize||i.normalized!==a.normalized)throw new Error("THREE.BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}validateInstanceId(e){const t=this._instanceInfo;if(e<0||e>=t.length||t[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid instanceId ${e}. Instance is either out of range or has been deleted.`)}validateGeometryId(e){const t=this._geometryInfo;if(e<0||e>=t.length||t[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid geometryId ${e}. Geometry is either out of range or has been deleted.`)}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Yi);const e=this.boundingBox,t=this._instanceInfo;e.makeEmpty();for(let n=0,i=t.length;n<i;n++){if(t[n].active===!1)continue;const a=t[n].geometryIndex;this.getMatrixAt(n,wo),this.getBoundingBoxAt(a,iv).applyMatrix4(wo),e.union(iv)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new rs);const e=this.boundingSphere,t=this._instanceInfo;e.makeEmpty();for(let n=0,i=t.length;n<i;n++){if(t[n].active===!1)continue;const a=t[n].geometryIndex;this.getMatrixAt(n,wo),this.getBoundingSphereAt(a,Eh).applyMatrix4(wo),e.union(Eh)}}addInstance(e){if(this._instanceInfo.length>=this.maxInstanceCount&&this._availableInstanceIds.length===0)throw new Error("THREE.BatchedMesh: Maximum item count reached.");const n={visible:!0,active:!0,geometryIndex:e};let i=null;this._availableInstanceIds.length>0?(this._availableInstanceIds.sort(n2),i=this._availableInstanceIds.shift(),this._instanceInfo[i]=n):(i=this._instanceInfo.length,this._instanceInfo.push(n));const a=this._matricesTexture;wo.identity().toArray(a.image.data,i*16),a.needsUpdate=!0;const o=this._colorsTexture;return o&&(cD.toArray(o.image.data,i*4),o.needsUpdate=!0),this._visibilityChanged=!0,i}addGeometry(e,t=-1,n=-1){this._initializeGeometry(e),this._validateGeometry(e);const i={vertexStart:-1,vertexCount:-1,reservedVertexCount:-1,indexStart:-1,indexCount:-1,reservedIndexCount:-1,start:-1,count:-1,boundingBox:null,boundingSphere:null,active:!0},a=this._geometryInfo;i.vertexStart=this._nextVertexStart,i.reservedVertexCount=t===-1?e.getAttribute("position").count:t;const o=e.getIndex();if(o!==null&&(i.indexStart=this._nextIndexStart,i.reservedIndexCount=n===-1?o.count:n),i.indexStart!==-1&&i.indexStart+i.reservedIndexCount>this._maxIndexCount||i.vertexStart+i.reservedVertexCount>this._maxVertexCount)throw new Error("THREE.BatchedMesh: Reserved space request exceeds the maximum buffer size.");let u;return this._availableGeometryIds.length>0?(this._availableGeometryIds.sort(n2),u=this._availableGeometryIds.shift(),a[u]=i):(u=this._geometryCount,this._geometryCount++,a.push(i)),this.setGeometryAt(u,e),this._nextIndexStart=i.indexStart+i.reservedIndexCount,this._nextVertexStart=i.vertexStart+i.reservedVertexCount,u}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("THREE.BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);const n=this.geometry,i=n.getIndex()!==null,a=n.getIndex(),o=t.getIndex(),c=this._geometryInfo[e];if(i&&o.count>c.reservedIndexCount||t.attributes.position.count>c.reservedVertexCount)throw new Error("THREE.BatchedMesh: Reserved space not large enough for provided geometry.");const u=c.vertexStart,h=c.reservedVertexCount;c.vertexCount=t.getAttribute("position").count;for(const m in n.attributes){const x=t.getAttribute(m),g=n.getAttribute(m);hD(x,g,u);const b=x.itemSize;for(let S=x.count,C=h;S<C;S++){const M=u+S;for(let A=0;A<b;A++)g.setComponent(M,A,0)}g.needsUpdate=!0,g.addUpdateRange(u*b,h*b)}if(i){const m=c.indexStart,x=c.reservedIndexCount;c.indexCount=t.getIndex().count;for(let g=0;g<o.count;g++)a.setX(m+g,u+o.getX(g));for(let g=o.count,b=x;g<b;g++)a.setX(m+g,u);a.needsUpdate=!0,a.addUpdateRange(m,c.reservedIndexCount)}return c.start=i?c.indexStart:c.vertexStart,c.count=i?c.indexCount:c.vertexCount,c.boundingBox=null,t.boundingBox!==null&&(c.boundingBox=t.boundingBox.clone()),c.boundingSphere=null,t.boundingSphere!==null&&(c.boundingSphere=t.boundingSphere.clone()),this._visibilityChanged=!0,e}deleteGeometry(e){const t=this._geometryInfo;if(e>=t.length||t[e].active===!1)return this;const n=this._instanceInfo;for(let i=0,a=n.length;i<a;i++)n[i].active&&n[i].geometryIndex===e&&this.deleteInstance(i);return t[e].active=!1,this._availableGeometryIds.push(e),this._visibilityChanged=!0,this}deleteInstance(e){return this.validateInstanceId(e),this._instanceInfo[e].active=!1,this._availableInstanceIds.push(e),this._visibilityChanged=!0,this}optimize(){let e=0,t=0;const n=this._geometryInfo,i=n.map((o,c)=>c).sort((o,c)=>n[o].vertexStart-n[c].vertexStart),a=this.geometry;for(let o=0,c=n.length;o<c;o++){const u=i[o],h=n[u];if(h.active!==!1){if(a.index!==null){if(h.indexStart!==t){const{indexStart:m,vertexStart:x,reservedIndexCount:g}=h,b=a.index,S=b.array,C=e-x;for(let M=m;M<m+g;M++)S[M]=S[M]+C;b.array.copyWithin(t,m,m+g),b.addUpdateRange(t,g),h.indexStart=t}t+=h.reservedIndexCount}if(h.vertexStart!==e){const{vertexStart:m,reservedVertexCount:x}=h,g=a.attributes;for(const b in g){const S=g[b],{array:C,itemSize:M}=S;C.copyWithin(e*M,m*M,(m+x)*M),S.addUpdateRange(e*M,x*M)}h.vertexStart=e}e+=h.reservedVertexCount,h.start=a.index?h.indexStart:h.vertexStart,this._nextIndexStart=a.index?h.indexStart+h.reservedIndexCount:0,this._nextVertexStart=h.vertexStart+h.reservedVertexCount}}return this}getBoundingBoxAt(e,t){if(e>=this._geometryCount)return null;const n=this.geometry,i=this._geometryInfo[e];if(i.boundingBox===null){const a=new Yi,o=n.index,c=n.attributes.position;for(let u=i.start,h=i.start+i.count;u<h;u++){let m=u;o&&(m=o.getX(m)),a.expandByPoint(Em.fromBufferAttribute(c,m))}i.boundingBox=a}return t.copy(i.boundingBox),t}getBoundingSphereAt(e,t){if(e>=this._geometryCount)return null;const n=this.geometry,i=this._geometryInfo[e];if(i.boundingSphere===null){const a=new rs;this.getBoundingBoxAt(e,iv),iv.getCenter(a.center);const o=n.index,c=n.attributes.position;let u=0;for(let h=i.start,m=i.start+i.count;h<m;h++){let x=h;o&&(x=o.getX(x)),Em.fromBufferAttribute(c,x),u=Math.max(u,a.center.distanceToSquared(Em))}a.radius=Math.sqrt(u),i.boundingSphere=a}return t.copy(i.boundingSphere),t}setMatrixAt(e,t){this.validateInstanceId(e);const n=this._matricesTexture,i=this._matricesTexture.image.data;return t.toArray(i,e*16),n.needsUpdate=!0,this}getMatrixAt(e,t){return this.validateInstanceId(e),t.fromArray(this._matricesTexture.image.data,e*16)}setColorAt(e,t){return this.validateInstanceId(e),this._colorsTexture===null&&this._initColorsTexture(),t.toArray(this._colorsTexture.image.data,e*4),this._colorsTexture.needsUpdate=!0,this}getColorAt(e,t){return this.validateInstanceId(e),t.fromArray(this._colorsTexture.image.data,e*4)}setVisibleAt(e,t){return this.validateInstanceId(e),this._instanceInfo[e].visible===t?this:(this._instanceInfo[e].visible=t,this._visibilityChanged=!0,this)}getVisibleAt(e){return this.validateInstanceId(e),this._instanceInfo[e].visible}setGeometryIdAt(e,t){return this.validateInstanceId(e),this.validateGeometryId(t),this._instanceInfo[e].geometryIndex=t,this}getGeometryIdAt(e){return this.validateInstanceId(e),this._instanceInfo[e].geometryIndex}getGeometryRangeAt(e,t={}){this.validateGeometryId(e);const n=this._geometryInfo[e];return t.vertexStart=n.vertexStart,t.vertexCount=n.vertexCount,t.reservedVertexCount=n.reservedVertexCount,t.indexStart=n.indexStart,t.indexCount=n.indexCount,t.reservedIndexCount=n.reservedIndexCount,t.start=n.start,t.count=n.count,t}setInstanceCount(e){const t=this._availableInstanceIds,n=this._instanceInfo;for(t.sort(n2);t[t.length-1]===n.length-1;)n.pop(),t.pop();if(e<n.length)throw new Error(`BatchedMesh: Instance ids outside the range ${e} are being used. Cannot shrink instance count.`);const i=new Int32Array(e),a=new Int32Array(e);Ch(this._multiDrawCounts,i),Ch(this._multiDrawStarts,a),this._multiDrawCounts=i,this._multiDrawStarts=a,this._maxInstanceCount=e;const o=this._indirectTexture,c=this._matricesTexture,u=this._colorsTexture;o.dispose(),this._initIndirectTexture(),Ch(o.image.data,this._indirectTexture.image.data),c.dispose(),this._initMatricesTexture(),Ch(c.image.data,this._matricesTexture.image.data),u&&(u.dispose(),this._initColorsTexture(),Ch(u.image.data,this._colorsTexture.image.data))}setGeometrySize(e,t){const n=[...this._geometryInfo].filter(c=>c.active);if(Math.max(...n.map(c=>c.vertexStart+c.reservedVertexCount))>e)throw new Error(`BatchedMesh: Geometry vertex values are being used outside the range ${t}. Cannot shrink further.`);if(this.geometry.index&&Math.max(...n.map(u=>u.indexStart+u.reservedIndexCount))>t)throw new Error(`BatchedMesh: Geometry index values are being used outside the range ${t}. Cannot shrink further.`);const a=this.geometry;a.dispose(),this._maxVertexCount=e,this._maxIndexCount=t,this._geometryInitialized&&(this._geometryInitialized=!1,this.geometry=new Rn,this._initializeGeometry(a));const o=this.geometry;a.index&&Ch(a.index.array,o.index.array);for(const c in a.attributes)Ch(a.attributes[c].array,o.attributes[c].array)}raycast(e,t){const n=this._instanceInfo,i=this._geometryInfo,a=this.matrixWorld,o=this.geometry;Ur.material=this.material,Ur.geometry.index=o.index,Ur.geometry.attributes=o.attributes,Ur.geometry.boundingBox===null&&(Ur.geometry.boundingBox=new Yi),Ur.geometry.boundingSphere===null&&(Ur.geometry.boundingSphere=new rs);for(let c=0,u=n.length;c<u;c++){if(!n[c].visible||!n[c].active)continue;const h=n[c].geometryIndex,m=i[h];Ur.geometry.setDrawRange(m.start,m.count),this.getMatrixAt(c,Ur.matrixWorld).premultiply(a),this.getBoundingBoxAt(h,Ur.geometry.boundingBox),this.getBoundingSphereAt(h,Ur.geometry.boundingSphere),Ur.raycast(e,av);for(let x=0,g=av.length;x<g;x++){const b=av[x];b.object=this,b.batchId=c,t.push(b)}av.length=0}Ur.material=null,Ur.geometry.index=null,Ur.geometry.attributes={},Ur.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._geometryInfo=e._geometryInfo.map(t=>({...t,boundingBox:t.boundingBox!==null?t.boundingBox.clone():null,boundingSphere:t.boundingSphere!==null?t.boundingSphere.clone():null})),this._instanceInfo=e._instanceInfo.map(t=>({...t})),this._availableInstanceIds=e._availableInstanceIds.slice(),this._availableGeometryIds=e._availableGeometryIds.slice(),this._nextIndexStart=e._nextIndexStart,this._nextVertexStart=e._nextVertexStart,this._geometryCount=e._geometryCount,this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._indirectTexture=e._indirectTexture.clone(),this._indirectTexture.image.data=this._indirectTexture.image.data.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),this._colorsTexture!==null&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,this._colorsTexture!==null&&(this._colorsTexture.dispose(),this._colorsTexture=null)}onBeforeRender(e,t,n,i,a){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const o=i.getIndex(),c=o===null?1:o.array.BYTES_PER_ELEMENT,u=this._instanceInfo,h=this._multiDrawStarts,m=this._multiDrawCounts,x=this._geometryInfo,g=this.perObjectFrustumCulled,b=this._indirectTexture,S=b.image.data,C=n.isArrayCamera?uD:YM;g&&!n.isArrayCamera&&(wo.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse).multiply(this.matrixWorld),YM.setFromProjectionMatrix(wo,n.coordinateSystem,n.reversedDepth));let M=0;if(this.sortObjects){wo.copy(this.matrixWorld).invert(),Em.setFromMatrixPosition(n.matrixWorld).applyMatrix4(wo),WM.set(0,0,-1).transformDirection(n.matrixWorld).transformDirection(wo);for(let N=0,B=u.length;N<B;N++)if(u[N].visible&&u[N].active){const F=u[N].geometryIndex;this.getMatrixAt(N,wo),this.getBoundingSphereAt(F,Eh).applyMatrix4(wo);let U=!1;if(g&&(U=!C.intersectsSphere(Eh,n)),!U){const z=x[F],P=fD.subVectors(Eh.center,Em).dot(WM);i2.push(z.start,z.count,P,N)}}const A=i2.list,R=this.customSort;R===null?A.sort(a.transparent?oD:rD):R.call(this,A,n);for(let N=0,B=A.length;N<B;N++){const F=A[N];h[M]=F.start*c,m[M]=F.count,S[M]=F.index,M++}i2.reset()}else for(let A=0,R=u.length;A<R;A++)if(u[A].visible&&u[A].active){const N=u[A].geometryIndex;let B=!1;if(g&&(this.getMatrixAt(A,wo),this.getBoundingSphereAt(N,Eh).applyMatrix4(wo),B=!C.intersectsSphere(Eh,n)),!B){const F=x[N];h[M]=F.start*c,m[M]=F.count,S[M]=A,M++}}b.needsUpdate=!0,this._multiDrawCount=M,this._visibilityChanged=!1}onBeforeShadow(e,t,n,i,a,o){this.onBeforeRender(e,null,i,a,o)}}class gs extends os{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new qt(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const G1=new k,j1=new k,qM=new wn,Cm=new ld,sv=new rs,a2=new k,JM=new k;let ui=class extends ai{constructor(e=new Rn,t=new gs){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[0];for(let i=1,a=t.count;i<a;i++)G1.fromBufferAttribute(t,i-1),j1.fromBufferAttribute(t,i),n[i]=n[i-1],n[i]+=G1.distanceTo(j1);e.setAttribute("lineDistance",new $t(n,1))}else un("Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,i=this.matrixWorld,a=e.params.Line.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),sv.copy(n.boundingSphere),sv.applyMatrix4(i),sv.radius+=a,e.ray.intersectsSphere(sv)===!1)return;qM.copy(i).invert(),Cm.copy(e.ray).applyMatrix4(qM);const c=a/((this.scale.x+this.scale.y+this.scale.z)/3),u=c*c,h=this.isLineSegments?2:1,m=n.index,g=n.attributes.position;if(m!==null){const b=Math.max(0,o.start),S=Math.min(m.count,o.start+o.count);for(let C=b,M=S-1;C<M;C+=h){const A=m.getX(C),R=m.getX(C+1),N=rv(this,e,Cm,u,A,R,C);N&&t.push(N)}if(this.isLineLoop){const C=m.getX(S-1),M=m.getX(b),A=rv(this,e,Cm,u,C,M,S-1);A&&t.push(A)}}else{const b=Math.max(0,o.start),S=Math.min(g.count,o.start+o.count);for(let C=b,M=S-1;C<M;C+=h){const A=rv(this,e,Cm,u,C,C+1,C);A&&t.push(A)}if(this.isLineLoop){const C=rv(this,e,Cm,u,S-1,b,S-1);C&&t.push(C)}}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const i=t[n[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,o=i.length;a<o;a++){const c=i[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=a}}}}};function rv(s,e,t,n,i,a,o){const c=s.geometry.attributes.position;if(G1.fromBufferAttribute(c,i),j1.fromBufferAttribute(c,a),t.distanceSqToSegment(G1,j1,a2,JM)>n)return;a2.applyMatrix4(s.matrixWorld);const h=e.ray.origin.distanceTo(a2);if(!(h<e.near||h>e.far))return{distance:h,point:JM.clone().applyMatrix4(s.matrixWorld),index:o,face:null,faceIndex:null,barycoord:null,object:s}}const ZM=new k,KM=new k;class Jo extends ui{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[];for(let i=0,a=t.count;i<a;i+=2)ZM.fromBufferAttribute(t,i),KM.fromBufferAttribute(t,i+1),n[i]=i===0?0:n[i-1],n[i+1]=n[i]+ZM.distanceTo(KM);e.setAttribute("lineDistance",new $t(n,1))}else un("LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class SS extends ui{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class Tf extends os{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new qt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const QM=new wn,N_=new ld,ov=new rs,lv=new k;class Lp extends ai{constructor(e=new Rn,t=new Tf){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,i=this.matrixWorld,a=e.params.Points.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),ov.copy(n.boundingSphere),ov.applyMatrix4(i),ov.radius+=a,e.ray.intersectsSphere(ov)===!1)return;QM.copy(i).invert(),N_.copy(e.ray).applyMatrix4(QM);const c=a/((this.scale.x+this.scale.y+this.scale.z)/3),u=c*c,h=n.index,x=n.attributes.position;if(h!==null){const g=Math.max(0,o.start),b=Math.min(h.count,o.start+o.count);for(let S=g,C=b;S<C;S++){const M=h.getX(S);lv.fromBufferAttribute(x,M),$M(lv,M,u,i,e,t,this)}}else{const g=Math.max(0,o.start),b=Math.min(x.count,o.start+o.count);for(let S=g,C=b;S<C;S++)lv.fromBufferAttribute(x,S),$M(lv,S,u,i,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const i=t[n[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,o=i.length;a<o;a++){const c=i[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=a}}}}}function $M(s,e,t,n,i,a,o){const c=N_.distanceSqToPoint(s);if(c<t){const u=new k;N_.closestPointToPoint(s,u),u.applyMatrix4(n);const h=i.ray.origin.distanceTo(u);if(h<i.near||h>i.far)return;a.push({distance:h,distanceToRay:Math.sqrt(c),point:u,index:e,face:null,faceIndex:null,barycoord:null,object:o})}}class vC extends Wi{constructor(e,t,n,i,a=bi,o=bi,c,u,h){super(e,t,n,i,a,o,c,u,h),this.isVideoTexture=!0,this.generateMipmaps=!1,this._requestVideoFrameCallbackId=0;const m=this;function x(){m.needsUpdate=!0,m._requestVideoFrameCallbackId=e.requestVideoFrameCallback(x)}"requestVideoFrameCallback"in e&&(this._requestVideoFrameCallbackId=e.requestVideoFrameCallback(x))}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}dispose(){this._requestVideoFrameCallbackId!==0&&(this.source.data.cancelVideoFrameCallback(this._requestVideoFrameCallbackId),this._requestVideoFrameCallbackId=0),super.dispose()}}class dD extends vC{constructor(e,t,n,i,a,o,c,u){super({},e,t,n,i,a,o,c,u),this.isVideoFrameTexture=!0}update(){}clone(){return new this.constructor().copy(this)}setFrame(e){this.image=e,this.needsUpdate=!0}}class pD extends Wi{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=Vs,this.minFilter=Vs,this.generateMipmaps=!1,this.needsUpdate=!0}}class by extends Wi{constructor(e,t,n,i,a,o,c,u,h,m,x,g){super(null,o,c,u,h,m,i,a,x,g),this.isCompressedTexture=!0,this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class mD extends by{constructor(e,t,n,i,a,o){super(e,t,n,a,o),this.isCompressedArrayTexture=!0,this.image.depth=i,this.wrapR=Pa,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class xD extends by{constructor(e,t,n){super(void 0,e[0].width,e[0].height,t,n,Kc),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class yC extends Wi{constructor(e,t,n,i,a,o,c,u,h){super(e,t,n,i,a,o,c,u,h),this.isCanvasTexture=!0,this.needsUpdate=!0}}class _y extends Wi{constructor(e,t,n=Qc,i,a,o,c=Vs,u=Vs,h,m=jp,x=1){if(m!==jp&&m!==Hp)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");const g={width:e,height:t,depth:x};super(g,i,a,o,c,u,m,n,h),this.isDepthTexture=!0,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new Cf(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}class AS extends Wi{constructor(e=null){super(),this.sourceTexture=e,this.isExternalTexture=!0}copy(e){return super.copy(e),this.sourceTexture=e.sourceTexture,this}}class Sy extends Rn{constructor(e=1,t=1,n=4,i=8,a=1){super(),this.type="CapsuleGeometry",this.parameters={radius:e,height:t,capSegments:n,radialSegments:i,heightSegments:a},t=Math.max(0,t),n=Math.max(1,Math.floor(n)),i=Math.max(3,Math.floor(i)),a=Math.max(1,Math.floor(a));const o=[],c=[],u=[],h=[],m=t/2,x=Math.PI/2*e,g=t,b=2*x+g,S=n*2+a,C=i+1,M=new k,A=new k;for(let R=0;R<=S;R++){let N=0,B=0,F=0,U=0;if(R<=n){const L=R/n,O=L*Math.PI/2;B=-m-e*Math.cos(O),F=e*Math.sin(O),U=-e*Math.cos(O),N=L*x}else if(R<=n+a){const L=(R-n)/a;B=-m+L*t,F=e,U=0,N=x+L*g}else{const L=(R-n-a)/n,O=L*Math.PI/2;B=m+e*Math.sin(O),F=e*Math.cos(O),U=e*Math.sin(O),N=x+g+L*x}const z=Math.max(0,Math.min(1,N/b));let P=0;R===0?P=.5/i:R===S&&(P=-.5/i);for(let L=0;L<=i;L++){const O=L/i,ee=O*Math.PI*2,Q=Math.sin(ee),te=Math.cos(ee);A.x=-F*te,A.y=B,A.z=F*Q,c.push(A.x,A.y,A.z),M.set(-F*te,U,F*Q),M.normalize(),u.push(M.x,M.y,M.z),h.push(O+P,z)}if(R>0){const L=(R-1)*C;for(let O=0;O<i;O++){const ee=L+O,Q=L+O+1,te=R*C+O,ne=R*C+O+1;o.push(ee,Q,te),o.push(Q,ne,te)}}}this.setIndex(o),this.setAttribute("position",new $t(c,3)),this.setAttribute("normal",new $t(u,3)),this.setAttribute("uv",new $t(h,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Sy(e.radius,e.height,e.capSegments,e.radialSegments,e.heightSegments)}}class Ay extends Rn{constructor(e=1,t=32,n=0,i=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:i},t=Math.max(3,t);const a=[],o=[],c=[],u=[],h=new k,m=new gt;o.push(0,0,0),c.push(0,0,1),u.push(.5,.5);for(let x=0,g=3;x<=t;x++,g+=3){const b=n+x/t*i;h.x=e*Math.cos(b),h.y=e*Math.sin(b),o.push(h.x,h.y,h.z),c.push(0,0,1),m.x=(o[g]/e+1)/2,m.y=(o[g+1]/e+1)/2,u.push(m.x,m.y)}for(let x=1;x<=t;x++)a.push(x,x+1,0);this.setIndex(a),this.setAttribute("position",new $t(o,3)),this.setAttribute("normal",new $t(c,3)),this.setAttribute("uv",new $t(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ay(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class Lr extends Rn{constructor(e=1,t=1,n=1,i=32,a=1,o=!1,c=0,u=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:i,heightSegments:a,openEnded:o,thetaStart:c,thetaLength:u};const h=this;i=Math.floor(i),a=Math.floor(a);const m=[],x=[],g=[],b=[];let S=0;const C=[],M=n/2;let A=0;R(),o===!1&&(e>0&&N(!0),t>0&&N(!1)),this.setIndex(m),this.setAttribute("position",new $t(x,3)),this.setAttribute("normal",new $t(g,3)),this.setAttribute("uv",new $t(b,2));function R(){const B=new k,F=new k;let U=0;const z=(t-e)/n;for(let P=0;P<=a;P++){const L=[],O=P/a,ee=O*(t-e)+e;for(let Q=0;Q<=i;Q++){const te=Q/i,ne=te*u+c,re=Math.sin(ne),j=Math.cos(ne);F.x=ee*re,F.y=-O*n+M,F.z=ee*j,x.push(F.x,F.y,F.z),B.set(re,z,j).normalize(),g.push(B.x,B.y,B.z),b.push(te,1-O),L.push(S++)}C.push(L)}for(let P=0;P<i;P++)for(let L=0;L<a;L++){const O=C[L][P],ee=C[L+1][P],Q=C[L+1][P+1],te=C[L][P+1];(e>0||L!==0)&&(m.push(O,ee,te),U+=3),(t>0||L!==a-1)&&(m.push(ee,Q,te),U+=3)}h.addGroup(A,U,0),A+=U}function N(B){const F=S,U=new gt,z=new k;let P=0;const L=B===!0?e:t,O=B===!0?1:-1;for(let Q=1;Q<=i;Q++)x.push(0,M*O,0),g.push(0,O,0),b.push(.5,.5),S++;const ee=S;for(let Q=0;Q<=i;Q++){const ne=Q/i*u+c,re=Math.cos(ne),j=Math.sin(ne);z.x=L*j,z.y=M*O,z.z=L*re,x.push(z.x,z.y,z.z),g.push(0,O,0),U.x=re*.5+.5,U.y=j*.5*O+.5,b.push(U.x,U.y),S++}for(let Q=0;Q<i;Q++){const te=F+Q,ne=ee+Q;B===!0?m.push(ne,ne+1,te):m.push(ne+1,ne,te),P+=3}h.addGroup(A,P,B===!0?1:2),A+=P}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Lr(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Cx extends Lr{constructor(e=1,t=1,n=32,i=1,a=!1,o=0,c=Math.PI*2){super(0,e,t,n,i,a,o,c),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:i,openEnded:a,thetaStart:o,thetaLength:c}}static fromJSON(e){return new Cx(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class jf extends Rn{constructor(e=[],t=[],n=1,i=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:i};const a=[],o=[];c(i),h(n),m(),this.setAttribute("position",new $t(a,3)),this.setAttribute("normal",new $t(a.slice(),3)),this.setAttribute("uv",new $t(o,2)),i===0?this.computeVertexNormals():this.normalizeNormals();function c(R){const N=new k,B=new k,F=new k;for(let U=0;U<t.length;U+=3)b(t[U+0],N),b(t[U+1],B),b(t[U+2],F),u(N,B,F,R)}function u(R,N,B,F){const U=F+1,z=[];for(let P=0;P<=U;P++){z[P]=[];const L=R.clone().lerp(B,P/U),O=N.clone().lerp(B,P/U),ee=U-P;for(let Q=0;Q<=ee;Q++)Q===0&&P===U?z[P][Q]=L:z[P][Q]=L.clone().lerp(O,Q/ee)}for(let P=0;P<U;P++)for(let L=0;L<2*(U-P)-1;L++){const O=Math.floor(L/2);L%2===0?(g(z[P][O+1]),g(z[P+1][O]),g(z[P][O])):(g(z[P][O+1]),g(z[P+1][O+1]),g(z[P+1][O]))}}function h(R){const N=new k;for(let B=0;B<a.length;B+=3)N.x=a[B+0],N.y=a[B+1],N.z=a[B+2],N.normalize().multiplyScalar(R),a[B+0]=N.x,a[B+1]=N.y,a[B+2]=N.z}function m(){const R=new k;for(let N=0;N<a.length;N+=3){R.x=a[N+0],R.y=a[N+1],R.z=a[N+2];const B=M(R)/2/Math.PI+.5,F=A(R)/Math.PI+.5;o.push(B,1-F)}S(),x()}function x(){for(let R=0;R<o.length;R+=6){const N=o[R+0],B=o[R+2],F=o[R+4],U=Math.max(N,B,F),z=Math.min(N,B,F);U>.9&&z<.1&&(N<.2&&(o[R+0]+=1),B<.2&&(o[R+2]+=1),F<.2&&(o[R+4]+=1))}}function g(R){a.push(R.x,R.y,R.z)}function b(R,N){const B=R*3;N.x=e[B+0],N.y=e[B+1],N.z=e[B+2]}function S(){const R=new k,N=new k,B=new k,F=new k,U=new gt,z=new gt,P=new gt;for(let L=0,O=0;L<a.length;L+=9,O+=6){R.set(a[L+0],a[L+1],a[L+2]),N.set(a[L+3],a[L+4],a[L+5]),B.set(a[L+6],a[L+7],a[L+8]),U.set(o[O+0],o[O+1]),z.set(o[O+2],o[O+3]),P.set(o[O+4],o[O+5]),F.copy(R).add(N).add(B).divideScalar(3);const ee=M(F);C(U,O+0,R,ee),C(z,O+2,N,ee),C(P,O+4,B,ee)}}function C(R,N,B,F){F<0&&R.x===1&&(o[N]=R.x-1),B.x===0&&B.z===0&&(o[N]=F/2/Math.PI+.5)}function M(R){return Math.atan2(R.z,-R.x)}function A(R){return Math.atan2(-R.y,Math.sqrt(R.x*R.x+R.z*R.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new jf(e.vertices,e.indices,e.radius,e.details)}}class My extends jf{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,i=1/n,a=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-n,0,-i,n,0,i,-n,0,i,n,-i,-n,0,-i,n,0,i,-n,0,i,n,0,-n,0,-i,n,0,-i,-n,0,i,n,0,i],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(a,o,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new My(e.radius,e.detail)}}const cv=new k,uv=new k,s2=new k,fv=new Ef;class bC extends Rn{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){const i=Math.pow(10,4),a=Math.cos(Qh*t),o=e.getIndex(),c=e.getAttribute("position"),u=o?o.count:c.count,h=[0,0,0],m=["a","b","c"],x=new Array(3),g={},b=[];for(let S=0;S<u;S+=3){o?(h[0]=o.getX(S),h[1]=o.getX(S+1),h[2]=o.getX(S+2)):(h[0]=S,h[1]=S+1,h[2]=S+2);const{a:C,b:M,c:A}=fv;if(C.fromBufferAttribute(c,h[0]),M.fromBufferAttribute(c,h[1]),A.fromBufferAttribute(c,h[2]),fv.getNormal(s2),x[0]=`${Math.round(C.x*i)},${Math.round(C.y*i)},${Math.round(C.z*i)}`,x[1]=`${Math.round(M.x*i)},${Math.round(M.y*i)},${Math.round(M.z*i)}`,x[2]=`${Math.round(A.x*i)},${Math.round(A.y*i)},${Math.round(A.z*i)}`,!(x[0]===x[1]||x[1]===x[2]||x[2]===x[0]))for(let R=0;R<3;R++){const N=(R+1)%3,B=x[R],F=x[N],U=fv[m[R]],z=fv[m[N]],P=`${B}_${F}`,L=`${F}_${B}`;L in g&&g[L]?(s2.dot(g[L].normal)<=a&&(b.push(U.x,U.y,U.z),b.push(z.x,z.y,z.z)),g[L]=null):P in g||(g[P]={index0:h[R],index1:h[N],normal:s2.clone()})}}for(const S in g)if(g[S]){const{index0:C,index1:M}=g[S];cv.fromBufferAttribute(c,C),uv.fromBufferAttribute(c,M),b.push(cv.x,cv.y,cv.z),b.push(uv.x,uv.y,uv.z)}this.setAttribute("position",new $t(b,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class fc{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){un("Curve: .getPoint() not implemented.")}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,i=this.getPoint(0),a=0;t.push(0);for(let o=1;o<=e;o++)n=this.getPoint(o/e),a+=n.distanceTo(i),t.push(a),i=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t=null){const n=this.getLengths();let i=0;const a=n.length;let o;t?o=t:o=e*n[a-1];let c=0,u=a-1,h;for(;c<=u;)if(i=Math.floor(c+(u-c)/2),h=n[i]-o,h<0)c=i+1;else if(h>0)u=i-1;else{u=i;break}if(i=u,n[i]===o)return i/(a-1);const m=n[i],g=n[i+1]-m,b=(o-m)/g;return(i+b)/(a-1)}getTangent(e,t){let i=e-1e-4,a=e+1e-4;i<0&&(i=0),a>1&&(a=1);const o=this.getPoint(i),c=this.getPoint(a),u=t||(o.isVector2?new gt:new k);return u.copy(c).sub(o).normalize(),u}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t=!1){const n=new k,i=[],a=[],o=[],c=new k,u=new wn;for(let b=0;b<=e;b++){const S=b/e;i[b]=this.getTangentAt(S,new k)}a[0]=new k,o[0]=new k;let h=Number.MAX_VALUE;const m=Math.abs(i[0].x),x=Math.abs(i[0].y),g=Math.abs(i[0].z);m<=h&&(h=m,n.set(1,0,0)),x<=h&&(h=x,n.set(0,1,0)),g<=h&&n.set(0,0,1),c.crossVectors(i[0],n).normalize(),a[0].crossVectors(i[0],c),o[0].crossVectors(i[0],a[0]);for(let b=1;b<=e;b++){if(a[b]=a[b-1].clone(),o[b]=o[b-1].clone(),c.crossVectors(i[b-1],i[b]),c.length()>Number.EPSILON){c.normalize();const S=Math.acos(Pn(i[b-1].dot(i[b]),-1,1));a[b].applyMatrix4(u.makeRotationAxis(c,S))}o[b].crossVectors(i[b],a[b])}if(t===!0){let b=Math.acos(Pn(a[0].dot(a[e]),-1,1));b/=e,i[0].dot(c.crossVectors(a[0],a[e]))>0&&(b=-b);for(let S=1;S<=e;S++)a[S].applyMatrix4(u.makeRotationAxis(i[S],b*S)),o[S].crossVectors(i[S],a[S])}return{tangents:i,normals:a,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.7,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class wy extends fc{constructor(e=0,t=0,n=1,i=1,a=0,o=Math.PI*2,c=!1,u=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=i,this.aStartAngle=a,this.aEndAngle=o,this.aClockwise=c,this.aRotation=u}getPoint(e,t=new gt){const n=t,i=Math.PI*2;let a=this.aEndAngle-this.aStartAngle;const o=Math.abs(a)<Number.EPSILON;for(;a<0;)a+=i;for(;a>i;)a-=i;a<Number.EPSILON&&(o?a=0:a=i),this.aClockwise===!0&&!o&&(a===i?a=-i:a=a-i);const c=this.aStartAngle+e*a;let u=this.aX+this.xRadius*Math.cos(c),h=this.aY+this.yRadius*Math.sin(c);if(this.aRotation!==0){const m=Math.cos(this.aRotation),x=Math.sin(this.aRotation),g=u-this.aX,b=h-this.aY;u=g*m-b*x+this.aX,h=g*x+b*m+this.aY}return n.set(u,h)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class _C extends wy{constructor(e,t,n,i,a,o){super(e,t,n,n,i,a,o),this.isArcCurve=!0,this.type="ArcCurve"}}function MS(){let s=0,e=0,t=0,n=0;function i(a,o,c,u){s=a,e=c,t=-3*a+3*o-2*c-u,n=2*a-2*o+c+u}return{initCatmullRom:function(a,o,c,u,h){i(o,c,h*(c-a),h*(u-o))},initNonuniformCatmullRom:function(a,o,c,u,h,m,x){let g=(o-a)/h-(c-a)/(h+m)+(c-o)/m,b=(c-o)/m-(u-o)/(m+x)+(u-c)/x;g*=m,b*=m,i(o,c,g,b)},calc:function(a){const o=a*a,c=o*a;return s+e*a+t*o+n*c}}}const hv=new k,r2=new MS,o2=new MS,l2=new MS;class _l extends fc{constructor(e=[],t=!1,n="centripetal",i=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=i}getPoint(e,t=new k){const n=t,i=this.points,a=i.length,o=(a-(this.closed?0:1))*e;let c=Math.floor(o),u=o-c;this.closed?c+=c>0?0:(Math.floor(Math.abs(c)/a)+1)*a:u===0&&c===a-1&&(c=a-2,u=1);let h,m;this.closed||c>0?h=i[(c-1)%a]:(hv.subVectors(i[0],i[1]).add(i[0]),h=hv);const x=i[c%a],g=i[(c+1)%a];if(this.closed||c+2<a?m=i[(c+2)%a]:(hv.subVectors(i[a-1],i[a-2]).add(i[a-1]),m=hv),this.curveType==="centripetal"||this.curveType==="chordal"){const b=this.curveType==="chordal"?.5:.25;let S=Math.pow(h.distanceToSquared(x),b),C=Math.pow(x.distanceToSquared(g),b),M=Math.pow(g.distanceToSquared(m),b);C<1e-4&&(C=1),S<1e-4&&(S=C),M<1e-4&&(M=C),r2.initNonuniformCatmullRom(h.x,x.x,g.x,m.x,S,C,M),o2.initNonuniformCatmullRom(h.y,x.y,g.y,m.y,S,C,M),l2.initNonuniformCatmullRom(h.z,x.z,g.z,m.z,S,C,M)}else this.curveType==="catmullrom"&&(r2.initCatmullRom(h.x,x.x,g.x,m.x,this.tension),o2.initCatmullRom(h.y,x.y,g.y,m.y,this.tension),l2.initCatmullRom(h.z,x.z,g.z,m.z,this.tension));return n.set(r2.calc(u),o2.calc(u),l2.calc(u)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const i=e.points[t];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const i=this.points[t];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const i=e.points[t];this.points.push(new k().fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function ew(s,e,t,n,i){const a=(n-e)*.5,o=(i-t)*.5,c=s*s,u=s*c;return(2*t-2*n+a+o)*u+(-3*t+3*n-2*a-o)*c+a*s+t}function gD(s,e){const t=1-s;return t*t*e}function vD(s,e){return 2*(1-s)*s*e}function yD(s,e){return s*s*e}function Qm(s,e,t,n){return gD(s,e)+vD(s,t)+yD(s,n)}function bD(s,e){const t=1-s;return t*t*t*e}function _D(s,e){const t=1-s;return 3*t*t*s*e}function SD(s,e){return 3*(1-s)*s*s*e}function AD(s,e){return s*s*s*e}function $m(s,e,t,n,i){return bD(s,e)+_D(s,t)+SD(s,n)+AD(s,i)}class wS extends fc{constructor(e=new gt,t=new gt,n=new gt,i=new gt){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=i}getPoint(e,t=new gt){const n=t,i=this.v0,a=this.v1,o=this.v2,c=this.v3;return n.set($m(e,i.x,a.x,o.x,c.x),$m(e,i.y,a.y,o.y,c.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class SC extends fc{constructor(e=new k,t=new k,n=new k,i=new k){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=i}getPoint(e,t=new k){const n=t,i=this.v0,a=this.v1,o=this.v2,c=this.v3;return n.set($m(e,i.x,a.x,o.x,c.x),$m(e,i.y,a.y,o.y,c.y),$m(e,i.z,a.z,o.z,c.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class ES extends fc{constructor(e=new gt,t=new gt){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new gt){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new gt){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class AC extends fc{constructor(e=new k,t=new k){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new k){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new k){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class CS extends fc{constructor(e=new gt,t=new gt,n=new gt){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new gt){const n=t,i=this.v0,a=this.v1,o=this.v2;return n.set(Qm(e,i.x,a.x,o.x),Qm(e,i.y,a.y,o.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class TS extends fc{constructor(e=new k,t=new k,n=new k){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new k){const n=t,i=this.v0,a=this.v1,o=this.v2;return n.set(Qm(e,i.x,a.x,o.x),Qm(e,i.y,a.y,o.y),Qm(e,i.z,a.z,o.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class RS extends fc{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new gt){const n=t,i=this.points,a=(i.length-1)*e,o=Math.floor(a),c=a-o,u=i[o===0?o:o-1],h=i[o],m=i[o>i.length-2?i.length-1:o+1],x=i[o>i.length-3?i.length-1:o+2];return n.set(ew(c,u.x,h.x,m.x,x.x),ew(c,u.y,h.y,m.y,x.y)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const i=e.points[t];this.points.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const i=this.points[t];e.points.push(i.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const i=e.points[t];this.points.push(new gt().fromArray(i))}return this}}var H1=Object.freeze({__proto__:null,ArcCurve:_C,CatmullRomCurve3:_l,CubicBezierCurve:wS,CubicBezierCurve3:SC,EllipseCurve:wy,LineCurve:ES,LineCurve3:AC,QuadraticBezierCurve:CS,QuadraticBezierCurve3:TS,SplineCurve:RS});class MC extends fc{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const n=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new H1[n](t,e))}return this}getPoint(e,t){const n=e*this.getLength(),i=this.getCurveLengths();let a=0;for(;a<i.length;){if(i[a]>=n){const o=i[a]-n,c=this.curves[a],u=c.getLength(),h=u===0?0:1-o/u;return c.getPointAt(h,t)}a++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,i=this.curves.length;n<i;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let n;for(let i=0,a=this.curves;i<a.length;i++){const o=a[i],c=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,u=o.getPoints(c);for(let h=0;h<u.length;h++){const m=u[h];n&&n.equals(m)||(t.push(m),n=m)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const i=e.curves[t];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){const i=this.curves[t];e.curves.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const i=e.curves[t];this.curves.push(new H1[i.type]().fromJSON(i))}return this}}class k1 extends MC{constructor(e){super(),this.type="Path",this.currentPoint=new gt,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const n=new ES(this.currentPoint.clone(),new gt(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,i){const a=new CS(this.currentPoint.clone(),new gt(e,t),new gt(n,i));return this.curves.push(a),this.currentPoint.set(n,i),this}bezierCurveTo(e,t,n,i,a,o){const c=new wS(this.currentPoint.clone(),new gt(e,t),new gt(n,i),new gt(a,o));return this.curves.push(c),this.currentPoint.set(a,o),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),n=new RS(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,i,a,o){const c=this.currentPoint.x,u=this.currentPoint.y;return this.absarc(e+c,t+u,n,i,a,o),this}absarc(e,t,n,i,a,o){return this.absellipse(e,t,n,n,i,a,o),this}ellipse(e,t,n,i,a,o,c,u){const h=this.currentPoint.x,m=this.currentPoint.y;return this.absellipse(e+h,t+m,n,i,a,o,c,u),this}absellipse(e,t,n,i,a,o,c,u){const h=new wy(e,t,n,i,a,o,c,u);if(this.curves.length>0){const x=h.getPoint(0);x.equals(this.currentPoint)||this.lineTo(x.x,x.y)}this.curves.push(h);const m=h.getPoint(1);return this.currentPoint.copy(m),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class Jc extends k1{constructor(e){super(e),this.uuid=Wo(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let n=0,i=this.holes.length;n<i;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const i=e.holes[t];this.holes.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){const i=this.holes[t];e.holes.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const i=e.holes[t];this.holes.push(new k1().fromJSON(i))}return this}}function MD(s,e,t=2){const n=e&&e.length,i=n?e[0]*t:s.length;let a=wC(s,0,i,t,!0);const o=[];if(!a||a.next===a.prev)return o;let c,u,h;if(n&&(a=RD(s,e,a,t)),s.length>80*t){c=s[0],u=s[1];let m=c,x=u;for(let g=t;g<i;g+=t){const b=s[g],S=s[g+1];b<c&&(c=b),S<u&&(u=S),b>m&&(m=b),S>x&&(x=S)}h=Math.max(m-c,x-u),h=h!==0?32767/h:0}return fx(a,o,t,c,u,h,0),o}function wC(s,e,t,n,i){let a;if(i===GD(s,e,t,n)>0)for(let o=e;o<t;o+=n)a=tw(o/n|0,s[o],s[o+1],a);else for(let o=t-n;o>=e;o-=n)a=tw(o/n|0,s[o],s[o+1],a);return a&&Kp(a,a.next)&&(dx(a),a=a.next),a}function nd(s,e){if(!s)return s;e||(e=s);let t=s,n;do if(n=!1,!t.steiner&&(Kp(t,t.next)||Fa(t.prev,t,t.next)===0)){if(dx(t),t=e=t.prev,t===t.next)break;n=!0}else t=t.next;while(n||t!==e);return e}function fx(s,e,t,n,i,a,o){if(!s)return;!o&&a&&LD(s,n,i,a);let c=s;for(;s.prev!==s.next;){const u=s.prev,h=s.next;if(a?ED(s,n,i,a):wD(s)){e.push(u.i,s.i,h.i),dx(s),s=h.next,c=h.next;continue}if(s=h,s===c){o?o===1?(s=CD(nd(s),e),fx(s,e,t,n,i,a,2)):o===2&&TD(s,e,t,n,i,a):fx(nd(s),e,t,n,i,a,1);break}}}function wD(s){const e=s.prev,t=s,n=s.next;if(Fa(e,t,n)>=0)return!1;const i=e.x,a=t.x,o=n.x,c=e.y,u=t.y,h=n.y,m=Math.min(i,a,o),x=Math.min(c,u,h),g=Math.max(i,a,o),b=Math.max(c,u,h);let S=n.next;for(;S!==e;){if(S.x>=m&&S.x<=g&&S.y>=x&&S.y<=b&&jm(i,c,a,u,o,h,S.x,S.y)&&Fa(S.prev,S,S.next)>=0)return!1;S=S.next}return!0}function ED(s,e,t,n){const i=s.prev,a=s,o=s.next;if(Fa(i,a,o)>=0)return!1;const c=i.x,u=a.x,h=o.x,m=i.y,x=a.y,g=o.y,b=Math.min(c,u,h),S=Math.min(m,x,g),C=Math.max(c,u,h),M=Math.max(m,x,g),A=B_(b,S,e,t,n),R=B_(C,M,e,t,n);let N=s.prevZ,B=s.nextZ;for(;N&&N.z>=A&&B&&B.z<=R;){if(N.x>=b&&N.x<=C&&N.y>=S&&N.y<=M&&N!==i&&N!==o&&jm(c,m,u,x,h,g,N.x,N.y)&&Fa(N.prev,N,N.next)>=0||(N=N.prevZ,B.x>=b&&B.x<=C&&B.y>=S&&B.y<=M&&B!==i&&B!==o&&jm(c,m,u,x,h,g,B.x,B.y)&&Fa(B.prev,B,B.next)>=0))return!1;B=B.nextZ}for(;N&&N.z>=A;){if(N.x>=b&&N.x<=C&&N.y>=S&&N.y<=M&&N!==i&&N!==o&&jm(c,m,u,x,h,g,N.x,N.y)&&Fa(N.prev,N,N.next)>=0)return!1;N=N.prevZ}for(;B&&B.z<=R;){if(B.x>=b&&B.x<=C&&B.y>=S&&B.y<=M&&B!==i&&B!==o&&jm(c,m,u,x,h,g,B.x,B.y)&&Fa(B.prev,B,B.next)>=0)return!1;B=B.nextZ}return!0}function CD(s,e){let t=s;do{const n=t.prev,i=t.next.next;!Kp(n,i)&&CC(n,t,t.next,i)&&hx(n,i)&&hx(i,n)&&(e.push(n.i,t.i,i.i),dx(t),dx(t.next),t=s=i),t=t.next}while(t!==s);return nd(t)}function TD(s,e,t,n,i,a){let o=s;do{let c=o.next.next;for(;c!==o.prev;){if(o.i!==c.i&&zD(o,c)){let u=TC(o,c);o=nd(o,o.next),u=nd(u,u.next),fx(o,e,t,n,i,a,0),fx(u,e,t,n,i,a,0);return}c=c.next}o=o.next}while(o!==s)}function RD(s,e,t,n){const i=[];for(let a=0,o=e.length;a<o;a++){const c=e[a]*n,u=a<o-1?e[a+1]*n:s.length,h=wC(s,c,u,n,!1);h===h.next&&(h.steiner=!0),i.push(ID(h))}i.sort(ND);for(let a=0;a<i.length;a++)t=BD(i[a],t);return t}function ND(s,e){let t=s.x-e.x;if(t===0&&(t=s.y-e.y,t===0)){const n=(s.next.y-s.y)/(s.next.x-s.x),i=(e.next.y-e.y)/(e.next.x-e.x);t=n-i}return t}function BD(s,e){const t=DD(s,e);if(!t)return e;const n=TC(t,s);return nd(n,n.next),nd(t,t.next)}function DD(s,e){let t=e;const n=s.x,i=s.y;let a=-1/0,o;if(Kp(s,t))return t;do{if(Kp(s,t.next))return t.next;if(i<=t.y&&i>=t.next.y&&t.next.y!==t.y){const x=t.x+(i-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(x<=n&&x>a&&(a=x,o=t.x<t.next.x?t:t.next,x===n))return o}t=t.next}while(t!==e);if(!o)return null;const c=o,u=o.x,h=o.y;let m=1/0;t=o;do{if(n>=t.x&&t.x>=u&&n!==t.x&&EC(i<h?n:a,i,u,h,i<h?a:n,i,t.x,t.y)){const x=Math.abs(i-t.y)/(n-t.x);hx(t,s)&&(x<m||x===m&&(t.x>o.x||t.x===o.x&&UD(o,t)))&&(o=t,m=x)}t=t.next}while(t!==c);return o}function UD(s,e){return Fa(s.prev,s,e.prev)<0&&Fa(e.next,s,s.next)<0}function LD(s,e,t,n){let i=s;do i.z===0&&(i.z=B_(i.x,i.y,e,t,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==s);i.prevZ.nextZ=null,i.prevZ=null,OD(i)}function OD(s){let e,t=1;do{let n=s,i;s=null;let a=null;for(e=0;n;){e++;let o=n,c=0;for(let h=0;h<t&&(c++,o=o.nextZ,!!o);h++);let u=t;for(;c>0||u>0&&o;)c!==0&&(u===0||!o||n.z<=o.z)?(i=n,n=n.nextZ,c--):(i=o,o=o.nextZ,u--),a?a.nextZ=i:s=i,i.prevZ=a,a=i;n=o}a.nextZ=null,t*=2}while(e>1);return s}function B_(s,e,t,n,i){return s=(s-t)*i|0,e=(e-n)*i|0,s=(s|s<<8)&16711935,s=(s|s<<4)&252645135,s=(s|s<<2)&858993459,s=(s|s<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,s|e<<1}function ID(s){let e=s,t=s;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==s);return t}function EC(s,e,t,n,i,a,o,c){return(i-o)*(e-c)>=(s-o)*(a-c)&&(s-o)*(n-c)>=(t-o)*(e-c)&&(t-o)*(a-c)>=(i-o)*(n-c)}function jm(s,e,t,n,i,a,o,c){return!(s===o&&e===c)&&EC(s,e,t,n,i,a,o,c)}function zD(s,e){return s.next.i!==e.i&&s.prev.i!==e.i&&!FD(s,e)&&(hx(s,e)&&hx(e,s)&&PD(s,e)&&(Fa(s.prev,s,e.prev)||Fa(s,e.prev,e))||Kp(s,e)&&Fa(s.prev,s,s.next)>0&&Fa(e.prev,e,e.next)>0)}function Fa(s,e,t){return(e.y-s.y)*(t.x-e.x)-(e.x-s.x)*(t.y-e.y)}function Kp(s,e){return s.x===e.x&&s.y===e.y}function CC(s,e,t,n){const i=pv(Fa(s,e,t)),a=pv(Fa(s,e,n)),o=pv(Fa(t,n,s)),c=pv(Fa(t,n,e));return!!(i!==a&&o!==c||i===0&&dv(s,t,e)||a===0&&dv(s,n,e)||o===0&&dv(t,s,n)||c===0&&dv(t,e,n))}function dv(s,e,t){return e.x<=Math.max(s.x,t.x)&&e.x>=Math.min(s.x,t.x)&&e.y<=Math.max(s.y,t.y)&&e.y>=Math.min(s.y,t.y)}function pv(s){return s>0?1:s<0?-1:0}function FD(s,e){let t=s;do{if(t.i!==s.i&&t.next.i!==s.i&&t.i!==e.i&&t.next.i!==e.i&&CC(t,t.next,s,e))return!0;t=t.next}while(t!==s);return!1}function hx(s,e){return Fa(s.prev,s,s.next)<0?Fa(s,e,s.next)>=0&&Fa(s,s.prev,e)>=0:Fa(s,e,s.prev)<0||Fa(s,s.next,e)<0}function PD(s,e){let t=s,n=!1;const i=(s.x+e.x)/2,a=(s.y+e.y)/2;do t.y>a!=t.next.y>a&&t.next.y!==t.y&&i<(t.next.x-t.x)*(a-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next;while(t!==s);return n}function TC(s,e){const t=D_(s.i,s.x,s.y),n=D_(e.i,e.x,e.y),i=s.next,a=e.prev;return s.next=e,e.prev=s,t.next=i,i.prev=t,n.next=t,t.prev=n,a.next=n,n.prev=a,n}function tw(s,e,t,n){const i=D_(s,e,t);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function dx(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function D_(s,e,t){return{i:s,x:e,y:t,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function GD(s,e,t,n){let i=0;for(let a=e,o=t-n;a<t;a+=n)i+=(s[o]-s[a])*(s[a+1]+s[o+1]),o=a;return i}class jD{static triangulate(e,t,n=2){return MD(e,t,n)}}class Ml{static area(e){const t=e.length;let n=0;for(let i=t-1,a=0;a<t;i=a++)n+=e[i].x*e[a].y-e[a].x*e[i].y;return n*.5}static isClockWise(e){return Ml.area(e)<0}static triangulateShape(e,t){const n=[],i=[],a=[];nw(e),iw(n,e);let o=e.length;t.forEach(nw);for(let u=0;u<t.length;u++)i.push(o),o+=t[u].length,iw(n,t[u]);const c=jD.triangulate(n,i);for(let u=0;u<c.length;u+=3)a.push(c.slice(u,u+3));return a}}function nw(s){const e=s.length;e>2&&s[e-1].equals(s[0])&&s.pop()}function iw(s,e){for(let t=0;t<e.length;t++)s.push(e[t].x),s.push(e[t].y)}class id extends Rn{constructor(e=new Jc([new gt(.5,.5),new gt(-.5,.5),new gt(-.5,-.5),new gt(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,i=[],a=[];for(let c=0,u=e.length;c<u;c++){const h=e[c];o(h)}this.setAttribute("position",new $t(i,3)),this.setAttribute("uv",new $t(a,2)),this.computeVertexNormals();function o(c){const u=[],h=t.curveSegments!==void 0?t.curveSegments:12,m=t.steps!==void 0?t.steps:1,x=t.depth!==void 0?t.depth:1;let g=t.bevelEnabled!==void 0?t.bevelEnabled:!0,b=t.bevelThickness!==void 0?t.bevelThickness:.2,S=t.bevelSize!==void 0?t.bevelSize:b-.1,C=t.bevelOffset!==void 0?t.bevelOffset:0,M=t.bevelSegments!==void 0?t.bevelSegments:3;const A=t.extrudePath,R=t.UVGenerator!==void 0?t.UVGenerator:HD;let N,B=!1,F,U,z,P;A&&(N=A.getSpacedPoints(m),B=!0,g=!1,F=A.computeFrenetFrames(m,!1),U=new k,z=new k,P=new k),g||(M=0,b=0,S=0,C=0);const L=c.extractPoints(h);let O=L.shape;const ee=L.holes;if(!Ml.isClockWise(O)){O=O.reverse();for(let De=0,le=ee.length;De<le;De++){const Ye=ee[De];Ml.isClockWise(Ye)&&(ee[De]=Ye.reverse())}}function te(De){const Ye=10000000000000001e-36;let Ze=De[0];for(let je=1;je<=De.length;je++){const He=je%De.length,et=De[He],Ne=et.x-Ze.x,st=et.y-Ze.y,oe=Ne*Ne+st*st,X=Math.max(Math.abs(et.x),Math.abs(et.y),Math.abs(Ze.x),Math.abs(Ze.y)),Ae=Ye*X*X;if(oe<=Ae){De.splice(He,1),je--;continue}Ze=et}}te(O),ee.forEach(te);const ne=ee.length,re=O;for(let De=0;De<ne;De++){const le=ee[De];O=O.concat(le)}function j(De,le,Ye){return le||Xn("ExtrudeGeometry: vec does not exist"),De.clone().addScaledVector(le,Ye)}const ae=O.length;function J(De,le,Ye){let Ze,je,He;const et=De.x-le.x,Ne=De.y-le.y,st=Ye.x-De.x,oe=Ye.y-De.y,X=et*et+Ne*Ne,Ae=et*oe-Ne*st;if(Math.abs(Ae)>Number.EPSILON){const Pe=Math.sqrt(X),Ue=Math.sqrt(st*st+oe*oe),Be=le.x-Ne/Pe,bt=le.y+et/Pe,vt=Ye.x-oe/Ue,It=Ye.y+st/Ue,zt=((vt-Be)*oe-(It-bt)*st)/(et*oe-Ne*st);Ze=Be+et*zt-De.x,je=bt+Ne*zt-De.y;const qe=Ze*Ze+je*je;if(qe<=2)return new gt(Ze,je);He=Math.sqrt(qe/2)}else{let Pe=!1;et>Number.EPSILON?st>Number.EPSILON&&(Pe=!0):et<-Number.EPSILON?st<-Number.EPSILON&&(Pe=!0):Math.sign(Ne)===Math.sign(oe)&&(Pe=!0),Pe?(Ze=-Ne,je=et,He=Math.sqrt(X)):(Ze=et,je=Ne,He=Math.sqrt(X/2))}return new gt(Ze/He,je/He)}const ie=[];for(let De=0,le=re.length,Ye=le-1,Ze=De+1;De<le;De++,Ye++,Ze++)Ye===le&&(Ye=0),Ze===le&&(Ze=0),ie[De]=J(re[De],re[Ye],re[Ze]);const se=[];let I,W=ie.concat();for(let De=0,le=ne;De<le;De++){const Ye=ee[De];I=[];for(let Ze=0,je=Ye.length,He=je-1,et=Ze+1;Ze<je;Ze++,He++,et++)He===je&&(He=0),et===je&&(et=0),I[Ze]=J(Ye[Ze],Ye[He],Ye[et]);se.push(I),W=W.concat(I)}let fe;if(M===0)fe=Ml.triangulateShape(re,ee);else{const De=[],le=[];for(let Ye=0;Ye<M;Ye++){const Ze=Ye/M,je=b*Math.cos(Ze*Math.PI/2),He=S*Math.sin(Ze*Math.PI/2)+C;for(let et=0,Ne=re.length;et<Ne;et++){const st=j(re[et],ie[et],He);ze(st.x,st.y,-je),Ze===0&&De.push(st)}for(let et=0,Ne=ne;et<Ne;et++){const st=ee[et];I=se[et];const oe=[];for(let X=0,Ae=st.length;X<Ae;X++){const Pe=j(st[X],I[X],He);ze(Pe.x,Pe.y,-je),Ze===0&&oe.push(Pe)}Ze===0&&le.push(oe)}}fe=Ml.triangulateShape(De,le)}const Z=fe.length,me=S+C;for(let De=0;De<ae;De++){const le=g?j(O[De],W[De],me):O[De];B?(z.copy(F.normals[0]).multiplyScalar(le.x),U.copy(F.binormals[0]).multiplyScalar(le.y),P.copy(N[0]).add(z).add(U),ze(P.x,P.y,P.z)):ze(le.x,le.y,0)}for(let De=1;De<=m;De++)for(let le=0;le<ae;le++){const Ye=g?j(O[le],W[le],me):O[le];B?(z.copy(F.normals[De]).multiplyScalar(Ye.x),U.copy(F.binormals[De]).multiplyScalar(Ye.y),P.copy(N[De]).add(z).add(U),ze(P.x,P.y,P.z)):ze(Ye.x,Ye.y,x/m*De)}for(let De=M-1;De>=0;De--){const le=De/M,Ye=b*Math.cos(le*Math.PI/2),Ze=S*Math.sin(le*Math.PI/2)+C;for(let je=0,He=re.length;je<He;je++){const et=j(re[je],ie[je],Ze);ze(et.x,et.y,x+Ye)}for(let je=0,He=ee.length;je<He;je++){const et=ee[je];I=se[je];for(let Ne=0,st=et.length;Ne<st;Ne++){const oe=j(et[Ne],I[Ne],Ze);B?ze(oe.x,oe.y+N[m-1].y,N[m-1].x+Ye):ze(oe.x,oe.y,x+Ye)}}}$(),pe();function $(){const De=i.length/3;if(g){let le=0,Ye=ae*le;for(let Ze=0;Ze<Z;Ze++){const je=fe[Ze];Ge(je[2]+Ye,je[1]+Ye,je[0]+Ye)}le=m+M*2,Ye=ae*le;for(let Ze=0;Ze<Z;Ze++){const je=fe[Ze];Ge(je[0]+Ye,je[1]+Ye,je[2]+Ye)}}else{for(let le=0;le<Z;le++){const Ye=fe[le];Ge(Ye[2],Ye[1],Ye[0])}for(let le=0;le<Z;le++){const Ye=fe[le];Ge(Ye[0]+ae*m,Ye[1]+ae*m,Ye[2]+ae*m)}}n.addGroup(De,i.length/3-De,0)}function pe(){const De=i.length/3;let le=0;ve(re,le),le+=re.length;for(let Ye=0,Ze=ee.length;Ye<Ze;Ye++){const je=ee[Ye];ve(je,le),le+=je.length}n.addGroup(De,i.length/3-De,1)}function ve(De,le){let Ye=De.length;for(;--Ye>=0;){const Ze=Ye;let je=Ye-1;je<0&&(je=De.length-1);for(let He=0,et=m+M*2;He<et;He++){const Ne=ae*He,st=ae*(He+1),oe=le+Ze+Ne,X=le+je+Ne,Ae=le+je+st,Pe=le+Ze+st;Fe(oe,X,Ae,Pe)}}}function ze(De,le,Ye){u.push(De),u.push(le),u.push(Ye)}function Ge(De,le,Ye){Qe(De),Qe(le),Qe(Ye);const Ze=i.length/3,je=R.generateTopUV(n,i,Ze-3,Ze-2,Ze-1);lt(je[0]),lt(je[1]),lt(je[2])}function Fe(De,le,Ye,Ze){Qe(De),Qe(le),Qe(Ze),Qe(le),Qe(Ye),Qe(Ze);const je=i.length/3,He=R.generateSideWallUV(n,i,je-6,je-3,je-2,je-1);lt(He[0]),lt(He[1]),lt(He[3]),lt(He[1]),lt(He[2]),lt(He[3])}function Qe(De){i.push(u[De*3+0]),i.push(u[De*3+1]),i.push(u[De*3+2])}function lt(De){a.push(De.x),a.push(De.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,n=this.parameters.options;return kD(t,n,e)}static fromJSON(e,t){const n=[];for(let a=0,o=e.shapes.length;a<o;a++){const c=t[e.shapes[a]];n.push(c)}const i=e.options.extrudePath;return i!==void 0&&(e.options.extrudePath=new H1[i.type]().fromJSON(i)),new id(n,e.options)}}const HD={generateTopUV:function(s,e,t,n,i){const a=e[t*3],o=e[t*3+1],c=e[n*3],u=e[n*3+1],h=e[i*3],m=e[i*3+1];return[new gt(a,o),new gt(c,u),new gt(h,m)]},generateSideWallUV:function(s,e,t,n,i,a){const o=e[t*3],c=e[t*3+1],u=e[t*3+2],h=e[n*3],m=e[n*3+1],x=e[n*3+2],g=e[i*3],b=e[i*3+1],S=e[i*3+2],C=e[a*3],M=e[a*3+1],A=e[a*3+2];return Math.abs(c-m)<Math.abs(o-h)?[new gt(o,1-u),new gt(h,1-x),new gt(g,1-S),new gt(C,1-A)]:[new gt(c,1-u),new gt(m,1-x),new gt(b,1-S),new gt(M,1-A)]}};function kD(s,e,t){if(t.shapes=[],Array.isArray(s))for(let n=0,i=s.length;n<i;n++){const a=s[n];t.shapes.push(a.uuid)}else t.shapes.push(s.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class Tx extends jf{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,i=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],a=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(i,a,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Tx(e.radius,e.detail)}}class Qp extends Rn{constructor(e=[new gt(0,-.5),new gt(.5,0),new gt(0,.5)],t=12,n=0,i=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:i},t=Math.floor(t),i=Pn(i,0,Math.PI*2);const a=[],o=[],c=[],u=[],h=[],m=1/t,x=new k,g=new gt,b=new k,S=new k,C=new k;let M=0,A=0;for(let R=0;R<=e.length-1;R++)switch(R){case 0:M=e[R+1].x-e[R].x,A=e[R+1].y-e[R].y,b.x=A*1,b.y=-M,b.z=A*0,C.copy(b),b.normalize(),u.push(b.x,b.y,b.z);break;case e.length-1:u.push(C.x,C.y,C.z);break;default:M=e[R+1].x-e[R].x,A=e[R+1].y-e[R].y,b.x=A*1,b.y=-M,b.z=A*0,S.copy(b),b.x+=C.x,b.y+=C.y,b.z+=C.z,b.normalize(),u.push(b.x,b.y,b.z),C.copy(S)}for(let R=0;R<=t;R++){const N=n+R*m*i,B=Math.sin(N),F=Math.cos(N);for(let U=0;U<=e.length-1;U++){x.x=e[U].x*B,x.y=e[U].y,x.z=e[U].x*F,o.push(x.x,x.y,x.z),g.x=R/t,g.y=U/(e.length-1),c.push(g.x,g.y);const z=u[3*U+0]*B,P=u[3*U+1],L=u[3*U+0]*F;h.push(z,P,L)}}for(let R=0;R<t;R++)for(let N=0;N<e.length-1;N++){const B=N+R*e.length,F=B,U=B+e.length,z=B+e.length+1,P=B+1;a.push(F,U,P),a.push(z,P,U)}this.setIndex(a),this.setAttribute("position",new $t(o,3)),this.setAttribute("uv",new $t(c,2)),this.setAttribute("normal",new $t(h,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Qp(e.points,e.segments,e.phiStart,e.phiLength)}}class bl extends jf{constructor(e=1,t=0){const n=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],i=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(n,i,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new bl(e.radius,e.detail)}}class is extends Rn{constructor(e=1,t=1,n=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:i};const a=e/2,o=t/2,c=Math.floor(n),u=Math.floor(i),h=c+1,m=u+1,x=e/c,g=t/u,b=[],S=[],C=[],M=[];for(let A=0;A<m;A++){const R=A*g-o;for(let N=0;N<h;N++){const B=N*x-a;S.push(B,-R,0),C.push(0,0,1),M.push(N/c),M.push(1-A/u)}}for(let A=0;A<u;A++)for(let R=0;R<c;R++){const N=R+h*A,B=R+h*(A+1),F=R+1+h*(A+1),U=R+1+h*A;b.push(N,B,U),b.push(B,F,U)}this.setIndex(b),this.setAttribute("position",new $t(S,3)),this.setAttribute("normal",new $t(C,3)),this.setAttribute("uv",new $t(M,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new is(e.width,e.height,e.widthSegments,e.heightSegments)}}class Ey extends Rn{constructor(e=.5,t=1,n=32,i=1,a=0,o=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:i,thetaStart:a,thetaLength:o},n=Math.max(3,n),i=Math.max(1,i);const c=[],u=[],h=[],m=[];let x=e;const g=(t-e)/i,b=new k,S=new gt;for(let C=0;C<=i;C++){for(let M=0;M<=n;M++){const A=a+M/n*o;b.x=x*Math.cos(A),b.y=x*Math.sin(A),u.push(b.x,b.y,b.z),h.push(0,0,1),S.x=(b.x/t+1)/2,S.y=(b.y/t+1)/2,m.push(S.x,S.y)}x+=g}for(let C=0;C<i;C++){const M=C*(n+1);for(let A=0;A<n;A++){const R=A+M,N=R,B=R+n+1,F=R+n+2,U=R+1;c.push(N,B,U),c.push(B,F,U)}}this.setIndex(c),this.setAttribute("position",new $t(u,3)),this.setAttribute("normal",new $t(h,3)),this.setAttribute("uv",new $t(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ey(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class Cy extends Rn{constructor(e=new Jc([new gt(0,.5),new gt(-.5,-.5),new gt(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const n=[],i=[],a=[],o=[];let c=0,u=0;if(Array.isArray(e)===!1)h(e);else for(let m=0;m<e.length;m++)h(e[m]),this.addGroup(c,u,m),c+=u,u=0;this.setIndex(n),this.setAttribute("position",new $t(i,3)),this.setAttribute("normal",new $t(a,3)),this.setAttribute("uv",new $t(o,2));function h(m){const x=i.length/3,g=m.extractPoints(t);let b=g.shape;const S=g.holes;Ml.isClockWise(b)===!1&&(b=b.reverse());for(let M=0,A=S.length;M<A;M++){const R=S[M];Ml.isClockWise(R)===!0&&(S[M]=R.reverse())}const C=Ml.triangulateShape(b,S);for(let M=0,A=S.length;M<A;M++){const R=S[M];b=b.concat(R)}for(let M=0,A=b.length;M<A;M++){const R=b[M];i.push(R.x,R.y,0),a.push(0,0,1),o.push(R.x,R.y)}for(let M=0,A=C.length;M<A;M++){const R=C[M],N=R[0]+x,B=R[1]+x,F=R[2]+x;n.push(N,B,F),u+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes;return VD(t,e)}static fromJSON(e,t){const n=[];for(let i=0,a=e.shapes.length;i<a;i++){const o=t[e.shapes[i]];n.push(o)}return new Cy(n,e.curveSegments)}}function VD(s,e){if(e.shapes=[],Array.isArray(s))for(let t=0,n=s.length;t<n;t++){const i=s[t];e.shapes.push(i.uuid)}else e.shapes.push(s.uuid);return e}class r0 extends Rn{constructor(e=1,t=32,n=16,i=0,a=Math.PI*2,o=0,c=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:i,phiLength:a,thetaStart:o,thetaLength:c},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const u=Math.min(o+c,Math.PI);let h=0;const m=[],x=new k,g=new k,b=[],S=[],C=[],M=[];for(let A=0;A<=n;A++){const R=[],N=A/n;let B=0;A===0&&o===0?B=.5/t:A===n&&u===Math.PI&&(B=-.5/t);for(let F=0;F<=t;F++){const U=F/t;x.x=-e*Math.cos(i+U*a)*Math.sin(o+N*c),x.y=e*Math.cos(o+N*c),x.z=e*Math.sin(i+U*a)*Math.sin(o+N*c),S.push(x.x,x.y,x.z),g.copy(x).normalize(),C.push(g.x,g.y,g.z),M.push(U+B,1-N),R.push(h++)}m.push(R)}for(let A=0;A<n;A++)for(let R=0;R<t;R++){const N=m[A][R+1],B=m[A][R],F=m[A+1][R],U=m[A+1][R+1];(A!==0||o>0)&&b.push(N,B,U),(A!==n-1||u<Math.PI)&&b.push(B,F,U)}this.setIndex(b),this.setAttribute("position",new $t(S,3)),this.setAttribute("normal",new $t(C,3)),this.setAttribute("uv",new $t(M,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new r0(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class Ty extends jf{constructor(e=1,t=0){const n=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],i=[2,1,0,0,3,2,1,3,0,2,3,1];super(n,i,e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Ty(e.radius,e.detail)}}class Rf extends Rn{constructor(e=1,t=.4,n=12,i=48,a=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:i,arc:a},n=Math.floor(n),i=Math.floor(i);const o=[],c=[],u=[],h=[],m=new k,x=new k,g=new k;for(let b=0;b<=n;b++)for(let S=0;S<=i;S++){const C=S/i*a,M=b/n*Math.PI*2;x.x=(e+t*Math.cos(M))*Math.cos(C),x.y=(e+t*Math.cos(M))*Math.sin(C),x.z=t*Math.sin(M),c.push(x.x,x.y,x.z),m.x=e*Math.cos(C),m.y=e*Math.sin(C),g.subVectors(x,m).normalize(),u.push(g.x,g.y,g.z),h.push(S/i),h.push(b/n)}for(let b=1;b<=n;b++)for(let S=1;S<=i;S++){const C=(i+1)*b+S-1,M=(i+1)*(b-1)+S-1,A=(i+1)*(b-1)+S,R=(i+1)*b+S;o.push(C,M,R),o.push(M,A,R)}this.setIndex(o),this.setAttribute("position",new $t(c,3)),this.setAttribute("normal",new $t(u,3)),this.setAttribute("uv",new $t(h,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Rf(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class Ry extends Rn{constructor(e=1,t=.4,n=64,i=8,a=2,o=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:i,p:a,q:o},n=Math.floor(n),i=Math.floor(i);const c=[],u=[],h=[],m=[],x=new k,g=new k,b=new k,S=new k,C=new k,M=new k,A=new k;for(let N=0;N<=n;++N){const B=N/n*a*Math.PI*2;R(B,a,o,e,b),R(B+.01,a,o,e,S),M.subVectors(S,b),A.addVectors(S,b),C.crossVectors(M,A),A.crossVectors(C,M),C.normalize(),A.normalize();for(let F=0;F<=i;++F){const U=F/i*Math.PI*2,z=-t*Math.cos(U),P=t*Math.sin(U);x.x=b.x+(z*A.x+P*C.x),x.y=b.y+(z*A.y+P*C.y),x.z=b.z+(z*A.z+P*C.z),u.push(x.x,x.y,x.z),g.subVectors(x,b).normalize(),h.push(g.x,g.y,g.z),m.push(N/n),m.push(F/i)}}for(let N=1;N<=n;N++)for(let B=1;B<=i;B++){const F=(i+1)*(N-1)+(B-1),U=(i+1)*N+(B-1),z=(i+1)*N+B,P=(i+1)*(N-1)+B;c.push(F,U,P),c.push(U,z,P)}this.setIndex(c),this.setAttribute("position",new $t(u,3)),this.setAttribute("normal",new $t(h,3)),this.setAttribute("uv",new $t(m,2));function R(N,B,F,U,z){const P=Math.cos(N),L=Math.sin(N),O=F/B*N,ee=Math.cos(O);z.x=U*(2+ee)*.5*P,z.y=U*(2+ee)*L*.5,z.z=U*Math.sin(O)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ry(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class Ny extends Rn{constructor(e=new TS(new k(-1,-1,0),new k(-1,1,0),new k(1,1,0)),t=64,n=1,i=8,a=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:i,closed:a};const o=e.computeFrenetFrames(t,a);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const c=new k,u=new k,h=new gt;let m=new k;const x=[],g=[],b=[],S=[];C(),this.setIndex(S),this.setAttribute("position",new $t(x,3)),this.setAttribute("normal",new $t(g,3)),this.setAttribute("uv",new $t(b,2));function C(){for(let N=0;N<t;N++)M(N);M(a===!1?t:0),R(),A()}function M(N){m=e.getPointAt(N/t,m);const B=o.normals[N],F=o.binormals[N];for(let U=0;U<=i;U++){const z=U/i*Math.PI*2,P=Math.sin(z),L=-Math.cos(z);u.x=L*B.x+P*F.x,u.y=L*B.y+P*F.y,u.z=L*B.z+P*F.z,u.normalize(),g.push(u.x,u.y,u.z),c.x=m.x+n*u.x,c.y=m.y+n*u.y,c.z=m.z+n*u.z,x.push(c.x,c.y,c.z)}}function A(){for(let N=1;N<=t;N++)for(let B=1;B<=i;B++){const F=(i+1)*(N-1)+(B-1),U=(i+1)*N+(B-1),z=(i+1)*N+B,P=(i+1)*(N-1)+B;S.push(F,U,P),S.push(U,z,P)}}function R(){for(let N=0;N<=t;N++)for(let B=0;B<=i;B++)h.x=N/t,h.y=B/i,b.push(h.x,h.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new Ny(new H1[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class NS extends Rn{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],n=new Set,i=new k,a=new k;if(e.index!==null){const o=e.attributes.position,c=e.index;let u=e.groups;u.length===0&&(u=[{start:0,count:c.count,materialIndex:0}]);for(let h=0,m=u.length;h<m;++h){const x=u[h],g=x.start,b=x.count;for(let S=g,C=g+b;S<C;S+=3)for(let M=0;M<3;M++){const A=c.getX(S+M),R=c.getX(S+(M+1)%3);i.fromBufferAttribute(o,A),a.fromBufferAttribute(o,R),aw(i,a,n)===!0&&(t.push(i.x,i.y,i.z),t.push(a.x,a.y,a.z))}}}else{const o=e.attributes.position;for(let c=0,u=o.count/3;c<u;c++)for(let h=0;h<3;h++){const m=3*c+h,x=3*c+(h+1)%3;i.fromBufferAttribute(o,m),a.fromBufferAttribute(o,x),aw(i,a,n)===!0&&(t.push(i.x,i.y,i.z),t.push(a.x,a.y,a.z))}}this.setAttribute("position",new $t(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function aw(s,e,t){const n=`${s.x},${s.y},${s.z}-${e.x},${e.y},${e.z}`,i=`${e.x},${e.y},${e.z}-${s.x},${s.y},${s.z}`;return t.has(n)===!0||t.has(i)===!0?!1:(t.add(n),t.add(i),!0)}var sw=Object.freeze({__proto__:null,BoxGeometry:ks,CapsuleGeometry:Sy,CircleGeometry:Ay,ConeGeometry:Cx,CylinderGeometry:Lr,DodecahedronGeometry:My,EdgesGeometry:bC,ExtrudeGeometry:id,IcosahedronGeometry:Tx,LatheGeometry:Qp,OctahedronGeometry:bl,PlaneGeometry:is,PolyhedronGeometry:jf,RingGeometry:Ey,ShapeGeometry:Cy,SphereGeometry:r0,TetrahedronGeometry:Ty,TorusGeometry:Rf,TorusKnotGeometry:Ry,TubeGeometry:Ny,WireframeGeometry:NS});class RC extends os{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new qt(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class NC extends Ys{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class Rx extends os{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new qt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new qt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Gf,this.normalScale=new gt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new hi,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Cl extends Rx{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new gt(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Pn(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new qt(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new qt(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new qt(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class BS extends os{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new qt(16777215),this.specular=new qt(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new qt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Gf,this.normalScale=new gt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new hi,this.combine=bx,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class BC extends os{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new qt(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new qt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Gf,this.normalScale=new gt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class DC extends os{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Gf,this.normalScale=new gt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class UC extends os{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new qt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new qt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Gf,this.normalScale=new gt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new hi,this.combine=bx,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class By extends os{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=$3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class Dy extends os{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}class LC extends os{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new qt(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Gf,this.normalScale=new gt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this.fog=e.fog,this}}class OC extends gs{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function qh(s,e){return!s||s.constructor===e?s:typeof e.BYTES_PER_ELEMENT=="number"?new e(s):Array.prototype.slice.call(s)}function IC(s){return ArrayBuffer.isView(s)&&!(s instanceof DataView)}function zC(s){function e(i,a){return s[i]-s[a]}const t=s.length,n=new Array(t);for(let i=0;i!==t;++i)n[i]=i;return n.sort(e),n}function U_(s,e,t){const n=s.length,i=new s.constructor(n);for(let a=0,o=0;o!==n;++a){const c=t[a]*e;for(let u=0;u!==e;++u)i[o++]=s[c+u]}return i}function DS(s,e,t,n){let i=1,a=s[0];for(;a!==void 0&&a[n]===void 0;)a=s[i++];if(a===void 0)return;let o=a[n];if(o!==void 0)if(Array.isArray(o))do o=a[n],o!==void 0&&(e.push(a.time),t.push(...o)),a=s[i++];while(a!==void 0);else if(o.toArray!==void 0)do o=a[n],o!==void 0&&(e.push(a.time),o.toArray(t,t.length)),a=s[i++];while(a!==void 0);else do o=a[n],o!==void 0&&(e.push(a.time),t.push(o)),a=s[i++];while(a!==void 0)}function XD(s,e,t,n,i=30){const a=s.clone();a.name=e;const o=[];for(let u=0;u<a.tracks.length;++u){const h=a.tracks[u],m=h.getValueSize(),x=[],g=[];for(let b=0;b<h.times.length;++b){const S=h.times[b]*i;if(!(S<t||S>=n)){x.push(h.times[b]);for(let C=0;C<m;++C)g.push(h.values[b*m+C])}}x.length!==0&&(h.times=qh(x,h.times.constructor),h.values=qh(g,h.values.constructor),o.push(h))}a.tracks=o;let c=1/0;for(let u=0;u<a.tracks.length;++u)c>a.tracks[u].times[0]&&(c=a.tracks[u].times[0]);for(let u=0;u<a.tracks.length;++u)a.tracks[u].shift(-1*c);return a.resetDuration(),a}function YD(s,e=0,t=s,n=30){n<=0&&(n=30);const i=t.tracks.length,a=e/n;for(let o=0;o<i;++o){const c=t.tracks[o],u=c.ValueTypeName;if(u==="bool"||u==="string")continue;const h=s.tracks.find(function(A){return A.name===c.name&&A.ValueTypeName===u});if(h===void 0)continue;let m=0;const x=c.getValueSize();c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(m=x/3);let g=0;const b=h.getValueSize();h.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(g=b/3);const S=c.times.length-1;let C;if(a<=c.times[0]){const A=m,R=x-m;C=c.values.slice(A,R)}else if(a>=c.times[S]){const A=S*x+m,R=A+x-m;C=c.values.slice(A,R)}else{const A=c.createInterpolant(),R=m,N=x-m;A.evaluate(a),C=A.resultBuffer.slice(R,N)}u==="quaternion"&&new Fn().fromArray(C).normalize().conjugate().toArray(C);const M=h.times.length;for(let A=0;A<M;++A){const R=A*b+g;if(u==="quaternion")Fn.multiplyQuaternionsFlat(h.values,R,C,0,h.values,R);else{const N=b-g*2;for(let B=0;B<N;++B)h.values[R+B]-=C[B]}}}return s.blendMode=uS,s}class WD{static convertArray(e,t){return qh(e,t)}static isTypedArray(e){return IC(e)}static getKeyframeOrder(e){return zC(e)}static sortedArray(e,t,n){return U_(e,t,n)}static flattenJSON(e,t,n,i){DS(e,t,n,i)}static subclip(e,t,n,i,a=30){return XD(e,t,n,i,a)}static makeClipAdditive(e,t=0,n=e,i=30){return YD(e,t,n,i)}}class o0{constructor(e,t,n,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=i!==void 0?i:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,i=t[n],a=t[n-1];e:{t:{let o;n:{i:if(!(e<i)){for(let c=n+2;;){if(i===void 0){if(e<a)break i;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===c)break;if(a=i,i=t[++n],e<i)break t}o=t.length;break n}if(!(e>=a)){const c=t[1];e<c&&(n=2,a=c);for(let u=n-2;;){if(a===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===u)break;if(i=a,a=t[--n-1],e>=a)break t}o=n,n=0;break n}break e}for(;n<o;){const c=n+o>>>1;e<t[c]?o=c:n=c+1}if(i=t[n],a=t[n-1],a===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===void 0)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,a,i)}return this.interpolate_(n,a,e,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,i=this.valueSize,a=e*i;for(let o=0;o!==i;++o)t[o]=n[a+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class FC extends o0{constructor(e,t,n,i){super(e,t,n,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Xh,endingEnd:Xh}}intervalChanged_(e,t,n){const i=this.parameterPositions;let a=e-2,o=e+1,c=i[a],u=i[o];if(c===void 0)switch(this.getSettings_().endingStart){case Yh:a=e,c=2*t-n;break;case rx:a=i.length-2,c=t+i[a]-i[a+1];break;default:a=e,c=n}if(u===void 0)switch(this.getSettings_().endingEnd){case Yh:o=e,u=2*n-t;break;case rx:o=1,u=n+i[1]-i[0];break;default:o=e-1,u=t}const h=(n-t)*.5,m=this.valueSize;this._weightPrev=h/(t-c),this._weightNext=h/(u-n),this._offsetPrev=a*m,this._offsetNext=o*m}interpolate_(e,t,n,i){const a=this.resultBuffer,o=this.sampleValues,c=this.valueSize,u=e*c,h=u-c,m=this._offsetPrev,x=this._offsetNext,g=this._weightPrev,b=this._weightNext,S=(n-t)/(i-t),C=S*S,M=C*S,A=-g*M+2*g*C-g*S,R=(1+g)*M+(-1.5-2*g)*C+(-.5+g)*S+1,N=(-1-b)*M+(1.5+b)*C+.5*S,B=b*M-b*C;for(let F=0;F!==c;++F)a[F]=A*o[m+F]+R*o[h+F]+N*o[u+F]+B*o[x+F];return a}}class US extends o0{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e,t,n,i){const a=this.resultBuffer,o=this.sampleValues,c=this.valueSize,u=e*c,h=u-c,m=(n-t)/(i-t),x=1-m;for(let g=0;g!==c;++g)a[g]=o[h+g]*x+o[u+g]*m;return a}}class PC extends o0{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e){return this.copySampleValue_(e-1)}}class Tl{constructor(e,t,n,i){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=qh(t,this.TimeBufferType),this.values=qh(n,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:qh(e.times,Array),values:qh(e.values,Array)};const i=e.getInterpolation();i!==e.DefaultInterpolation&&(n.interpolation=i)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new PC(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new US(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new FC(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case kp:t=this.InterpolantFactoryMethodDiscrete;break;case Vp:t=this.InterpolantFactoryMethodLinear;break;case qv:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(n);return un("KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return kp;case this.InterpolantFactoryMethodLinear:return Vp;case this.InterpolantFactoryMethodSmooth:return qv}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]*=e}return this}trim(e,t){const n=this.times,i=n.length;let a=0,o=i-1;for(;a!==i&&n[a]<e;)++a;for(;o!==-1&&n[o]>t;)--o;if(++o,a!==0||o!==i){a>=o&&(o=Math.max(o,1),a=o-1);const c=this.getValueSize();this.times=n.slice(a,o),this.values=this.values.slice(a*c,o*c)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(Xn("KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,i=this.values,a=n.length;a===0&&(Xn("KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let c=0;c!==a;c++){const u=n[c];if(typeof u=="number"&&isNaN(u)){Xn("KeyframeTrack: Time is not a valid number.",this,c,u),e=!1;break}if(o!==null&&o>u){Xn("KeyframeTrack: Out of order keys.",this,c,u,o),e=!1;break}o=u}if(i!==void 0&&IC(i))for(let c=0,u=i.length;c!==u;++c){const h=i[c];if(isNaN(h)){Xn("KeyframeTrack: Value is not a valid number.",this,c,h),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),n=this.getValueSize(),i=this.getInterpolation()===qv,a=e.length-1;let o=1;for(let c=1;c<a;++c){let u=!1;const h=e[c],m=e[c+1];if(h!==m&&(c!==1||h!==e[0]))if(i)u=!0;else{const x=c*n,g=x-n,b=x+n;for(let S=0;S!==n;++S){const C=t[x+S];if(C!==t[g+S]||C!==t[b+S]){u=!0;break}}}if(u){if(c!==o){e[o]=e[c];const x=c*n,g=o*n;for(let b=0;b!==n;++b)t[g+b]=t[x+b]}++o}}if(a>0){e[o]=e[a];for(let c=a*n,u=o*n,h=0;h!==n;++h)t[u+h]=t[c+h];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=t.slice(0,o*n)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),n=this.constructor,i=new n(this.name,e,t);return i.createInterpolant=this.createInterpolant,i}}Tl.prototype.ValueTypeName="";Tl.prototype.TimeBufferType=Float32Array;Tl.prototype.ValueBufferType=Float32Array;Tl.prototype.DefaultInterpolation=Vp;class cd extends Tl{constructor(e,t,n){super(e,t,n)}}cd.prototype.ValueTypeName="bool";cd.prototype.ValueBufferType=Array;cd.prototype.DefaultInterpolation=kp;cd.prototype.InterpolantFactoryMethodLinear=void 0;cd.prototype.InterpolantFactoryMethodSmooth=void 0;class LS extends Tl{constructor(e,t,n,i){super(e,t,n,i)}}LS.prototype.ValueTypeName="color";class ad extends Tl{constructor(e,t,n,i){super(e,t,n,i)}}ad.prototype.ValueTypeName="number";class GC extends o0{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e,t,n,i){const a=this.resultBuffer,o=this.sampleValues,c=this.valueSize,u=(n-t)/(i-t);let h=e*c;for(let m=h+c;h!==m;h+=4)Fn.slerpFlat(a,0,o,h-c,o,h,u);return a}}class sd extends Tl{constructor(e,t,n,i){super(e,t,n,i)}InterpolantFactoryMethodLinear(e){return new GC(this.times,this.values,this.getValueSize(),e)}}sd.prototype.ValueTypeName="quaternion";sd.prototype.InterpolantFactoryMethodSmooth=void 0;class ud extends Tl{constructor(e,t,n){super(e,t,n)}}ud.prototype.ValueTypeName="string";ud.prototype.ValueBufferType=Array;ud.prototype.DefaultInterpolation=kp;ud.prototype.InterpolantFactoryMethodLinear=void 0;ud.prototype.InterpolantFactoryMethodSmooth=void 0;class rd extends Tl{constructor(e,t,n,i){super(e,t,n,i)}}rd.prototype.ValueTypeName="vector";class $p{constructor(e="",t=-1,n=[],i=hy){this.name=e,this.tracks=n,this.duration=t,this.blendMode=i,this.uuid=Wo(),this.userData={},this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,i=1/(e.fps||1);for(let o=0,c=n.length;o!==c;++o)t.push(JD(n[o]).scale(i));const a=new this(e.name,e.duration,t,e.blendMode);return a.uuid=e.uuid,a.userData=JSON.parse(e.userData||"{}"),a}static toJSON(e){const t=[],n=e.tracks,i={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode,userData:JSON.stringify(e.userData)};for(let a=0,o=n.length;a!==o;++a)t.push(Tl.toJSON(n[a]));return i}static CreateFromMorphTargetSequence(e,t,n,i){const a=t.length,o=[];for(let c=0;c<a;c++){let u=[],h=[];u.push((c+a-1)%a,c,(c+1)%a),h.push(0,1,0);const m=zC(u);u=U_(u,1,m),h=U_(h,1,m),!i&&u[0]===0&&(u.push(a),h.push(h[0])),o.push(new ad(".morphTargetInfluences["+t[c].name+"]",u,h).scale(1/n))}return new this(e,-1,o)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const i=e;n=i.geometry&&i.geometry.animations||i.animations}for(let i=0;i<n.length;i++)if(n[i].name===t)return n[i];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const i={},a=/^([\w-]*?)([\d]+)$/;for(let c=0,u=e.length;c<u;c++){const h=e[c],m=h.name.match(a);if(m&&m.length>1){const x=m[1];let g=i[x];g||(i[x]=g=[]),g.push(h)}}const o=[];for(const c in i)o.push(this.CreateFromMorphTargetSequence(c,i[c],t,n));return o}static parseAnimation(e,t){if(un("AnimationClip: parseAnimation() is deprecated and will be removed with r185"),!e)return Xn("AnimationClip: No animation in JSONLoader data."),null;const n=function(x,g,b,S,C){if(b.length!==0){const M=[],A=[];DS(b,M,A,S),M.length!==0&&C.push(new x(g,M,A))}},i=[],a=e.name||"default",o=e.fps||30,c=e.blendMode;let u=e.length||-1;const h=e.hierarchy||[];for(let x=0;x<h.length;x++){const g=h[x].keys;if(!(!g||g.length===0))if(g[0].morphTargets){const b={};let S;for(S=0;S<g.length;S++)if(g[S].morphTargets)for(let C=0;C<g[S].morphTargets.length;C++)b[g[S].morphTargets[C]]=-1;for(const C in b){const M=[],A=[];for(let R=0;R!==g[S].morphTargets.length;++R){const N=g[S];M.push(N.time),A.push(N.morphTarget===C?1:0)}i.push(new ad(".morphTargetInfluence["+C+"]",M,A))}u=b.length*o}else{const b=".bones["+t[x].name+"]";n(rd,b+".position",g,"pos",i),n(sd,b+".quaternion",g,"rot",i),n(rd,b+".scale",g,"scl",i)}}return i.length===0?null:new this(a,u,i,c)}resetDuration(){const e=this.tracks;let t=0;for(let n=0,i=e.length;n!==i;++n){const a=this.tracks[n];t=Math.max(t,a.times[a.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let n=0;n<this.tracks.length;n++)e.push(this.tracks[n].clone());const t=new this.constructor(this.name,this.duration,e,this.blendMode);return t.userData=JSON.parse(JSON.stringify(this.userData)),t}toJSON(){return this.constructor.toJSON(this)}}function qD(s){switch(s.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return ad;case"vector":case"vector2":case"vector3":case"vector4":return rd;case"color":return LS;case"quaternion":return sd;case"bool":case"boolean":return cd;case"string":return ud}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+s)}function JD(s){if(s.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=qD(s.type);if(s.times===void 0){const t=[],n=[];DS(s.keys,t,n,"value"),s.times=t,s.values=n}return e.parse!==void 0?e.parse(s):new e(s.name,s.times,s.values,s.interpolation)}const Wc={enabled:!1,files:{},add:function(s,e){this.enabled!==!1&&(this.files[s]=e)},get:function(s){if(this.enabled!==!1)return this.files[s]},remove:function(s){delete this.files[s]},clear:function(){this.files={}}};class Uy{constructor(e,t,n){const i=this;let a=!1,o=0,c=0,u;const h=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this._abortController=null,this.itemStart=function(m){c++,a===!1&&i.onStart!==void 0&&i.onStart(m,o,c),a=!0},this.itemEnd=function(m){o++,i.onProgress!==void 0&&i.onProgress(m,o,c),o===c&&(a=!1,i.onLoad!==void 0&&i.onLoad())},this.itemError=function(m){i.onError!==void 0&&i.onError(m)},this.resolveURL=function(m){return u?u(m):m},this.setURLModifier=function(m){return u=m,this},this.addHandler=function(m,x){return h.push(m,x),this},this.removeHandler=function(m){const x=h.indexOf(m);return x!==-1&&h.splice(x,2),this},this.getHandler=function(m){for(let x=0,g=h.length;x<g;x+=2){const b=h[x],S=h[x+1];if(b.global&&(b.lastIndex=0),b.test(m))return S}return null},this.abort=function(){return this.abortController.abort(),this._abortController=null,this}}get abortController(){return this._abortController||(this._abortController=new AbortController),this._abortController}}const jC=new Uy;class Ws{constructor(e){this.manager=e!==void 0?e:jC,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise(function(i,a){n.load(e,i,t,a)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}abort(){return this}}Ws.DEFAULT_MATERIAL_NAME="__DEFAULT";const Uu={};class ZD extends Error{constructor(e,t){super(e),this.response=t}}class Xs extends Ws{constructor(e){super(e),this.mimeType="",this.responseType="",this._abortController=new AbortController}load(e,t,n,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const a=Wc.get(`file:${e}`);if(a!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(a),this.manager.itemEnd(e)},0),a;if(Uu[e]!==void 0){Uu[e].push({onLoad:t,onProgress:n,onError:i});return}Uu[e]=[],Uu[e].push({onLoad:t,onProgress:n,onError:i});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin",signal:typeof AbortSignal.any=="function"?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal}),c=this.mimeType,u=this.responseType;fetch(o).then(h=>{if(h.status===200||h.status===0){if(h.status===0&&un("FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||h.body===void 0||h.body.getReader===void 0)return h;const m=Uu[e],x=h.body.getReader(),g=h.headers.get("X-File-Size")||h.headers.get("Content-Length"),b=g?parseInt(g):0,S=b!==0;let C=0;const M=new ReadableStream({start(A){R();function R(){x.read().then(({done:N,value:B})=>{if(N)A.close();else{C+=B.byteLength;const F=new ProgressEvent("progress",{lengthComputable:S,loaded:C,total:b});for(let U=0,z=m.length;U<z;U++){const P=m[U];P.onProgress&&P.onProgress(F)}A.enqueue(B),R()}},N=>{A.error(N)})}}});return new Response(M)}else throw new ZD(`fetch for "${h.url}" responded with ${h.status}: ${h.statusText}`,h)}).then(h=>{switch(u){case"arraybuffer":return h.arrayBuffer();case"blob":return h.blob();case"document":return h.text().then(m=>new DOMParser().parseFromString(m,c));case"json":return h.json();default:if(c==="")return h.text();{const x=/charset="?([^;"\s]*)"?/i.exec(c),g=x&&x[1]?x[1].toLowerCase():void 0,b=new TextDecoder(g);return h.arrayBuffer().then(S=>b.decode(S))}}}).then(h=>{Wc.add(`file:${e}`,h);const m=Uu[e];delete Uu[e];for(let x=0,g=m.length;x<g;x++){const b=m[x];b.onLoad&&b.onLoad(h)}}).catch(h=>{const m=Uu[e];if(m===void 0)throw this.manager.itemError(e),h;delete Uu[e];for(let x=0,g=m.length;x<g;x++){const b=m[x];b.onError&&b.onError(h)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}class KD extends Ws{constructor(e){super(e)}load(e,t,n,i){const a=this,o=new Xs(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(c){try{t(a.parse(JSON.parse(c)))}catch(u){i?i(u):Xn(u),a.manager.itemError(e)}},n,i)}parse(e){const t=[];for(let n=0;n<e.length;n++){const i=$p.parse(e[n]);t.push(i)}return t}}class QD extends Ws{constructor(e){super(e)}load(e,t,n,i){const a=this,o=[],c=new by,u=new Xs(this.manager);u.setPath(this.path),u.setResponseType("arraybuffer"),u.setRequestHeader(this.requestHeader),u.setWithCredentials(a.withCredentials);let h=0;function m(x){u.load(e[x],function(g){const b=a.parse(g,!0);o[x]={width:b.width,height:b.height,format:b.format,mipmaps:b.mipmaps},h+=1,h===6&&(b.mipmapCount===1&&(c.minFilter=bi),c.image=o,c.format=b.format,c.needsUpdate=!0,t&&t(c))},n,i)}if(Array.isArray(e))for(let x=0,g=e.length;x<g;++x)m(x);else u.load(e,function(x){const g=a.parse(x,!0);if(g.isCubemap){const b=g.mipmaps.length/g.mipmapCount;for(let S=0;S<b;S++){o[S]={mipmaps:[]};for(let C=0;C<g.mipmapCount;C++)o[S].mipmaps.push(g.mipmaps[S*g.mipmapCount+C]),o[S].format=g.format,o[S].width=g.width,o[S].height=g.height}c.image=o}else c.image.width=g.width,c.image.height=g.height,c.mipmaps=g.mipmaps;g.mipmapCount===1&&(c.minFilter=bi),c.format=g.format,c.needsUpdate=!0,t&&t(c)},n,i);return c}}const vp=new WeakMap;class px extends Ws{constructor(e){super(e)}load(e,t,n,i){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const a=this,o=Wc.get(`image:${e}`);if(o!==void 0){if(o.complete===!0)a.manager.itemStart(e),setTimeout(function(){t&&t(o),a.manager.itemEnd(e)},0);else{let x=vp.get(o);x===void 0&&(x=[],vp.set(o,x)),x.push({onLoad:t,onError:i})}return o}const c=cx("img");function u(){m(),t&&t(this);const x=vp.get(this)||[];for(let g=0;g<x.length;g++){const b=x[g];b.onLoad&&b.onLoad(this)}vp.delete(this),a.manager.itemEnd(e)}function h(x){m(),i&&i(x),Wc.remove(`image:${e}`);const g=vp.get(this)||[];for(let b=0;b<g.length;b++){const S=g[b];S.onError&&S.onError(x)}vp.delete(this),a.manager.itemError(e),a.manager.itemEnd(e)}function m(){c.removeEventListener("load",u,!1),c.removeEventListener("error",h,!1)}return c.addEventListener("load",u,!1),c.addEventListener("error",h,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(c.crossOrigin=this.crossOrigin),Wc.add(`image:${e}`,c),a.manager.itemStart(e),c.src=e,c}}class HC extends Ws{constructor(e){super(e)}load(e,t,n,i){const a=new Mx;a.colorSpace=Hs;const o=new px(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let c=0;function u(h){o.load(e[h],function(m){a.images[h]=m,c++,c===6&&(a.needsUpdate=!0,t&&t(a))},void 0,i)}for(let h=0;h<e.length;++h)u(h);return a}}class OS extends Ws{constructor(e){super(e)}load(e,t,n,i){const a=this,o=new wl,c=new Xs(this.manager);return c.setResponseType("arraybuffer"),c.setRequestHeader(this.requestHeader),c.setPath(this.path),c.setWithCredentials(a.withCredentials),c.load(e,function(u){let h;try{h=a.parse(u)}catch(m){if(i!==void 0)i(m);else{m(m);return}}h.image!==void 0?o.image=h.image:h.data!==void 0&&(o.image.width=h.width,o.image.height=h.height,o.image.data=h.data),o.wrapS=h.wrapS!==void 0?h.wrapS:Pa,o.wrapT=h.wrapT!==void 0?h.wrapT:Pa,o.magFilter=h.magFilter!==void 0?h.magFilter:bi,o.minFilter=h.minFilter!==void 0?h.minFilter:bi,o.anisotropy=h.anisotropy!==void 0?h.anisotropy:1,h.colorSpace!==void 0&&(o.colorSpace=h.colorSpace),h.flipY!==void 0&&(o.flipY=h.flipY),h.format!==void 0&&(o.format=h.format),h.type!==void 0&&(o.type=h.type),h.mipmaps!==void 0&&(o.mipmaps=h.mipmaps,o.minFilter=Al),h.mipmapCount===1&&(o.minFilter=bi),h.generateMipmaps!==void 0&&(o.generateMipmaps=h.generateMipmaps),o.needsUpdate=!0,t&&t(o,h)},n,i),o}}class kC extends Ws{constructor(e){super(e)}load(e,t,n,i){const a=new Wi,o=new px(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(c){a.image=c,a.needsUpdate=!0,t!==void 0&&t(a)},n,i),a}}class Hf extends ai{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new qt(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(t.object.target=this.target.uuid),t}}class VC extends Hf{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(ai.DEFAULT_UP),this.updateMatrix(),this.groundColor=new qt(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const c2=new wn,rw=new k,ow=new k;class IS{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new gt(512,512),this.mapType=uo,this.map=null,this.mapPass=null,this.matrix=new wn,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new s0,this._frameExtents=new gt(1,1),this._viewportCount=1,this._viewports=[new oi(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;rw.setFromMatrixPosition(e.matrixWorld),t.position.copy(rw),ow.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(ow),t.updateMatrixWorld(),c2.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(c2,t.coordinateSystem,t.reversedDepth),t.reversedDepth?n.set(.5,0,0,.5,0,.5,0,.5,0,0,1,0,0,0,0,1):n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(c2)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class $D extends IS{constructor(){super(new Ba(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1,this.aspect=1}updateMatrices(e){const t=this.camera,n=Wp*2*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height*this.aspect,a=e.distance||t.far;(n!==t.fov||i!==t.aspect||a!==t.far)&&(t.fov=n,t.aspect=i,t.far=a,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class zS extends Hf{constructor(e,t,n=0,i=Math.PI/3,a=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(ai.DEFAULT_UP),this.updateMatrix(),this.target=new ai,this.distance=n,this.angle=i,this.penumbra=a,this.decay=o,this.map=null,this.shadow=new $D}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const lw=new wn,Tm=new k,u2=new k;class e5 extends IS{constructor(){super(new Ba(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new gt(4,2),this._viewportCount=6,this._viewports=[new oi(2,1,1,1),new oi(0,1,1,1),new oi(3,1,1,1),new oi(1,1,1,1),new oi(3,0,1,1),new oi(1,0,1,1)],this._cubeDirections=[new k(1,0,0),new k(-1,0,0),new k(0,0,1),new k(0,0,-1),new k(0,1,0),new k(0,-1,0)],this._cubeUps=[new k(0,1,0),new k(0,1,0),new k(0,1,0),new k(0,1,0),new k(0,0,1),new k(0,0,-1)]}updateMatrices(e,t=0){const n=this.camera,i=this.matrix,a=e.distance||n.far;a!==n.far&&(n.far=a,n.updateProjectionMatrix()),Tm.setFromMatrixPosition(e.matrixWorld),n.position.copy(Tm),u2.copy(n.position),u2.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(u2),n.updateMatrixWorld(),i.makeTranslation(-Tm.x,-Tm.y,-Tm.z),lw.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(lw,n.coordinateSystem,n.reversedDepth)}}class FS extends Hf{constructor(e,t,n=0,i=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=i,this.shadow=new e5}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}let El=class extends my{constructor(e=-1,t=1,n=1,i=-1,a=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=i,this.near=a,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,n,i,a,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=a,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let a=n-e,o=n+e,c=i+t,u=i-t;if(this.view!==null&&this.view.enabled){const h=(this.right-this.left)/this.view.fullWidth/this.zoom,m=(this.top-this.bottom)/this.view.fullHeight/this.zoom;a+=h*this.view.offsetX,o=a+h*this.view.width,c-=m*this.view.offsetY,u=c-m*this.view.height}this.projectionMatrix.makeOrthographic(a,o,c,u,this.near,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}};class t5 extends IS{constructor(){super(new El(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class PS extends Hf{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(ai.DEFAULT_UP),this.updateMatrix(),this.target=new ai,this.shadow=new t5}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class XC extends Hf{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class YC extends Hf{constructor(e,t,n=10,i=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=i}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class WC{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new k)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,i=e.y,a=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.282095),t.addScaledVector(o[1],.488603*i),t.addScaledVector(o[2],.488603*a),t.addScaledVector(o[3],.488603*n),t.addScaledVector(o[4],1.092548*(n*i)),t.addScaledVector(o[5],1.092548*(i*a)),t.addScaledVector(o[6],.315392*(3*a*a-1)),t.addScaledVector(o[7],1.092548*(n*a)),t.addScaledVector(o[8],.546274*(n*n-i*i)),t}getIrradianceAt(e,t){const n=e.x,i=e.y,a=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.886227),t.addScaledVector(o[1],2*.511664*i),t.addScaledVector(o[2],2*.511664*a),t.addScaledVector(o[3],2*.511664*n),t.addScaledVector(o[4],2*.429043*n*i),t.addScaledVector(o[5],2*.429043*i*a),t.addScaledVector(o[6],.743125*a*a-.247708),t.addScaledVector(o[7],2*.429043*n*a),t.addScaledVector(o[8],.429043*(n*n-i*i)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const n=this.coefficients;for(let i=0;i<9;i++)n[i].fromArray(e,t+i*3);return this}toArray(e=[],t=0){const n=this.coefficients;for(let i=0;i<9;i++)n[i].toArray(e,t+i*3);return e}static getBasisAt(e,t){const n=e.x,i=e.y,a=e.z;t[0]=.282095,t[1]=.488603*i,t[2]=.488603*a,t[3]=.488603*n,t[4]=1.092548*n*i,t[5]=1.092548*i*a,t[6]=.315392*(3*a*a-1),t[7]=1.092548*n*a,t[8]=.546274*(n*n-i*i)}}class qC extends Hf{constructor(e=new WC,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class Ly extends Ws{constructor(e){super(e),this.textures={}}load(e,t,n,i){const a=this,o=new Xs(a.manager);o.setPath(a.path),o.setRequestHeader(a.requestHeader),o.setWithCredentials(a.withCredentials),o.load(e,function(c){try{t(a.parse(JSON.parse(c)))}catch(u){i?i(u):Xn(u),a.manager.itemError(e)}},n,i)}parse(e){const t=this.textures;function n(a){return t[a]===void 0&&un("MaterialLoader: Undefined texture",a),t[a]}const i=this.createMaterialFromType(e.type);if(e.uuid!==void 0&&(i.uuid=e.uuid),e.name!==void 0&&(i.name=e.name),e.color!==void 0&&i.color!==void 0&&i.color.setHex(e.color),e.roughness!==void 0&&(i.roughness=e.roughness),e.metalness!==void 0&&(i.metalness=e.metalness),e.sheen!==void 0&&(i.sheen=e.sheen),e.sheenColor!==void 0&&(i.sheenColor=new qt().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(i.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&i.emissive!==void 0&&i.emissive.setHex(e.emissive),e.specular!==void 0&&i.specular!==void 0&&i.specular.setHex(e.specular),e.specularIntensity!==void 0&&(i.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&i.specularColor!==void 0&&i.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(i.shininess=e.shininess),e.clearcoat!==void 0&&(i.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=e.clearcoatRoughness),e.dispersion!==void 0&&(i.dispersion=e.dispersion),e.iridescence!==void 0&&(i.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(i.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(i.transmission=e.transmission),e.thickness!==void 0&&(i.thickness=e.thickness),e.attenuationDistance!==void 0&&(i.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&i.attenuationColor!==void 0&&i.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(i.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(i.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(i.fog=e.fog),e.flatShading!==void 0&&(i.flatShading=e.flatShading),e.blending!==void 0&&(i.blending=e.blending),e.combine!==void 0&&(i.combine=e.combine),e.side!==void 0&&(i.side=e.side),e.shadowSide!==void 0&&(i.shadowSide=e.shadowSide),e.opacity!==void 0&&(i.opacity=e.opacity),e.transparent!==void 0&&(i.transparent=e.transparent),e.alphaTest!==void 0&&(i.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(i.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(i.depthFunc=e.depthFunc),e.depthTest!==void 0&&(i.depthTest=e.depthTest),e.depthWrite!==void 0&&(i.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(i.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(i.blendSrc=e.blendSrc),e.blendDst!==void 0&&(i.blendDst=e.blendDst),e.blendEquation!==void 0&&(i.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(i.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(i.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(i.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&i.blendColor!==void 0&&i.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(i.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(i.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(i.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(i.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(i.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(i.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(i.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(i.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(i.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(i.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(i.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(i.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(i.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(i.rotation=e.rotation),e.linewidth!==void 0&&(i.linewidth=e.linewidth),e.dashSize!==void 0&&(i.dashSize=e.dashSize),e.gapSize!==void 0&&(i.gapSize=e.gapSize),e.scale!==void 0&&(i.scale=e.scale),e.polygonOffset!==void 0&&(i.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(i.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(i.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(i.dithering=e.dithering),e.alphaToCoverage!==void 0&&(i.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(i.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(i.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(i.visible=e.visible),e.toneMapped!==void 0&&(i.toneMapped=e.toneMapped),e.userData!==void 0&&(i.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?i.vertexColors=e.vertexColors>0:i.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const a in e.uniforms){const o=e.uniforms[a];switch(i.uniforms[a]={},o.type){case"t":i.uniforms[a].value=n(o.value);break;case"c":i.uniforms[a].value=new qt().setHex(o.value);break;case"v2":i.uniforms[a].value=new gt().fromArray(o.value);break;case"v3":i.uniforms[a].value=new k().fromArray(o.value);break;case"v4":i.uniforms[a].value=new oi().fromArray(o.value);break;case"m3":i.uniforms[a].value=new Qn().fromArray(o.value);break;case"m4":i.uniforms[a].value=new wn().fromArray(o.value);break;default:i.uniforms[a].value=o.value}}if(e.defines!==void 0&&(i.defines=e.defines),e.vertexShader!==void 0&&(i.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(i.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(i.glslVersion=e.glslVersion),e.extensions!==void 0)for(const a in e.extensions)i.extensions[a]=e.extensions[a];if(e.lights!==void 0&&(i.lights=e.lights),e.clipping!==void 0&&(i.clipping=e.clipping),e.size!==void 0&&(i.size=e.size),e.sizeAttenuation!==void 0&&(i.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(i.map=n(e.map)),e.matcap!==void 0&&(i.matcap=n(e.matcap)),e.alphaMap!==void 0&&(i.alphaMap=n(e.alphaMap)),e.bumpMap!==void 0&&(i.bumpMap=n(e.bumpMap)),e.bumpScale!==void 0&&(i.bumpScale=e.bumpScale),e.normalMap!==void 0&&(i.normalMap=n(e.normalMap)),e.normalMapType!==void 0&&(i.normalMapType=e.normalMapType),e.normalScale!==void 0){let a=e.normalScale;Array.isArray(a)===!1&&(a=[a,a]),i.normalScale=new gt().fromArray(a)}return e.displacementMap!==void 0&&(i.displacementMap=n(e.displacementMap)),e.displacementScale!==void 0&&(i.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(i.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(i.roughnessMap=n(e.roughnessMap)),e.metalnessMap!==void 0&&(i.metalnessMap=n(e.metalnessMap)),e.emissiveMap!==void 0&&(i.emissiveMap=n(e.emissiveMap)),e.emissiveIntensity!==void 0&&(i.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(i.specularMap=n(e.specularMap)),e.specularIntensityMap!==void 0&&(i.specularIntensityMap=n(e.specularIntensityMap)),e.specularColorMap!==void 0&&(i.specularColorMap=n(e.specularColorMap)),e.envMap!==void 0&&(i.envMap=n(e.envMap)),e.envMapRotation!==void 0&&i.envMapRotation.fromArray(e.envMapRotation),e.envMapIntensity!==void 0&&(i.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(i.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(i.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(i.lightMap=n(e.lightMap)),e.lightMapIntensity!==void 0&&(i.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(i.aoMap=n(e.aoMap)),e.aoMapIntensity!==void 0&&(i.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(i.gradientMap=n(e.gradientMap)),e.clearcoatMap!==void 0&&(i.clearcoatMap=n(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(i.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(i.clearcoatNormalMap=n(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(i.clearcoatNormalScale=new gt().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(i.iridescenceMap=n(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(i.iridescenceThicknessMap=n(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(i.transmissionMap=n(e.transmissionMap)),e.thicknessMap!==void 0&&(i.thicknessMap=n(e.thicknessMap)),e.anisotropyMap!==void 0&&(i.anisotropyMap=n(e.anisotropyMap)),e.sheenColorMap!==void 0&&(i.sheenColorMap=n(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(i.sheenRoughnessMap=n(e.sheenRoughnessMap)),i}setTextures(e){return this.textures=e,this}createMaterialFromType(e){return Ly.createMaterialFromType(e)}static createMaterialFromType(e){const t={ShadowMaterial:RC,SpriteMaterial:yS,RawShaderMaterial:NC,ShaderMaterial:Ys,PointsMaterial:Tf,MeshPhysicalMaterial:Cl,MeshStandardMaterial:Rx,MeshPhongMaterial:BS,MeshToonMaterial:BC,MeshNormalMaterial:DC,MeshLambertMaterial:UC,MeshDepthMaterial:By,MeshDistanceMaterial:Dy,MeshBasicMaterial:ur,MeshMatcapMaterial:LC,LineDashedMaterial:OC,LineBasicMaterial:gs,Material:os};return new t[e]}}class Df{static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class Oy extends Rn{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class JC extends Ws{constructor(e){super(e)}load(e,t,n,i){const a=this,o=new Xs(a.manager);o.setPath(a.path),o.setRequestHeader(a.requestHeader),o.setWithCredentials(a.withCredentials),o.load(e,function(c){try{t(a.parse(JSON.parse(c)))}catch(u){i?i(u):Xn(u),a.manager.itemError(e)}},n,i)}parse(e){const t={},n={};function i(b,S){if(t[S]!==void 0)return t[S];const M=b.interleavedBuffers[S],A=a(b,M.buffer),R=Bp(M.type,A),N=new wx(R,M.stride);return N.uuid=M.uuid,t[S]=N,N}function a(b,S){if(n[S]!==void 0)return n[S];const M=b.arrayBuffers[S],A=new Uint32Array(M).buffer;return n[S]=A,A}const o=e.isInstancedBufferGeometry?new Oy:new Rn,c=e.data.index;if(c!==void 0){const b=Bp(c.type,c.array);o.setIndex(new Ii(b,1))}const u=e.data.attributes;for(const b in u){const S=u[b];let C;if(S.isInterleavedBufferAttribute){const M=i(e.data,S.data);C=new Co(M,S.itemSize,S.offset,S.normalized)}else{const M=Bp(S.type,S.array),A=S.isInstancedBufferAttribute?Ff:Ii;C=new A(M,S.itemSize,S.normalized)}S.name!==void 0&&(C.name=S.name),S.usage!==void 0&&C.setUsage(S.usage),o.setAttribute(b,C)}const h=e.data.morphAttributes;if(h)for(const b in h){const S=h[b],C=[];for(let M=0,A=S.length;M<A;M++){const R=S[M];let N;if(R.isInterleavedBufferAttribute){const B=i(e.data,R.data);N=new Co(B,R.itemSize,R.offset,R.normalized)}else{const B=Bp(R.type,R.array);N=new Ii(B,R.itemSize,R.normalized)}R.name!==void 0&&(N.name=R.name),C.push(N)}o.morphAttributes[b]=C}e.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);const x=e.data.groups||e.data.drawcalls||e.data.offsets;if(x!==void 0)for(let b=0,S=x.length;b!==S;++b){const C=x[b];o.addGroup(C.start,C.count,C.materialIndex)}const g=e.data.boundingSphere;return g!==void 0&&(o.boundingSphere=new rs().fromJSON(g)),e.name&&(o.name=e.name),e.userData&&(o.userData=e.userData),o}}class n5 extends Ws{constructor(e){super(e)}load(e,t,n,i){const a=this,o=this.path===""?Df.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;const c=new Xs(this.manager);c.setPath(this.path),c.setRequestHeader(this.requestHeader),c.setWithCredentials(this.withCredentials),c.load(e,function(u){let h=null;try{h=JSON.parse(u)}catch(x){i!==void 0&&i(x),x("ObjectLoader: Can't parse "+e+".",x.message);return}const m=h.metadata;if(m===void 0||m.type===void 0||m.type.toLowerCase()==="geometry"){i!==void 0&&i(new Error("THREE.ObjectLoader: Can't load "+e)),Xn("ObjectLoader: Can't load "+e);return}a.parse(h,t)},n,i)}async loadAsync(e,t){const n=this,i=this.path===""?Df.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||i;const a=new Xs(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials);const o=await a.loadAsync(e,t),c=JSON.parse(o),u=c.metadata;if(u===void 0||u.type===void 0||u.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await n.parseAsync(c)}parse(e,t){const n=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),a=this.parseGeometries(e.geometries,i),o=this.parseImages(e.images,function(){t!==void 0&&t(h)}),c=this.parseTextures(e.textures,o),u=this.parseMaterials(e.materials,c),h=this.parseObject(e.object,a,u,c,n),m=this.parseSkeletons(e.skeletons,h);if(this.bindSkeletons(h,m),this.bindLightTargets(h),t!==void 0){let x=!1;for(const g in o)if(o[g].data instanceof HTMLImageElement){x=!0;break}x===!1&&t(h)}return h}async parseAsync(e){const t=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),i=this.parseGeometries(e.geometries,n),a=await this.parseImagesAsync(e.images),o=this.parseTextures(e.textures,a),c=this.parseMaterials(e.materials,o),u=this.parseObject(e.object,i,c,o,t),h=this.parseSkeletons(e.skeletons,u);return this.bindSkeletons(u,h),this.bindLightTargets(u),u}parseShapes(e){const t={};if(e!==void 0)for(let n=0,i=e.length;n<i;n++){const a=new Jc().fromJSON(e[n]);t[a.uuid]=a}return t}parseSkeletons(e,t){const n={},i={};if(t.traverse(function(a){a.isBone&&(i[a.uuid]=a)}),e!==void 0)for(let a=0,o=e.length;a<o;a++){const c=new Ex().fromJSON(e[a],i);n[c.uuid]=c}return n}parseGeometries(e,t){const n={};if(e!==void 0){const i=new JC;for(let a=0,o=e.length;a<o;a++){let c;const u=e[a];switch(u.type){case"BufferGeometry":case"InstancedBufferGeometry":c=i.parse(u);break;default:u.type in sw?c=sw[u.type].fromJSON(u,t):un(`ObjectLoader: Unsupported geometry type "${u.type}"`)}c.uuid=u.uuid,u.name!==void 0&&(c.name=u.name),u.userData!==void 0&&(c.userData=u.userData),n[u.uuid]=c}}return n}parseMaterials(e,t){const n={},i={};if(e!==void 0){const a=new Ly;a.setTextures(t);for(let o=0,c=e.length;o<c;o++){const u=e[o];n[u.uuid]===void 0&&(n[u.uuid]=a.parse(u)),i[u.uuid]=n[u.uuid]}}return i}parseAnimations(e){const t={};if(e!==void 0)for(let n=0;n<e.length;n++){const i=e[n],a=$p.parse(i);t[a.uuid]=a}return t}parseImages(e,t){const n=this,i={};let a;function o(u){return n.manager.itemStart(u),a.load(u,function(){n.manager.itemEnd(u)},void 0,function(){n.manager.itemError(u),n.manager.itemEnd(u)})}function c(u){if(typeof u=="string"){const h=u,m=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(h)?h:n.resourcePath+h;return o(m)}else return u.data?{data:Bp(u.type,u.data),width:u.width,height:u.height}:null}if(e!==void 0&&e.length>0){const u=new Uy(t);a=new px(u),a.setCrossOrigin(this.crossOrigin);for(let h=0,m=e.length;h<m;h++){const x=e[h],g=x.url;if(Array.isArray(g)){const b=[];for(let S=0,C=g.length;S<C;S++){const M=g[S],A=c(M);A!==null&&(A instanceof HTMLImageElement?b.push(A):b.push(new wl(A.data,A.width,A.height)))}i[x.uuid]=new Cf(b)}else{const b=c(x.url);i[x.uuid]=new Cf(b)}}}return i}async parseImagesAsync(e){const t=this,n={};let i;async function a(o){if(typeof o=="string"){const c=o,u=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c)?c:t.resourcePath+c;return await i.loadAsync(u)}else return o.data?{data:Bp(o.type,o.data),width:o.width,height:o.height}:null}if(e!==void 0&&e.length>0){i=new px(this.manager),i.setCrossOrigin(this.crossOrigin);for(let o=0,c=e.length;o<c;o++){const u=e[o],h=u.url;if(Array.isArray(h)){const m=[];for(let x=0,g=h.length;x<g;x++){const b=h[x],S=await a(b);S!==null&&(S instanceof HTMLImageElement?m.push(S):m.push(new wl(S.data,S.width,S.height)))}n[u.uuid]=new Cf(m)}else{const m=await a(u.url);n[u.uuid]=new Cf(m)}}}return n}parseTextures(e,t){function n(a,o){return typeof a=="number"?a:(un("ObjectLoader.parseTexture: Constant should be in numeric form.",a),o[a])}const i={};if(e!==void 0)for(let a=0,o=e.length;a<o;a++){const c=e[a];c.image===void 0&&un('ObjectLoader: No "image" specified for',c.uuid),t[c.image]===void 0&&un("ObjectLoader: Undefined image",c.image);const u=t[c.image],h=u.data;let m;Array.isArray(h)?(m=new Mx,h.length===6&&(m.needsUpdate=!0)):(h&&h.data?m=new wl:m=new Wi,h&&(m.needsUpdate=!0)),m.source=u,m.uuid=c.uuid,c.name!==void 0&&(m.name=c.name),c.mapping!==void 0&&(m.mapping=n(c.mapping,i5)),c.channel!==void 0&&(m.channel=c.channel),c.offset!==void 0&&m.offset.fromArray(c.offset),c.repeat!==void 0&&m.repeat.fromArray(c.repeat),c.center!==void 0&&m.center.fromArray(c.center),c.rotation!==void 0&&(m.rotation=c.rotation),c.wrap!==void 0&&(m.wrapS=n(c.wrap[0],cw),m.wrapT=n(c.wrap[1],cw)),c.format!==void 0&&(m.format=c.format),c.internalFormat!==void 0&&(m.internalFormat=c.internalFormat),c.type!==void 0&&(m.type=c.type),c.colorSpace!==void 0&&(m.colorSpace=c.colorSpace),c.minFilter!==void 0&&(m.minFilter=n(c.minFilter,uw)),c.magFilter!==void 0&&(m.magFilter=n(c.magFilter,uw)),c.anisotropy!==void 0&&(m.anisotropy=c.anisotropy),c.flipY!==void 0&&(m.flipY=c.flipY),c.generateMipmaps!==void 0&&(m.generateMipmaps=c.generateMipmaps),c.premultiplyAlpha!==void 0&&(m.premultiplyAlpha=c.premultiplyAlpha),c.unpackAlignment!==void 0&&(m.unpackAlignment=c.unpackAlignment),c.compareFunction!==void 0&&(m.compareFunction=c.compareFunction),c.userData!==void 0&&(m.userData=c.userData),i[c.uuid]=m}return i}parseObject(e,t,n,i,a){let o;function c(g){return t[g]===void 0&&un("ObjectLoader: Undefined geometry",g),t[g]}function u(g){if(g!==void 0){if(Array.isArray(g)){const b=[];for(let S=0,C=g.length;S<C;S++){const M=g[S];n[M]===void 0&&un("ObjectLoader: Undefined material",M),b.push(n[M])}return b}return n[g]===void 0&&un("ObjectLoader: Undefined material",g),n[g]}}function h(g){return i[g]===void 0&&un("ObjectLoader: Undefined texture",g),i[g]}let m,x;switch(e.type){case"Scene":o=new a0,e.background!==void 0&&(Number.isInteger(e.background)?o.background=new qt(e.background):o.background=h(e.background)),e.environment!==void 0&&(o.environment=h(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?o.fog=new gy(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(o.fog=new xy(e.fog.color,e.fog.density)),e.fog.name!==""&&(o.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(o.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(o.backgroundIntensity=e.backgroundIntensity),e.backgroundRotation!==void 0&&o.backgroundRotation.fromArray(e.backgroundRotation),e.environmentIntensity!==void 0&&(o.environmentIntensity=e.environmentIntensity),e.environmentRotation!==void 0&&o.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":o=new Ba(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(o.focus=e.focus),e.zoom!==void 0&&(o.zoom=e.zoom),e.filmGauge!==void 0&&(o.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(o.filmOffset=e.filmOffset),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new El(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(o.zoom=e.zoom),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"AmbientLight":o=new XC(e.color,e.intensity);break;case"DirectionalLight":o=new PS(e.color,e.intensity),o.target=e.target||"";break;case"PointLight":o=new FS(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new YC(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new zS(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay),o.target=e.target||"";break;case"HemisphereLight":o=new VC(e.color,e.groundColor,e.intensity);break;case"LightProbe":o=new qC().fromJSON(e);break;case"SkinnedMesh":m=c(e.geometry),x=u(e.material),o=new bS(m,x),e.bindMode!==void 0&&(o.bindMode=e.bindMode),e.bindMatrix!==void 0&&o.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(o.skeleton=e.skeleton);break;case"Mesh":m=c(e.geometry),x=u(e.material),o=new sn(m,x);break;case"InstancedMesh":m=c(e.geometry),x=u(e.material);const g=e.count,b=e.instanceMatrix,S=e.instanceColor;o=new _S(m,x,g),o.instanceMatrix=new Ff(new Float32Array(b.array),16),S!==void 0&&(o.instanceColor=new Ff(new Float32Array(S.array),S.itemSize));break;case"BatchedMesh":m=c(e.geometry),x=u(e.material),o=new gC(e.maxInstanceCount,e.maxVertexCount,e.maxIndexCount,x),o.geometry=m,o.perObjectFrustumCulled=e.perObjectFrustumCulled,o.sortObjects=e.sortObjects,o._drawRanges=e.drawRanges,o._reservedRanges=e.reservedRanges,o._geometryInfo=e.geometryInfo.map(C=>{let M=null,A=null;return C.boundingBox!==void 0&&(M=new Yi().fromJSON(C.boundingBox)),C.boundingSphere!==void 0&&(A=new rs().fromJSON(C.boundingSphere)),{...C,boundingBox:M,boundingSphere:A}}),o._instanceInfo=e.instanceInfo,o._availableInstanceIds=e._availableInstanceIds,o._availableGeometryIds=e._availableGeometryIds,o._nextIndexStart=e.nextIndexStart,o._nextVertexStart=e.nextVertexStart,o._geometryCount=e.geometryCount,o._maxInstanceCount=e.maxInstanceCount,o._maxVertexCount=e.maxVertexCount,o._maxIndexCount=e.maxIndexCount,o._geometryInitialized=e.geometryInitialized,o._matricesTexture=h(e.matricesTexture.uuid),o._indirectTexture=h(e.indirectTexture.uuid),e.colorsTexture!==void 0&&(o._colorsTexture=h(e.colorsTexture.uuid)),e.boundingSphere!==void 0&&(o.boundingSphere=new rs().fromJSON(e.boundingSphere)),e.boundingBox!==void 0&&(o.boundingBox=new Yi().fromJSON(e.boundingBox));break;case"LOD":o=new xC;break;case"Line":o=new ui(c(e.geometry),u(e.material));break;case"LineLoop":o=new SS(c(e.geometry),u(e.material));break;case"LineSegments":o=new Jo(c(e.geometry),u(e.material));break;case"PointCloud":case"Points":o=new Lp(c(e.geometry),u(e.material));break;case"Sprite":o=new mC(u(e.material));break;case"Group":o=new Yc;break;case"Bone":o=new vy;break;default:o=new ai}if(o.uuid=e.uuid,e.name!==void 0&&(o.name=e.name),e.matrix!==void 0?(o.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(e.position!==void 0&&o.position.fromArray(e.position),e.rotation!==void 0&&o.rotation.fromArray(e.rotation),e.quaternion!==void 0&&o.quaternion.fromArray(e.quaternion),e.scale!==void 0&&o.scale.fromArray(e.scale)),e.up!==void 0&&o.up.fromArray(e.up),e.castShadow!==void 0&&(o.castShadow=e.castShadow),e.receiveShadow!==void 0&&(o.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.intensity!==void 0&&(o.shadow.intensity=e.shadow.intensity),e.shadow.bias!==void 0&&(o.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(o.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(o.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&o.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(o.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(o.visible=e.visible),e.frustumCulled!==void 0&&(o.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(o.renderOrder=e.renderOrder),e.userData!==void 0&&(o.userData=e.userData),e.layers!==void 0&&(o.layers.mask=e.layers),e.children!==void 0){const g=e.children;for(let b=0;b<g.length;b++)o.add(this.parseObject(g[b],t,n,i,a))}if(e.animations!==void 0){const g=e.animations;for(let b=0;b<g.length;b++){const S=g[b];o.animations.push(a[S])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(o.autoUpdate=e.autoUpdate);const g=e.levels;for(let b=0;b<g.length;b++){const S=g[b],C=o.getObjectByProperty("uuid",S.object);C!==void 0&&o.addLevel(C,S.distance,S.hysteresis)}}return o}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(n){if(n.isSkinnedMesh===!0&&n.skeleton!==void 0){const i=t[n.skeleton];i===void 0?un("ObjectLoader: No skeleton found with UUID:",n.skeleton):n.bind(i,n.bindMatrix)}})}bindLightTargets(e){e.traverse(function(t){if(t.isDirectionalLight||t.isSpotLight){const n=t.target,i=e.getObjectByProperty("uuid",n);i!==void 0?t.target=i:t.target=new ai}})}}const i5={UVMapping:Uf,CubeReflectionMapping:Kc,CubeRefractionMapping:Lf,EquirectangularReflectionMapping:zp,EquirectangularRefractionMapping:sx,CubeUVReflectionMapping:i0},cw={RepeatWrapping:Of,ClampToEdgeWrapping:Pa,MirroredRepeatWrapping:Fp},uw={NearestFilter:Vs,NearestMipmapNearestFilter:ay,NearestMipmapLinearFilter:Vh,LinearFilter:bi,LinearMipmapNearestFilter:Dp,LinearMipmapLinearFilter:Al},f2=new WeakMap;class ZC extends Ws{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&un("ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&un("ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"},this._abortController=new AbortController}setOptions(e){return this.options=e,this}load(e,t,n,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const a=this,o=Wc.get(`image-bitmap:${e}`);if(o!==void 0){if(a.manager.itemStart(e),o.then){o.then(h=>{if(f2.has(o)===!0)i&&i(f2.get(o)),a.manager.itemError(e),a.manager.itemEnd(e);else return t&&t(h),a.manager.itemEnd(e),h});return}return setTimeout(function(){t&&t(o),a.manager.itemEnd(e)},0),o}const c={};c.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",c.headers=this.requestHeader,c.signal=typeof AbortSignal.any=="function"?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal;const u=fetch(e,c).then(function(h){return h.blob()}).then(function(h){return createImageBitmap(h,Object.assign(a.options,{colorSpaceConversion:"none"}))}).then(function(h){return Wc.add(`image-bitmap:${e}`,h),t&&t(h),a.manager.itemEnd(e),h}).catch(function(h){i&&i(h),f2.set(u,h),Wc.remove(`image-bitmap:${e}`),a.manager.itemError(e),a.manager.itemEnd(e)});Wc.add(`image-bitmap:${e}`,u),a.manager.itemStart(e)}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}let mv;class GS{static getContext(){return mv===void 0&&(mv=new(window.AudioContext||window.webkitAudioContext)),mv}static setContext(e){mv=e}}class a5 extends Ws{constructor(e){super(e)}load(e,t,n,i){const a=this,o=new Xs(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(u){try{const h=u.slice(0);GS.getContext().decodeAudioData(h,function(x){t(x)}).catch(c)}catch(h){c(h)}},n,i);function c(u){i?i(u):Xn(u),a.manager.itemError(e)}}}const fw=new wn,hw=new wn,Th=new wn;class s5{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Ba,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Ba,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,Th.copy(e.projectionMatrix);const i=t.eyeSep/2,a=i*t.near/t.focus,o=t.near*Math.tan(Qh*t.fov*.5)/t.zoom;let c,u;hw.elements[12]=-i,fw.elements[12]=i,c=-o*t.aspect+a,u=o*t.aspect+a,Th.elements[0]=2*t.near/(u-c),Th.elements[8]=(u+c)/(u-c),this.cameraL.projectionMatrix.copy(Th),c=-o*t.aspect-a,u=o*t.aspect-a,Th.elements[0]=2*t.near/(u-c),Th.elements[8]=(u+c)/(u-c),this.cameraR.projectionMatrix.copy(Th)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(hw),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(fw)}}class KC extends Ba{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}class jS{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=performance.now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=performance.now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}const Rh=new k,h2=new Fn,r5=new k,Nh=new k,Bh=new k;class o5 extends ai{constructor(){super(),this.type="AudioListener",this.context=GS.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new jS}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Rh,h2,r5),Nh.set(0,0,-1).applyQuaternion(h2),Bh.set(0,1,0).applyQuaternion(h2),t.positionX){const n=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(Rh.x,n),t.positionY.linearRampToValueAtTime(Rh.y,n),t.positionZ.linearRampToValueAtTime(Rh.z,n),t.forwardX.linearRampToValueAtTime(Nh.x,n),t.forwardY.linearRampToValueAtTime(Nh.y,n),t.forwardZ.linearRampToValueAtTime(Nh.z,n),t.upX.linearRampToValueAtTime(Bh.x,n),t.upY.linearRampToValueAtTime(Bh.y,n),t.upZ.linearRampToValueAtTime(Bh.z,n)}else t.setPosition(Rh.x,Rh.y,Rh.z),t.setOrientation(Nh.x,Nh.y,Nh.z,Bh.x,Bh.y,Bh.z)}}class QC extends ai{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){un("Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){un("Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){un("Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(e=0){if(this.hasPlaybackControl===!1){un("Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(this.context.currentTime+e),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){un("Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1,this._progress=0}getLoop(){return this.hasPlaybackControl===!1?(un("Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){un("Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}copy(e,t){return super.copy(e,t),e.sourceType!=="buffer"?(un("Audio: Audio source type cannot be copied."),this):(this.autoplay=e.autoplay,this.buffer=e.buffer,this.detune=e.detune,this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this.offset=e.offset,this.duration=e.duration,this.playbackRate=e.playbackRate,this.hasPlaybackControl=e.hasPlaybackControl,this.sourceType=e.sourceType,this.filters=e.filters.slice(),this)}clone(e){return new this.constructor(this.listener).copy(this,e)}}const Dh=new k,dw=new Fn,l5=new k,Uh=new k;class c5 extends QC{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){return super.connect(),this.panner.connect(this.gain),this}disconnect(){return super.disconnect(),this.panner.disconnect(this.gain),this}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(Dh,dw,l5),Uh.set(0,0,1).applyQuaternion(dw);const t=this.panner;if(t.positionX){const n=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(Dh.x,n),t.positionY.linearRampToValueAtTime(Dh.y,n),t.positionZ.linearRampToValueAtTime(Dh.z,n),t.orientationX.linearRampToValueAtTime(Uh.x,n),t.orientationY.linearRampToValueAtTime(Uh.y,n),t.orientationZ.linearRampToValueAtTime(Uh.z,n)}else t.setPosition(Dh.x,Dh.y,Dh.z),t.setOrientation(Uh.x,Uh.y,Uh.z)}}class u5{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}}class $C{constructor(e,t,n){this.binding=e,this.valueSize=n;let i,a,o;switch(t){case"quaternion":i=this._slerp,a=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(n*6),this._workIndex=5;break;case"string":case"bool":i=this._select,a=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(n*5);break;default:i=this._lerp,a=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(n*5)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=a,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,i=this.valueSize,a=e*i+i;let o=this.cumulativeWeight;if(o===0){for(let c=0;c!==i;++c)n[a+c]=n[c];o=t}else{o+=t;const c=t/o;this._mixBufferRegion(n,a,0,c,i)}this.cumulativeWeight=o}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,i=n*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,i,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,i=e*t+t,a=this.cumulativeWeight,o=this.cumulativeWeightAdditive,c=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,a<1){const u=t*this._origIndex;this._mixBufferRegion(n,i,u,1-a,t)}o>0&&this._mixBufferRegionAdditive(n,i,this._addIndex*t,1,t);for(let u=t,h=t+t;u!==h;++u)if(n[u]!==n[u+t]){c.setValue(n,i);break}}saveOriginalState(){const e=this.binding,t=this.buffer,n=this.valueSize,i=n*this._origIndex;e.getValue(t,i);for(let a=n,o=i;a!==o;++a)t[a]=t[i+a%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,i,a){if(i>=.5)for(let o=0;o!==a;++o)e[t+o]=e[n+o]}_slerp(e,t,n,i){Fn.slerpFlat(e,t,e,t,e,n,i)}_slerpAdditive(e,t,n,i,a){const o=this._workIndex*a;Fn.multiplyQuaternionsFlat(e,o,e,t,e,n),Fn.slerpFlat(e,t,e,t,e,o,i)}_lerp(e,t,n,i,a){const o=1-i;for(let c=0;c!==a;++c){const u=t+c;e[u]=e[u]*o+e[n+c]*i}}_lerpAdditive(e,t,n,i,a){for(let o=0;o!==a;++o){const c=t+o;e[c]=e[c]+e[n+o]*i}}}const HS="\\[\\]\\.:\\/",f5=new RegExp("["+HS+"]","g"),kS="[^"+HS+"]",h5="[^"+HS.replace("\\.","")+"]",d5=/((?:WC+[\/:])*)/.source.replace("WC",kS),p5=/(WCOD+)?/.source.replace("WCOD",h5),m5=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",kS),x5=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",kS),g5=new RegExp("^"+d5+p5+m5+x5+"$"),v5=["material","materials","bones","map"];class y5{constructor(e,t,n){const i=n||Bi.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}getValue(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,i=this._bindings[n];i!==void 0&&i.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let i=this._targetGroup.nCachedObjects_,a=n.length;i!==a;++i)n[i].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}class Bi{constructor(e,t,n){this.path=t,this.parsedPath=n||Bi.parseTrackName(t),this.node=Bi.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new Bi.Composite(e,t,n):new Bi(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(f5,"")}static parseTrackName(e){const t=g5.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=n.nodeName&&n.nodeName.lastIndexOf(".");if(i!==void 0&&i!==-1){const a=n.nodeName.substring(i+1);v5.indexOf(a)!==-1&&(n.nodeName=n.nodeName.substring(0,i),n.objectName=a)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(n!==void 0)return n}if(e.children){const n=function(a){for(let o=0;o<a.length;o++){const c=a[o];if(c.name===t||c.uuid===t)return c;const u=n(c.children);if(u)return u}return null},i=n(e.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let i=0,a=n.length;i!==a;++i)e[t++]=n[i]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let i=0,a=n.length;i!==a;++i)n[i]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let i=0,a=n.length;i!==a;++i)n[i]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let i=0,a=n.length;i!==a;++i)n[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,i=t.propertyName;let a=t.propertyIndex;if(e||(e=Bi.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){un("PropertyBinding: No target node found for track: "+this.path+".");return}if(n){let h=t.objectIndex;switch(n){case"materials":if(!e.material){Xn("PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){Xn("PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){Xn("PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let m=0;m<e.length;m++)if(e[m].name===h){h=m;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){Xn("PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){Xn("PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[n]===void 0){Xn("PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[n]}if(h!==void 0){if(e[h]===void 0){Xn("PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[h]}}const o=e[i];if(o===void 0){const h=t.nodeName;Xn("PropertyBinding: Trying to update property for track: "+h+"."+i+" but it wasn't found.",e);return}let c=this.Versioning.None;this.targetObject=e,e.isMaterial===!0?c=this.Versioning.NeedsUpdate:e.isObject3D===!0&&(c=this.Versioning.MatrixWorldNeedsUpdate);let u=this.BindingType.Direct;if(a!==void 0){if(i==="morphTargetInfluences"){if(!e.geometry){Xn("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){Xn("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[a]!==void 0&&(a=e.morphTargetDictionary[a])}u=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=a}else o.fromArray!==void 0&&o.toArray!==void 0?(u=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(u=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=i;this.getValue=this.GetterByBindingType[u],this.setValue=this.SetterByBindingTypeAndVersioning[u][c]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Bi.Composite=y5;Bi.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Bi.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Bi.prototype.GetterByBindingType=[Bi.prototype._getValue_direct,Bi.prototype._getValue_array,Bi.prototype._getValue_arrayElement,Bi.prototype._getValue_toArray];Bi.prototype.SetterByBindingTypeAndVersioning=[[Bi.prototype._setValue_direct,Bi.prototype._setValue_direct_setNeedsUpdate,Bi.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Bi.prototype._setValue_array,Bi.prototype._setValue_array_setNeedsUpdate,Bi.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Bi.prototype._setValue_arrayElement,Bi.prototype._setValue_arrayElement_setNeedsUpdate,Bi.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Bi.prototype._setValue_fromArray,Bi.prototype._setValue_fromArray_setNeedsUpdate,Bi.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class b5{constructor(){this.isAnimationObjectGroup=!0,this.uuid=Wo(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let n=0,i=arguments.length;n!==i;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,n=this._paths,i=this._parsedPaths,a=this._bindings,o=a.length;let c,u=e.length,h=this.nCachedObjects_;for(let m=0,x=arguments.length;m!==x;++m){const g=arguments[m],b=g.uuid;let S=t[b];if(S===void 0){S=u++,t[b]=S,e.push(g);for(let C=0,M=o;C!==M;++C)a[C].push(new Bi(g,n[C],i[C]))}else if(S<h){c=e[S];const C=--h,M=e[C];t[M.uuid]=S,e[S]=M,t[b]=C,e[C]=g;for(let A=0,R=o;A!==R;++A){const N=a[A],B=N[C];let F=N[S];N[S]=B,F===void 0&&(F=new Bi(g,n[A],i[A])),N[C]=F}}else e[S]!==c&&Xn("AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=h}remove(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,i=n.length;let a=this.nCachedObjects_;for(let o=0,c=arguments.length;o!==c;++o){const u=arguments[o],h=u.uuid,m=t[h];if(m!==void 0&&m>=a){const x=a++,g=e[x];t[g.uuid]=m,e[m]=g,t[h]=x,e[x]=u;for(let b=0,S=i;b!==S;++b){const C=n[b],M=C[x],A=C[m];C[m]=M,C[x]=A}}}this.nCachedObjects_=a}uncache(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,i=n.length;let a=this.nCachedObjects_,o=e.length;for(let c=0,u=arguments.length;c!==u;++c){const h=arguments[c],m=h.uuid,x=t[m];if(x!==void 0)if(delete t[m],x<a){const g=--a,b=e[g],S=--o,C=e[S];t[b.uuid]=x,e[x]=b,t[C.uuid]=g,e[g]=C,e.pop();for(let M=0,A=i;M!==A;++M){const R=n[M],N=R[g],B=R[S];R[x]=N,R[g]=B,R.pop()}}else{const g=--o,b=e[g];g>0&&(t[b.uuid]=x),e[x]=b,e.pop();for(let S=0,C=i;S!==C;++S){const M=n[S];M[x]=M[g],M.pop()}}}this.nCachedObjects_=a}subscribe_(e,t){const n=this._bindingsIndicesByPath;let i=n[e];const a=this._bindings;if(i!==void 0)return a[i];const o=this._paths,c=this._parsedPaths,u=this._objects,h=u.length,m=this.nCachedObjects_,x=new Array(h);i=a.length,n[e]=i,o.push(e),c.push(t),a.push(x);for(let g=m,b=u.length;g!==b;++g){const S=u[g];x[g]=new Bi(S,e,t)}return x}unsubscribe_(e){const t=this._bindingsIndicesByPath,n=t[e];if(n!==void 0){const i=this._paths,a=this._parsedPaths,o=this._bindings,c=o.length-1,u=o[c],h=e[c];t[h]=n,o[n]=u,o.pop(),a[n]=a[c],a.pop(),i[n]=i[c],i.pop()}}}class eT{constructor(e,t,n=null,i=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=i;const a=t.tracks,o=a.length,c=new Array(o),u={endingStart:Xh,endingEnd:Xh};for(let h=0;h!==o;++h){const m=a[h].createInterpolant(null);c[h]=m,m.settings=u}this._interpolantSettings=u,this._interpolants=c,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Z3,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n=!1){if(e.fadeOut(t),this.fadeIn(t),n===!0){const i=this._clip.duration,a=e._clip.duration,o=a/i,c=i/a;e.warp(1,o,t),this.warp(c,1,t)}return this}crossFadeTo(e,t,n=!1){return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const i=this._mixer,a=i.time,o=this.timeScale;let c=this._timeScaleInterpolant;c===null&&(c=i._lendControlInterpolant(),this._timeScaleInterpolant=c);const u=c.parameterPositions,h=c.sampleValues;return u[0]=a,u[1]=a+n,h[0]=e/o,h[1]=t/o,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,i){if(!this.enabled){this._updateWeight(e);return}const a=this._startTime;if(a!==null){const u=(e-a)*n;u<0||n===0?t=0:(this._startTime=null,t=n*u)}t*=this._updateTimeScale(e);const o=this._updateTime(t),c=this._updateWeight(e);if(c>0){const u=this._interpolants,h=this._propertyBindings;switch(this.blendMode){case uS:for(let m=0,x=u.length;m!==x;++m)u[m].evaluate(o),h[m].accumulateAdditive(c);break;case hy:default:for(let m=0,x=u.length;m!==x;++m)u[m].evaluate(o),h[m].accumulate(i,c)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(n!==null){const i=n.evaluate(e)[0];t*=i,e>n.parameterPositions[1]&&(this.stopFading(),i===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;if(n!==null){const i=n.evaluate(e)[0];t*=i,e>n.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let i=this.time+e,a=this._loopCount;const o=n===K3;if(e===0)return a===-1?i:o&&(a&1)===1?t-i:i;if(n===J3){a===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(i>=t)i=t;else if(i<0)i=0;else{this.time=i;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(a===-1&&(e>=0?(a=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),i>=t||i<0){const c=Math.floor(i/t);i-=t*c,a+=Math.abs(c);const u=this.repetitions-a;if(u<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=e>0?t:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(u===1){const h=e<0;this._setEndings(h,!h,o)}else this._setEndings(!1,!1,o);this._loopCount=a,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:c})}}else this.time=i;if(o&&(a&1)===1)return t-i}return i}_setEndings(e,t,n){const i=this._interpolantSettings;n?(i.endingStart=Yh,i.endingEnd=Yh):(e?i.endingStart=this.zeroSlopeAtStart?Yh:Xh:i.endingStart=rx,t?i.endingEnd=this.zeroSlopeAtEnd?Yh:Xh:i.endingEnd=rx)}_scheduleFading(e,t,n){const i=this._mixer,a=i.time;let o=this._weightInterpolant;o===null&&(o=i._lendControlInterpolant(),this._weightInterpolant=o);const c=o.parameterPositions,u=o.sampleValues;return c[0]=a,u[0]=t,c[1]=a+e,u[1]=n,this}}const _5=new Float32Array(1);class S5 extends eu{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const n=e._localRoot||this._root,i=e._clip.tracks,a=i.length,o=e._propertyBindings,c=e._interpolants,u=n.uuid,h=this._bindingsByRootAndName;let m=h[u];m===void 0&&(m={},h[u]=m);for(let x=0;x!==a;++x){const g=i[x],b=g.name;let S=m[b];if(S!==void 0)++S.referenceCount,o[x]=S;else{if(S=o[x],S!==void 0){S._cacheIndex===null&&(++S.referenceCount,this._addInactiveBinding(S,u,b));continue}const C=t&&t._propertyBindings[x].binding.parsedPath;S=new $C(Bi.create(n,b,C),g.ValueTypeName,g.getValueSize()),++S.referenceCount,this._addInactiveBinding(S,u,b),o[x]=S}c[x].resultBuffer=S.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const n=(e._localRoot||this._root).uuid,i=e._clip.uuid,a=this._actionsByClip[i];this._bindAction(e,a&&a.knownActions[0]),this._addInactiveAction(e,i,n)}const t=e._propertyBindings;for(let n=0,i=t.length;n!==i;++n){const a=t[n];a.useCount++===0&&(this._lendBinding(a),a.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let n=0,i=t.length;n!==i;++n){const a=t[n];--a.useCount===0&&(a.restoreOriginalState(),this._takeBackBinding(a))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,n){const i=this._actions,a=this._actionsByClip;let o=a[t];if(o===void 0)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,a[t]=o;else{const c=o.knownActions;e._byClipCacheIndex=c.length,c.push(e)}e._cacheIndex=i.length,i.push(e),o.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],i=e._cacheIndex;n._cacheIndex=i,t[i]=n,t.pop(),e._cacheIndex=null;const a=e._clip.uuid,o=this._actionsByClip,c=o[a],u=c.knownActions,h=u[u.length-1],m=e._byClipCacheIndex;h._byClipCacheIndex=m,u[m]=h,u.pop(),e._byClipCacheIndex=null;const x=c.actionByRoot,g=(e._localRoot||this._root).uuid;delete x[g],u.length===0&&delete o[a],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let n=0,i=t.length;n!==i;++n){const a=t[n];--a.referenceCount===0&&this._removeInactiveBinding(a)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,i=this._nActiveActions++,a=t[i];e._cacheIndex=i,t[i]=e,a._cacheIndex=n,t[n]=a}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,i=--this._nActiveActions,a=t[i];e._cacheIndex=i,t[i]=e,a._cacheIndex=n,t[n]=a}_addInactiveBinding(e,t,n){const i=this._bindingsByRootAndName,a=this._bindings;let o=i[t];o===void 0&&(o={},i[t]=o),o[n]=e,e._cacheIndex=a.length,a.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,i=n.rootNode.uuid,a=n.path,o=this._bindingsByRootAndName,c=o[i],u=t[t.length-1],h=e._cacheIndex;u._cacheIndex=h,t[h]=u,t.pop(),delete c[a],Object.keys(c).length===0&&delete o[i]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,i=this._nActiveBindings++,a=t[i];e._cacheIndex=i,t[i]=e,a._cacheIndex=n,t[n]=a}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,i=--this._nActiveBindings,a=t[i];e._cacheIndex=i,t[i]=e,a._cacheIndex=n,t[n]=a}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return n===void 0&&(n=new US(new Float32Array(2),new Float32Array(2),1,_5),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,i=--this._nActiveControlInterpolants,a=t[i];e.__cacheIndex=i,t[i]=e,a.__cacheIndex=n,t[n]=a}clipAction(e,t,n){const i=t||this._root,a=i.uuid;let o=typeof e=="string"?$p.findByName(i,e):e;const c=o!==null?o.uuid:e,u=this._actionsByClip[c];let h=null;if(n===void 0&&(o!==null?n=o.blendMode:n=hy),u!==void 0){const x=u.actionByRoot[a];if(x!==void 0&&x.blendMode===n)return x;h=u.knownActions[0],o===null&&(o=h._clip)}if(o===null)return null;const m=new eT(this,o,t,n);return this._bindAction(m,h),this._addInactiveAction(m,c,a),m}existingAction(e,t){const n=t||this._root,i=n.uuid,a=typeof e=="string"?$p.findByName(n,e):e,o=a?a.uuid:e,c=this._actionsByClip[o];return c!==void 0&&c.actionByRoot[i]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let n=t-1;n>=0;--n)e[n].stop();return this}update(e){e*=this.timeScale;const t=this._actions,n=this._nActiveActions,i=this.time+=e,a=Math.sign(e),o=this._accuIndex^=1;for(let h=0;h!==n;++h)t[h]._update(i,e,a,o);const c=this._bindings,u=this._nActiveBindings;for(let h=0;h!==u;++h)c[h].apply(o);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,i=this._actionsByClip,a=i[n];if(a!==void 0){const o=a.knownActions;for(let c=0,u=o.length;c!==u;++c){const h=o[c];this._deactivateAction(h);const m=h._cacheIndex,x=t[t.length-1];h._cacheIndex=null,h._byClipCacheIndex=null,x._cacheIndex=m,t[m]=x,t.pop(),this._removeInactiveBindingsForAction(h)}delete i[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const o in n){const c=n[o].actionByRoot,u=c[t];u!==void 0&&(this._deactivateAction(u),this._removeInactiveAction(u))}const i=this._bindingsByRootAndName,a=i[t];if(a!==void 0)for(const o in a){const c=a[o];c.restoreOriginalState(),this._removeInactiveBinding(c)}}uncacheAction(e,t){const n=this.existingAction(e,t);n!==null&&(this._deactivateAction(n),this._removeInactiveAction(n))}}class A5 extends mS{constructor(e=1,t=1,n=1,i={}){super(e,t,i),this.isRenderTarget3D=!0,this.depth=n,this.texture=new py(null,e,t,n),this._setTextureOptions(i),this.texture.isRenderTargetTexture=!0}}class Iy{constructor(e){this.value=e}clone(){return new Iy(this.value.clone===void 0?this.value:this.value.clone())}}let M5=0;class w5 extends eu{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:M5++}),this.name="",this.usage=lx,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){this.dispatchEvent({type:"dispose"})}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let n=0,i=t.length;n<i;n++){const a=Array.isArray(t[n])?t[n]:[t[n]];for(let o=0;o<a.length;o++)this.uniforms.push(a[o].clone())}return this}clone(){return new this.constructor().copy(this)}}class V1 extends wx{constructor(e,t,n=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class E5{constructor(e,t,n,i,a,o=!1){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=i,this.count=a,this.normalized=o,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}const pw=new wn;class zy{constructor(e,t,n=0,i=1/0){this.ray=new ld(e,t),this.near=n,this.far=i,this.camera=null,this.layers=new qp,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):Xn("Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return pw.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(pw),this}intersectObject(e,t=!0,n=[]){return L_(e,this,n,t),n.sort(mw),n}intersectObjects(e,t=!0,n=[]){for(let i=0,a=e.length;i<a;i++)L_(e[i],this,n,t);return n.sort(mw),n}}function mw(s,e){return s.distance-e.distance}function L_(s,e,t,n){let i=!0;if(s.layers.test(e.layers)&&s.raycast(e,t)===!1&&(i=!1),i===!0&&n===!0){const a=s.children;for(let o=0,c=a.length;o<c;o++)L_(a[o],e,t,!0)}}class C5{constructor(){this._previousTime=0,this._currentTime=0,this._startTime=performance.now(),this._delta=0,this._elapsed=0,this._timescale=1,this._document=null,this._pageVisibilityHandler=null}connect(e){this._document=e,e.hidden!==void 0&&(this._pageVisibilityHandler=T5.bind(this),e.addEventListener("visibilitychange",this._pageVisibilityHandler,!1))}disconnect(){this._pageVisibilityHandler!==null&&(this._document.removeEventListener("visibilitychange",this._pageVisibilityHandler),this._pageVisibilityHandler=null),this._document=null}getDelta(){return this._delta/1e3}getElapsed(){return this._elapsed/1e3}getTimescale(){return this._timescale}setTimescale(e){return this._timescale=e,this}reset(){return this._currentTime=performance.now()-this._startTime,this}dispose(){this.disconnect()}update(e){return this._pageVisibilityHandler!==null&&this._document.hidden===!0?this._delta=0:(this._previousTime=this._currentTime,this._currentTime=(e!==void 0?e:performance.now())-this._startTime,this._delta=(this._currentTime-this._previousTime)*this._timescale,this._elapsed+=this._delta),this}}function T5(){this._document.hidden===!1&&this.reset()}class X1{constructor(e=1,t=0,n=0){this.radius=e,this.phi=t,this.theta=n}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Pn(this.phi,1e-6,Math.PI-1e-6),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(Pn(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class R5{constructor(e=1,t=0,n=0){this.radius=e,this.theta=t,this.y=n}set(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}clone(){return new this.constructor().copy(this)}}class VS{constructor(e,t,n,i){VS.prototype.isMatrix2=!0,this.elements=[1,0,0,1],e!==void 0&&this.set(e,t,n,i)}identity(){return this.set(1,0,0,1),this}fromArray(e,t=0){for(let n=0;n<4;n++)this.elements[n]=e[n+t];return this}set(e,t,n,i){const a=this.elements;return a[0]=e,a[2]=t,a[1]=n,a[3]=i,this}}const xw=new gt;class N5{constructor(e=new gt(1/0,1/0),t=new gt(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=xw.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,xw).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const gw=new k,xv=new k,yp=new k,bp=new k,d2=new k,B5=new k,D5=new k;class XS{constructor(e=new k,t=new k){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){gw.subVectors(e,this.start),xv.subVectors(this.end,this.start);const n=xv.dot(xv);let a=xv.dot(gw)/n;return t&&(a=Pn(a,0,1)),a}closestPointToPoint(e,t,n){const i=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(i).add(this.start)}distanceSqToLine3(e,t=B5,n=D5){const i=10000000000000001e-32;let a,o;const c=this.start,u=e.start,h=this.end,m=e.end;yp.subVectors(h,c),bp.subVectors(m,u),d2.subVectors(c,u);const x=yp.dot(yp),g=bp.dot(bp),b=bp.dot(d2);if(x<=i&&g<=i)return t.copy(c),n.copy(u),t.sub(n),t.dot(t);if(x<=i)a=0,o=b/g,o=Pn(o,0,1);else{const S=yp.dot(d2);if(g<=i)o=0,a=Pn(-S/x,0,1);else{const C=yp.dot(bp),M=x*g-C*C;M!==0?a=Pn((C*b-S*g)/M,0,1):a=0,o=(C*a+b)/g,o<0?(o=0,a=Pn(-S/x,0,1)):o>1&&(o=1,a=Pn((C-S)/x,0,1))}}return t.copy(c).add(yp.multiplyScalar(a)),n.copy(u).add(bp.multiplyScalar(o)),t.sub(n),t.dot(t)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const vw=new k;class U5 extends ai{constructor(e,t){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const n=new Rn,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let o=0,c=1,u=32;o<u;o++,c++){const h=o/u*Math.PI*2,m=c/u*Math.PI*2;i.push(Math.cos(h),Math.sin(h),1,Math.cos(m),Math.sin(m),1)}n.setAttribute("position",new $t(i,3));const a=new gs({fog:!1,toneMapped:!1});this.cone=new Jo(n,a),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),vw.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(vw),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Sf=new k,gv=new wn,p2=new wn;class L5 extends Jo{constructor(e){const t=tT(e),n=new Rn,i=[],a=[];for(let h=0;h<t.length;h++){const m=t[h];m.parent&&m.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),a.push(0,0,0),a.push(0,0,0))}n.setAttribute("position",new $t(i,3)),n.setAttribute("color",new $t(a,3));const o=new gs({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(n,o),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1;const c=new qt(255),u=new qt(65280);this.setColors(c,u)}updateMatrixWorld(e){const t=this.bones,n=this.geometry,i=n.getAttribute("position");p2.copy(this.root.matrixWorld).invert();for(let a=0,o=0;a<t.length;a++){const c=t[a];c.parent&&c.parent.isBone&&(gv.multiplyMatrices(p2,c.matrixWorld),Sf.setFromMatrixPosition(gv),i.setXYZ(o,Sf.x,Sf.y,Sf.z),gv.multiplyMatrices(p2,c.parent.matrixWorld),Sf.setFromMatrixPosition(gv),i.setXYZ(o+1,Sf.x,Sf.y,Sf.z),o+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}setColors(e,t){const i=this.geometry.getAttribute("color");for(let a=0;a<i.count;a+=2)i.setXYZ(a,e.r,e.g,e.b),i.setXYZ(a+1,t.r,t.g,t.b);return i.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}function tT(s){const e=[];s.isBone===!0&&e.push(s);for(let t=0;t<s.children.length;t++)e.push(...tT(s.children[t]));return e}class O5 extends sn{constructor(e,t,n){const i=new r0(t,4,2),a=new ur({wireframe:!0,fog:!1,toneMapped:!1});super(i,a),this.light=e,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const I5=new k,yw=new qt,bw=new qt;class z5 extends ai{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="HemisphereLightHelper";const i=new bl(t);i.rotateY(Math.PI*.5),this.material=new ur({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const a=i.getAttribute("position"),o=new Float32Array(a.count*3);i.setAttribute("color",new Ii(o,3)),this.add(new sn(i,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");yw.copy(this.light.color),bw.copy(this.light.groundColor);for(let n=0,i=t.count;n<i;n++){const a=n<i/2?yw:bw;t.setXYZ(n,a.r,a.g,a.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(I5.setFromMatrixPosition(this.light.matrixWorld).negate())}}class F5 extends Jo{constructor(e=10,t=10,n=4473924,i=8947848){n=new qt(n),i=new qt(i);const a=t/2,o=e/t,c=e/2,u=[],h=[];for(let g=0,b=0,S=-c;g<=t;g++,S+=o){u.push(-c,0,S,c,0,S),u.push(S,0,-c,S,0,c);const C=g===a?n:i;C.toArray(h,b),b+=3,C.toArray(h,b),b+=3,C.toArray(h,b),b+=3,C.toArray(h,b),b+=3}const m=new Rn;m.setAttribute("position",new $t(u,3)),m.setAttribute("color",new $t(h,3));const x=new gs({vertexColors:!0,toneMapped:!1});super(m,x),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class P5 extends Jo{constructor(e=10,t=16,n=8,i=64,a=4473924,o=8947848){a=new qt(a),o=new qt(o);const c=[],u=[];if(t>1)for(let x=0;x<t;x++){const g=x/t*(Math.PI*2),b=Math.sin(g)*e,S=Math.cos(g)*e;c.push(0,0,0),c.push(b,0,S);const C=x&1?a:o;u.push(C.r,C.g,C.b),u.push(C.r,C.g,C.b)}for(let x=0;x<n;x++){const g=x&1?a:o,b=e-e/n*x;for(let S=0;S<i;S++){let C=S/i*(Math.PI*2),M=Math.sin(C)*b,A=Math.cos(C)*b;c.push(M,0,A),u.push(g.r,g.g,g.b),C=(S+1)/i*(Math.PI*2),M=Math.sin(C)*b,A=Math.cos(C)*b,c.push(M,0,A),u.push(g.r,g.g,g.b)}}const h=new Rn;h.setAttribute("position",new $t(c,3)),h.setAttribute("color",new $t(u,3));const m=new gs({vertexColors:!0,toneMapped:!1});super(h,m),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const _w=new k,vv=new k,Sw=new k;class G5 extends ai{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",t===void 0&&(t=1);let i=new Rn;i.setAttribute("position",new $t([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const a=new gs({fog:!1,toneMapped:!1});this.lightPlane=new ui(i,a),this.add(this.lightPlane),i=new Rn,i.setAttribute("position",new $t([0,0,0,0,0,1],3)),this.targetLine=new ui(i,a),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),_w.setFromMatrixPosition(this.light.matrixWorld),vv.setFromMatrixPosition(this.light.target.matrixWorld),Sw.subVectors(vv,_w),this.lightPlane.lookAt(vv),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(vv),this.targetLine.scale.z=Sw.length()}}const yv=new k,Za=new my;class j5 extends Jo{constructor(e){const t=new Rn,n=new gs({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],a=[],o={};c("n1","n2"),c("n2","n4"),c("n4","n3"),c("n3","n1"),c("f1","f2"),c("f2","f4"),c("f4","f3"),c("f3","f1"),c("n1","f1"),c("n2","f2"),c("n3","f3"),c("n4","f4"),c("p","n1"),c("p","n2"),c("p","n3"),c("p","n4"),c("u1","u2"),c("u2","u3"),c("u3","u1"),c("c","t"),c("p","c"),c("cn1","cn2"),c("cn3","cn4"),c("cf1","cf2"),c("cf3","cf4");function c(S,C){u(S),u(C)}function u(S){i.push(0,0,0),a.push(0,0,0),o[S]===void 0&&(o[S]=[]),o[S].push(i.length/3-1)}t.setAttribute("position",new $t(i,3)),t.setAttribute("color",new $t(a,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update();const h=new qt(16755200),m=new qt(16711680),x=new qt(43775),g=new qt(16777215),b=new qt(3355443);this.setColors(h,m,x,g,b)}setColors(e,t,n,i,a){const c=this.geometry.getAttribute("color");return c.setXYZ(0,e.r,e.g,e.b),c.setXYZ(1,e.r,e.g,e.b),c.setXYZ(2,e.r,e.g,e.b),c.setXYZ(3,e.r,e.g,e.b),c.setXYZ(4,e.r,e.g,e.b),c.setXYZ(5,e.r,e.g,e.b),c.setXYZ(6,e.r,e.g,e.b),c.setXYZ(7,e.r,e.g,e.b),c.setXYZ(8,e.r,e.g,e.b),c.setXYZ(9,e.r,e.g,e.b),c.setXYZ(10,e.r,e.g,e.b),c.setXYZ(11,e.r,e.g,e.b),c.setXYZ(12,e.r,e.g,e.b),c.setXYZ(13,e.r,e.g,e.b),c.setXYZ(14,e.r,e.g,e.b),c.setXYZ(15,e.r,e.g,e.b),c.setXYZ(16,e.r,e.g,e.b),c.setXYZ(17,e.r,e.g,e.b),c.setXYZ(18,e.r,e.g,e.b),c.setXYZ(19,e.r,e.g,e.b),c.setXYZ(20,e.r,e.g,e.b),c.setXYZ(21,e.r,e.g,e.b),c.setXYZ(22,e.r,e.g,e.b),c.setXYZ(23,e.r,e.g,e.b),c.setXYZ(24,t.r,t.g,t.b),c.setXYZ(25,t.r,t.g,t.b),c.setXYZ(26,t.r,t.g,t.b),c.setXYZ(27,t.r,t.g,t.b),c.setXYZ(28,t.r,t.g,t.b),c.setXYZ(29,t.r,t.g,t.b),c.setXYZ(30,t.r,t.g,t.b),c.setXYZ(31,t.r,t.g,t.b),c.setXYZ(32,n.r,n.g,n.b),c.setXYZ(33,n.r,n.g,n.b),c.setXYZ(34,n.r,n.g,n.b),c.setXYZ(35,n.r,n.g,n.b),c.setXYZ(36,n.r,n.g,n.b),c.setXYZ(37,n.r,n.g,n.b),c.setXYZ(38,i.r,i.g,i.b),c.setXYZ(39,i.r,i.g,i.b),c.setXYZ(40,a.r,a.g,a.b),c.setXYZ(41,a.r,a.g,a.b),c.setXYZ(42,a.r,a.g,a.b),c.setXYZ(43,a.r,a.g,a.b),c.setXYZ(44,a.r,a.g,a.b),c.setXYZ(45,a.r,a.g,a.b),c.setXYZ(46,a.r,a.g,a.b),c.setXYZ(47,a.r,a.g,a.b),c.setXYZ(48,a.r,a.g,a.b),c.setXYZ(49,a.r,a.g,a.b),c.needsUpdate=!0,this}update(){const e=this.geometry,t=this.pointMap,n=1,i=1;let a,o;if(Za.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),this.camera.reversedDepth===!0)a=1,o=0;else if(this.camera.coordinateSystem===Yo)a=-1,o=1;else if(this.camera.coordinateSystem===Xp)a=0,o=1;else throw new Error("THREE.CameraHelper.update(): Invalid coordinate system: "+this.camera.coordinateSystem);ns("c",t,e,Za,0,0,a),ns("t",t,e,Za,0,0,o),ns("n1",t,e,Za,-n,-i,a),ns("n2",t,e,Za,n,-i,a),ns("n3",t,e,Za,-n,i,a),ns("n4",t,e,Za,n,i,a),ns("f1",t,e,Za,-n,-i,o),ns("f2",t,e,Za,n,-i,o),ns("f3",t,e,Za,-n,i,o),ns("f4",t,e,Za,n,i,o),ns("u1",t,e,Za,n*.7,i*1.1,a),ns("u2",t,e,Za,-n*.7,i*1.1,a),ns("u3",t,e,Za,0,i*2,a),ns("cf1",t,e,Za,-n,0,o),ns("cf2",t,e,Za,n,0,o),ns("cf3",t,e,Za,0,-i,o),ns("cf4",t,e,Za,0,i,o),ns("cn1",t,e,Za,-n,0,a),ns("cn2",t,e,Za,n,0,a),ns("cn3",t,e,Za,0,-i,a),ns("cn4",t,e,Za,0,i,a),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function ns(s,e,t,n,i,a,o){yv.set(i,a,o).unproject(n);const c=e[s];if(c!==void 0){const u=t.getAttribute("position");for(let h=0,m=c.length;h<m;h++)u.setXYZ(c[h],yv.x,yv.y,yv.z)}}const bv=new Yi;class H5 extends Jo{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Float32Array(24),a=new Rn;a.setIndex(new Ii(n,1)),a.setAttribute("position",new Ii(i,3)),super(a,new gs({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(){if(this.object!==void 0&&bv.setFromObject(this.object),bv.isEmpty())return;const e=bv.min,t=bv.max,n=this.geometry.attributes.position,i=n.array;i[0]=t.x,i[1]=t.y,i[2]=t.z,i[3]=e.x,i[4]=t.y,i[5]=t.z,i[6]=e.x,i[7]=e.y,i[8]=t.z,i[9]=t.x,i[10]=e.y,i[11]=t.z,i[12]=t.x,i[13]=t.y,i[14]=e.z,i[15]=e.x,i[16]=t.y,i[17]=e.z,i[18]=e.x,i[19]=e.y,i[20]=e.z,i[21]=t.x,i[22]=e.y,i[23]=e.z,n.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class k5 extends Jo{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],a=new Rn;a.setIndex(new Ii(n,1)),a.setAttribute("position",new $t(i,3)),super(a,new gs({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class V5 extends ui{constructor(e,t=1,n=16776960){const i=n,a=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],o=new Rn;o.setAttribute("position",new $t(a,3)),o.computeBoundingSphere(),super(o,new gs({color:i,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const c=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],u=new Rn;u.setAttribute("position",new $t(c,3)),u.computeBoundingSphere(),this.add(new sn(u,new ur({color:i,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const Aw=new k;let _v,m2;class X5 extends ai{constructor(e=new k(0,0,1),t=new k(0,0,0),n=1,i=16776960,a=n*.2,o=a*.2){super(),this.type="ArrowHelper",_v===void 0&&(_v=new Rn,_v.setAttribute("position",new $t([0,0,0,0,1,0],3)),m2=new Cx(.5,1,5,1),m2.translate(0,-.5,0)),this.position.copy(t),this.line=new ui(_v,new gs({color:i,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new sn(m2,new ur({color:i,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,a,o)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{Aw.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(Aw,t)}}setLength(e,t=e*.2,n=t*.2){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class Y5 extends Jo{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],i=new Rn;i.setAttribute("position",new $t(t,3)),i.setAttribute("color",new $t(n,3));const a=new gs({vertexColors:!0,toneMapped:!1});super(i,a),this.type="AxesHelper"}setColors(e,t,n){const i=new qt,a=this.geometry.attributes.color.array;return i.set(e),i.toArray(a,0),i.toArray(a,3),i.set(t),i.toArray(a,6),i.toArray(a,9),i.set(n),i.toArray(a,12),i.toArray(a,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class W5{constructor(){this.type="ShapePath",this.color=new qt,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new k1,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,i){return this.currentPath.quadraticCurveTo(e,t,n,i),this}bezierCurveTo(e,t,n,i,a,o){return this.currentPath.bezierCurveTo(e,t,n,i,a,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(A){const R=[];for(let N=0,B=A.length;N<B;N++){const F=A[N],U=new Jc;U.curves=F.curves,R.push(U)}return R}function n(A,R){const N=R.length;let B=!1;for(let F=N-1,U=0;U<N;F=U++){let z=R[F],P=R[U],L=P.x-z.x,O=P.y-z.y;if(Math.abs(O)>Number.EPSILON){if(O<0&&(z=R[U],L=-L,P=R[F],O=-O),A.y<z.y||A.y>P.y)continue;if(A.y===z.y){if(A.x===z.x)return!0}else{const ee=O*(A.x-z.x)-L*(A.y-z.y);if(ee===0)return!0;if(ee<0)continue;B=!B}}else{if(A.y!==z.y)continue;if(P.x<=A.x&&A.x<=z.x||z.x<=A.x&&A.x<=P.x)return!0}}return B}const i=Ml.isClockWise,a=this.subPaths;if(a.length===0)return[];let o,c,u;const h=[];if(a.length===1)return c=a[0],u=new Jc,u.curves=c.curves,h.push(u),h;let m=!i(a[0].getPoints());m=e?!m:m;const x=[],g=[];let b=[],S=0,C;g[S]=void 0,b[S]=[];for(let A=0,R=a.length;A<R;A++)c=a[A],C=c.getPoints(),o=i(C),o=e?!o:o,o?(!m&&g[S]&&S++,g[S]={s:new Jc,p:C},g[S].s.curves=c.curves,m&&S++,b[S]=[]):b[S].push({h:c,p:C[0]});if(!g[0])return t(a);if(g.length>1){let A=!1,R=0;for(let N=0,B=g.length;N<B;N++)x[N]=[];for(let N=0,B=g.length;N<B;N++){const F=b[N];for(let U=0;U<F.length;U++){const z=F[U];let P=!0;for(let L=0;L<g.length;L++)n(z.p,g[L].p)&&(N!==L&&R++,P?(P=!1,x[L].push(z)):A=!0);P&&x[N].push(z)}}R>0&&A===!1&&(b=x)}let M;for(let A=0,R=g.length;A<R;A++){u=g[A].s,h.push(u),M=b[A];for(let N=0,B=M.length;N<B;N++)u.holes.push(M[N].h)}return h}}class q5 extends eu{constructor(e,t=null){super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(e){if(e===void 0){un("Controls: connect() now requires an element.");return}this.domElement!==null&&this.disconnect(),this.domElement=e}disconnect(){}dispose(){}update(){}}function J5(s,e){const t=s.image&&s.image.width?s.image.width/s.image.height:1;return t>e?(s.repeat.x=1,s.repeat.y=t/e,s.offset.x=0,s.offset.y=(1-s.repeat.y)/2):(s.repeat.x=e/t,s.repeat.y=1,s.offset.x=(1-s.repeat.x)/2,s.offset.y=0),s}function Z5(s,e){const t=s.image&&s.image.width?s.image.width/s.image.height:1;return t>e?(s.repeat.x=e/t,s.repeat.y=1,s.offset.x=(1-s.repeat.x)/2,s.offset.y=0):(s.repeat.x=1,s.repeat.y=t/e,s.offset.x=0,s.offset.y=(1-s.repeat.y)/2),s}function K5(s){return s.repeat.x=1,s.repeat.y=1,s.offset.x=0,s.offset.y=0,s}function O_(s,e,t,n){const i=Q5(n);switch(t){case lS:return s*e;case Sx:return s*e/i.components*i.byteLength;case Ax:return s*e/i.components*i.byteLength;case cy:return s*e*2/i.components*i.byteLength;case uy:return s*e*2/i.components*i.byteLength;case cS:return s*e*3/i.components*i.byteLength;case ss:return s*e*4/i.components*i.byteLength;case fy:return s*e*4/i.components*i.byteLength;case Wm:case qm:return Math.floor((s+3)/4)*Math.floor((e+3)/4)*8;case Jm:case Zm:return Math.floor((s+3)/4)*Math.floor((e+3)/4)*16;case h1:case p1:return Math.max(s,16)*Math.max(e,8)/4;case f1:case d1:return Math.max(s,8)*Math.max(e,8)/2;case m1:case x1:return Math.floor((s+3)/4)*Math.floor((e+3)/4)*8;case g1:return Math.floor((s+3)/4)*Math.floor((e+3)/4)*16;case v1:return Math.floor((s+3)/4)*Math.floor((e+3)/4)*16;case y1:return Math.floor((s+4)/5)*Math.floor((e+3)/4)*16;case b1:return Math.floor((s+4)/5)*Math.floor((e+4)/5)*16;case _1:return Math.floor((s+5)/6)*Math.floor((e+4)/5)*16;case S1:return Math.floor((s+5)/6)*Math.floor((e+5)/6)*16;case A1:return Math.floor((s+7)/8)*Math.floor((e+4)/5)*16;case M1:return Math.floor((s+7)/8)*Math.floor((e+5)/6)*16;case w1:return Math.floor((s+7)/8)*Math.floor((e+7)/8)*16;case E1:return Math.floor((s+9)/10)*Math.floor((e+4)/5)*16;case C1:return Math.floor((s+9)/10)*Math.floor((e+5)/6)*16;case T1:return Math.floor((s+9)/10)*Math.floor((e+7)/8)*16;case R1:return Math.floor((s+9)/10)*Math.floor((e+9)/10)*16;case N1:return Math.floor((s+11)/12)*Math.floor((e+9)/10)*16;case B1:return Math.floor((s+11)/12)*Math.floor((e+11)/12)*16;case D1:case U1:case L1:return Math.ceil(s/4)*Math.ceil(e/4)*16;case O1:case I1:return Math.ceil(s/4)*Math.ceil(e/4)*8;case z1:case F1:return Math.ceil(s/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function Q5(s){switch(s){case uo:case sy:return{byteLength:1,components:1};case Pp:case ry:case xs:return{byteLength:2,components:1};case oy:case ly:return{byteLength:2,components:4};case Qc:case _x:case Da:return{byteLength:4,components:1};case rS:case oS:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${s}.`)}class $5{static contain(e,t){return J5(e,t)}static cover(e,t){return Z5(e,t)}static fill(e){return K5(e)}static getByteLength(e,t,n,i){return O_(e,t,n,i)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:n0}}));typeof window<"u"&&(window.__THREE__?un("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=n0);/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */function nT(){let s=null,e=!1,t=null,n=null;function i(a,o){t(a,o),n=s.requestAnimationFrame(i)}return{start:function(){e!==!0&&t!==null&&(n=s.requestAnimationFrame(i),e=!0)},stop:function(){s.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(a){t=a},setContext:function(a){s=a}}}function e4(s){const e=new WeakMap;function t(c,u){const h=c.array,m=c.usage,x=h.byteLength,g=s.createBuffer();s.bindBuffer(u,g),s.bufferData(u,h,m),c.onUploadCallback();let b;if(h instanceof Float32Array)b=s.FLOAT;else if(typeof Float16Array<"u"&&h instanceof Float16Array)b=s.HALF_FLOAT;else if(h instanceof Uint16Array)c.isFloat16BufferAttribute?b=s.HALF_FLOAT:b=s.UNSIGNED_SHORT;else if(h instanceof Int16Array)b=s.SHORT;else if(h instanceof Uint32Array)b=s.UNSIGNED_INT;else if(h instanceof Int32Array)b=s.INT;else if(h instanceof Int8Array)b=s.BYTE;else if(h instanceof Uint8Array)b=s.UNSIGNED_BYTE;else if(h instanceof Uint8ClampedArray)b=s.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+h);return{buffer:g,type:b,bytesPerElement:h.BYTES_PER_ELEMENT,version:c.version,size:x}}function n(c,u,h){const m=u.array,x=u.updateRanges;if(s.bindBuffer(h,c),x.length===0)s.bufferSubData(h,0,m);else{x.sort((b,S)=>b.start-S.start);let g=0;for(let b=1;b<x.length;b++){const S=x[g],C=x[b];C.start<=S.start+S.count+1?S.count=Math.max(S.count,C.start+C.count-S.start):(++g,x[g]=C)}x.length=g+1;for(let b=0,S=x.length;b<S;b++){const C=x[b];s.bufferSubData(h,C.start*m.BYTES_PER_ELEMENT,m,C.start,C.count)}u.clearUpdateRanges()}u.onUploadCallback()}function i(c){return c.isInterleavedBufferAttribute&&(c=c.data),e.get(c)}function a(c){c.isInterleavedBufferAttribute&&(c=c.data);const u=e.get(c);u&&(s.deleteBuffer(u.buffer),e.delete(c))}function o(c,u){if(c.isInterleavedBufferAttribute&&(c=c.data),c.isGLBufferAttribute){const m=e.get(c);(!m||m.version<c.version)&&e.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version});return}const h=e.get(c);if(h===void 0)e.set(c,t(c,u));else if(h.version<c.version){if(h.size!==c.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");n(h.buffer,c,u),h.version=c.version}}return{get:i,remove:a,update:o}}var t4=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,n4=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,i4=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,a4=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,s4=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,r4=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,o4=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,l4=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,c4=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,u4=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,f4=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,h4=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,d4=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,p4=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,m4=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,x4=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,g4=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,v4=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,y4=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,b4=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,_4=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,S4=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,A4=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,M4=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,w4=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,E4=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,C4=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,T4=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,R4=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,N4=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,B4="gl_FragColor = linearToOutputTexel( gl_FragColor );",D4=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,U4=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,L4=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
#endif`,O4=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,I4=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,z4=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,F4=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,P4=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,G4=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,j4=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,H4=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,k4=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,V4=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,X4=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,Y4=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,W4=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, pow4( roughness ) ) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,q4=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,J4=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,Z4=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,K4=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,Q4=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,$4=`uniform sampler2D dfgLUT;
struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transpose( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 uv = vec2( roughness, dotNV );
	return texture2D( dfgLUT, uv ).rg;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
vec3 BRDF_GGX_Multiscatter( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 singleScatter = BRDF_GGX( lightDir, viewDir, normal, material );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 dfgV = DFGApprox( vec3(0.0, 0.0, 1.0), vec3(sqrt(1.0 - dotNV * dotNV), 0.0, dotNV), material.roughness );
	vec2 dfgL = DFGApprox( vec3(0.0, 0.0, 1.0), vec3(sqrt(1.0 - dotNL * dotNL), 0.0, dotNL), material.roughness );
	vec3 FssEss_V = material.specularColor * dfgV.x + material.specularF90 * dfgV.y;
	vec3 FssEss_L = material.specularColor * dfgL.x + material.specularF90 * dfgL.y;
	float Ess_V = dfgV.x + dfgV.y;
	float Ess_L = dfgL.x + dfgL.y;
	float Ems_V = 1.0 - Ess_V;
	float Ems_L = 1.0 - Ess_L;
	vec3 Favg = material.specularColor + ( 1.0 - material.specularColor ) * 0.047619;
	vec3 Fms = FssEss_V * FssEss_L * Favg / ( 1.0 - Ems_V * Ems_L * Favg * Favg + EPSILON );
	float compensationFactor = Ems_V * Ems_L;
	vec3 multiScatter = Fms * compensationFactor;
	return singleScatter + multiScatter;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX_Multiscatter( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,eU=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,tU=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,nU=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,iU=`#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,aU=`#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,sU=`#ifdef USE_LOGARITHMIC_DEPTH_BUFFER
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,rU=`#ifdef USE_LOGARITHMIC_DEPTH_BUFFER
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,oU=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,lU=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,cU=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,uU=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,fU=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,hU=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,dU=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,pU=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,mU=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,xU=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,gU=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,vU=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,yU=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,bU=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,_U=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,SU=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,AU=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,MU=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,wU=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,EU=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,CU=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,TU=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,RU=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,NU=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,BU=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,DU=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,UU=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,LU=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,OU=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,IU=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		float depth = unpackRGBAToDepth( texture2D( depths, uv ) );
		#ifdef USE_REVERSED_DEPTH_BUFFER
			return step( depth, compare );
		#else
			return step( compare, depth );
		#endif
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow( sampler2D shadow, vec2 uv, float compare ) {
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		#ifdef USE_REVERSED_DEPTH_BUFFER
			float hard_shadow = step( distribution.x, compare );
		#else
			float hard_shadow = step( compare, distribution.x );
		#endif
		if ( hard_shadow != 1.0 ) {
			float distance = compare - distribution.x;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,zU=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,FU=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,PU=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,GU=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,jU=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,HU=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,kU=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,VU=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,XU=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,YU=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,WU=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,qU=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,JU=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,ZU=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,KU=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,QU=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,$U=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const eL=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,tL=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,nL=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,iL=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,aL=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,sL=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,rL=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,oL=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	#ifdef USE_REVERSED_DEPTH_BUFFER
		float fragCoordZ = vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ];
	#else
		float fragCoordZ = 0.5 * vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ] + 0.5;
	#endif
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,lL=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,cL=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,uL=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,fL=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,hL=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,dL=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,pL=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,mL=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,xL=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,gL=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vL=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,yL=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,bL=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,_L=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,SL=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,AL=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,ML=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,wL=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,EL=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,CL=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,TL=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,RL=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,NL=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,BL=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,DL=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,UL=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,ni={alphahash_fragment:t4,alphahash_pars_fragment:n4,alphamap_fragment:i4,alphamap_pars_fragment:a4,alphatest_fragment:s4,alphatest_pars_fragment:r4,aomap_fragment:o4,aomap_pars_fragment:l4,batching_pars_vertex:c4,batching_vertex:u4,begin_vertex:f4,beginnormal_vertex:h4,bsdfs:d4,iridescence_fragment:p4,bumpmap_pars_fragment:m4,clipping_planes_fragment:x4,clipping_planes_pars_fragment:g4,clipping_planes_pars_vertex:v4,clipping_planes_vertex:y4,color_fragment:b4,color_pars_fragment:_4,color_pars_vertex:S4,color_vertex:A4,common:M4,cube_uv_reflection_fragment:w4,defaultnormal_vertex:E4,displacementmap_pars_vertex:C4,displacementmap_vertex:T4,emissivemap_fragment:R4,emissivemap_pars_fragment:N4,colorspace_fragment:B4,colorspace_pars_fragment:D4,envmap_fragment:U4,envmap_common_pars_fragment:L4,envmap_pars_fragment:O4,envmap_pars_vertex:I4,envmap_physical_pars_fragment:W4,envmap_vertex:z4,fog_vertex:F4,fog_pars_vertex:P4,fog_fragment:G4,fog_pars_fragment:j4,gradientmap_pars_fragment:H4,lightmap_pars_fragment:k4,lights_lambert_fragment:V4,lights_lambert_pars_fragment:X4,lights_pars_begin:Y4,lights_toon_fragment:q4,lights_toon_pars_fragment:J4,lights_phong_fragment:Z4,lights_phong_pars_fragment:K4,lights_physical_fragment:Q4,lights_physical_pars_fragment:$4,lights_fragment_begin:eU,lights_fragment_maps:tU,lights_fragment_end:nU,logdepthbuf_fragment:iU,logdepthbuf_pars_fragment:aU,logdepthbuf_pars_vertex:sU,logdepthbuf_vertex:rU,map_fragment:oU,map_pars_fragment:lU,map_particle_fragment:cU,map_particle_pars_fragment:uU,metalnessmap_fragment:fU,metalnessmap_pars_fragment:hU,morphinstance_vertex:dU,morphcolor_vertex:pU,morphnormal_vertex:mU,morphtarget_pars_vertex:xU,morphtarget_vertex:gU,normal_fragment_begin:vU,normal_fragment_maps:yU,normal_pars_fragment:bU,normal_pars_vertex:_U,normal_vertex:SU,normalmap_pars_fragment:AU,clearcoat_normal_fragment_begin:MU,clearcoat_normal_fragment_maps:wU,clearcoat_pars_fragment:EU,iridescence_pars_fragment:CU,opaque_fragment:TU,packing:RU,premultiplied_alpha_fragment:NU,project_vertex:BU,dithering_fragment:DU,dithering_pars_fragment:UU,roughnessmap_fragment:LU,roughnessmap_pars_fragment:OU,shadowmap_pars_fragment:IU,shadowmap_pars_vertex:zU,shadowmap_vertex:FU,shadowmask_pars_fragment:PU,skinbase_vertex:GU,skinning_pars_vertex:jU,skinning_vertex:HU,skinnormal_vertex:kU,specularmap_fragment:VU,specularmap_pars_fragment:XU,tonemapping_fragment:YU,tonemapping_pars_fragment:WU,transmission_fragment:qU,transmission_pars_fragment:JU,uv_pars_fragment:ZU,uv_pars_vertex:KU,uv_vertex:QU,worldpos_vertex:$U,background_vert:eL,background_frag:tL,backgroundCube_vert:nL,backgroundCube_frag:iL,cube_vert:aL,cube_frag:sL,depth_vert:rL,depth_frag:oL,distanceRGBA_vert:lL,distanceRGBA_frag:cL,equirect_vert:uL,equirect_frag:fL,linedashed_vert:hL,linedashed_frag:dL,meshbasic_vert:pL,meshbasic_frag:mL,meshlambert_vert:xL,meshlambert_frag:gL,meshmatcap_vert:vL,meshmatcap_frag:yL,meshnormal_vert:bL,meshnormal_frag:_L,meshphong_vert:SL,meshphong_frag:AL,meshphysical_vert:ML,meshphysical_frag:wL,meshtoon_vert:EL,meshtoon_frag:CL,points_vert:TL,points_frag:RL,shadow_vert:NL,shadow_frag:BL,sprite_vert:DL,sprite_frag:UL},rn={common:{diffuse:{value:new qt(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Qn},alphaMap:{value:null},alphaMapTransform:{value:new Qn},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Qn}},envmap:{envMap:{value:null},envMapRotation:{value:new Qn},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98},dfgLUT:{value:null}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Qn}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Qn}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Qn},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Qn},normalScale:{value:new gt(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Qn},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Qn}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Qn}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Qn}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new qt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new qt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Qn},alphaTest:{value:0},uvTransform:{value:new Qn}},sprite:{diffuse:{value:new qt(16777215)},opacity:{value:1},center:{value:new gt(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Qn},alphaMap:{value:null},alphaMapTransform:{value:new Qn},alphaTest:{value:0}}},oc={basic:{uniforms:oo([rn.common,rn.specularmap,rn.envmap,rn.aomap,rn.lightmap,rn.fog]),vertexShader:ni.meshbasic_vert,fragmentShader:ni.meshbasic_frag},lambert:{uniforms:oo([rn.common,rn.specularmap,rn.envmap,rn.aomap,rn.lightmap,rn.emissivemap,rn.bumpmap,rn.normalmap,rn.displacementmap,rn.fog,rn.lights,{emissive:{value:new qt(0)}}]),vertexShader:ni.meshlambert_vert,fragmentShader:ni.meshlambert_frag},phong:{uniforms:oo([rn.common,rn.specularmap,rn.envmap,rn.aomap,rn.lightmap,rn.emissivemap,rn.bumpmap,rn.normalmap,rn.displacementmap,rn.fog,rn.lights,{emissive:{value:new qt(0)},specular:{value:new qt(1118481)},shininess:{value:30}}]),vertexShader:ni.meshphong_vert,fragmentShader:ni.meshphong_frag},standard:{uniforms:oo([rn.common,rn.envmap,rn.aomap,rn.lightmap,rn.emissivemap,rn.bumpmap,rn.normalmap,rn.displacementmap,rn.roughnessmap,rn.metalnessmap,rn.fog,rn.lights,{emissive:{value:new qt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ni.meshphysical_vert,fragmentShader:ni.meshphysical_frag},toon:{uniforms:oo([rn.common,rn.aomap,rn.lightmap,rn.emissivemap,rn.bumpmap,rn.normalmap,rn.displacementmap,rn.gradientmap,rn.fog,rn.lights,{emissive:{value:new qt(0)}}]),vertexShader:ni.meshtoon_vert,fragmentShader:ni.meshtoon_frag},matcap:{uniforms:oo([rn.common,rn.bumpmap,rn.normalmap,rn.displacementmap,rn.fog,{matcap:{value:null}}]),vertexShader:ni.meshmatcap_vert,fragmentShader:ni.meshmatcap_frag},points:{uniforms:oo([rn.points,rn.fog]),vertexShader:ni.points_vert,fragmentShader:ni.points_frag},dashed:{uniforms:oo([rn.common,rn.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ni.linedashed_vert,fragmentShader:ni.linedashed_frag},depth:{uniforms:oo([rn.common,rn.displacementmap]),vertexShader:ni.depth_vert,fragmentShader:ni.depth_frag},normal:{uniforms:oo([rn.common,rn.bumpmap,rn.normalmap,rn.displacementmap,{opacity:{value:1}}]),vertexShader:ni.meshnormal_vert,fragmentShader:ni.meshnormal_frag},sprite:{uniforms:oo([rn.sprite,rn.fog]),vertexShader:ni.sprite_vert,fragmentShader:ni.sprite_frag},background:{uniforms:{uvTransform:{value:new Qn},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:ni.background_vert,fragmentShader:ni.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Qn}},vertexShader:ni.backgroundCube_vert,fragmentShader:ni.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:ni.cube_vert,fragmentShader:ni.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ni.equirect_vert,fragmentShader:ni.equirect_frag},distanceRGBA:{uniforms:oo([rn.common,rn.displacementmap,{referencePosition:{value:new k},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ni.distanceRGBA_vert,fragmentShader:ni.distanceRGBA_frag},shadow:{uniforms:oo([rn.lights,rn.fog,{color:{value:new qt(0)},opacity:{value:1}}]),vertexShader:ni.shadow_vert,fragmentShader:ni.shadow_frag}};oc.physical={uniforms:oo([oc.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Qn},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Qn},clearcoatNormalScale:{value:new gt(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Qn},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Qn},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Qn},sheen:{value:0},sheenColor:{value:new qt(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Qn},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Qn},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Qn},transmissionSamplerSize:{value:new gt},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Qn},attenuationDistance:{value:0},attenuationColor:{value:new qt(0)},specularColor:{value:new qt(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Qn},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Qn},anisotropyVector:{value:new gt},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Qn}}]),vertexShader:ni.meshphysical_vert,fragmentShader:ni.meshphysical_frag};const Sv={r:0,b:0,g:0},Lh=new hi,LL=new wn;function OL(s,e,t,n,i,a,o){const c=new qt(0);let u=a===!0?0:1,h,m,x=null,g=0,b=null;function S(N){let B=N.isScene===!0?N.background:null;return B&&B.isTexture&&(B=(N.backgroundBlurriness>0?t:e).get(B)),B}function C(N){let B=!1;const F=S(N);F===null?A(c,u):F&&F.isColor&&(A(F,1),B=!0);const U=s.xr.getEnvironmentBlendMode();U==="additive"?n.buffers.color.setClear(0,0,0,1,o):U==="alpha-blend"&&n.buffers.color.setClear(0,0,0,0,o),(s.autoClear||B)&&(n.buffers.depth.setTest(!0),n.buffers.depth.setMask(!0),n.buffers.color.setMask(!0),s.clear(s.autoClearColor,s.autoClearDepth,s.autoClearStencil))}function M(N,B){const F=S(B);F&&(F.isCubeTexture||F.mapping===i0)?(m===void 0&&(m=new sn(new ks(1,1,1),new Ys({name:"BackgroundCubeMaterial",uniforms:Jp(oc.backgroundCube.uniforms),vertexShader:oc.backgroundCube.vertexShader,fragmentShader:oc.backgroundCube.fragmentShader,side:fr,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),m.geometry.deleteAttribute("normal"),m.geometry.deleteAttribute("uv"),m.onBeforeRender=function(U,z,P){this.matrixWorld.copyPosition(P.matrixWorld)},Object.defineProperty(m.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(m)),Lh.copy(B.backgroundRotation),Lh.x*=-1,Lh.y*=-1,Lh.z*=-1,F.isCubeTexture&&F.isRenderTargetTexture===!1&&(Lh.y*=-1,Lh.z*=-1),m.material.uniforms.envMap.value=F,m.material.uniforms.flipEnvMap.value=F.isCubeTexture&&F.isRenderTargetTexture===!1?-1:1,m.material.uniforms.backgroundBlurriness.value=B.backgroundBlurriness,m.material.uniforms.backgroundIntensity.value=B.backgroundIntensity,m.material.uniforms.backgroundRotation.value.setFromMatrix4(LL.makeRotationFromEuler(Lh)),m.material.toneMapped=Ri.getTransfer(F.colorSpace)!==ta,(x!==F||g!==F.version||b!==s.toneMapping)&&(m.material.needsUpdate=!0,x=F,g=F.version,b=s.toneMapping),m.layers.enableAll(),N.unshift(m,m.geometry,m.material,0,0,null)):F&&F.isTexture&&(h===void 0&&(h=new sn(new is(2,2),new Ys({name:"BackgroundMaterial",uniforms:Jp(oc.background.uniforms),vertexShader:oc.background.vertexShader,fragmentShader:oc.background.fragmentShader,side:Zc,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),h.geometry.deleteAttribute("normal"),Object.defineProperty(h.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(h)),h.material.uniforms.t2D.value=F,h.material.uniforms.backgroundIntensity.value=B.backgroundIntensity,h.material.toneMapped=Ri.getTransfer(F.colorSpace)!==ta,F.matrixAutoUpdate===!0&&F.updateMatrix(),h.material.uniforms.uvTransform.value.copy(F.matrix),(x!==F||g!==F.version||b!==s.toneMapping)&&(h.material.needsUpdate=!0,x=F,g=F.version,b=s.toneMapping),h.layers.enableAll(),N.unshift(h,h.geometry,h.material,0,0,null))}function A(N,B){N.getRGB(Sv,hC(s)),n.buffers.color.setClear(Sv.r,Sv.g,Sv.b,B,o)}function R(){m!==void 0&&(m.geometry.dispose(),m.material.dispose(),m=void 0),h!==void 0&&(h.geometry.dispose(),h.material.dispose(),h=void 0)}return{getClearColor:function(){return c},setClearColor:function(N,B=1){c.set(N),u=B,A(c,u)},getClearAlpha:function(){return u},setClearAlpha:function(N){u=N,A(c,u)},render:C,addToRenderList:M,dispose:R}}function IL(s,e){const t=s.getParameter(s.MAX_VERTEX_ATTRIBS),n={},i=g(null);let a=i,o=!1;function c(O,ee,Q,te,ne){let re=!1;const j=x(te,Q,ee);a!==j&&(a=j,h(a.object)),re=b(O,te,Q,ne),re&&S(O,te,Q,ne),ne!==null&&e.update(ne,s.ELEMENT_ARRAY_BUFFER),(re||o)&&(o=!1,B(O,ee,Q,te),ne!==null&&s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,e.get(ne).buffer))}function u(){return s.createVertexArray()}function h(O){return s.bindVertexArray(O)}function m(O){return s.deleteVertexArray(O)}function x(O,ee,Q){const te=Q.wireframe===!0;let ne=n[O.id];ne===void 0&&(ne={},n[O.id]=ne);let re=ne[ee.id];re===void 0&&(re={},ne[ee.id]=re);let j=re[te];return j===void 0&&(j=g(u()),re[te]=j),j}function g(O){const ee=[],Q=[],te=[];for(let ne=0;ne<t;ne++)ee[ne]=0,Q[ne]=0,te[ne]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:ee,enabledAttributes:Q,attributeDivisors:te,object:O,attributes:{},index:null}}function b(O,ee,Q,te){const ne=a.attributes,re=ee.attributes;let j=0;const ae=Q.getAttributes();for(const J in ae)if(ae[J].location>=0){const se=ne[J];let I=re[J];if(I===void 0&&(J==="instanceMatrix"&&O.instanceMatrix&&(I=O.instanceMatrix),J==="instanceColor"&&O.instanceColor&&(I=O.instanceColor)),se===void 0||se.attribute!==I||I&&se.data!==I.data)return!0;j++}return a.attributesNum!==j||a.index!==te}function S(O,ee,Q,te){const ne={},re=ee.attributes;let j=0;const ae=Q.getAttributes();for(const J in ae)if(ae[J].location>=0){let se=re[J];se===void 0&&(J==="instanceMatrix"&&O.instanceMatrix&&(se=O.instanceMatrix),J==="instanceColor"&&O.instanceColor&&(se=O.instanceColor));const I={};I.attribute=se,se&&se.data&&(I.data=se.data),ne[J]=I,j++}a.attributes=ne,a.attributesNum=j,a.index=te}function C(){const O=a.newAttributes;for(let ee=0,Q=O.length;ee<Q;ee++)O[ee]=0}function M(O){A(O,0)}function A(O,ee){const Q=a.newAttributes,te=a.enabledAttributes,ne=a.attributeDivisors;Q[O]=1,te[O]===0&&(s.enableVertexAttribArray(O),te[O]=1),ne[O]!==ee&&(s.vertexAttribDivisor(O,ee),ne[O]=ee)}function R(){const O=a.newAttributes,ee=a.enabledAttributes;for(let Q=0,te=ee.length;Q<te;Q++)ee[Q]!==O[Q]&&(s.disableVertexAttribArray(Q),ee[Q]=0)}function N(O,ee,Q,te,ne,re,j){j===!0?s.vertexAttribIPointer(O,ee,Q,ne,re):s.vertexAttribPointer(O,ee,Q,te,ne,re)}function B(O,ee,Q,te){C();const ne=te.attributes,re=Q.getAttributes(),j=ee.defaultAttributeValues;for(const ae in re){const J=re[ae];if(J.location>=0){let ie=ne[ae];if(ie===void 0&&(ae==="instanceMatrix"&&O.instanceMatrix&&(ie=O.instanceMatrix),ae==="instanceColor"&&O.instanceColor&&(ie=O.instanceColor)),ie!==void 0){const se=ie.normalized,I=ie.itemSize,W=e.get(ie);if(W===void 0)continue;const fe=W.buffer,Z=W.type,me=W.bytesPerElement,$=Z===s.INT||Z===s.UNSIGNED_INT||ie.gpuType===_x;if(ie.isInterleavedBufferAttribute){const pe=ie.data,ve=pe.stride,ze=ie.offset;if(pe.isInstancedInterleavedBuffer){for(let Ge=0;Ge<J.locationSize;Ge++)A(J.location+Ge,pe.meshPerAttribute);O.isInstancedMesh!==!0&&te._maxInstanceCount===void 0&&(te._maxInstanceCount=pe.meshPerAttribute*pe.count)}else for(let Ge=0;Ge<J.locationSize;Ge++)M(J.location+Ge);s.bindBuffer(s.ARRAY_BUFFER,fe);for(let Ge=0;Ge<J.locationSize;Ge++)N(J.location+Ge,I/J.locationSize,Z,se,ve*me,(ze+I/J.locationSize*Ge)*me,$)}else{if(ie.isInstancedBufferAttribute){for(let pe=0;pe<J.locationSize;pe++)A(J.location+pe,ie.meshPerAttribute);O.isInstancedMesh!==!0&&te._maxInstanceCount===void 0&&(te._maxInstanceCount=ie.meshPerAttribute*ie.count)}else for(let pe=0;pe<J.locationSize;pe++)M(J.location+pe);s.bindBuffer(s.ARRAY_BUFFER,fe);for(let pe=0;pe<J.locationSize;pe++)N(J.location+pe,I/J.locationSize,Z,se,I*me,I/J.locationSize*pe*me,$)}}else if(j!==void 0){const se=j[ae];if(se!==void 0)switch(se.length){case 2:s.vertexAttrib2fv(J.location,se);break;case 3:s.vertexAttrib3fv(J.location,se);break;case 4:s.vertexAttrib4fv(J.location,se);break;default:s.vertexAttrib1fv(J.location,se)}}}}R()}function F(){P();for(const O in n){const ee=n[O];for(const Q in ee){const te=ee[Q];for(const ne in te)m(te[ne].object),delete te[ne];delete ee[Q]}delete n[O]}}function U(O){if(n[O.id]===void 0)return;const ee=n[O.id];for(const Q in ee){const te=ee[Q];for(const ne in te)m(te[ne].object),delete te[ne];delete ee[Q]}delete n[O.id]}function z(O){for(const ee in n){const Q=n[ee];if(Q[O.id]===void 0)continue;const te=Q[O.id];for(const ne in te)m(te[ne].object),delete te[ne];delete Q[O.id]}}function P(){L(),o=!0,a!==i&&(a=i,h(a.object))}function L(){i.geometry=null,i.program=null,i.wireframe=!1}return{setup:c,reset:P,resetDefaultState:L,dispose:F,releaseStatesOfGeometry:U,releaseStatesOfProgram:z,initAttributes:C,enableAttribute:M,disableUnusedAttributes:R}}function zL(s,e,t){let n;function i(h){n=h}function a(h,m){s.drawArrays(n,h,m),t.update(m,n,1)}function o(h,m,x){x!==0&&(s.drawArraysInstanced(n,h,m,x),t.update(m,n,x))}function c(h,m,x){if(x===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(n,h,0,m,0,x);let b=0;for(let S=0;S<x;S++)b+=m[S];t.update(b,n,1)}function u(h,m,x,g){if(x===0)return;const b=e.get("WEBGL_multi_draw");if(b===null)for(let S=0;S<h.length;S++)o(h[S],m[S],g[S]);else{b.multiDrawArraysInstancedWEBGL(n,h,0,m,0,g,0,x);let S=0;for(let C=0;C<x;C++)S+=m[C]*g[C];t.update(S,n,1)}}this.setMode=i,this.render=a,this.renderInstances=o,this.renderMultiDraw=c,this.renderMultiDrawInstances=u}function FL(s,e,t,n){let i;function a(){if(i!==void 0)return i;if(e.has("EXT_texture_filter_anisotropic")===!0){const z=e.get("EXT_texture_filter_anisotropic");i=s.getParameter(z.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function o(z){return!(z!==ss&&n.convert(z)!==s.getParameter(s.IMPLEMENTATION_COLOR_READ_FORMAT))}function c(z){const P=z===xs&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(z!==uo&&n.convert(z)!==s.getParameter(s.IMPLEMENTATION_COLOR_READ_TYPE)&&z!==Da&&!P)}function u(z){if(z==="highp"){if(s.getShaderPrecisionFormat(s.VERTEX_SHADER,s.HIGH_FLOAT).precision>0&&s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.HIGH_FLOAT).precision>0)return"highp";z="mediump"}return z==="mediump"&&s.getShaderPrecisionFormat(s.VERTEX_SHADER,s.MEDIUM_FLOAT).precision>0&&s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let h=t.precision!==void 0?t.precision:"highp";const m=u(h);m!==h&&(un("WebGLRenderer:",h,"not supported, using",m,"instead."),h=m);const x=t.logarithmicDepthBuffer===!0,g=t.reversedDepthBuffer===!0&&e.has("EXT_clip_control"),b=s.getParameter(s.MAX_TEXTURE_IMAGE_UNITS),S=s.getParameter(s.MAX_VERTEX_TEXTURE_IMAGE_UNITS),C=s.getParameter(s.MAX_TEXTURE_SIZE),M=s.getParameter(s.MAX_CUBE_MAP_TEXTURE_SIZE),A=s.getParameter(s.MAX_VERTEX_ATTRIBS),R=s.getParameter(s.MAX_VERTEX_UNIFORM_VECTORS),N=s.getParameter(s.MAX_VARYING_VECTORS),B=s.getParameter(s.MAX_FRAGMENT_UNIFORM_VECTORS),F=S>0,U=s.getParameter(s.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:a,getMaxPrecision:u,textureFormatReadable:o,textureTypeReadable:c,precision:h,logarithmicDepthBuffer:x,reversedDepthBuffer:g,maxTextures:b,maxVertexTextures:S,maxTextureSize:C,maxCubemapSize:M,maxAttributes:A,maxVertexUniforms:R,maxVaryings:N,maxFragmentUniforms:B,vertexTextures:F,maxSamples:U}}function PL(s){const e=this;let t=null,n=0,i=!1,a=!1;const o=new rc,c=new Qn,u={value:null,needsUpdate:!1};this.uniform=u,this.numPlanes=0,this.numIntersection=0,this.init=function(x,g){const b=x.length!==0||g||n!==0||i;return i=g,n=x.length,b},this.beginShadows=function(){a=!0,m(null)},this.endShadows=function(){a=!1},this.setGlobalState=function(x,g){t=m(x,g,0)},this.setState=function(x,g,b){const S=x.clippingPlanes,C=x.clipIntersection,M=x.clipShadows,A=s.get(x);if(!i||S===null||S.length===0||a&&!M)a?m(null):h();else{const R=a?0:n,N=R*4;let B=A.clippingState||null;u.value=B,B=m(S,g,N,b);for(let F=0;F!==N;++F)B[F]=t[F];A.clippingState=B,this.numIntersection=C?this.numPlanes:0,this.numPlanes+=R}};function h(){u.value!==t&&(u.value=t,u.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function m(x,g,b,S){const C=x!==null?x.length:0;let M=null;if(C!==0){if(M=u.value,S!==!0||M===null){const A=b+C*4,R=g.matrixWorldInverse;c.getNormalMatrix(R),(M===null||M.length<A)&&(M=new Float32Array(A));for(let N=0,B=b;N!==C;++N,B+=4)o.copy(x[N]).applyMatrix4(R,c),o.normal.toArray(M,B),M[B+3]=o.constant}u.value=M,u.needsUpdate=!0}return e.numPlanes=C,e.numIntersection=0,M}}function GL(s){let e=new WeakMap;function t(o,c){return c===zp?o.mapping=Kc:c===sx&&(o.mapping=Lf),o}function n(o){if(o&&o.isTexture){const c=o.mapping;if(c===zp||c===sx)if(e.has(o)){const u=e.get(o).texture;return t(u,o.mapping)}else{const u=o.image;if(u&&u.height>0){const h=new vS(u.height);return h.fromEquirectangularTexture(s,o),e.set(o,h),o.addEventListener("dispose",i),t(h.texture,o.mapping)}else return null}}return o}function i(o){const c=o.target;c.removeEventListener("dispose",i);const u=e.get(c);u!==void 0&&(e.delete(c),u.dispose())}function a(){e=new WeakMap}return{get:n,dispose:a}}const Nf=4,Mw=[.125,.215,.35,.446,.526,.582],kh=20,jL=256,Rm=new El,ww=new qt;let x2=null,g2=0,v2=0,y2=!1;const HL=new k;class I_{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._sizeLods=[],this._sigmas=[],this._lodMeshes=[],this._backgroundBox=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._blurMaterial=null,this._ggxMaterial=null}fromScene(e,t=0,n=.1,i=100,a={}){const{size:o=256,position:c=HL}=a;x2=this._renderer.getRenderTarget(),g2=this._renderer.getActiveCubeFace(),v2=this._renderer.getActiveMipmapLevel(),y2=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(o);const u=this._allocateTargets();return u.depthBuffer=!0,this._sceneToCubeUV(e,n,i,u,c),t>0&&this._blur(u,0,0,t),this._applyPMREM(u),this._cleanup(u),u}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=Tw(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=Cw(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose(),this._backgroundBox!==null&&(this._backgroundBox.geometry.dispose(),this._backgroundBox.material.dispose())}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._ggxMaterial!==null&&this._ggxMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodMeshes.length;e++)this._lodMeshes[e].geometry.dispose()}_cleanup(e){this._renderer.setRenderTarget(x2,g2,v2),this._renderer.xr.enabled=y2,e.scissorTest=!1,_p(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Kc||e.mapping===Lf?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),x2=this._renderer.getRenderTarget(),g2=this._renderer.getActiveCubeFace(),v2=this._renderer.getActiveMipmapLevel(),y2=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:bi,minFilter:bi,generateMipmaps:!1,type:xs,format:ss,colorSpace:uc,depthBuffer:!1},i=Ew(e,t,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=Ew(e,t,n);const{_lodMax:a}=this;({lodMeshes:this._lodMeshes,sizeLods:this._sizeLods,sigmas:this._sigmas}=kL(a)),this._blurMaterial=XL(a,e,t),this._ggxMaterial=VL(a,e,t)}return i}_compileMaterial(e){const t=new sn(new Rn,e);this._renderer.compile(t,Rm)}_sceneToCubeUV(e,t,n,i,a){const u=new Ba(90,1,t,n),h=[1,-1,1,1,1,1],m=[1,1,1,-1,-1,-1],x=this._renderer,g=x.autoClear,b=x.toneMapping;x.getClearColor(ww),x.toneMapping=qc,x.autoClear=!1,x.state.buffers.depth.getReversed()&&(x.setRenderTarget(i),x.clearDepth(),x.setRenderTarget(null)),this._backgroundBox===null&&(this._backgroundBox=new sn(new ks,new ur({name:"PMREM.Background",side:fr,depthWrite:!1,depthTest:!1})));const C=this._backgroundBox,M=C.material;let A=!1;const R=e.background;R?R.isColor&&(M.color.copy(R),e.background=null,A=!0):(M.color.copy(ww),A=!0);for(let N=0;N<6;N++){const B=N%3;B===0?(u.up.set(0,h[N],0),u.position.set(a.x,a.y,a.z),u.lookAt(a.x+m[N],a.y,a.z)):B===1?(u.up.set(0,0,h[N]),u.position.set(a.x,a.y,a.z),u.lookAt(a.x,a.y+m[N],a.z)):(u.up.set(0,h[N],0),u.position.set(a.x,a.y,a.z),u.lookAt(a.x,a.y,a.z+m[N]));const F=this._cubeSize;_p(i,B*F,N>2?F:0,F,F),x.setRenderTarget(i),A&&x.render(C,u),x.render(e,u)}x.toneMapping=b,x.autoClear=g,e.background=R}_textureToCubeUV(e,t){const n=this._renderer,i=e.mapping===Kc||e.mapping===Lf;i?(this._cubemapMaterial===null&&(this._cubemapMaterial=Tw()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=Cw());const a=i?this._cubemapMaterial:this._equirectMaterial,o=this._lodMeshes[0];o.material=a;const c=a.uniforms;c.envMap.value=e;const u=this._cubeSize;_p(t,0,0,3*u,2*u),n.setRenderTarget(t),n.render(o,Rm)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;const i=this._lodMeshes.length;for(let a=1;a<i;a++)this._applyGGXFilter(e,a-1,a);t.autoClear=n}_applyGGXFilter(e,t,n){const i=this._renderer,a=this._pingPongRenderTarget,o=this._ggxMaterial,c=this._lodMeshes[n];c.material=o;const u=o.uniforms,h=n/(this._lodMeshes.length-1),m=t/(this._lodMeshes.length-1),x=Math.sqrt(h*h-m*m),g=.05+h*.95,b=x*g,{_lodMax:S}=this,C=this._sizeLods[n],M=3*C*(n>S-Nf?n-S+Nf:0),A=4*(this._cubeSize-C);u.envMap.value=e.texture,u.roughness.value=b,u.mipInt.value=S-t,_p(a,M,A,3*C,2*C),i.setRenderTarget(a),i.render(c,Rm),u.envMap.value=a.texture,u.roughness.value=0,u.mipInt.value=S-n,_p(e,M,A,3*C,2*C),i.setRenderTarget(e),i.render(c,Rm)}_blur(e,t,n,i,a){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,n,i,"latitudinal",a),this._halfBlur(o,e,n,n,i,"longitudinal",a)}_halfBlur(e,t,n,i,a,o,c){const u=this._renderer,h=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&Xn("blur direction must be either latitudinal or longitudinal!");const m=3,x=this._lodMeshes[i];x.material=h;const g=h.uniforms,b=this._sizeLods[n]-1,S=isFinite(a)?Math.PI/(2*b):2*Math.PI/(2*kh-1),C=a/S,M=isFinite(a)?1+Math.floor(m*C):kh;M>kh&&un(`sigmaRadians, ${a}, is too large and will clip, as it requested ${M} samples when the maximum is set to ${kh}`);const A=[];let R=0;for(let z=0;z<kh;++z){const P=z/C,L=Math.exp(-P*P/2);A.push(L),z===0?R+=L:z<M&&(R+=2*L)}for(let z=0;z<A.length;z++)A[z]=A[z]/R;g.envMap.value=e.texture,g.samples.value=M,g.weights.value=A,g.latitudinal.value=o==="latitudinal",c&&(g.poleAxis.value=c);const{_lodMax:N}=this;g.dTheta.value=S,g.mipInt.value=N-n;const B=this._sizeLods[i],F=3*B*(i>N-Nf?i-N+Nf:0),U=4*(this._cubeSize-B);_p(t,F,U,3*B,2*B),u.setRenderTarget(t),u.render(x,Rm)}}function kL(s){const e=[],t=[],n=[];let i=s;const a=s-Nf+1+Mw.length;for(let o=0;o<a;o++){const c=Math.pow(2,i);e.push(c);let u=1/c;o>s-Nf?u=Mw[o-s+Nf-1]:o===0&&(u=0),t.push(u);const h=1/(c-2),m=-h,x=1+h,g=[m,m,x,m,x,x,m,m,x,x,m,x],b=6,S=6,C=3,M=2,A=1,R=new Float32Array(C*S*b),N=new Float32Array(M*S*b),B=new Float32Array(A*S*b);for(let U=0;U<b;U++){const z=U%3*2/3-1,P=U>2?0:-1,L=[z,P,0,z+2/3,P,0,z+2/3,P+1,0,z,P,0,z+2/3,P+1,0,z,P+1,0];R.set(L,C*S*U),N.set(g,M*S*U);const O=[U,U,U,U,U,U];B.set(O,A*S*U)}const F=new Rn;F.setAttribute("position",new Ii(R,C)),F.setAttribute("uv",new Ii(N,M)),F.setAttribute("faceIndex",new Ii(B,A)),n.push(new sn(F,null)),i>Nf&&i--}return{lodMeshes:n,sizeLods:e,sigmas:t}}function Ew(s,e,t){const n=new qo(s,e,t);return n.texture.mapping=i0,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function _p(s,e,t,n,i){s.viewport.set(e,t,n,i),s.scissor.set(e,t,n,i)}function VL(s,e,t){return new Ys({name:"PMREMGGXConvolution",defines:{GGX_SAMPLES:jL,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${s}.0`},uniforms:{envMap:{value:null},roughness:{value:0},mipInt:{value:0}},vertexShader:Fy(),fragmentShader:`

			precision highp float;
			precision highp int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform float roughness;
			uniform float mipInt;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			#define PI 3.14159265359

			// Van der Corput radical inverse
			float radicalInverse_VdC(uint bits) {
				bits = (bits << 16u) | (bits >> 16u);
				bits = ((bits & 0x55555555u) << 1u) | ((bits & 0xAAAAAAAAu) >> 1u);
				bits = ((bits & 0x33333333u) << 2u) | ((bits & 0xCCCCCCCCu) >> 2u);
				bits = ((bits & 0x0F0F0F0Fu) << 4u) | ((bits & 0xF0F0F0F0u) >> 4u);
				bits = ((bits & 0x00FF00FFu) << 8u) | ((bits & 0xFF00FF00u) >> 8u);
				return float(bits) * 2.3283064365386963e-10; // / 0x100000000
			}

			// Hammersley sequence
			vec2 hammersley(uint i, uint N) {
				return vec2(float(i) / float(N), radicalInverse_VdC(i));
			}

			// GGX VNDF importance sampling (Eric Heitz 2018)
			// "Sampling the GGX Distribution of Visible Normals"
			// https://jcgt.org/published/0007/04/01/
			vec3 importanceSampleGGX_VNDF(vec2 Xi, vec3 V, float roughness) {
				float alpha = roughness * roughness;

				// Section 3.2: Transform view direction to hemisphere configuration
				vec3 Vh = normalize(vec3(alpha * V.x, alpha * V.y, V.z));

				// Section 4.1: Orthonormal basis
				float lensq = Vh.x * Vh.x + Vh.y * Vh.y;
				vec3 T1 = lensq > 0.0 ? vec3(-Vh.y, Vh.x, 0.0) / sqrt(lensq) : vec3(1.0, 0.0, 0.0);
				vec3 T2 = cross(Vh, T1);

				// Section 4.2: Parameterization of projected area
				float r = sqrt(Xi.x);
				float phi = 2.0 * PI * Xi.y;
				float t1 = r * cos(phi);
				float t2 = r * sin(phi);
				float s = 0.5 * (1.0 + Vh.z);
				t2 = (1.0 - s) * sqrt(1.0 - t1 * t1) + s * t2;

				// Section 4.3: Reprojection onto hemisphere
				vec3 Nh = t1 * T1 + t2 * T2 + sqrt(max(0.0, 1.0 - t1 * t1 - t2 * t2)) * Vh;

				// Section 3.4: Transform back to ellipsoid configuration
				return normalize(vec3(alpha * Nh.x, alpha * Nh.y, max(0.0, Nh.z)));
			}

			void main() {
				vec3 N = normalize(vOutputDirection);
				vec3 V = N; // Assume view direction equals normal for pre-filtering

				vec3 prefilteredColor = vec3(0.0);
				float totalWeight = 0.0;

				// For very low roughness, just sample the environment directly
				if (roughness < 0.001) {
					gl_FragColor = vec4(bilinearCubeUV(envMap, N, mipInt), 1.0);
					return;
				}

				// Tangent space basis for VNDF sampling
				vec3 up = abs(N.z) < 0.999 ? vec3(0.0, 0.0, 1.0) : vec3(1.0, 0.0, 0.0);
				vec3 tangent = normalize(cross(up, N));
				vec3 bitangent = cross(N, tangent);

				for(uint i = 0u; i < uint(GGX_SAMPLES); i++) {
					vec2 Xi = hammersley(i, uint(GGX_SAMPLES));

					// For PMREM, V = N, so in tangent space V is always (0, 0, 1)
					vec3 H_tangent = importanceSampleGGX_VNDF(Xi, vec3(0.0, 0.0, 1.0), roughness);

					// Transform H back to world space
					vec3 H = normalize(tangent * H_tangent.x + bitangent * H_tangent.y + N * H_tangent.z);
					vec3 L = normalize(2.0 * dot(V, H) * H - V);

					float NdotL = max(dot(N, L), 0.0);

					if(NdotL > 0.0) {
						// Sample environment at fixed mip level
						// VNDF importance sampling handles the distribution filtering
						vec3 sampleColor = bilinearCubeUV(envMap, L, mipInt);

						// Weight by NdotL for the split-sum approximation
						// VNDF PDF naturally accounts for the visible microfacet distribution
						prefilteredColor += sampleColor * NdotL;
						totalWeight += NdotL;
					}
				}

				if (totalWeight > 0.0) {
					prefilteredColor = prefilteredColor / totalWeight;
				}

				gl_FragColor = vec4(prefilteredColor, 1.0);
			}
		`,blending:cc,depthTest:!1,depthWrite:!1})}function XL(s,e,t){const n=new Float32Array(kh),i=new k(0,1,0);return new Ys({name:"SphericalGaussianBlur",defines:{n:kh,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${s}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:Fy(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:cc,depthTest:!1,depthWrite:!1})}function Cw(){return new Ys({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:Fy(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:cc,depthTest:!1,depthWrite:!1})}function Tw(){return new Ys({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:Fy(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:cc,depthTest:!1,depthWrite:!1})}function Fy(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function YL(s){let e=new WeakMap,t=null;function n(c){if(c&&c.isTexture){const u=c.mapping,h=u===zp||u===sx,m=u===Kc||u===Lf;if(h||m){let x=e.get(c);const g=x!==void 0?x.texture.pmremVersion:0;if(c.isRenderTargetTexture&&c.pmremVersion!==g)return t===null&&(t=new I_(s)),x=h?t.fromEquirectangular(c,x):t.fromCubemap(c,x),x.texture.pmremVersion=c.pmremVersion,e.set(c,x),x.texture;if(x!==void 0)return x.texture;{const b=c.image;return h&&b&&b.height>0||m&&b&&i(b)?(t===null&&(t=new I_(s)),x=h?t.fromEquirectangular(c):t.fromCubemap(c),x.texture.pmremVersion=c.pmremVersion,e.set(c,x),c.addEventListener("dispose",a),x.texture):null}}}return c}function i(c){let u=0;const h=6;for(let m=0;m<h;m++)c[m]!==void 0&&u++;return u===h}function a(c){const u=c.target;u.removeEventListener("dispose",a);const h=e.get(u);h!==void 0&&(e.delete(u),h.dispose())}function o(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:n,dispose:o}}function WL(s){const e={};function t(n){if(e[n]!==void 0)return e[n];const i=s.getExtension(n);return e[n]=i,i}return{has:function(n){return t(n)!==null},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(n){const i=t(n);return i===null&&Yp("WebGLRenderer: "+n+" extension not supported."),i}}}function qL(s,e,t,n){const i={},a=new WeakMap;function o(x){const g=x.target;g.index!==null&&e.remove(g.index);for(const S in g.attributes)e.remove(g.attributes[S]);g.removeEventListener("dispose",o),delete i[g.id];const b=a.get(g);b&&(e.remove(b),a.delete(g)),n.releaseStatesOfGeometry(g),g.isInstancedBufferGeometry===!0&&delete g._maxInstanceCount,t.memory.geometries--}function c(x,g){return i[g.id]===!0||(g.addEventListener("dispose",o),i[g.id]=!0,t.memory.geometries++),g}function u(x){const g=x.attributes;for(const b in g)e.update(g[b],s.ARRAY_BUFFER)}function h(x){const g=[],b=x.index,S=x.attributes.position;let C=0;if(b!==null){const R=b.array;C=b.version;for(let N=0,B=R.length;N<B;N+=3){const F=R[N+0],U=R[N+1],z=R[N+2];g.push(F,U,U,z,z,F)}}else if(S!==void 0){const R=S.array;C=S.version;for(let N=0,B=R.length/3-1;N<B;N+=3){const F=N+0,U=N+1,z=N+2;g.push(F,U,U,z,z,F)}}else return;const M=new(lC(g)?gS:xS)(g,1);M.version=C;const A=a.get(x);A&&e.remove(A),a.set(x,M)}function m(x){const g=a.get(x);if(g){const b=x.index;b!==null&&g.version<b.version&&h(x)}else h(x);return a.get(x)}return{get:c,update:u,getWireframeAttribute:m}}function JL(s,e,t){let n;function i(g){n=g}let a,o;function c(g){a=g.type,o=g.bytesPerElement}function u(g,b){s.drawElements(n,b,a,g*o),t.update(b,n,1)}function h(g,b,S){S!==0&&(s.drawElementsInstanced(n,b,a,g*o,S),t.update(b,n,S))}function m(g,b,S){if(S===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(n,b,0,a,g,0,S);let M=0;for(let A=0;A<S;A++)M+=b[A];t.update(M,n,1)}function x(g,b,S,C){if(S===0)return;const M=e.get("WEBGL_multi_draw");if(M===null)for(let A=0;A<g.length;A++)h(g[A]/o,b[A],C[A]);else{M.multiDrawElementsInstancedWEBGL(n,b,0,a,g,0,C,0,S);let A=0;for(let R=0;R<S;R++)A+=b[R]*C[R];t.update(A,n,1)}}this.setMode=i,this.setIndex=c,this.render=u,this.renderInstances=h,this.renderMultiDraw=m,this.renderMultiDrawInstances=x}function ZL(s){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function n(a,o,c){switch(t.calls++,o){case s.TRIANGLES:t.triangles+=c*(a/3);break;case s.LINES:t.lines+=c*(a/2);break;case s.LINE_STRIP:t.lines+=c*(a-1);break;case s.LINE_LOOP:t.lines+=c*a;break;case s.POINTS:t.points+=c*a;break;default:Xn("WebGLInfo: Unknown draw mode:",o);break}}function i(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:i,update:n}}function KL(s,e,t){const n=new WeakMap,i=new oi;function a(o,c,u){const h=o.morphTargetInfluences,m=c.morphAttributes.position||c.morphAttributes.normal||c.morphAttributes.color,x=m!==void 0?m.length:0;let g=n.get(c);if(g===void 0||g.count!==x){let O=function(){P.dispose(),n.delete(c),c.removeEventListener("dispose",O)};var b=O;g!==void 0&&g.texture.dispose();const S=c.morphAttributes.position!==void 0,C=c.morphAttributes.normal!==void 0,M=c.morphAttributes.color!==void 0,A=c.morphAttributes.position||[],R=c.morphAttributes.normal||[],N=c.morphAttributes.color||[];let B=0;S===!0&&(B=1),C===!0&&(B=2),M===!0&&(B=3);let F=c.attributes.position.count*B,U=1;F>e.maxTextureSize&&(U=Math.ceil(F/e.maxTextureSize),F=e.maxTextureSize);const z=new Float32Array(F*U*4*x),P=new dy(z,F,U,x);P.type=Da,P.needsUpdate=!0;const L=B*4;for(let ee=0;ee<x;ee++){const Q=A[ee],te=R[ee],ne=N[ee],re=F*U*4*ee;for(let j=0;j<Q.count;j++){const ae=j*L;S===!0&&(i.fromBufferAttribute(Q,j),z[re+ae+0]=i.x,z[re+ae+1]=i.y,z[re+ae+2]=i.z,z[re+ae+3]=0),C===!0&&(i.fromBufferAttribute(te,j),z[re+ae+4]=i.x,z[re+ae+5]=i.y,z[re+ae+6]=i.z,z[re+ae+7]=0),M===!0&&(i.fromBufferAttribute(ne,j),z[re+ae+8]=i.x,z[re+ae+9]=i.y,z[re+ae+10]=i.z,z[re+ae+11]=ne.itemSize===4?i.w:1)}}g={count:x,texture:P,size:new gt(F,U)},n.set(c,g),c.addEventListener("dispose",O)}if(o.isInstancedMesh===!0&&o.morphTexture!==null)u.getUniforms().setValue(s,"morphTexture",o.morphTexture,t);else{let S=0;for(let M=0;M<h.length;M++)S+=h[M];const C=c.morphTargetsRelative?1:1-S;u.getUniforms().setValue(s,"morphTargetBaseInfluence",C),u.getUniforms().setValue(s,"morphTargetInfluences",h)}u.getUniforms().setValue(s,"morphTargetsTexture",g.texture,t),u.getUniforms().setValue(s,"morphTargetsTextureSize",g.size)}return{update:a}}function QL(s,e,t,n){let i=new WeakMap;function a(u){const h=n.render.frame,m=u.geometry,x=e.get(u,m);if(i.get(x)!==h&&(e.update(x),i.set(x,h)),u.isInstancedMesh&&(u.hasEventListener("dispose",c)===!1&&u.addEventListener("dispose",c),i.get(u)!==h&&(t.update(u.instanceMatrix,s.ARRAY_BUFFER),u.instanceColor!==null&&t.update(u.instanceColor,s.ARRAY_BUFFER),i.set(u,h))),u.isSkinnedMesh){const g=u.skeleton;i.get(g)!==h&&(g.update(),i.set(g,h))}return x}function o(){i=new WeakMap}function c(u){const h=u.target;h.removeEventListener("dispose",c),t.remove(h.instanceMatrix),h.instanceColor!==null&&t.remove(h.instanceColor)}return{update:a,dispose:o}}const iT=new Wi,Rw=new _y(1,1),aT=new dy,sT=new py,rT=new Mx,Nw=[],Bw=[],Dw=new Float32Array(16),Uw=new Float32Array(9),Lw=new Float32Array(4);function l0(s,e,t){const n=s[0];if(n<=0||n>0)return s;const i=e*t;let a=Nw[i];if(a===void 0&&(a=new Float32Array(i),Nw[i]=a),e!==0){n.toArray(a,0);for(let o=1,c=0;o!==e;++o)c+=t,s[o].toArray(a,c)}return a}function Ts(s,e){if(s.length!==e.length)return!1;for(let t=0,n=s.length;t<n;t++)if(s[t]!==e[t])return!1;return!0}function Rs(s,e){for(let t=0,n=e.length;t<n;t++)s[t]=e[t]}function Py(s,e){let t=Bw[e];t===void 0&&(t=new Int32Array(e),Bw[e]=t);for(let n=0;n!==e;++n)t[n]=s.allocateTextureUnit();return t}function $L(s,e){const t=this.cache;t[0]!==e&&(s.uniform1f(this.addr,e),t[0]=e)}function eO(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(s.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Ts(t,e))return;s.uniform2fv(this.addr,e),Rs(t,e)}}function tO(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(s.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(s.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Ts(t,e))return;s.uniform3fv(this.addr,e),Rs(t,e)}}function nO(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(s.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Ts(t,e))return;s.uniform4fv(this.addr,e),Rs(t,e)}}function iO(s,e){const t=this.cache,n=e.elements;if(n===void 0){if(Ts(t,e))return;s.uniformMatrix2fv(this.addr,!1,e),Rs(t,e)}else{if(Ts(t,n))return;Lw.set(n),s.uniformMatrix2fv(this.addr,!1,Lw),Rs(t,n)}}function aO(s,e){const t=this.cache,n=e.elements;if(n===void 0){if(Ts(t,e))return;s.uniformMatrix3fv(this.addr,!1,e),Rs(t,e)}else{if(Ts(t,n))return;Uw.set(n),s.uniformMatrix3fv(this.addr,!1,Uw),Rs(t,n)}}function sO(s,e){const t=this.cache,n=e.elements;if(n===void 0){if(Ts(t,e))return;s.uniformMatrix4fv(this.addr,!1,e),Rs(t,e)}else{if(Ts(t,n))return;Dw.set(n),s.uniformMatrix4fv(this.addr,!1,Dw),Rs(t,n)}}function rO(s,e){const t=this.cache;t[0]!==e&&(s.uniform1i(this.addr,e),t[0]=e)}function oO(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(s.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Ts(t,e))return;s.uniform2iv(this.addr,e),Rs(t,e)}}function lO(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(s.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Ts(t,e))return;s.uniform3iv(this.addr,e),Rs(t,e)}}function cO(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(s.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Ts(t,e))return;s.uniform4iv(this.addr,e),Rs(t,e)}}function uO(s,e){const t=this.cache;t[0]!==e&&(s.uniform1ui(this.addr,e),t[0]=e)}function fO(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(s.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Ts(t,e))return;s.uniform2uiv(this.addr,e),Rs(t,e)}}function hO(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(s.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Ts(t,e))return;s.uniform3uiv(this.addr,e),Rs(t,e)}}function dO(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(s.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Ts(t,e))return;s.uniform4uiv(this.addr,e),Rs(t,e)}}function pO(s,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(s.uniform1i(this.addr,i),n[0]=i);let a;this.type===s.SAMPLER_2D_SHADOW?(Rw.compareFunction=dS,a=Rw):a=iT,t.setTexture2D(e||a,i)}function mO(s,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(s.uniform1i(this.addr,i),n[0]=i),t.setTexture3D(e||sT,i)}function xO(s,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(s.uniform1i(this.addr,i),n[0]=i),t.setTextureCube(e||rT,i)}function gO(s,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(s.uniform1i(this.addr,i),n[0]=i),t.setTexture2DArray(e||aT,i)}function vO(s){switch(s){case 5126:return $L;case 35664:return eO;case 35665:return tO;case 35666:return nO;case 35674:return iO;case 35675:return aO;case 35676:return sO;case 5124:case 35670:return rO;case 35667:case 35671:return oO;case 35668:case 35672:return lO;case 35669:case 35673:return cO;case 5125:return uO;case 36294:return fO;case 36295:return hO;case 36296:return dO;case 35678:case 36198:case 36298:case 36306:case 35682:return pO;case 35679:case 36299:case 36307:return mO;case 35680:case 36300:case 36308:case 36293:return xO;case 36289:case 36303:case 36311:case 36292:return gO}}function yO(s,e){s.uniform1fv(this.addr,e)}function bO(s,e){const t=l0(e,this.size,2);s.uniform2fv(this.addr,t)}function _O(s,e){const t=l0(e,this.size,3);s.uniform3fv(this.addr,t)}function SO(s,e){const t=l0(e,this.size,4);s.uniform4fv(this.addr,t)}function AO(s,e){const t=l0(e,this.size,4);s.uniformMatrix2fv(this.addr,!1,t)}function MO(s,e){const t=l0(e,this.size,9);s.uniformMatrix3fv(this.addr,!1,t)}function wO(s,e){const t=l0(e,this.size,16);s.uniformMatrix4fv(this.addr,!1,t)}function EO(s,e){s.uniform1iv(this.addr,e)}function CO(s,e){s.uniform2iv(this.addr,e)}function TO(s,e){s.uniform3iv(this.addr,e)}function RO(s,e){s.uniform4iv(this.addr,e)}function NO(s,e){s.uniform1uiv(this.addr,e)}function BO(s,e){s.uniform2uiv(this.addr,e)}function DO(s,e){s.uniform3uiv(this.addr,e)}function UO(s,e){s.uniform4uiv(this.addr,e)}function LO(s,e,t){const n=this.cache,i=e.length,a=Py(t,i);Ts(n,a)||(s.uniform1iv(this.addr,a),Rs(n,a));for(let o=0;o!==i;++o)t.setTexture2D(e[o]||iT,a[o])}function OO(s,e,t){const n=this.cache,i=e.length,a=Py(t,i);Ts(n,a)||(s.uniform1iv(this.addr,a),Rs(n,a));for(let o=0;o!==i;++o)t.setTexture3D(e[o]||sT,a[o])}function IO(s,e,t){const n=this.cache,i=e.length,a=Py(t,i);Ts(n,a)||(s.uniform1iv(this.addr,a),Rs(n,a));for(let o=0;o!==i;++o)t.setTextureCube(e[o]||rT,a[o])}function zO(s,e,t){const n=this.cache,i=e.length,a=Py(t,i);Ts(n,a)||(s.uniform1iv(this.addr,a),Rs(n,a));for(let o=0;o!==i;++o)t.setTexture2DArray(e[o]||aT,a[o])}function FO(s){switch(s){case 5126:return yO;case 35664:return bO;case 35665:return _O;case 35666:return SO;case 35674:return AO;case 35675:return MO;case 35676:return wO;case 5124:case 35670:return EO;case 35667:case 35671:return CO;case 35668:case 35672:return TO;case 35669:case 35673:return RO;case 5125:return NO;case 36294:return BO;case 36295:return DO;case 36296:return UO;case 35678:case 36198:case 36298:case 36306:case 35682:return LO;case 35679:case 36299:case 36307:return OO;case 35680:case 36300:case 36308:case 36293:return IO;case 36289:case 36303:case 36311:case 36292:return zO}}class PO{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.setValue=vO(t.type)}}class GO{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=FO(t.type)}}class jO{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const i=this.seq;for(let a=0,o=i.length;a!==o;++a){const c=i[a];c.setValue(e,t[c.id],n)}}}const b2=/(\w+)(\])?(\[|\.)?/g;function Ow(s,e){s.seq.push(e),s.map[e.id]=e}function HO(s,e,t){const n=s.name,i=n.length;for(b2.lastIndex=0;;){const a=b2.exec(n),o=b2.lastIndex;let c=a[1];const u=a[2]==="]",h=a[3];if(u&&(c=c|0),h===void 0||h==="["&&o+2===i){Ow(t,h===void 0?new PO(c,s,e):new GO(c,s,e));break}else{let x=t.map[c];x===void 0&&(x=new jO(c),Ow(t,x)),t=x}}}class Zv{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let i=0;i<n;++i){const a=e.getActiveUniform(t,i),o=e.getUniformLocation(t,a.name);HO(a,o,this)}}setValue(e,t,n,i){const a=this.map[t];a!==void 0&&a.setValue(e,n,i)}setOptional(e,t,n){const i=t[n];i!==void 0&&this.setValue(e,n,i)}static upload(e,t,n,i){for(let a=0,o=t.length;a!==o;++a){const c=t[a],u=n[c.id];u.needsUpdate!==!1&&c.setValue(e,u.value,i)}}static seqWithValue(e,t){const n=[];for(let i=0,a=e.length;i!==a;++i){const o=e[i];o.id in t&&n.push(o)}return n}}function Iw(s,e,t){const n=s.createShader(e);return s.shaderSource(n,t),s.compileShader(n),n}const kO=37297;let VO=0;function XO(s,e){const t=s.split(`
`),n=[],i=Math.max(e-6,0),a=Math.min(e+6,t.length);for(let o=i;o<a;o++){const c=o+1;n.push(`${c===e?">":" "} ${c}: ${t[o]}`)}return n.join(`
`)}const zw=new Qn;function YO(s){Ri._getMatrix(zw,Ri.workingColorSpace,s);const e=`mat3( ${zw.elements.map(t=>t.toFixed(4))} )`;switch(Ri.getTransfer(s)){case ox:return[e,"LinearTransferOETF"];case ta:return[e,"sRGBTransferOETF"];default:return un("WebGLProgram: Unsupported color space: ",s),[e,"LinearTransferOETF"]}}function Fw(s,e,t){const n=s.getShaderParameter(e,s.COMPILE_STATUS),a=(s.getShaderInfoLog(e)||"").trim();if(n&&a==="")return"";const o=/ERROR: 0:(\d+)/.exec(a);if(o){const c=parseInt(o[1]);return t.toUpperCase()+`

`+a+`

`+XO(s.getShaderSource(e),c)}else return a}function WO(s,e){const t=YO(e);return[`vec4 ${s}( vec4 value ) {`,`	return ${t[1]}( vec4( value.rgb * ${t[0]}, value.a ) );`,"}"].join(`
`)}function qO(s,e){let t;switch(e){case k3:t="Linear";break;case aS:t="Reinhard";break;case V3:t="Cineon";break;case sS:t="ACESFilmic";break;case Y3:t="AgX";break;case W3:t="Neutral";break;case X3:t="Custom";break;default:un("WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+s+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}const Av=new k;function JO(){Ri.getLuminanceCoefficients(Av);const s=Av.x.toFixed(4),e=Av.y.toFixed(4),t=Av.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${s}, ${e}, ${t} );`,"	return dot( weights, rgb );","}"].join(`
`)}function ZO(s){return[s.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",s.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(Hm).join(`
`)}function KO(s){const e=[];for(const t in s){const n=s[t];n!==!1&&e.push("#define "+t+" "+n)}return e.join(`
`)}function QO(s,e){const t={},n=s.getProgramParameter(e,s.ACTIVE_ATTRIBUTES);for(let i=0;i<n;i++){const a=s.getActiveAttrib(e,i),o=a.name;let c=1;a.type===s.FLOAT_MAT2&&(c=2),a.type===s.FLOAT_MAT3&&(c=3),a.type===s.FLOAT_MAT4&&(c=4),t[o]={type:a.type,location:s.getAttribLocation(e,o),locationSize:c}}return t}function Hm(s){return s!==""}function Pw(s,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return s.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function Gw(s,e){return s.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const $O=/^[ \t]*#include +<([\w\d./]+)>/gm;function z_(s){return s.replace($O,tI)}const eI=new Map;function tI(s,e){let t=ni[e];if(t===void 0){const n=eI.get(e);if(n!==void 0)t=ni[n],un('WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,n);else throw new Error("Can not resolve #include <"+e+">")}return z_(t)}const nI=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function jw(s){return s.replace(nI,iI)}function iI(s,e,t,n){let i="";for(let a=parseInt(e);a<parseInt(t);a++)i+=n.replace(/\[\s*i\s*\]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return i}function Hw(s){let e=`precision ${s.precision} float;
	precision ${s.precision} int;
	precision ${s.precision} sampler2D;
	precision ${s.precision} samplerCube;
	precision ${s.precision} sampler3D;
	precision ${s.precision} sampler2DArray;
	precision ${s.precision} sampler2DShadow;
	precision ${s.precision} samplerCubeShadow;
	precision ${s.precision} sampler2DArrayShadow;
	precision ${s.precision} isampler2D;
	precision ${s.precision} isampler3D;
	precision ${s.precision} isamplerCube;
	precision ${s.precision} isampler2DArray;
	precision ${s.precision} usampler2D;
	precision ${s.precision} usampler3D;
	precision ${s.precision} usamplerCube;
	precision ${s.precision} usampler2DArray;
	`;return s.precision==="highp"?e+=`
#define HIGH_PRECISION`:s.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:s.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function aI(s){let e="SHADOWMAP_TYPE_BASIC";return s.shadowMapType===iy?e="SHADOWMAP_TYPE_PCF":s.shadowMapType===Ym?e="SHADOWMAP_TYPE_PCF_SOFT":s.shadowMapType===sc&&(e="SHADOWMAP_TYPE_VSM"),e}function sI(s){let e="ENVMAP_TYPE_CUBE";if(s.envMap)switch(s.envMapMode){case Kc:case Lf:e="ENVMAP_TYPE_CUBE";break;case i0:e="ENVMAP_TYPE_CUBE_UV";break}return e}function rI(s){let e="ENVMAP_MODE_REFLECTION";if(s.envMap)switch(s.envMapMode){case Lf:e="ENVMAP_MODE_REFRACTION";break}return e}function oI(s){let e="ENVMAP_BLENDING_NONE";if(s.envMap)switch(s.combine){case bx:e="ENVMAP_BLENDING_MULTIPLY";break;case j3:e="ENVMAP_BLENDING_MIX";break;case H3:e="ENVMAP_BLENDING_ADD";break}return e}function lI(s){const e=s.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:n,maxMip:t}}function cI(s,e,t,n){const i=s.getContext(),a=t.defines;let o=t.vertexShader,c=t.fragmentShader;const u=aI(t),h=sI(t),m=rI(t),x=oI(t),g=lI(t),b=ZO(t),S=KO(a),C=i.createProgram();let M,A,R=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(M=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,S].filter(Hm).join(`
`),M.length>0&&(M+=`
`),A=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,S].filter(Hm).join(`
`),A.length>0&&(A+=`
`)):(M=[Hw(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,S,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+m:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+u:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",t.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Hm).join(`
`),A=[Hw(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,S,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+h:"",t.envMap?"#define "+m:"",t.envMap?"#define "+x:"",g?"#define CUBEUV_TEXEL_WIDTH "+g.texelWidth:"",g?"#define CUBEUV_TEXEL_HEIGHT "+g.texelHeight:"",g?"#define CUBEUV_MAX_MIP "+g.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+u:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",t.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",t.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==qc?"#define TONE_MAPPING":"",t.toneMapping!==qc?ni.tonemapping_pars_fragment:"",t.toneMapping!==qc?qO("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",ni.colorspace_pars_fragment,WO("linearToOutputTexel",t.outputColorSpace),JO(),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(Hm).join(`
`)),o=z_(o),o=Pw(o,t),o=Gw(o,t),c=z_(c),c=Pw(c,t),c=Gw(c,t),o=jw(o),c=jw(c),t.isRawShaderMaterial!==!0&&(R=`#version 300 es
`,M=[b,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+M,A=["#define varying in",t.glslVersion===R_?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===R_?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+A);const N=R+M+o,B=R+A+c,F=Iw(i,i.VERTEX_SHADER,N),U=Iw(i,i.FRAGMENT_SHADER,B);i.attachShader(C,F),i.attachShader(C,U),t.index0AttributeName!==void 0?i.bindAttribLocation(C,0,t.index0AttributeName):t.morphTargets===!0&&i.bindAttribLocation(C,0,"position"),i.linkProgram(C);function z(ee){if(s.debug.checkShaderErrors){const Q=i.getProgramInfoLog(C)||"",te=i.getShaderInfoLog(F)||"",ne=i.getShaderInfoLog(U)||"",re=Q.trim(),j=te.trim(),ae=ne.trim();let J=!0,ie=!0;if(i.getProgramParameter(C,i.LINK_STATUS)===!1)if(J=!1,typeof s.debug.onShaderError=="function")s.debug.onShaderError(i,C,F,U);else{const se=Fw(i,F,"vertex"),I=Fw(i,U,"fragment");Xn("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(C,i.VALIDATE_STATUS)+`

Material Name: `+ee.name+`
Material Type: `+ee.type+`

Program Info Log: `+re+`
`+se+`
`+I)}else re!==""?un("WebGLProgram: Program Info Log:",re):(j===""||ae==="")&&(ie=!1);ie&&(ee.diagnostics={runnable:J,programLog:re,vertexShader:{log:j,prefix:M},fragmentShader:{log:ae,prefix:A}})}i.deleteShader(F),i.deleteShader(U),P=new Zv(i,C),L=QO(i,C)}let P;this.getUniforms=function(){return P===void 0&&z(this),P};let L;this.getAttributes=function(){return L===void 0&&z(this),L};let O=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return O===!1&&(O=i.getProgramParameter(C,kO)),O},this.destroy=function(){n.releaseStatesOfProgram(this),i.deleteProgram(C),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=VO++,this.cacheKey=e,this.usedTimes=1,this.program=C,this.vertexShader=F,this.fragmentShader=U,this}let uI=0;class fI{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,i=this._getShaderStage(t),a=this._getShaderStage(n),o=this._getShaderCacheForMaterial(e);return o.has(i)===!1&&(o.add(i),i.usedTimes++),o.has(a)===!1&&(o.add(a),a.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return n===void 0&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return n===void 0&&(n=new hI(e),t.set(e,n)),n}}class hI{constructor(e){this.id=uI++,this.code=e,this.usedTimes=0}}function dI(s,e,t,n,i,a,o){const c=new qp,u=new fI,h=new Set,m=[],x=i.logarithmicDepthBuffer,g=i.vertexTextures;let b=i.precision;const S={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function C(L){return h.add(L),L===0?"uv":`uv${L}`}function M(L,O,ee,Q,te){const ne=Q.fog,re=te.geometry,j=L.isMeshStandardMaterial?Q.environment:null,ae=(L.isMeshStandardMaterial?t:e).get(L.envMap||j),J=ae&&ae.mapping===i0?ae.image.height:null,ie=S[L.type];L.precision!==null&&(b=i.getMaxPrecision(L.precision),b!==L.precision&&un("WebGLProgram.getParameters:",L.precision,"not supported, using",b,"instead."));const se=re.morphAttributes.position||re.morphAttributes.normal||re.morphAttributes.color,I=se!==void 0?se.length:0;let W=0;re.morphAttributes.position!==void 0&&(W=1),re.morphAttributes.normal!==void 0&&(W=2),re.morphAttributes.color!==void 0&&(W=3);let fe,Z,me,$;if(ie){const on=oc[ie];fe=on.vertexShader,Z=on.fragmentShader}else fe=L.vertexShader,Z=L.fragmentShader,u.update(L),me=u.getVertexShaderID(L),$=u.getFragmentShaderID(L);const pe=s.getRenderTarget(),ve=s.state.buffers.depth.getReversed(),ze=te.isInstancedMesh===!0,Ge=te.isBatchedMesh===!0,Fe=!!L.map,Qe=!!L.matcap,lt=!!ae,De=!!L.aoMap,le=!!L.lightMap,Ye=!!L.bumpMap,Ze=!!L.normalMap,je=!!L.displacementMap,He=!!L.emissiveMap,et=!!L.metalnessMap,Ne=!!L.roughnessMap,st=L.anisotropy>0,oe=L.clearcoat>0,X=L.dispersion>0,Ae=L.iridescence>0,Pe=L.sheen>0,Ue=L.transmission>0,Be=st&&!!L.anisotropyMap,bt=oe&&!!L.clearcoatMap,vt=oe&&!!L.clearcoatNormalMap,It=oe&&!!L.clearcoatRoughnessMap,zt=Ae&&!!L.iridescenceMap,qe=Ae&&!!L.iridescenceThicknessMap,We=Pe&&!!L.sheenColorMap,ft=Pe&&!!L.sheenRoughnessMap,ge=!!L.specularMap,Ie=!!L.specularColorMap,ht=!!L.specularIntensityMap,ye=Ue&&!!L.transmissionMap,Re=Ue&&!!L.thicknessMap,pt=!!L.gradientMap,Rt=!!L.alphaMap,dt=L.alphaTest>0,Ke=!!L.alphaHash,Lt=!!L.extensions;let Vt=qc;L.toneMapped&&(pe===null||pe.isXRRenderTarget===!0)&&(Vt=s.toneMapping);const Kt={shaderID:ie,shaderType:L.type,shaderName:L.name,vertexShader:fe,fragmentShader:Z,defines:L.defines,customVertexShaderID:me,customFragmentShaderID:$,isRawShaderMaterial:L.isRawShaderMaterial===!0,glslVersion:L.glslVersion,precision:b,batching:Ge,batchingColor:Ge&&te._colorsTexture!==null,instancing:ze,instancingColor:ze&&te.instanceColor!==null,instancingMorph:ze&&te.morphTexture!==null,supportsVertexTextures:g,outputColorSpace:pe===null?s.outputColorSpace:pe.isXRRenderTarget===!0?pe.texture.colorSpace:uc,alphaToCoverage:!!L.alphaToCoverage,map:Fe,matcap:Qe,envMap:lt,envMapMode:lt&&ae.mapping,envMapCubeUVHeight:J,aoMap:De,lightMap:le,bumpMap:Ye,normalMap:Ze,displacementMap:g&&je,emissiveMap:He,normalMapObjectSpace:Ze&&L.normalMapType===eC,normalMapTangentSpace:Ze&&L.normalMapType===Gf,metalnessMap:et,roughnessMap:Ne,anisotropy:st,anisotropyMap:Be,clearcoat:oe,clearcoatMap:bt,clearcoatNormalMap:vt,clearcoatRoughnessMap:It,dispersion:X,iridescence:Ae,iridescenceMap:zt,iridescenceThicknessMap:qe,sheen:Pe,sheenColorMap:We,sheenRoughnessMap:ft,specularMap:ge,specularColorMap:Ie,specularIntensityMap:ht,transmission:Ue,transmissionMap:ye,thicknessMap:Re,gradientMap:pt,opaque:L.transparent===!1&&L.blending===Kh&&L.alphaToCoverage===!1,alphaMap:Rt,alphaTest:dt,alphaHash:Ke,combine:L.combine,mapUv:Fe&&C(L.map.channel),aoMapUv:De&&C(L.aoMap.channel),lightMapUv:le&&C(L.lightMap.channel),bumpMapUv:Ye&&C(L.bumpMap.channel),normalMapUv:Ze&&C(L.normalMap.channel),displacementMapUv:je&&C(L.displacementMap.channel),emissiveMapUv:He&&C(L.emissiveMap.channel),metalnessMapUv:et&&C(L.metalnessMap.channel),roughnessMapUv:Ne&&C(L.roughnessMap.channel),anisotropyMapUv:Be&&C(L.anisotropyMap.channel),clearcoatMapUv:bt&&C(L.clearcoatMap.channel),clearcoatNormalMapUv:vt&&C(L.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:It&&C(L.clearcoatRoughnessMap.channel),iridescenceMapUv:zt&&C(L.iridescenceMap.channel),iridescenceThicknessMapUv:qe&&C(L.iridescenceThicknessMap.channel),sheenColorMapUv:We&&C(L.sheenColorMap.channel),sheenRoughnessMapUv:ft&&C(L.sheenRoughnessMap.channel),specularMapUv:ge&&C(L.specularMap.channel),specularColorMapUv:Ie&&C(L.specularColorMap.channel),specularIntensityMapUv:ht&&C(L.specularIntensityMap.channel),transmissionMapUv:ye&&C(L.transmissionMap.channel),thicknessMapUv:Re&&C(L.thicknessMap.channel),alphaMapUv:Rt&&C(L.alphaMap.channel),vertexTangents:!!re.attributes.tangent&&(Ze||st),vertexColors:L.vertexColors,vertexAlphas:L.vertexColors===!0&&!!re.attributes.color&&re.attributes.color.itemSize===4,pointsUvs:te.isPoints===!0&&!!re.attributes.uv&&(Fe||Rt),fog:!!ne,useFog:L.fog===!0,fogExp2:!!ne&&ne.isFogExp2,flatShading:L.flatShading===!0&&L.wireframe===!1,sizeAttenuation:L.sizeAttenuation===!0,logarithmicDepthBuffer:x,reversedDepthBuffer:ve,skinning:te.isSkinnedMesh===!0,morphTargets:re.morphAttributes.position!==void 0,morphNormals:re.morphAttributes.normal!==void 0,morphColors:re.morphAttributes.color!==void 0,morphTargetsCount:I,morphTextureStride:W,numDirLights:O.directional.length,numPointLights:O.point.length,numSpotLights:O.spot.length,numSpotLightMaps:O.spotLightMap.length,numRectAreaLights:O.rectArea.length,numHemiLights:O.hemi.length,numDirLightShadows:O.directionalShadowMap.length,numPointLightShadows:O.pointShadowMap.length,numSpotLightShadows:O.spotShadowMap.length,numSpotLightShadowsWithMaps:O.numSpotLightShadowsWithMaps,numLightProbes:O.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:L.dithering,shadowMapEnabled:s.shadowMap.enabled&&ee.length>0,shadowMapType:s.shadowMap.type,toneMapping:Vt,decodeVideoTexture:Fe&&L.map.isVideoTexture===!0&&Ri.getTransfer(L.map.colorSpace)===ta,decodeVideoTextureEmissive:He&&L.emissiveMap.isVideoTexture===!0&&Ri.getTransfer(L.emissiveMap.colorSpace)===ta,premultipliedAlpha:L.premultipliedAlpha,doubleSided:L.side===Oi,flipSided:L.side===fr,useDepthPacking:L.depthPacking>=0,depthPacking:L.depthPacking||0,index0AttributeName:L.index0AttributeName,extensionClipCullDistance:Lt&&L.extensions.clipCullDistance===!0&&n.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(Lt&&L.extensions.multiDraw===!0||Ge)&&n.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:n.has("KHR_parallel_shader_compile"),customProgramCacheKey:L.customProgramCacheKey()};return Kt.vertexUv1s=h.has(1),Kt.vertexUv2s=h.has(2),Kt.vertexUv3s=h.has(3),h.clear(),Kt}function A(L){const O=[];if(L.shaderID?O.push(L.shaderID):(O.push(L.customVertexShaderID),O.push(L.customFragmentShaderID)),L.defines!==void 0)for(const ee in L.defines)O.push(ee),O.push(L.defines[ee]);return L.isRawShaderMaterial===!1&&(R(O,L),N(O,L),O.push(s.outputColorSpace)),O.push(L.customProgramCacheKey),O.join()}function R(L,O){L.push(O.precision),L.push(O.outputColorSpace),L.push(O.envMapMode),L.push(O.envMapCubeUVHeight),L.push(O.mapUv),L.push(O.alphaMapUv),L.push(O.lightMapUv),L.push(O.aoMapUv),L.push(O.bumpMapUv),L.push(O.normalMapUv),L.push(O.displacementMapUv),L.push(O.emissiveMapUv),L.push(O.metalnessMapUv),L.push(O.roughnessMapUv),L.push(O.anisotropyMapUv),L.push(O.clearcoatMapUv),L.push(O.clearcoatNormalMapUv),L.push(O.clearcoatRoughnessMapUv),L.push(O.iridescenceMapUv),L.push(O.iridescenceThicknessMapUv),L.push(O.sheenColorMapUv),L.push(O.sheenRoughnessMapUv),L.push(O.specularMapUv),L.push(O.specularColorMapUv),L.push(O.specularIntensityMapUv),L.push(O.transmissionMapUv),L.push(O.thicknessMapUv),L.push(O.combine),L.push(O.fogExp2),L.push(O.sizeAttenuation),L.push(O.morphTargetsCount),L.push(O.morphAttributeCount),L.push(O.numDirLights),L.push(O.numPointLights),L.push(O.numSpotLights),L.push(O.numSpotLightMaps),L.push(O.numHemiLights),L.push(O.numRectAreaLights),L.push(O.numDirLightShadows),L.push(O.numPointLightShadows),L.push(O.numSpotLightShadows),L.push(O.numSpotLightShadowsWithMaps),L.push(O.numLightProbes),L.push(O.shadowMapType),L.push(O.toneMapping),L.push(O.numClippingPlanes),L.push(O.numClipIntersection),L.push(O.depthPacking)}function N(L,O){c.disableAll(),O.supportsVertexTextures&&c.enable(0),O.instancing&&c.enable(1),O.instancingColor&&c.enable(2),O.instancingMorph&&c.enable(3),O.matcap&&c.enable(4),O.envMap&&c.enable(5),O.normalMapObjectSpace&&c.enable(6),O.normalMapTangentSpace&&c.enable(7),O.clearcoat&&c.enable(8),O.iridescence&&c.enable(9),O.alphaTest&&c.enable(10),O.vertexColors&&c.enable(11),O.vertexAlphas&&c.enable(12),O.vertexUv1s&&c.enable(13),O.vertexUv2s&&c.enable(14),O.vertexUv3s&&c.enable(15),O.vertexTangents&&c.enable(16),O.anisotropy&&c.enable(17),O.alphaHash&&c.enable(18),O.batching&&c.enable(19),O.dispersion&&c.enable(20),O.batchingColor&&c.enable(21),O.gradientMap&&c.enable(22),L.push(c.mask),c.disableAll(),O.fog&&c.enable(0),O.useFog&&c.enable(1),O.flatShading&&c.enable(2),O.logarithmicDepthBuffer&&c.enable(3),O.reversedDepthBuffer&&c.enable(4),O.skinning&&c.enable(5),O.morphTargets&&c.enable(6),O.morphNormals&&c.enable(7),O.morphColors&&c.enable(8),O.premultipliedAlpha&&c.enable(9),O.shadowMapEnabled&&c.enable(10),O.doubleSided&&c.enable(11),O.flipSided&&c.enable(12),O.useDepthPacking&&c.enable(13),O.dithering&&c.enable(14),O.transmission&&c.enable(15),O.sheen&&c.enable(16),O.opaque&&c.enable(17),O.pointsUvs&&c.enable(18),O.decodeVideoTexture&&c.enable(19),O.decodeVideoTextureEmissive&&c.enable(20),O.alphaToCoverage&&c.enable(21),L.push(c.mask)}function B(L){const O=S[L.type];let ee;if(O){const Q=oc[O];ee=Zp.clone(Q.uniforms)}else ee=L.uniforms;return ee}function F(L,O){let ee;for(let Q=0,te=m.length;Q<te;Q++){const ne=m[Q];if(ne.cacheKey===O){ee=ne,++ee.usedTimes;break}}return ee===void 0&&(ee=new cI(s,O,L,a),m.push(ee)),ee}function U(L){if(--L.usedTimes===0){const O=m.indexOf(L);m[O]=m[m.length-1],m.pop(),L.destroy()}}function z(L){u.remove(L)}function P(){u.dispose()}return{getParameters:M,getProgramCacheKey:A,getUniforms:B,acquireProgram:F,releaseProgram:U,releaseShaderCache:z,programs:m,dispose:P}}function pI(){let s=new WeakMap;function e(o){return s.has(o)}function t(o){let c=s.get(o);return c===void 0&&(c={},s.set(o,c)),c}function n(o){s.delete(o)}function i(o,c,u){s.get(o)[c]=u}function a(){s=new WeakMap}return{has:e,get:t,remove:n,update:i,dispose:a}}function mI(s,e){return s.groupOrder!==e.groupOrder?s.groupOrder-e.groupOrder:s.renderOrder!==e.renderOrder?s.renderOrder-e.renderOrder:s.material.id!==e.material.id?s.material.id-e.material.id:s.z!==e.z?s.z-e.z:s.id-e.id}function kw(s,e){return s.groupOrder!==e.groupOrder?s.groupOrder-e.groupOrder:s.renderOrder!==e.renderOrder?s.renderOrder-e.renderOrder:s.z!==e.z?e.z-s.z:s.id-e.id}function Vw(){const s=[];let e=0;const t=[],n=[],i=[];function a(){e=0,t.length=0,n.length=0,i.length=0}function o(x,g,b,S,C,M){let A=s[e];return A===void 0?(A={id:x.id,object:x,geometry:g,material:b,groupOrder:S,renderOrder:x.renderOrder,z:C,group:M},s[e]=A):(A.id=x.id,A.object=x,A.geometry=g,A.material=b,A.groupOrder=S,A.renderOrder=x.renderOrder,A.z=C,A.group=M),e++,A}function c(x,g,b,S,C,M){const A=o(x,g,b,S,C,M);b.transmission>0?n.push(A):b.transparent===!0?i.push(A):t.push(A)}function u(x,g,b,S,C,M){const A=o(x,g,b,S,C,M);b.transmission>0?n.unshift(A):b.transparent===!0?i.unshift(A):t.unshift(A)}function h(x,g){t.length>1&&t.sort(x||mI),n.length>1&&n.sort(g||kw),i.length>1&&i.sort(g||kw)}function m(){for(let x=e,g=s.length;x<g;x++){const b=s[x];if(b.id===null)break;b.id=null,b.object=null,b.geometry=null,b.material=null,b.group=null}}return{opaque:t,transmissive:n,transparent:i,init:a,push:c,unshift:u,finish:m,sort:h}}function xI(){let s=new WeakMap;function e(n,i){const a=s.get(n);let o;return a===void 0?(o=new Vw,s.set(n,[o])):i>=a.length?(o=new Vw,a.push(o)):o=a[i],o}function t(){s=new WeakMap}return{get:e,dispose:t}}function gI(){const s={};return{get:function(e){if(s[e.id]!==void 0)return s[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new k,color:new qt};break;case"SpotLight":t={position:new k,direction:new k,color:new qt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new k,color:new qt,distance:0,decay:0};break;case"HemisphereLight":t={direction:new k,skyColor:new qt,groundColor:new qt};break;case"RectAreaLight":t={color:new qt,position:new k,halfWidth:new k,halfHeight:new k};break}return s[e.id]=t,t}}}function vI(){const s={};return{get:function(e){if(s[e.id]!==void 0)return s[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new gt};break;case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new gt};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new gt,shadowCameraNear:1,shadowCameraFar:1e3};break}return s[e.id]=t,t}}}let yI=0;function bI(s,e){return(e.castShadow?2:0)-(s.castShadow?2:0)+(e.map?1:0)-(s.map?1:0)}function _I(s){const e=new gI,t=vI(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let h=0;h<9;h++)n.probe.push(new k);const i=new k,a=new wn,o=new wn;function c(h){let m=0,x=0,g=0;for(let L=0;L<9;L++)n.probe[L].set(0,0,0);let b=0,S=0,C=0,M=0,A=0,R=0,N=0,B=0,F=0,U=0,z=0;h.sort(bI);for(let L=0,O=h.length;L<O;L++){const ee=h[L],Q=ee.color,te=ee.intensity,ne=ee.distance,re=ee.shadow&&ee.shadow.map?ee.shadow.map.texture:null;if(ee.isAmbientLight)m+=Q.r*te,x+=Q.g*te,g+=Q.b*te;else if(ee.isLightProbe){for(let j=0;j<9;j++)n.probe[j].addScaledVector(ee.sh.coefficients[j],te);z++}else if(ee.isDirectionalLight){const j=e.get(ee);if(j.color.copy(ee.color).multiplyScalar(ee.intensity),ee.castShadow){const ae=ee.shadow,J=t.get(ee);J.shadowIntensity=ae.intensity,J.shadowBias=ae.bias,J.shadowNormalBias=ae.normalBias,J.shadowRadius=ae.radius,J.shadowMapSize=ae.mapSize,n.directionalShadow[b]=J,n.directionalShadowMap[b]=re,n.directionalShadowMatrix[b]=ee.shadow.matrix,R++}n.directional[b]=j,b++}else if(ee.isSpotLight){const j=e.get(ee);j.position.setFromMatrixPosition(ee.matrixWorld),j.color.copy(Q).multiplyScalar(te),j.distance=ne,j.coneCos=Math.cos(ee.angle),j.penumbraCos=Math.cos(ee.angle*(1-ee.penumbra)),j.decay=ee.decay,n.spot[C]=j;const ae=ee.shadow;if(ee.map&&(n.spotLightMap[F]=ee.map,F++,ae.updateMatrices(ee),ee.castShadow&&U++),n.spotLightMatrix[C]=ae.matrix,ee.castShadow){const J=t.get(ee);J.shadowIntensity=ae.intensity,J.shadowBias=ae.bias,J.shadowNormalBias=ae.normalBias,J.shadowRadius=ae.radius,J.shadowMapSize=ae.mapSize,n.spotShadow[C]=J,n.spotShadowMap[C]=re,B++}C++}else if(ee.isRectAreaLight){const j=e.get(ee);j.color.copy(Q).multiplyScalar(te),j.halfWidth.set(ee.width*.5,0,0),j.halfHeight.set(0,ee.height*.5,0),n.rectArea[M]=j,M++}else if(ee.isPointLight){const j=e.get(ee);if(j.color.copy(ee.color).multiplyScalar(ee.intensity),j.distance=ee.distance,j.decay=ee.decay,ee.castShadow){const ae=ee.shadow,J=t.get(ee);J.shadowIntensity=ae.intensity,J.shadowBias=ae.bias,J.shadowNormalBias=ae.normalBias,J.shadowRadius=ae.radius,J.shadowMapSize=ae.mapSize,J.shadowCameraNear=ae.camera.near,J.shadowCameraFar=ae.camera.far,n.pointShadow[S]=J,n.pointShadowMap[S]=re,n.pointShadowMatrix[S]=ee.shadow.matrix,N++}n.point[S]=j,S++}else if(ee.isHemisphereLight){const j=e.get(ee);j.skyColor.copy(ee.color).multiplyScalar(te),j.groundColor.copy(ee.groundColor).multiplyScalar(te),n.hemi[A]=j,A++}}M>0&&(s.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=rn.LTC_FLOAT_1,n.rectAreaLTC2=rn.LTC_FLOAT_2):(n.rectAreaLTC1=rn.LTC_HALF_1,n.rectAreaLTC2=rn.LTC_HALF_2)),n.ambient[0]=m,n.ambient[1]=x,n.ambient[2]=g;const P=n.hash;(P.directionalLength!==b||P.pointLength!==S||P.spotLength!==C||P.rectAreaLength!==M||P.hemiLength!==A||P.numDirectionalShadows!==R||P.numPointShadows!==N||P.numSpotShadows!==B||P.numSpotMaps!==F||P.numLightProbes!==z)&&(n.directional.length=b,n.spot.length=C,n.rectArea.length=M,n.point.length=S,n.hemi.length=A,n.directionalShadow.length=R,n.directionalShadowMap.length=R,n.pointShadow.length=N,n.pointShadowMap.length=N,n.spotShadow.length=B,n.spotShadowMap.length=B,n.directionalShadowMatrix.length=R,n.pointShadowMatrix.length=N,n.spotLightMatrix.length=B+F-U,n.spotLightMap.length=F,n.numSpotLightShadowsWithMaps=U,n.numLightProbes=z,P.directionalLength=b,P.pointLength=S,P.spotLength=C,P.rectAreaLength=M,P.hemiLength=A,P.numDirectionalShadows=R,P.numPointShadows=N,P.numSpotShadows=B,P.numSpotMaps=F,P.numLightProbes=z,n.version=yI++)}function u(h,m){let x=0,g=0,b=0,S=0,C=0;const M=m.matrixWorldInverse;for(let A=0,R=h.length;A<R;A++){const N=h[A];if(N.isDirectionalLight){const B=n.directional[x];B.direction.setFromMatrixPosition(N.matrixWorld),i.setFromMatrixPosition(N.target.matrixWorld),B.direction.sub(i),B.direction.transformDirection(M),x++}else if(N.isSpotLight){const B=n.spot[b];B.position.setFromMatrixPosition(N.matrixWorld),B.position.applyMatrix4(M),B.direction.setFromMatrixPosition(N.matrixWorld),i.setFromMatrixPosition(N.target.matrixWorld),B.direction.sub(i),B.direction.transformDirection(M),b++}else if(N.isRectAreaLight){const B=n.rectArea[S];B.position.setFromMatrixPosition(N.matrixWorld),B.position.applyMatrix4(M),o.identity(),a.copy(N.matrixWorld),a.premultiply(M),o.extractRotation(a),B.halfWidth.set(N.width*.5,0,0),B.halfHeight.set(0,N.height*.5,0),B.halfWidth.applyMatrix4(o),B.halfHeight.applyMatrix4(o),S++}else if(N.isPointLight){const B=n.point[g];B.position.setFromMatrixPosition(N.matrixWorld),B.position.applyMatrix4(M),g++}else if(N.isHemisphereLight){const B=n.hemi[C];B.direction.setFromMatrixPosition(N.matrixWorld),B.direction.transformDirection(M),C++}}}return{setup:c,setupView:u,state:n}}function Xw(s){const e=new _I(s),t=[],n=[];function i(m){h.camera=m,t.length=0,n.length=0}function a(m){t.push(m)}function o(m){n.push(m)}function c(){e.setup(t)}function u(m){e.setupView(t,m)}const h={lightsArray:t,shadowsArray:n,camera:null,lights:e,transmissionRenderTarget:{}};return{init:i,state:h,setupLights:c,setupLightsView:u,pushLight:a,pushShadow:o}}function SI(s){let e=new WeakMap;function t(i,a=0){const o=e.get(i);let c;return o===void 0?(c=new Xw(s),e.set(i,[c])):a>=o.length?(c=new Xw(s),o.push(c)):c=o[a],c}function n(){e=new WeakMap}return{get:t,dispose:n}}const AI=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,MI=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function wI(s,e,t){let n=new s0;const i=new gt,a=new gt,o=new oi,c=new By({depthPacking:hS}),u=new Dy,h={},m=t.maxTextureSize,x={[Zc]:fr,[fr]:Zc,[Oi]:Oi},g=new Ys({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new gt},radius:{value:4}},vertexShader:AI,fragmentShader:MI}),b=g.clone();b.defines.HORIZONTAL_PASS=1;const S=new Rn;S.setAttribute("position",new Ii(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const C=new sn(S,g),M=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=iy;let A=this.type;this.render=function(U,z,P){if(M.enabled===!1||M.autoUpdate===!1&&M.needsUpdate===!1||U.length===0)return;const L=s.getRenderTarget(),O=s.getActiveCubeFace(),ee=s.getActiveMipmapLevel(),Q=s.state;Q.setBlending(cc),Q.buffers.depth.getReversed()===!0?Q.buffers.color.setClear(0,0,0,0):Q.buffers.color.setClear(1,1,1,1),Q.buffers.depth.setTest(!0),Q.setScissorTest(!1);const te=A!==sc&&this.type===sc,ne=A===sc&&this.type!==sc;for(let re=0,j=U.length;re<j;re++){const ae=U[re],J=ae.shadow;if(J===void 0){un("WebGLShadowMap:",ae,"has no shadow.");continue}if(J.autoUpdate===!1&&J.needsUpdate===!1)continue;i.copy(J.mapSize);const ie=J.getFrameExtents();if(i.multiply(ie),a.copy(J.mapSize),(i.x>m||i.y>m)&&(i.x>m&&(a.x=Math.floor(m/ie.x),i.x=a.x*ie.x,J.mapSize.x=a.x),i.y>m&&(a.y=Math.floor(m/ie.y),i.y=a.y*ie.y,J.mapSize.y=a.y)),J.map===null||te===!0||ne===!0){const I=this.type!==sc?{minFilter:Vs,magFilter:Vs}:{};J.map!==null&&J.map.dispose(),J.map=new qo(i.x,i.y,I),J.map.texture.name=ae.name+".shadowMap",J.camera.updateProjectionMatrix()}s.setRenderTarget(J.map),s.clear();const se=J.getViewportCount();for(let I=0;I<se;I++){const W=J.getViewport(I);o.set(a.x*W.x,a.y*W.y,a.x*W.z,a.y*W.w),Q.viewport(o),J.updateMatrices(ae,I),n=J.getFrustum(),B(z,P,J.camera,ae,this.type)}J.isPointLightShadow!==!0&&this.type===sc&&R(J,P),J.needsUpdate=!1}A=this.type,M.needsUpdate=!1,s.setRenderTarget(L,O,ee)};function R(U,z){const P=e.update(C);g.defines.VSM_SAMPLES!==U.blurSamples&&(g.defines.VSM_SAMPLES=U.blurSamples,b.defines.VSM_SAMPLES=U.blurSamples,g.needsUpdate=!0,b.needsUpdate=!0),U.mapPass===null&&(U.mapPass=new qo(i.x,i.y)),g.uniforms.shadow_pass.value=U.map.texture,g.uniforms.resolution.value=U.mapSize,g.uniforms.radius.value=U.radius,s.setRenderTarget(U.mapPass),s.clear(),s.renderBufferDirect(z,null,P,g,C,null),b.uniforms.shadow_pass.value=U.mapPass.texture,b.uniforms.resolution.value=U.mapSize,b.uniforms.radius.value=U.radius,s.setRenderTarget(U.map),s.clear(),s.renderBufferDirect(z,null,P,b,C,null)}function N(U,z,P,L){let O=null;const ee=P.isPointLight===!0?U.customDistanceMaterial:U.customDepthMaterial;if(ee!==void 0)O=ee;else if(O=P.isPointLight===!0?u:c,s.localClippingEnabled&&z.clipShadows===!0&&Array.isArray(z.clippingPlanes)&&z.clippingPlanes.length!==0||z.displacementMap&&z.displacementScale!==0||z.alphaMap&&z.alphaTest>0||z.map&&z.alphaTest>0||z.alphaToCoverage===!0){const Q=O.uuid,te=z.uuid;let ne=h[Q];ne===void 0&&(ne={},h[Q]=ne);let re=ne[te];re===void 0&&(re=O.clone(),ne[te]=re,z.addEventListener("dispose",F)),O=re}if(O.visible=z.visible,O.wireframe=z.wireframe,L===sc?O.side=z.shadowSide!==null?z.shadowSide:z.side:O.side=z.shadowSide!==null?z.shadowSide:x[z.side],O.alphaMap=z.alphaMap,O.alphaTest=z.alphaToCoverage===!0?.5:z.alphaTest,O.map=z.map,O.clipShadows=z.clipShadows,O.clippingPlanes=z.clippingPlanes,O.clipIntersection=z.clipIntersection,O.displacementMap=z.displacementMap,O.displacementScale=z.displacementScale,O.displacementBias=z.displacementBias,O.wireframeLinewidth=z.wireframeLinewidth,O.linewidth=z.linewidth,P.isPointLight===!0&&O.isMeshDistanceMaterial===!0){const Q=s.properties.get(O);Q.light=P}return O}function B(U,z,P,L,O){if(U.visible===!1)return;if(U.layers.test(z.layers)&&(U.isMesh||U.isLine||U.isPoints)&&(U.castShadow||U.receiveShadow&&O===sc)&&(!U.frustumCulled||n.intersectsObject(U))){U.modelViewMatrix.multiplyMatrices(P.matrixWorldInverse,U.matrixWorld);const te=e.update(U),ne=U.material;if(Array.isArray(ne)){const re=te.groups;for(let j=0,ae=re.length;j<ae;j++){const J=re[j],ie=ne[J.materialIndex];if(ie&&ie.visible){const se=N(U,ie,L,O);U.onBeforeShadow(s,U,z,P,te,se,J),s.renderBufferDirect(P,null,te,se,U,J),U.onAfterShadow(s,U,z,P,te,se,J)}}}else if(ne.visible){const re=N(U,ne,L,O);U.onBeforeShadow(s,U,z,P,te,re,null),s.renderBufferDirect(P,null,te,re,U,null),U.onAfterShadow(s,U,z,P,te,re,null)}}const Q=U.children;for(let te=0,ne=Q.length;te<ne;te++)B(Q[te],z,P,L,O)}function F(U){U.target.removeEventListener("dispose",F);for(const P in h){const L=h[P],O=U.target.uuid;O in L&&(L[O].dispose(),delete L[O])}}}const EI={[a1]:s1,[r1]:c1,[o1]:u1,[td]:l1,[s1]:a1,[c1]:r1,[u1]:o1,[l1]:td};function CI(s,e){function t(){let ye=!1;const Re=new oi;let pt=null;const Rt=new oi(0,0,0,0);return{setMask:function(dt){pt!==dt&&!ye&&(s.colorMask(dt,dt,dt,dt),pt=dt)},setLocked:function(dt){ye=dt},setClear:function(dt,Ke,Lt,Vt,Kt){Kt===!0&&(dt*=Vt,Ke*=Vt,Lt*=Vt),Re.set(dt,Ke,Lt,Vt),Rt.equals(Re)===!1&&(s.clearColor(dt,Ke,Lt,Vt),Rt.copy(Re))},reset:function(){ye=!1,pt=null,Rt.set(-1,0,0,0)}}}function n(){let ye=!1,Re=!1,pt=null,Rt=null,dt=null;return{setReversed:function(Ke){if(Re!==Ke){const Lt=e.get("EXT_clip_control");Ke?Lt.clipControlEXT(Lt.LOWER_LEFT_EXT,Lt.ZERO_TO_ONE_EXT):Lt.clipControlEXT(Lt.LOWER_LEFT_EXT,Lt.NEGATIVE_ONE_TO_ONE_EXT),Re=Ke;const Vt=dt;dt=null,this.setClear(Vt)}},getReversed:function(){return Re},setTest:function(Ke){Ke?pe(s.DEPTH_TEST):ve(s.DEPTH_TEST)},setMask:function(Ke){pt!==Ke&&!ye&&(s.depthMask(Ke),pt=Ke)},setFunc:function(Ke){if(Re&&(Ke=EI[Ke]),Rt!==Ke){switch(Ke){case a1:s.depthFunc(s.NEVER);break;case s1:s.depthFunc(s.ALWAYS);break;case r1:s.depthFunc(s.LESS);break;case td:s.depthFunc(s.LEQUAL);break;case o1:s.depthFunc(s.EQUAL);break;case l1:s.depthFunc(s.GEQUAL);break;case c1:s.depthFunc(s.GREATER);break;case u1:s.depthFunc(s.NOTEQUAL);break;default:s.depthFunc(s.LEQUAL)}Rt=Ke}},setLocked:function(Ke){ye=Ke},setClear:function(Ke){dt!==Ke&&(Re&&(Ke=1-Ke),s.clearDepth(Ke),dt=Ke)},reset:function(){ye=!1,pt=null,Rt=null,dt=null,Re=!1}}}function i(){let ye=!1,Re=null,pt=null,Rt=null,dt=null,Ke=null,Lt=null,Vt=null,Kt=null;return{setTest:function(on){ye||(on?pe(s.STENCIL_TEST):ve(s.STENCIL_TEST))},setMask:function(on){Re!==on&&!ye&&(s.stencilMask(on),Re=on)},setFunc:function(on,Gn,En){(pt!==on||Rt!==Gn||dt!==En)&&(s.stencilFunc(on,Gn,En),pt=on,Rt=Gn,dt=En)},setOp:function(on,Gn,En){(Ke!==on||Lt!==Gn||Vt!==En)&&(s.stencilOp(on,Gn,En),Ke=on,Lt=Gn,Vt=En)},setLocked:function(on){ye=on},setClear:function(on){Kt!==on&&(s.clearStencil(on),Kt=on)},reset:function(){ye=!1,Re=null,pt=null,Rt=null,dt=null,Ke=null,Lt=null,Vt=null,Kt=null}}}const a=new t,o=new n,c=new i,u=new WeakMap,h=new WeakMap;let m={},x={},g=new WeakMap,b=[],S=null,C=!1,M=null,A=null,R=null,N=null,B=null,F=null,U=null,z=new qt(0,0,0),P=0,L=!1,O=null,ee=null,Q=null,te=null,ne=null;const re=s.getParameter(s.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let j=!1,ae=0;const J=s.getParameter(s.VERSION);J.indexOf("WebGL")!==-1?(ae=parseFloat(/^WebGL (\d)/.exec(J)[1]),j=ae>=1):J.indexOf("OpenGL ES")!==-1&&(ae=parseFloat(/^OpenGL ES (\d)/.exec(J)[1]),j=ae>=2);let ie=null,se={};const I=s.getParameter(s.SCISSOR_BOX),W=s.getParameter(s.VIEWPORT),fe=new oi().fromArray(I),Z=new oi().fromArray(W);function me(ye,Re,pt,Rt){const dt=new Uint8Array(4),Ke=s.createTexture();s.bindTexture(ye,Ke),s.texParameteri(ye,s.TEXTURE_MIN_FILTER,s.NEAREST),s.texParameteri(ye,s.TEXTURE_MAG_FILTER,s.NEAREST);for(let Lt=0;Lt<pt;Lt++)ye===s.TEXTURE_3D||ye===s.TEXTURE_2D_ARRAY?s.texImage3D(Re,0,s.RGBA,1,1,Rt,0,s.RGBA,s.UNSIGNED_BYTE,dt):s.texImage2D(Re+Lt,0,s.RGBA,1,1,0,s.RGBA,s.UNSIGNED_BYTE,dt);return Ke}const $={};$[s.TEXTURE_2D]=me(s.TEXTURE_2D,s.TEXTURE_2D,1),$[s.TEXTURE_CUBE_MAP]=me(s.TEXTURE_CUBE_MAP,s.TEXTURE_CUBE_MAP_POSITIVE_X,6),$[s.TEXTURE_2D_ARRAY]=me(s.TEXTURE_2D_ARRAY,s.TEXTURE_2D_ARRAY,1,1),$[s.TEXTURE_3D]=me(s.TEXTURE_3D,s.TEXTURE_3D,1,1),a.setClear(0,0,0,1),o.setClear(1),c.setClear(0),pe(s.DEPTH_TEST),o.setFunc(td),Ye(!1),Ze(A_),pe(s.CULL_FACE),De(cc);function pe(ye){m[ye]!==!0&&(s.enable(ye),m[ye]=!0)}function ve(ye){m[ye]!==!1&&(s.disable(ye),m[ye]=!1)}function ze(ye,Re){return x[ye]!==Re?(s.bindFramebuffer(ye,Re),x[ye]=Re,ye===s.DRAW_FRAMEBUFFER&&(x[s.FRAMEBUFFER]=Re),ye===s.FRAMEBUFFER&&(x[s.DRAW_FRAMEBUFFER]=Re),!0):!1}function Ge(ye,Re){let pt=b,Rt=!1;if(ye){pt=g.get(Re),pt===void 0&&(pt=[],g.set(Re,pt));const dt=ye.textures;if(pt.length!==dt.length||pt[0]!==s.COLOR_ATTACHMENT0){for(let Ke=0,Lt=dt.length;Ke<Lt;Ke++)pt[Ke]=s.COLOR_ATTACHMENT0+Ke;pt.length=dt.length,Rt=!0}}else pt[0]!==s.BACK&&(pt[0]=s.BACK,Rt=!0);Rt&&s.drawBuffers(pt)}function Fe(ye){return S!==ye?(s.useProgram(ye),S=ye,!0):!1}const Qe={[wf]:s.FUNC_ADD,[M3]:s.FUNC_SUBTRACT,[w3]:s.FUNC_REVERSE_SUBTRACT};Qe[E3]=s.MIN,Qe[C3]=s.MAX;const lt={[T3]:s.ZERO,[R3]:s.ONE,[N3]:s.SRC_COLOR,[n1]:s.SRC_ALPHA,[I3]:s.SRC_ALPHA_SATURATE,[L3]:s.DST_COLOR,[D3]:s.DST_ALPHA,[B3]:s.ONE_MINUS_SRC_COLOR,[i1]:s.ONE_MINUS_SRC_ALPHA,[O3]:s.ONE_MINUS_DST_COLOR,[U3]:s.ONE_MINUS_DST_ALPHA,[z3]:s.CONSTANT_COLOR,[F3]:s.ONE_MINUS_CONSTANT_COLOR,[P3]:s.CONSTANT_ALPHA,[G3]:s.ONE_MINUS_CONSTANT_ALPHA};function De(ye,Re,pt,Rt,dt,Ke,Lt,Vt,Kt,on){if(ye===cc){C===!0&&(ve(s.BLEND),C=!1);return}if(C===!1&&(pe(s.BLEND),C=!0),ye!==A3){if(ye!==M||on!==L){if((A!==wf||B!==wf)&&(s.blendEquation(s.FUNC_ADD),A=wf,B=wf),on)switch(ye){case Kh:s.blendFuncSeparate(s.ONE,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA);break;case t1:s.blendFunc(s.ONE,s.ONE);break;case M_:s.blendFuncSeparate(s.ZERO,s.ONE_MINUS_SRC_COLOR,s.ZERO,s.ONE);break;case w_:s.blendFuncSeparate(s.DST_COLOR,s.ONE_MINUS_SRC_ALPHA,s.ZERO,s.ONE);break;default:Xn("WebGLState: Invalid blending: ",ye);break}else switch(ye){case Kh:s.blendFuncSeparate(s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA);break;case t1:s.blendFuncSeparate(s.SRC_ALPHA,s.ONE,s.ONE,s.ONE);break;case M_:Xn("WebGLState: SubtractiveBlending requires material.premultipliedAlpha = true");break;case w_:Xn("WebGLState: MultiplyBlending requires material.premultipliedAlpha = true");break;default:Xn("WebGLState: Invalid blending: ",ye);break}R=null,N=null,F=null,U=null,z.set(0,0,0),P=0,M=ye,L=on}return}dt=dt||Re,Ke=Ke||pt,Lt=Lt||Rt,(Re!==A||dt!==B)&&(s.blendEquationSeparate(Qe[Re],Qe[dt]),A=Re,B=dt),(pt!==R||Rt!==N||Ke!==F||Lt!==U)&&(s.blendFuncSeparate(lt[pt],lt[Rt],lt[Ke],lt[Lt]),R=pt,N=Rt,F=Ke,U=Lt),(Vt.equals(z)===!1||Kt!==P)&&(s.blendColor(Vt.r,Vt.g,Vt.b,Kt),z.copy(Vt),P=Kt),M=ye,L=!1}function le(ye,Re){ye.side===Oi?ve(s.CULL_FACE):pe(s.CULL_FACE);let pt=ye.side===fr;Re&&(pt=!pt),Ye(pt),ye.blending===Kh&&ye.transparent===!1?De(cc):De(ye.blending,ye.blendEquation,ye.blendSrc,ye.blendDst,ye.blendEquationAlpha,ye.blendSrcAlpha,ye.blendDstAlpha,ye.blendColor,ye.blendAlpha,ye.premultipliedAlpha),o.setFunc(ye.depthFunc),o.setTest(ye.depthTest),o.setMask(ye.depthWrite),a.setMask(ye.colorWrite);const Rt=ye.stencilWrite;c.setTest(Rt),Rt&&(c.setMask(ye.stencilWriteMask),c.setFunc(ye.stencilFunc,ye.stencilRef,ye.stencilFuncMask),c.setOp(ye.stencilFail,ye.stencilZFail,ye.stencilZPass)),He(ye.polygonOffset,ye.polygonOffsetFactor,ye.polygonOffsetUnits),ye.alphaToCoverage===!0?pe(s.SAMPLE_ALPHA_TO_COVERAGE):ve(s.SAMPLE_ALPHA_TO_COVERAGE)}function Ye(ye){O!==ye&&(ye?s.frontFace(s.CW):s.frontFace(s.CCW),O=ye)}function Ze(ye){ye!==b3?(pe(s.CULL_FACE),ye!==ee&&(ye===A_?s.cullFace(s.BACK):ye===_3?s.cullFace(s.FRONT):s.cullFace(s.FRONT_AND_BACK))):ve(s.CULL_FACE),ee=ye}function je(ye){ye!==Q&&(j&&s.lineWidth(ye),Q=ye)}function He(ye,Re,pt){ye?(pe(s.POLYGON_OFFSET_FILL),(te!==Re||ne!==pt)&&(s.polygonOffset(Re,pt),te=Re,ne=pt)):ve(s.POLYGON_OFFSET_FILL)}function et(ye){ye?pe(s.SCISSOR_TEST):ve(s.SCISSOR_TEST)}function Ne(ye){ye===void 0&&(ye=s.TEXTURE0+re-1),ie!==ye&&(s.activeTexture(ye),ie=ye)}function st(ye,Re,pt){pt===void 0&&(ie===null?pt=s.TEXTURE0+re-1:pt=ie);let Rt=se[pt];Rt===void 0&&(Rt={type:void 0,texture:void 0},se[pt]=Rt),(Rt.type!==ye||Rt.texture!==Re)&&(ie!==pt&&(s.activeTexture(pt),ie=pt),s.bindTexture(ye,Re||$[ye]),Rt.type=ye,Rt.texture=Re)}function oe(){const ye=se[ie];ye!==void 0&&ye.type!==void 0&&(s.bindTexture(ye.type,null),ye.type=void 0,ye.texture=void 0)}function X(){try{s.compressedTexImage2D(...arguments)}catch(ye){ye("WebGLState:",ye)}}function Ae(){try{s.compressedTexImage3D(...arguments)}catch(ye){ye("WebGLState:",ye)}}function Pe(){try{s.texSubImage2D(...arguments)}catch(ye){ye("WebGLState:",ye)}}function Ue(){try{s.texSubImage3D(...arguments)}catch(ye){ye("WebGLState:",ye)}}function Be(){try{s.compressedTexSubImage2D(...arguments)}catch(ye){ye("WebGLState:",ye)}}function bt(){try{s.compressedTexSubImage3D(...arguments)}catch(ye){ye("WebGLState:",ye)}}function vt(){try{s.texStorage2D(...arguments)}catch(ye){ye("WebGLState:",ye)}}function It(){try{s.texStorage3D(...arguments)}catch(ye){ye("WebGLState:",ye)}}function zt(){try{s.texImage2D(...arguments)}catch(ye){ye("WebGLState:",ye)}}function qe(){try{s.texImage3D(...arguments)}catch(ye){ye("WebGLState:",ye)}}function We(ye){fe.equals(ye)===!1&&(s.scissor(ye.x,ye.y,ye.z,ye.w),fe.copy(ye))}function ft(ye){Z.equals(ye)===!1&&(s.viewport(ye.x,ye.y,ye.z,ye.w),Z.copy(ye))}function ge(ye,Re){let pt=h.get(Re);pt===void 0&&(pt=new WeakMap,h.set(Re,pt));let Rt=pt.get(ye);Rt===void 0&&(Rt=s.getUniformBlockIndex(Re,ye.name),pt.set(ye,Rt))}function Ie(ye,Re){const Rt=h.get(Re).get(ye);u.get(Re)!==Rt&&(s.uniformBlockBinding(Re,Rt,ye.__bindingPointIndex),u.set(Re,Rt))}function ht(){s.disable(s.BLEND),s.disable(s.CULL_FACE),s.disable(s.DEPTH_TEST),s.disable(s.POLYGON_OFFSET_FILL),s.disable(s.SCISSOR_TEST),s.disable(s.STENCIL_TEST),s.disable(s.SAMPLE_ALPHA_TO_COVERAGE),s.blendEquation(s.FUNC_ADD),s.blendFunc(s.ONE,s.ZERO),s.blendFuncSeparate(s.ONE,s.ZERO,s.ONE,s.ZERO),s.blendColor(0,0,0,0),s.colorMask(!0,!0,!0,!0),s.clearColor(0,0,0,0),s.depthMask(!0),s.depthFunc(s.LESS),o.setReversed(!1),s.clearDepth(1),s.stencilMask(4294967295),s.stencilFunc(s.ALWAYS,0,4294967295),s.stencilOp(s.KEEP,s.KEEP,s.KEEP),s.clearStencil(0),s.cullFace(s.BACK),s.frontFace(s.CCW),s.polygonOffset(0,0),s.activeTexture(s.TEXTURE0),s.bindFramebuffer(s.FRAMEBUFFER,null),s.bindFramebuffer(s.DRAW_FRAMEBUFFER,null),s.bindFramebuffer(s.READ_FRAMEBUFFER,null),s.useProgram(null),s.lineWidth(1),s.scissor(0,0,s.canvas.width,s.canvas.height),s.viewport(0,0,s.canvas.width,s.canvas.height),m={},ie=null,se={},x={},g=new WeakMap,b=[],S=null,C=!1,M=null,A=null,R=null,N=null,B=null,F=null,U=null,z=new qt(0,0,0),P=0,L=!1,O=null,ee=null,Q=null,te=null,ne=null,fe.set(0,0,s.canvas.width,s.canvas.height),Z.set(0,0,s.canvas.width,s.canvas.height),a.reset(),o.reset(),c.reset()}return{buffers:{color:a,depth:o,stencil:c},enable:pe,disable:ve,bindFramebuffer:ze,drawBuffers:Ge,useProgram:Fe,setBlending:De,setMaterial:le,setFlipSided:Ye,setCullFace:Ze,setLineWidth:je,setPolygonOffset:He,setScissorTest:et,activeTexture:Ne,bindTexture:st,unbindTexture:oe,compressedTexImage2D:X,compressedTexImage3D:Ae,texImage2D:zt,texImage3D:qe,updateUBOMapping:ge,uniformBlockBinding:Ie,texStorage2D:vt,texStorage3D:It,texSubImage2D:Pe,texSubImage3D:Ue,compressedTexSubImage2D:Be,compressedTexSubImage3D:bt,scissor:We,viewport:ft,reset:ht}}function TI(s,e,t,n,i,a,o){const c=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,u=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),h=new gt,m=new WeakMap;let x;const g=new WeakMap;let b=!1;try{b=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function S(oe,X){return b?new OffscreenCanvas(oe,X):cx("canvas")}function C(oe,X,Ae){let Pe=1;const Ue=st(oe);if((Ue.width>Ae||Ue.height>Ae)&&(Pe=Ae/Math.max(Ue.width,Ue.height)),Pe<1)if(typeof HTMLImageElement<"u"&&oe instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&oe instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&oe instanceof ImageBitmap||typeof VideoFrame<"u"&&oe instanceof VideoFrame){const Be=Math.floor(Pe*Ue.width),bt=Math.floor(Pe*Ue.height);x===void 0&&(x=S(Be,bt));const vt=X?S(Be,bt):x;return vt.width=Be,vt.height=bt,vt.getContext("2d").drawImage(oe,0,0,Be,bt),un("WebGLRenderer: Texture has been resized from ("+Ue.width+"x"+Ue.height+") to ("+Be+"x"+bt+")."),vt}else return"data"in oe&&un("WebGLRenderer: Image in DataTexture is too big ("+Ue.width+"x"+Ue.height+")."),oe;return oe}function M(oe){return oe.generateMipmaps}function A(oe){s.generateMipmap(oe)}function R(oe){return oe.isWebGLCubeRenderTarget?s.TEXTURE_CUBE_MAP:oe.isWebGL3DRenderTarget?s.TEXTURE_3D:oe.isWebGLArrayRenderTarget||oe.isCompressedArrayTexture?s.TEXTURE_2D_ARRAY:s.TEXTURE_2D}function N(oe,X,Ae,Pe,Ue=!1){if(oe!==null){if(s[oe]!==void 0)return s[oe];un("WebGLRenderer: Attempt to use non-existing WebGL internal format '"+oe+"'")}let Be=X;if(X===s.RED&&(Ae===s.FLOAT&&(Be=s.R32F),Ae===s.HALF_FLOAT&&(Be=s.R16F),Ae===s.UNSIGNED_BYTE&&(Be=s.R8)),X===s.RED_INTEGER&&(Ae===s.UNSIGNED_BYTE&&(Be=s.R8UI),Ae===s.UNSIGNED_SHORT&&(Be=s.R16UI),Ae===s.UNSIGNED_INT&&(Be=s.R32UI),Ae===s.BYTE&&(Be=s.R8I),Ae===s.SHORT&&(Be=s.R16I),Ae===s.INT&&(Be=s.R32I)),X===s.RG&&(Ae===s.FLOAT&&(Be=s.RG32F),Ae===s.HALF_FLOAT&&(Be=s.RG16F),Ae===s.UNSIGNED_BYTE&&(Be=s.RG8)),X===s.RG_INTEGER&&(Ae===s.UNSIGNED_BYTE&&(Be=s.RG8UI),Ae===s.UNSIGNED_SHORT&&(Be=s.RG16UI),Ae===s.UNSIGNED_INT&&(Be=s.RG32UI),Ae===s.BYTE&&(Be=s.RG8I),Ae===s.SHORT&&(Be=s.RG16I),Ae===s.INT&&(Be=s.RG32I)),X===s.RGB_INTEGER&&(Ae===s.UNSIGNED_BYTE&&(Be=s.RGB8UI),Ae===s.UNSIGNED_SHORT&&(Be=s.RGB16UI),Ae===s.UNSIGNED_INT&&(Be=s.RGB32UI),Ae===s.BYTE&&(Be=s.RGB8I),Ae===s.SHORT&&(Be=s.RGB16I),Ae===s.INT&&(Be=s.RGB32I)),X===s.RGBA_INTEGER&&(Ae===s.UNSIGNED_BYTE&&(Be=s.RGBA8UI),Ae===s.UNSIGNED_SHORT&&(Be=s.RGBA16UI),Ae===s.UNSIGNED_INT&&(Be=s.RGBA32UI),Ae===s.BYTE&&(Be=s.RGBA8I),Ae===s.SHORT&&(Be=s.RGBA16I),Ae===s.INT&&(Be=s.RGBA32I)),X===s.RGB&&(Ae===s.UNSIGNED_INT_5_9_9_9_REV&&(Be=s.RGB9_E5),Ae===s.UNSIGNED_INT_10F_11F_11F_REV&&(Be=s.R11F_G11F_B10F)),X===s.RGBA){const bt=Ue?ox:Ri.getTransfer(Pe);Ae===s.FLOAT&&(Be=s.RGBA32F),Ae===s.HALF_FLOAT&&(Be=s.RGBA16F),Ae===s.UNSIGNED_BYTE&&(Be=bt===ta?s.SRGB8_ALPHA8:s.RGBA8),Ae===s.UNSIGNED_SHORT_4_4_4_4&&(Be=s.RGBA4),Ae===s.UNSIGNED_SHORT_5_5_5_1&&(Be=s.RGB5_A1)}return(Be===s.R16F||Be===s.R32F||Be===s.RG16F||Be===s.RG32F||Be===s.RGBA16F||Be===s.RGBA32F)&&e.get("EXT_color_buffer_float"),Be}function B(oe,X){let Ae;return oe?X===null||X===Qc||X===Gp?Ae=s.DEPTH24_STENCIL8:X===Da?Ae=s.DEPTH32F_STENCIL8:X===Pp&&(Ae=s.DEPTH24_STENCIL8,un("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):X===null||X===Qc||X===Gp?Ae=s.DEPTH_COMPONENT24:X===Da?Ae=s.DEPTH_COMPONENT32F:X===Pp&&(Ae=s.DEPTH_COMPONENT16),Ae}function F(oe,X){return M(oe)===!0||oe.isFramebufferTexture&&oe.minFilter!==Vs&&oe.minFilter!==bi?Math.log2(Math.max(X.width,X.height))+1:oe.mipmaps!==void 0&&oe.mipmaps.length>0?oe.mipmaps.length:oe.isCompressedTexture&&Array.isArray(oe.image)?X.mipmaps.length:1}function U(oe){const X=oe.target;X.removeEventListener("dispose",U),P(X),X.isVideoTexture&&m.delete(X)}function z(oe){const X=oe.target;X.removeEventListener("dispose",z),O(X)}function P(oe){const X=n.get(oe);if(X.__webglInit===void 0)return;const Ae=oe.source,Pe=g.get(Ae);if(Pe){const Ue=Pe[X.__cacheKey];Ue.usedTimes--,Ue.usedTimes===0&&L(oe),Object.keys(Pe).length===0&&g.delete(Ae)}n.remove(oe)}function L(oe){const X=n.get(oe);s.deleteTexture(X.__webglTexture);const Ae=oe.source,Pe=g.get(Ae);delete Pe[X.__cacheKey],o.memory.textures--}function O(oe){const X=n.get(oe);if(oe.depthTexture&&(oe.depthTexture.dispose(),n.remove(oe.depthTexture)),oe.isWebGLCubeRenderTarget)for(let Pe=0;Pe<6;Pe++){if(Array.isArray(X.__webglFramebuffer[Pe]))for(let Ue=0;Ue<X.__webglFramebuffer[Pe].length;Ue++)s.deleteFramebuffer(X.__webglFramebuffer[Pe][Ue]);else s.deleteFramebuffer(X.__webglFramebuffer[Pe]);X.__webglDepthbuffer&&s.deleteRenderbuffer(X.__webglDepthbuffer[Pe])}else{if(Array.isArray(X.__webglFramebuffer))for(let Pe=0;Pe<X.__webglFramebuffer.length;Pe++)s.deleteFramebuffer(X.__webglFramebuffer[Pe]);else s.deleteFramebuffer(X.__webglFramebuffer);if(X.__webglDepthbuffer&&s.deleteRenderbuffer(X.__webglDepthbuffer),X.__webglMultisampledFramebuffer&&s.deleteFramebuffer(X.__webglMultisampledFramebuffer),X.__webglColorRenderbuffer)for(let Pe=0;Pe<X.__webglColorRenderbuffer.length;Pe++)X.__webglColorRenderbuffer[Pe]&&s.deleteRenderbuffer(X.__webglColorRenderbuffer[Pe]);X.__webglDepthRenderbuffer&&s.deleteRenderbuffer(X.__webglDepthRenderbuffer)}const Ae=oe.textures;for(let Pe=0,Ue=Ae.length;Pe<Ue;Pe++){const Be=n.get(Ae[Pe]);Be.__webglTexture&&(s.deleteTexture(Be.__webglTexture),o.memory.textures--),n.remove(Ae[Pe])}n.remove(oe)}let ee=0;function Q(){ee=0}function te(){const oe=ee;return oe>=i.maxTextures&&un("WebGLTextures: Trying to use "+oe+" texture units while this GPU supports only "+i.maxTextures),ee+=1,oe}function ne(oe){const X=[];return X.push(oe.wrapS),X.push(oe.wrapT),X.push(oe.wrapR||0),X.push(oe.magFilter),X.push(oe.minFilter),X.push(oe.anisotropy),X.push(oe.internalFormat),X.push(oe.format),X.push(oe.type),X.push(oe.generateMipmaps),X.push(oe.premultiplyAlpha),X.push(oe.flipY),X.push(oe.unpackAlignment),X.push(oe.colorSpace),X.join()}function re(oe,X){const Ae=n.get(oe);if(oe.isVideoTexture&&et(oe),oe.isRenderTargetTexture===!1&&oe.isExternalTexture!==!0&&oe.version>0&&Ae.__version!==oe.version){const Pe=oe.image;if(Pe===null)un("WebGLRenderer: Texture marked for update but no image data found.");else if(Pe.complete===!1)un("WebGLRenderer: Texture marked for update but image is incomplete");else{$(Ae,oe,X);return}}else oe.isExternalTexture&&(Ae.__webglTexture=oe.sourceTexture?oe.sourceTexture:null);t.bindTexture(s.TEXTURE_2D,Ae.__webglTexture,s.TEXTURE0+X)}function j(oe,X){const Ae=n.get(oe);if(oe.isRenderTargetTexture===!1&&oe.version>0&&Ae.__version!==oe.version){$(Ae,oe,X);return}else oe.isExternalTexture&&(Ae.__webglTexture=oe.sourceTexture?oe.sourceTexture:null);t.bindTexture(s.TEXTURE_2D_ARRAY,Ae.__webglTexture,s.TEXTURE0+X)}function ae(oe,X){const Ae=n.get(oe);if(oe.isRenderTargetTexture===!1&&oe.version>0&&Ae.__version!==oe.version){$(Ae,oe,X);return}t.bindTexture(s.TEXTURE_3D,Ae.__webglTexture,s.TEXTURE0+X)}function J(oe,X){const Ae=n.get(oe);if(oe.version>0&&Ae.__version!==oe.version){pe(Ae,oe,X);return}t.bindTexture(s.TEXTURE_CUBE_MAP,Ae.__webglTexture,s.TEXTURE0+X)}const ie={[Of]:s.REPEAT,[Pa]:s.CLAMP_TO_EDGE,[Fp]:s.MIRRORED_REPEAT},se={[Vs]:s.NEAREST,[ay]:s.NEAREST_MIPMAP_NEAREST,[Vh]:s.NEAREST_MIPMAP_LINEAR,[bi]:s.LINEAR,[Dp]:s.LINEAR_MIPMAP_NEAREST,[Al]:s.LINEAR_MIPMAP_LINEAR},I={[tC]:s.NEVER,[oC]:s.ALWAYS,[nC]:s.LESS,[dS]:s.LEQUAL,[iC]:s.EQUAL,[rC]:s.GEQUAL,[aC]:s.GREATER,[sC]:s.NOTEQUAL};function W(oe,X){if(X.type===Da&&e.has("OES_texture_float_linear")===!1&&(X.magFilter===bi||X.magFilter===Dp||X.magFilter===Vh||X.magFilter===Al||X.minFilter===bi||X.minFilter===Dp||X.minFilter===Vh||X.minFilter===Al)&&un("WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),s.texParameteri(oe,s.TEXTURE_WRAP_S,ie[X.wrapS]),s.texParameteri(oe,s.TEXTURE_WRAP_T,ie[X.wrapT]),(oe===s.TEXTURE_3D||oe===s.TEXTURE_2D_ARRAY)&&s.texParameteri(oe,s.TEXTURE_WRAP_R,ie[X.wrapR]),s.texParameteri(oe,s.TEXTURE_MAG_FILTER,se[X.magFilter]),s.texParameteri(oe,s.TEXTURE_MIN_FILTER,se[X.minFilter]),X.compareFunction&&(s.texParameteri(oe,s.TEXTURE_COMPARE_MODE,s.COMPARE_REF_TO_TEXTURE),s.texParameteri(oe,s.TEXTURE_COMPARE_FUNC,I[X.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(X.magFilter===Vs||X.minFilter!==Vh&&X.minFilter!==Al||X.type===Da&&e.has("OES_texture_float_linear")===!1)return;if(X.anisotropy>1||n.get(X).__currentAnisotropy){const Ae=e.get("EXT_texture_filter_anisotropic");s.texParameterf(oe,Ae.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(X.anisotropy,i.getMaxAnisotropy())),n.get(X).__currentAnisotropy=X.anisotropy}}}function fe(oe,X){let Ae=!1;oe.__webglInit===void 0&&(oe.__webglInit=!0,X.addEventListener("dispose",U));const Pe=X.source;let Ue=g.get(Pe);Ue===void 0&&(Ue={},g.set(Pe,Ue));const Be=ne(X);if(Be!==oe.__cacheKey){Ue[Be]===void 0&&(Ue[Be]={texture:s.createTexture(),usedTimes:0},o.memory.textures++,Ae=!0),Ue[Be].usedTimes++;const bt=Ue[oe.__cacheKey];bt!==void 0&&(Ue[oe.__cacheKey].usedTimes--,bt.usedTimes===0&&L(X)),oe.__cacheKey=Be,oe.__webglTexture=Ue[Be].texture}return Ae}function Z(oe,X,Ae){return Math.floor(Math.floor(oe/Ae)/X)}function me(oe,X,Ae,Pe){const Be=oe.updateRanges;if(Be.length===0)t.texSubImage2D(s.TEXTURE_2D,0,0,0,X.width,X.height,Ae,Pe,X.data);else{Be.sort((qe,We)=>qe.start-We.start);let bt=0;for(let qe=1;qe<Be.length;qe++){const We=Be[bt],ft=Be[qe],ge=We.start+We.count,Ie=Z(ft.start,X.width,4),ht=Z(We.start,X.width,4);ft.start<=ge+1&&Ie===ht&&Z(ft.start+ft.count-1,X.width,4)===Ie?We.count=Math.max(We.count,ft.start+ft.count-We.start):(++bt,Be[bt]=ft)}Be.length=bt+1;const vt=s.getParameter(s.UNPACK_ROW_LENGTH),It=s.getParameter(s.UNPACK_SKIP_PIXELS),zt=s.getParameter(s.UNPACK_SKIP_ROWS);s.pixelStorei(s.UNPACK_ROW_LENGTH,X.width);for(let qe=0,We=Be.length;qe<We;qe++){const ft=Be[qe],ge=Math.floor(ft.start/4),Ie=Math.ceil(ft.count/4),ht=ge%X.width,ye=Math.floor(ge/X.width),Re=Ie,pt=1;s.pixelStorei(s.UNPACK_SKIP_PIXELS,ht),s.pixelStorei(s.UNPACK_SKIP_ROWS,ye),t.texSubImage2D(s.TEXTURE_2D,0,ht,ye,Re,pt,Ae,Pe,X.data)}oe.clearUpdateRanges(),s.pixelStorei(s.UNPACK_ROW_LENGTH,vt),s.pixelStorei(s.UNPACK_SKIP_PIXELS,It),s.pixelStorei(s.UNPACK_SKIP_ROWS,zt)}}function $(oe,X,Ae){let Pe=s.TEXTURE_2D;(X.isDataArrayTexture||X.isCompressedArrayTexture)&&(Pe=s.TEXTURE_2D_ARRAY),X.isData3DTexture&&(Pe=s.TEXTURE_3D);const Ue=fe(oe,X),Be=X.source;t.bindTexture(Pe,oe.__webglTexture,s.TEXTURE0+Ae);const bt=n.get(Be);if(Be.version!==bt.__version||Ue===!0){t.activeTexture(s.TEXTURE0+Ae);const vt=Ri.getPrimaries(Ri.workingColorSpace),It=X.colorSpace===zu?null:Ri.getPrimaries(X.colorSpace),zt=X.colorSpace===zu||vt===It?s.NONE:s.BROWSER_DEFAULT_WEBGL;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,X.flipY),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,X.premultiplyAlpha),s.pixelStorei(s.UNPACK_ALIGNMENT,X.unpackAlignment),s.pixelStorei(s.UNPACK_COLORSPACE_CONVERSION_WEBGL,zt);let qe=C(X.image,!1,i.maxTextureSize);qe=Ne(X,qe);const We=a.convert(X.format,X.colorSpace),ft=a.convert(X.type);let ge=N(X.internalFormat,We,ft,X.colorSpace,X.isVideoTexture);W(Pe,X);let Ie;const ht=X.mipmaps,ye=X.isVideoTexture!==!0,Re=bt.__version===void 0||Ue===!0,pt=Be.dataReady,Rt=F(X,qe);if(X.isDepthTexture)ge=B(X.format===Hp,X.type),Re&&(ye?t.texStorage2D(s.TEXTURE_2D,1,ge,qe.width,qe.height):t.texImage2D(s.TEXTURE_2D,0,ge,qe.width,qe.height,0,We,ft,null));else if(X.isDataTexture)if(ht.length>0){ye&&Re&&t.texStorage2D(s.TEXTURE_2D,Rt,ge,ht[0].width,ht[0].height);for(let dt=0,Ke=ht.length;dt<Ke;dt++)Ie=ht[dt],ye?pt&&t.texSubImage2D(s.TEXTURE_2D,dt,0,0,Ie.width,Ie.height,We,ft,Ie.data):t.texImage2D(s.TEXTURE_2D,dt,ge,Ie.width,Ie.height,0,We,ft,Ie.data);X.generateMipmaps=!1}else ye?(Re&&t.texStorage2D(s.TEXTURE_2D,Rt,ge,qe.width,qe.height),pt&&me(X,qe,We,ft)):t.texImage2D(s.TEXTURE_2D,0,ge,qe.width,qe.height,0,We,ft,qe.data);else if(X.isCompressedTexture)if(X.isCompressedArrayTexture){ye&&Re&&t.texStorage3D(s.TEXTURE_2D_ARRAY,Rt,ge,ht[0].width,ht[0].height,qe.depth);for(let dt=0,Ke=ht.length;dt<Ke;dt++)if(Ie=ht[dt],X.format!==ss)if(We!==null)if(ye){if(pt)if(X.layerUpdates.size>0){const Lt=O_(Ie.width,Ie.height,X.format,X.type);for(const Vt of X.layerUpdates){const Kt=Ie.data.subarray(Vt*Lt/Ie.data.BYTES_PER_ELEMENT,(Vt+1)*Lt/Ie.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(s.TEXTURE_2D_ARRAY,dt,0,0,Vt,Ie.width,Ie.height,1,We,Kt)}X.clearLayerUpdates()}else t.compressedTexSubImage3D(s.TEXTURE_2D_ARRAY,dt,0,0,0,Ie.width,Ie.height,qe.depth,We,Ie.data)}else t.compressedTexImage3D(s.TEXTURE_2D_ARRAY,dt,ge,Ie.width,Ie.height,qe.depth,0,Ie.data,0,0);else un("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else ye?pt&&t.texSubImage3D(s.TEXTURE_2D_ARRAY,dt,0,0,0,Ie.width,Ie.height,qe.depth,We,ft,Ie.data):t.texImage3D(s.TEXTURE_2D_ARRAY,dt,ge,Ie.width,Ie.height,qe.depth,0,We,ft,Ie.data)}else{ye&&Re&&t.texStorage2D(s.TEXTURE_2D,Rt,ge,ht[0].width,ht[0].height);for(let dt=0,Ke=ht.length;dt<Ke;dt++)Ie=ht[dt],X.format!==ss?We!==null?ye?pt&&t.compressedTexSubImage2D(s.TEXTURE_2D,dt,0,0,Ie.width,Ie.height,We,Ie.data):t.compressedTexImage2D(s.TEXTURE_2D,dt,ge,Ie.width,Ie.height,0,Ie.data):un("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):ye?pt&&t.texSubImage2D(s.TEXTURE_2D,dt,0,0,Ie.width,Ie.height,We,ft,Ie.data):t.texImage2D(s.TEXTURE_2D,dt,ge,Ie.width,Ie.height,0,We,ft,Ie.data)}else if(X.isDataArrayTexture)if(ye){if(Re&&t.texStorage3D(s.TEXTURE_2D_ARRAY,Rt,ge,qe.width,qe.height,qe.depth),pt)if(X.layerUpdates.size>0){const dt=O_(qe.width,qe.height,X.format,X.type);for(const Ke of X.layerUpdates){const Lt=qe.data.subarray(Ke*dt/qe.data.BYTES_PER_ELEMENT,(Ke+1)*dt/qe.data.BYTES_PER_ELEMENT);t.texSubImage3D(s.TEXTURE_2D_ARRAY,0,0,0,Ke,qe.width,qe.height,1,We,ft,Lt)}X.clearLayerUpdates()}else t.texSubImage3D(s.TEXTURE_2D_ARRAY,0,0,0,0,qe.width,qe.height,qe.depth,We,ft,qe.data)}else t.texImage3D(s.TEXTURE_2D_ARRAY,0,ge,qe.width,qe.height,qe.depth,0,We,ft,qe.data);else if(X.isData3DTexture)ye?(Re&&t.texStorage3D(s.TEXTURE_3D,Rt,ge,qe.width,qe.height,qe.depth),pt&&t.texSubImage3D(s.TEXTURE_3D,0,0,0,0,qe.width,qe.height,qe.depth,We,ft,qe.data)):t.texImage3D(s.TEXTURE_3D,0,ge,qe.width,qe.height,qe.depth,0,We,ft,qe.data);else if(X.isFramebufferTexture){if(Re)if(ye)t.texStorage2D(s.TEXTURE_2D,Rt,ge,qe.width,qe.height);else{let dt=qe.width,Ke=qe.height;for(let Lt=0;Lt<Rt;Lt++)t.texImage2D(s.TEXTURE_2D,Lt,ge,dt,Ke,0,We,ft,null),dt>>=1,Ke>>=1}}else if(ht.length>0){if(ye&&Re){const dt=st(ht[0]);t.texStorage2D(s.TEXTURE_2D,Rt,ge,dt.width,dt.height)}for(let dt=0,Ke=ht.length;dt<Ke;dt++)Ie=ht[dt],ye?pt&&t.texSubImage2D(s.TEXTURE_2D,dt,0,0,We,ft,Ie):t.texImage2D(s.TEXTURE_2D,dt,ge,We,ft,Ie);X.generateMipmaps=!1}else if(ye){if(Re){const dt=st(qe);t.texStorage2D(s.TEXTURE_2D,Rt,ge,dt.width,dt.height)}pt&&t.texSubImage2D(s.TEXTURE_2D,0,0,0,We,ft,qe)}else t.texImage2D(s.TEXTURE_2D,0,ge,We,ft,qe);M(X)&&A(Pe),bt.__version=Be.version,X.onUpdate&&X.onUpdate(X)}oe.__version=X.version}function pe(oe,X,Ae){if(X.image.length!==6)return;const Pe=fe(oe,X),Ue=X.source;t.bindTexture(s.TEXTURE_CUBE_MAP,oe.__webglTexture,s.TEXTURE0+Ae);const Be=n.get(Ue);if(Ue.version!==Be.__version||Pe===!0){t.activeTexture(s.TEXTURE0+Ae);const bt=Ri.getPrimaries(Ri.workingColorSpace),vt=X.colorSpace===zu?null:Ri.getPrimaries(X.colorSpace),It=X.colorSpace===zu||bt===vt?s.NONE:s.BROWSER_DEFAULT_WEBGL;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,X.flipY),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,X.premultiplyAlpha),s.pixelStorei(s.UNPACK_ALIGNMENT,X.unpackAlignment),s.pixelStorei(s.UNPACK_COLORSPACE_CONVERSION_WEBGL,It);const zt=X.isCompressedTexture||X.image[0].isCompressedTexture,qe=X.image[0]&&X.image[0].isDataTexture,We=[];for(let Ke=0;Ke<6;Ke++)!zt&&!qe?We[Ke]=C(X.image[Ke],!0,i.maxCubemapSize):We[Ke]=qe?X.image[Ke].image:X.image[Ke],We[Ke]=Ne(X,We[Ke]);const ft=We[0],ge=a.convert(X.format,X.colorSpace),Ie=a.convert(X.type),ht=N(X.internalFormat,ge,Ie,X.colorSpace),ye=X.isVideoTexture!==!0,Re=Be.__version===void 0||Pe===!0,pt=Ue.dataReady;let Rt=F(X,ft);W(s.TEXTURE_CUBE_MAP,X);let dt;if(zt){ye&&Re&&t.texStorage2D(s.TEXTURE_CUBE_MAP,Rt,ht,ft.width,ft.height);for(let Ke=0;Ke<6;Ke++){dt=We[Ke].mipmaps;for(let Lt=0;Lt<dt.length;Lt++){const Vt=dt[Lt];X.format!==ss?ge!==null?ye?pt&&t.compressedTexSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Ke,Lt,0,0,Vt.width,Vt.height,ge,Vt.data):t.compressedTexImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Ke,Lt,ht,Vt.width,Vt.height,0,Vt.data):un("WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):ye?pt&&t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Ke,Lt,0,0,Vt.width,Vt.height,ge,Ie,Vt.data):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Ke,Lt,ht,Vt.width,Vt.height,0,ge,Ie,Vt.data)}}}else{if(dt=X.mipmaps,ye&&Re){dt.length>0&&Rt++;const Ke=st(We[0]);t.texStorage2D(s.TEXTURE_CUBE_MAP,Rt,ht,Ke.width,Ke.height)}for(let Ke=0;Ke<6;Ke++)if(qe){ye?pt&&t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Ke,0,0,0,We[Ke].width,We[Ke].height,ge,Ie,We[Ke].data):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Ke,0,ht,We[Ke].width,We[Ke].height,0,ge,Ie,We[Ke].data);for(let Lt=0;Lt<dt.length;Lt++){const Kt=dt[Lt].image[Ke].image;ye?pt&&t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Ke,Lt+1,0,0,Kt.width,Kt.height,ge,Ie,Kt.data):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Ke,Lt+1,ht,Kt.width,Kt.height,0,ge,Ie,Kt.data)}}else{ye?pt&&t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Ke,0,0,0,ge,Ie,We[Ke]):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Ke,0,ht,ge,Ie,We[Ke]);for(let Lt=0;Lt<dt.length;Lt++){const Vt=dt[Lt];ye?pt&&t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Ke,Lt+1,0,0,ge,Ie,Vt.image[Ke]):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+Ke,Lt+1,ht,ge,Ie,Vt.image[Ke])}}}M(X)&&A(s.TEXTURE_CUBE_MAP),Be.__version=Ue.version,X.onUpdate&&X.onUpdate(X)}oe.__version=X.version}function ve(oe,X,Ae,Pe,Ue,Be){const bt=a.convert(Ae.format,Ae.colorSpace),vt=a.convert(Ae.type),It=N(Ae.internalFormat,bt,vt,Ae.colorSpace),zt=n.get(X),qe=n.get(Ae);if(qe.__renderTarget=X,!zt.__hasExternalTextures){const We=Math.max(1,X.width>>Be),ft=Math.max(1,X.height>>Be);Ue===s.TEXTURE_3D||Ue===s.TEXTURE_2D_ARRAY?t.texImage3D(Ue,Be,It,We,ft,X.depth,0,bt,vt,null):t.texImage2D(Ue,Be,It,We,ft,0,bt,vt,null)}t.bindFramebuffer(s.FRAMEBUFFER,oe),He(X)?c.framebufferTexture2DMultisampleEXT(s.FRAMEBUFFER,Pe,Ue,qe.__webglTexture,0,je(X)):(Ue===s.TEXTURE_2D||Ue>=s.TEXTURE_CUBE_MAP_POSITIVE_X&&Ue<=s.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&s.framebufferTexture2D(s.FRAMEBUFFER,Pe,Ue,qe.__webglTexture,Be),t.bindFramebuffer(s.FRAMEBUFFER,null)}function ze(oe,X,Ae){if(s.bindRenderbuffer(s.RENDERBUFFER,oe),X.depthBuffer){const Pe=X.depthTexture,Ue=Pe&&Pe.isDepthTexture?Pe.type:null,Be=B(X.stencilBuffer,Ue),bt=X.stencilBuffer?s.DEPTH_STENCIL_ATTACHMENT:s.DEPTH_ATTACHMENT,vt=je(X);He(X)?c.renderbufferStorageMultisampleEXT(s.RENDERBUFFER,vt,Be,X.width,X.height):Ae?s.renderbufferStorageMultisample(s.RENDERBUFFER,vt,Be,X.width,X.height):s.renderbufferStorage(s.RENDERBUFFER,Be,X.width,X.height),s.framebufferRenderbuffer(s.FRAMEBUFFER,bt,s.RENDERBUFFER,oe)}else{const Pe=X.textures;for(let Ue=0;Ue<Pe.length;Ue++){const Be=Pe[Ue],bt=a.convert(Be.format,Be.colorSpace),vt=a.convert(Be.type),It=N(Be.internalFormat,bt,vt,Be.colorSpace),zt=je(X);Ae&&He(X)===!1?s.renderbufferStorageMultisample(s.RENDERBUFFER,zt,It,X.width,X.height):He(X)?c.renderbufferStorageMultisampleEXT(s.RENDERBUFFER,zt,It,X.width,X.height):s.renderbufferStorage(s.RENDERBUFFER,It,X.width,X.height)}}s.bindRenderbuffer(s.RENDERBUFFER,null)}function Ge(oe,X){if(X&&X.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(s.FRAMEBUFFER,oe),!(X.depthTexture&&X.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const Pe=n.get(X.depthTexture);Pe.__renderTarget=X,(!Pe.__webglTexture||X.depthTexture.image.width!==X.width||X.depthTexture.image.height!==X.height)&&(X.depthTexture.image.width=X.width,X.depthTexture.image.height=X.height,X.depthTexture.needsUpdate=!0),re(X.depthTexture,0);const Ue=Pe.__webglTexture,Be=je(X);if(X.depthTexture.format===jp)He(X)?c.framebufferTexture2DMultisampleEXT(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.TEXTURE_2D,Ue,0,Be):s.framebufferTexture2D(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.TEXTURE_2D,Ue,0);else if(X.depthTexture.format===Hp)He(X)?c.framebufferTexture2DMultisampleEXT(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.TEXTURE_2D,Ue,0,Be):s.framebufferTexture2D(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.TEXTURE_2D,Ue,0);else throw new Error("Unknown depthTexture format")}function Fe(oe){const X=n.get(oe),Ae=oe.isWebGLCubeRenderTarget===!0;if(X.__boundDepthTexture!==oe.depthTexture){const Pe=oe.depthTexture;if(X.__depthDisposeCallback&&X.__depthDisposeCallback(),Pe){const Ue=()=>{delete X.__boundDepthTexture,delete X.__depthDisposeCallback,Pe.removeEventListener("dispose",Ue)};Pe.addEventListener("dispose",Ue),X.__depthDisposeCallback=Ue}X.__boundDepthTexture=Pe}if(oe.depthTexture&&!X.__autoAllocateDepthBuffer){if(Ae)throw new Error("target.depthTexture not supported in Cube render targets");const Pe=oe.texture.mipmaps;Pe&&Pe.length>0?Ge(X.__webglFramebuffer[0],oe):Ge(X.__webglFramebuffer,oe)}else if(Ae){X.__webglDepthbuffer=[];for(let Pe=0;Pe<6;Pe++)if(t.bindFramebuffer(s.FRAMEBUFFER,X.__webglFramebuffer[Pe]),X.__webglDepthbuffer[Pe]===void 0)X.__webglDepthbuffer[Pe]=s.createRenderbuffer(),ze(X.__webglDepthbuffer[Pe],oe,!1);else{const Ue=oe.stencilBuffer?s.DEPTH_STENCIL_ATTACHMENT:s.DEPTH_ATTACHMENT,Be=X.__webglDepthbuffer[Pe];s.bindRenderbuffer(s.RENDERBUFFER,Be),s.framebufferRenderbuffer(s.FRAMEBUFFER,Ue,s.RENDERBUFFER,Be)}}else{const Pe=oe.texture.mipmaps;if(Pe&&Pe.length>0?t.bindFramebuffer(s.FRAMEBUFFER,X.__webglFramebuffer[0]):t.bindFramebuffer(s.FRAMEBUFFER,X.__webglFramebuffer),X.__webglDepthbuffer===void 0)X.__webglDepthbuffer=s.createRenderbuffer(),ze(X.__webglDepthbuffer,oe,!1);else{const Ue=oe.stencilBuffer?s.DEPTH_STENCIL_ATTACHMENT:s.DEPTH_ATTACHMENT,Be=X.__webglDepthbuffer;s.bindRenderbuffer(s.RENDERBUFFER,Be),s.framebufferRenderbuffer(s.FRAMEBUFFER,Ue,s.RENDERBUFFER,Be)}}t.bindFramebuffer(s.FRAMEBUFFER,null)}function Qe(oe,X,Ae){const Pe=n.get(oe);X!==void 0&&ve(Pe.__webglFramebuffer,oe,oe.texture,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,0),Ae!==void 0&&Fe(oe)}function lt(oe){const X=oe.texture,Ae=n.get(oe),Pe=n.get(X);oe.addEventListener("dispose",z);const Ue=oe.textures,Be=oe.isWebGLCubeRenderTarget===!0,bt=Ue.length>1;if(bt||(Pe.__webglTexture===void 0&&(Pe.__webglTexture=s.createTexture()),Pe.__version=X.version,o.memory.textures++),Be){Ae.__webglFramebuffer=[];for(let vt=0;vt<6;vt++)if(X.mipmaps&&X.mipmaps.length>0){Ae.__webglFramebuffer[vt]=[];for(let It=0;It<X.mipmaps.length;It++)Ae.__webglFramebuffer[vt][It]=s.createFramebuffer()}else Ae.__webglFramebuffer[vt]=s.createFramebuffer()}else{if(X.mipmaps&&X.mipmaps.length>0){Ae.__webglFramebuffer=[];for(let vt=0;vt<X.mipmaps.length;vt++)Ae.__webglFramebuffer[vt]=s.createFramebuffer()}else Ae.__webglFramebuffer=s.createFramebuffer();if(bt)for(let vt=0,It=Ue.length;vt<It;vt++){const zt=n.get(Ue[vt]);zt.__webglTexture===void 0&&(zt.__webglTexture=s.createTexture(),o.memory.textures++)}if(oe.samples>0&&He(oe)===!1){Ae.__webglMultisampledFramebuffer=s.createFramebuffer(),Ae.__webglColorRenderbuffer=[],t.bindFramebuffer(s.FRAMEBUFFER,Ae.__webglMultisampledFramebuffer);for(let vt=0;vt<Ue.length;vt++){const It=Ue[vt];Ae.__webglColorRenderbuffer[vt]=s.createRenderbuffer(),s.bindRenderbuffer(s.RENDERBUFFER,Ae.__webglColorRenderbuffer[vt]);const zt=a.convert(It.format,It.colorSpace),qe=a.convert(It.type),We=N(It.internalFormat,zt,qe,It.colorSpace,oe.isXRRenderTarget===!0),ft=je(oe);s.renderbufferStorageMultisample(s.RENDERBUFFER,ft,We,oe.width,oe.height),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+vt,s.RENDERBUFFER,Ae.__webglColorRenderbuffer[vt])}s.bindRenderbuffer(s.RENDERBUFFER,null),oe.depthBuffer&&(Ae.__webglDepthRenderbuffer=s.createRenderbuffer(),ze(Ae.__webglDepthRenderbuffer,oe,!0)),t.bindFramebuffer(s.FRAMEBUFFER,null)}}if(Be){t.bindTexture(s.TEXTURE_CUBE_MAP,Pe.__webglTexture),W(s.TEXTURE_CUBE_MAP,X);for(let vt=0;vt<6;vt++)if(X.mipmaps&&X.mipmaps.length>0)for(let It=0;It<X.mipmaps.length;It++)ve(Ae.__webglFramebuffer[vt][It],oe,X,s.COLOR_ATTACHMENT0,s.TEXTURE_CUBE_MAP_POSITIVE_X+vt,It);else ve(Ae.__webglFramebuffer[vt],oe,X,s.COLOR_ATTACHMENT0,s.TEXTURE_CUBE_MAP_POSITIVE_X+vt,0);M(X)&&A(s.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(bt){for(let vt=0,It=Ue.length;vt<It;vt++){const zt=Ue[vt],qe=n.get(zt);let We=s.TEXTURE_2D;(oe.isWebGL3DRenderTarget||oe.isWebGLArrayRenderTarget)&&(We=oe.isWebGL3DRenderTarget?s.TEXTURE_3D:s.TEXTURE_2D_ARRAY),t.bindTexture(We,qe.__webglTexture),W(We,zt),ve(Ae.__webglFramebuffer,oe,zt,s.COLOR_ATTACHMENT0+vt,We,0),M(zt)&&A(We)}t.unbindTexture()}else{let vt=s.TEXTURE_2D;if((oe.isWebGL3DRenderTarget||oe.isWebGLArrayRenderTarget)&&(vt=oe.isWebGL3DRenderTarget?s.TEXTURE_3D:s.TEXTURE_2D_ARRAY),t.bindTexture(vt,Pe.__webglTexture),W(vt,X),X.mipmaps&&X.mipmaps.length>0)for(let It=0;It<X.mipmaps.length;It++)ve(Ae.__webglFramebuffer[It],oe,X,s.COLOR_ATTACHMENT0,vt,It);else ve(Ae.__webglFramebuffer,oe,X,s.COLOR_ATTACHMENT0,vt,0);M(X)&&A(vt),t.unbindTexture()}oe.depthBuffer&&Fe(oe)}function De(oe){const X=oe.textures;for(let Ae=0,Pe=X.length;Ae<Pe;Ae++){const Ue=X[Ae];if(M(Ue)){const Be=R(oe),bt=n.get(Ue).__webglTexture;t.bindTexture(Be,bt),A(Be),t.unbindTexture()}}}const le=[],Ye=[];function Ze(oe){if(oe.samples>0){if(He(oe)===!1){const X=oe.textures,Ae=oe.width,Pe=oe.height;let Ue=s.COLOR_BUFFER_BIT;const Be=oe.stencilBuffer?s.DEPTH_STENCIL_ATTACHMENT:s.DEPTH_ATTACHMENT,bt=n.get(oe),vt=X.length>1;if(vt)for(let zt=0;zt<X.length;zt++)t.bindFramebuffer(s.FRAMEBUFFER,bt.__webglMultisampledFramebuffer),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+zt,s.RENDERBUFFER,null),t.bindFramebuffer(s.FRAMEBUFFER,bt.__webglFramebuffer),s.framebufferTexture2D(s.DRAW_FRAMEBUFFER,s.COLOR_ATTACHMENT0+zt,s.TEXTURE_2D,null,0);t.bindFramebuffer(s.READ_FRAMEBUFFER,bt.__webglMultisampledFramebuffer);const It=oe.texture.mipmaps;It&&It.length>0?t.bindFramebuffer(s.DRAW_FRAMEBUFFER,bt.__webglFramebuffer[0]):t.bindFramebuffer(s.DRAW_FRAMEBUFFER,bt.__webglFramebuffer);for(let zt=0;zt<X.length;zt++){if(oe.resolveDepthBuffer&&(oe.depthBuffer&&(Ue|=s.DEPTH_BUFFER_BIT),oe.stencilBuffer&&oe.resolveStencilBuffer&&(Ue|=s.STENCIL_BUFFER_BIT)),vt){s.framebufferRenderbuffer(s.READ_FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.RENDERBUFFER,bt.__webglColorRenderbuffer[zt]);const qe=n.get(X[zt]).__webglTexture;s.framebufferTexture2D(s.DRAW_FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,qe,0)}s.blitFramebuffer(0,0,Ae,Pe,0,0,Ae,Pe,Ue,s.NEAREST),u===!0&&(le.length=0,Ye.length=0,le.push(s.COLOR_ATTACHMENT0+zt),oe.depthBuffer&&oe.resolveDepthBuffer===!1&&(le.push(Be),Ye.push(Be),s.invalidateFramebuffer(s.DRAW_FRAMEBUFFER,Ye)),s.invalidateFramebuffer(s.READ_FRAMEBUFFER,le))}if(t.bindFramebuffer(s.READ_FRAMEBUFFER,null),t.bindFramebuffer(s.DRAW_FRAMEBUFFER,null),vt)for(let zt=0;zt<X.length;zt++){t.bindFramebuffer(s.FRAMEBUFFER,bt.__webglMultisampledFramebuffer),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+zt,s.RENDERBUFFER,bt.__webglColorRenderbuffer[zt]);const qe=n.get(X[zt]).__webglTexture;t.bindFramebuffer(s.FRAMEBUFFER,bt.__webglFramebuffer),s.framebufferTexture2D(s.DRAW_FRAMEBUFFER,s.COLOR_ATTACHMENT0+zt,s.TEXTURE_2D,qe,0)}t.bindFramebuffer(s.DRAW_FRAMEBUFFER,bt.__webglMultisampledFramebuffer)}else if(oe.depthBuffer&&oe.resolveDepthBuffer===!1&&u){const X=oe.stencilBuffer?s.DEPTH_STENCIL_ATTACHMENT:s.DEPTH_ATTACHMENT;s.invalidateFramebuffer(s.DRAW_FRAMEBUFFER,[X])}}}function je(oe){return Math.min(i.maxSamples,oe.samples)}function He(oe){const X=n.get(oe);return oe.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&X.__useRenderToTexture!==!1}function et(oe){const X=o.render.frame;m.get(oe)!==X&&(m.set(oe,X),oe.update())}function Ne(oe,X){const Ae=oe.colorSpace,Pe=oe.format,Ue=oe.type;return oe.isCompressedTexture===!0||oe.isVideoTexture===!0||Ae!==uc&&Ae!==zu&&(Ri.getTransfer(Ae)===ta?(Pe!==ss||Ue!==uo)&&un("WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):Xn("WebGLTextures: Unsupported texture color space:",Ae)),X}function st(oe){return typeof HTMLImageElement<"u"&&oe instanceof HTMLImageElement?(h.width=oe.naturalWidth||oe.width,h.height=oe.naturalHeight||oe.height):typeof VideoFrame<"u"&&oe instanceof VideoFrame?(h.width=oe.displayWidth,h.height=oe.displayHeight):(h.width=oe.width,h.height=oe.height),h}this.allocateTextureUnit=te,this.resetTextureUnits=Q,this.setTexture2D=re,this.setTexture2DArray=j,this.setTexture3D=ae,this.setTextureCube=J,this.rebindTextures=Qe,this.setupRenderTarget=lt,this.updateRenderTargetMipmap=De,this.updateMultisampleRenderTarget=Ze,this.setupDepthRenderbuffer=Fe,this.setupFrameBufferTexture=ve,this.useMultisampledRTT=He}function oT(s,e){function t(n,i=zu){let a;const o=Ri.getTransfer(i);if(n===uo)return s.UNSIGNED_BYTE;if(n===oy)return s.UNSIGNED_SHORT_4_4_4_4;if(n===ly)return s.UNSIGNED_SHORT_5_5_5_1;if(n===rS)return s.UNSIGNED_INT_5_9_9_9_REV;if(n===oS)return s.UNSIGNED_INT_10F_11F_11F_REV;if(n===sy)return s.BYTE;if(n===ry)return s.SHORT;if(n===Pp)return s.UNSIGNED_SHORT;if(n===_x)return s.INT;if(n===Qc)return s.UNSIGNED_INT;if(n===Da)return s.FLOAT;if(n===xs)return s.HALF_FLOAT;if(n===lS)return s.ALPHA;if(n===cS)return s.RGB;if(n===ss)return s.RGBA;if(n===jp)return s.DEPTH_COMPONENT;if(n===Hp)return s.DEPTH_STENCIL;if(n===Sx)return s.RED;if(n===Ax)return s.RED_INTEGER;if(n===cy)return s.RG;if(n===uy)return s.RG_INTEGER;if(n===fy)return s.RGBA_INTEGER;if(n===Wm||n===qm||n===Jm||n===Zm)if(o===ta)if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(n===Wm)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===qm)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===Jm)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===Zm)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=e.get("WEBGL_compressed_texture_s3tc"),a!==null){if(n===Wm)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===qm)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===Jm)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===Zm)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(n===f1||n===h1||n===d1||n===p1)if(a=e.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(n===f1)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===h1)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===d1)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===p1)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(n===m1||n===x1||n===g1)if(a=e.get("WEBGL_compressed_texture_etc"),a!==null){if(n===m1||n===x1)return o===ta?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(n===g1)return o===ta?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(n===v1||n===y1||n===b1||n===_1||n===S1||n===A1||n===M1||n===w1||n===E1||n===C1||n===T1||n===R1||n===N1||n===B1)if(a=e.get("WEBGL_compressed_texture_astc"),a!==null){if(n===v1)return o===ta?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===y1)return o===ta?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===b1)return o===ta?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===_1)return o===ta?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===S1)return o===ta?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===A1)return o===ta?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===M1)return o===ta?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===w1)return o===ta?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===E1)return o===ta?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===C1)return o===ta?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===T1)return o===ta?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===R1)return o===ta?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===N1)return o===ta?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===B1)return o===ta?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(n===D1||n===U1||n===L1)if(a=e.get("EXT_texture_compression_bptc"),a!==null){if(n===D1)return o===ta?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===U1)return a.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===L1)return a.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(n===O1||n===I1||n===z1||n===F1)if(a=e.get("EXT_texture_compression_rgtc"),a!==null){if(n===O1)return a.COMPRESSED_RED_RGTC1_EXT;if(n===I1)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===z1)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===F1)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return n===Gp?s.UNSIGNED_INT_24_8:s[n]!==void 0?s[n]:null}return{convert:t}}const RI=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,NI=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class BI{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t){if(this.texture===null){const n=new AS(e.texture);(e.depthNear!==t.depthNear||e.depthFar!==t.depthFar)&&(this.depthNear=e.depthNear,this.depthFar=e.depthFar),this.texture=n}}getMesh(e){if(this.texture!==null&&this.mesh===null){const t=e.cameras[0].viewport,n=new Ys({vertexShader:RI,fragmentShader:NI,uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new sn(new is(20,20),n)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class DI extends eu{constructor(e,t){super();const n=this;let i=null,a=1,o=null,c="local-floor",u=1,h=null,m=null,x=null,g=null,b=null,S=null;const C=typeof XRWebGLBinding<"u",M=new BI,A={},R=t.getContextAttributes();let N=null,B=null;const F=[],U=[],z=new gt;let P=null;const L=new Ba;L.viewport=new oi;const O=new Ba;O.viewport=new oi;const ee=[L,O],Q=new KC;let te=null,ne=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function($){let pe=F[$];return pe===void 0&&(pe=new Jv,F[$]=pe),pe.getTargetRaySpace()},this.getControllerGrip=function($){let pe=F[$];return pe===void 0&&(pe=new Jv,F[$]=pe),pe.getGripSpace()},this.getHand=function($){let pe=F[$];return pe===void 0&&(pe=new Jv,F[$]=pe),pe.getHandSpace()};function re($){const pe=U.indexOf($.inputSource);if(pe===-1)return;const ve=F[pe];ve!==void 0&&(ve.update($.inputSource,$.frame,h||o),ve.dispatchEvent({type:$.type,data:$.inputSource}))}function j(){i.removeEventListener("select",re),i.removeEventListener("selectstart",re),i.removeEventListener("selectend",re),i.removeEventListener("squeeze",re),i.removeEventListener("squeezestart",re),i.removeEventListener("squeezeend",re),i.removeEventListener("end",j),i.removeEventListener("inputsourceschange",ae);for(let $=0;$<F.length;$++){const pe=U[$];pe!==null&&(U[$]=null,F[$].disconnect(pe))}te=null,ne=null,M.reset();for(const $ in A)delete A[$];e.setRenderTarget(N),b=null,g=null,x=null,i=null,B=null,me.stop(),n.isPresenting=!1,e.setPixelRatio(P),e.setSize(z.width,z.height,!1),n.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function($){a=$,n.isPresenting===!0&&un("WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function($){c=$,n.isPresenting===!0&&un("WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return h||o},this.setReferenceSpace=function($){h=$},this.getBaseLayer=function(){return g!==null?g:b},this.getBinding=function(){return x===null&&C&&(x=new XRWebGLBinding(i,t)),x},this.getFrame=function(){return S},this.getSession=function(){return i},this.setSession=async function($){if(i=$,i!==null){if(N=e.getRenderTarget(),i.addEventListener("select",re),i.addEventListener("selectstart",re),i.addEventListener("selectend",re),i.addEventListener("squeeze",re),i.addEventListener("squeezestart",re),i.addEventListener("squeezeend",re),i.addEventListener("end",j),i.addEventListener("inputsourceschange",ae),R.xrCompatible!==!0&&await t.makeXRCompatible(),P=e.getPixelRatio(),e.getSize(z),C&&"createProjectionLayer"in XRWebGLBinding.prototype){let ve=null,ze=null,Ge=null;R.depth&&(Ge=R.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,ve=R.stencil?Hp:jp,ze=R.stencil?Gp:Qc);const Fe={colorFormat:t.RGBA8,depthFormat:Ge,scaleFactor:a};x=this.getBinding(),g=x.createProjectionLayer(Fe),i.updateRenderState({layers:[g]}),e.setPixelRatio(1),e.setSize(g.textureWidth,g.textureHeight,!1),B=new qo(g.textureWidth,g.textureHeight,{format:ss,type:uo,depthTexture:new _y(g.textureWidth,g.textureHeight,ze,void 0,void 0,void 0,void 0,void 0,void 0,ve),stencilBuffer:R.stencil,colorSpace:e.outputColorSpace,samples:R.antialias?4:0,resolveDepthBuffer:g.ignoreDepthValues===!1,resolveStencilBuffer:g.ignoreDepthValues===!1})}else{const ve={antialias:R.antialias,alpha:!0,depth:R.depth,stencil:R.stencil,framebufferScaleFactor:a};b=new XRWebGLLayer(i,t,ve),i.updateRenderState({baseLayer:b}),e.setPixelRatio(1),e.setSize(b.framebufferWidth,b.framebufferHeight,!1),B=new qo(b.framebufferWidth,b.framebufferHeight,{format:ss,type:uo,colorSpace:e.outputColorSpace,stencilBuffer:R.stencil,resolveDepthBuffer:b.ignoreDepthValues===!1,resolveStencilBuffer:b.ignoreDepthValues===!1})}B.isXRRenderTarget=!0,this.setFoveation(u),h=null,o=await i.requestReferenceSpace(c),me.setContext(i),me.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(i!==null)return i.environmentBlendMode},this.getDepthTexture=function(){return M.getDepthTexture()};function ae($){for(let pe=0;pe<$.removed.length;pe++){const ve=$.removed[pe],ze=U.indexOf(ve);ze>=0&&(U[ze]=null,F[ze].disconnect(ve))}for(let pe=0;pe<$.added.length;pe++){const ve=$.added[pe];let ze=U.indexOf(ve);if(ze===-1){for(let Fe=0;Fe<F.length;Fe++)if(Fe>=U.length){U.push(ve),ze=Fe;break}else if(U[Fe]===null){U[Fe]=ve,ze=Fe;break}if(ze===-1)break}const Ge=F[ze];Ge&&Ge.connect(ve)}}const J=new k,ie=new k;function se($,pe,ve){J.setFromMatrixPosition(pe.matrixWorld),ie.setFromMatrixPosition(ve.matrixWorld);const ze=J.distanceTo(ie),Ge=pe.projectionMatrix.elements,Fe=ve.projectionMatrix.elements,Qe=Ge[14]/(Ge[10]-1),lt=Ge[14]/(Ge[10]+1),De=(Ge[9]+1)/Ge[5],le=(Ge[9]-1)/Ge[5],Ye=(Ge[8]-1)/Ge[0],Ze=(Fe[8]+1)/Fe[0],je=Qe*Ye,He=Qe*Ze,et=ze/(-Ye+Ze),Ne=et*-Ye;if(pe.matrixWorld.decompose($.position,$.quaternion,$.scale),$.translateX(Ne),$.translateZ(et),$.matrixWorld.compose($.position,$.quaternion,$.scale),$.matrixWorldInverse.copy($.matrixWorld).invert(),Ge[10]===-1)$.projectionMatrix.copy(pe.projectionMatrix),$.projectionMatrixInverse.copy(pe.projectionMatrixInverse);else{const st=Qe+et,oe=lt+et,X=je-Ne,Ae=He+(ze-Ne),Pe=De*lt/oe*st,Ue=le*lt/oe*st;$.projectionMatrix.makePerspective(X,Ae,Pe,Ue,st,oe),$.projectionMatrixInverse.copy($.projectionMatrix).invert()}}function I($,pe){pe===null?$.matrixWorld.copy($.matrix):$.matrixWorld.multiplyMatrices(pe.matrixWorld,$.matrix),$.matrixWorldInverse.copy($.matrixWorld).invert()}this.updateCamera=function($){if(i===null)return;let pe=$.near,ve=$.far;M.texture!==null&&(M.depthNear>0&&(pe=M.depthNear),M.depthFar>0&&(ve=M.depthFar)),Q.near=O.near=L.near=pe,Q.far=O.far=L.far=ve,(te!==Q.near||ne!==Q.far)&&(i.updateRenderState({depthNear:Q.near,depthFar:Q.far}),te=Q.near,ne=Q.far),Q.layers.mask=$.layers.mask|6,L.layers.mask=Q.layers.mask&3,O.layers.mask=Q.layers.mask&5;const ze=$.parent,Ge=Q.cameras;I(Q,ze);for(let Fe=0;Fe<Ge.length;Fe++)I(Ge[Fe],ze);Ge.length===2?se(Q,L,O):Q.projectionMatrix.copy(L.projectionMatrix),W($,Q,ze)};function W($,pe,ve){ve===null?$.matrix.copy(pe.matrixWorld):($.matrix.copy(ve.matrixWorld),$.matrix.invert(),$.matrix.multiply(pe.matrixWorld)),$.matrix.decompose($.position,$.quaternion,$.scale),$.updateMatrixWorld(!0),$.projectionMatrix.copy(pe.projectionMatrix),$.projectionMatrixInverse.copy(pe.projectionMatrixInverse),$.isPerspectiveCamera&&($.fov=Wp*2*Math.atan(1/$.projectionMatrix.elements[5]),$.zoom=1)}this.getCamera=function(){return Q},this.getFoveation=function(){if(!(g===null&&b===null))return u},this.setFoveation=function($){u=$,g!==null&&(g.fixedFoveation=$),b!==null&&b.fixedFoveation!==void 0&&(b.fixedFoveation=$)},this.hasDepthSensing=function(){return M.texture!==null},this.getDepthSensingMesh=function(){return M.getMesh(Q)},this.getCameraTexture=function($){return A[$]};let fe=null;function Z($,pe){if(m=pe.getViewerPose(h||o),S=pe,m!==null){const ve=m.views;b!==null&&(e.setRenderTargetFramebuffer(B,b.framebuffer),e.setRenderTarget(B));let ze=!1;ve.length!==Q.cameras.length&&(Q.cameras.length=0,ze=!0);for(let lt=0;lt<ve.length;lt++){const De=ve[lt];let le=null;if(b!==null)le=b.getViewport(De);else{const Ze=x.getViewSubImage(g,De);le=Ze.viewport,lt===0&&(e.setRenderTargetTextures(B,Ze.colorTexture,Ze.depthStencilTexture),e.setRenderTarget(B))}let Ye=ee[lt];Ye===void 0&&(Ye=new Ba,Ye.layers.enable(lt),Ye.viewport=new oi,ee[lt]=Ye),Ye.matrix.fromArray(De.transform.matrix),Ye.matrix.decompose(Ye.position,Ye.quaternion,Ye.scale),Ye.projectionMatrix.fromArray(De.projectionMatrix),Ye.projectionMatrixInverse.copy(Ye.projectionMatrix).invert(),Ye.viewport.set(le.x,le.y,le.width,le.height),lt===0&&(Q.matrix.copy(Ye.matrix),Q.matrix.decompose(Q.position,Q.quaternion,Q.scale)),ze===!0&&Q.cameras.push(Ye)}const Ge=i.enabledFeatures;if(Ge&&Ge.includes("depth-sensing")&&i.depthUsage=="gpu-optimized"&&C){x=n.getBinding();const lt=x.getDepthInformation(ve[0]);lt&&lt.isValid&&lt.texture&&M.init(lt,i.renderState)}if(Ge&&Ge.includes("camera-access")&&C){e.state.unbindTexture(),x=n.getBinding();for(let lt=0;lt<ve.length;lt++){const De=ve[lt].camera;if(De){let le=A[De];le||(le=new AS,A[De]=le);const Ye=x.getCameraImage(De);le.sourceTexture=Ye}}}}for(let ve=0;ve<F.length;ve++){const ze=U[ve],Ge=F[ve];ze!==null&&Ge!==void 0&&Ge.update(ze,pe,h||o)}fe&&fe($,pe),pe.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:pe}),S=null}const me=new nT;me.setAnimationLoop(Z),this.setAnimationLoop=function($){fe=$},this.dispose=function(){}}}const Oh=new hi,UI=new wn;function LI(s,e){function t(M,A){M.matrixAutoUpdate===!0&&M.updateMatrix(),A.value.copy(M.matrix)}function n(M,A){A.color.getRGB(M.fogColor.value,hC(s)),A.isFog?(M.fogNear.value=A.near,M.fogFar.value=A.far):A.isFogExp2&&(M.fogDensity.value=A.density)}function i(M,A,R,N,B){A.isMeshBasicMaterial||A.isMeshLambertMaterial?a(M,A):A.isMeshToonMaterial?(a(M,A),x(M,A)):A.isMeshPhongMaterial?(a(M,A),m(M,A)):A.isMeshStandardMaterial?(a(M,A),g(M,A),A.isMeshPhysicalMaterial&&b(M,A,B)):A.isMeshMatcapMaterial?(a(M,A),S(M,A)):A.isMeshDepthMaterial?a(M,A):A.isMeshDistanceMaterial?(a(M,A),C(M,A)):A.isMeshNormalMaterial?a(M,A):A.isLineBasicMaterial?(o(M,A),A.isLineDashedMaterial&&c(M,A)):A.isPointsMaterial?u(M,A,R,N):A.isSpriteMaterial?h(M,A):A.isShadowMaterial?(M.color.value.copy(A.color),M.opacity.value=A.opacity):A.isShaderMaterial&&(A.uniformsNeedUpdate=!1)}function a(M,A){M.opacity.value=A.opacity,A.color&&M.diffuse.value.copy(A.color),A.emissive&&M.emissive.value.copy(A.emissive).multiplyScalar(A.emissiveIntensity),A.map&&(M.map.value=A.map,t(A.map,M.mapTransform)),A.alphaMap&&(M.alphaMap.value=A.alphaMap,t(A.alphaMap,M.alphaMapTransform)),A.bumpMap&&(M.bumpMap.value=A.bumpMap,t(A.bumpMap,M.bumpMapTransform),M.bumpScale.value=A.bumpScale,A.side===fr&&(M.bumpScale.value*=-1)),A.normalMap&&(M.normalMap.value=A.normalMap,t(A.normalMap,M.normalMapTransform),M.normalScale.value.copy(A.normalScale),A.side===fr&&M.normalScale.value.negate()),A.displacementMap&&(M.displacementMap.value=A.displacementMap,t(A.displacementMap,M.displacementMapTransform),M.displacementScale.value=A.displacementScale,M.displacementBias.value=A.displacementBias),A.emissiveMap&&(M.emissiveMap.value=A.emissiveMap,t(A.emissiveMap,M.emissiveMapTransform)),A.specularMap&&(M.specularMap.value=A.specularMap,t(A.specularMap,M.specularMapTransform)),A.alphaTest>0&&(M.alphaTest.value=A.alphaTest);const R=e.get(A),N=R.envMap,B=R.envMapRotation;N&&(M.envMap.value=N,Oh.copy(B),Oh.x*=-1,Oh.y*=-1,Oh.z*=-1,N.isCubeTexture&&N.isRenderTargetTexture===!1&&(Oh.y*=-1,Oh.z*=-1),M.envMapRotation.value.setFromMatrix4(UI.makeRotationFromEuler(Oh)),M.flipEnvMap.value=N.isCubeTexture&&N.isRenderTargetTexture===!1?-1:1,M.reflectivity.value=A.reflectivity,M.ior.value=A.ior,M.refractionRatio.value=A.refractionRatio),A.lightMap&&(M.lightMap.value=A.lightMap,M.lightMapIntensity.value=A.lightMapIntensity,t(A.lightMap,M.lightMapTransform)),A.aoMap&&(M.aoMap.value=A.aoMap,M.aoMapIntensity.value=A.aoMapIntensity,t(A.aoMap,M.aoMapTransform))}function o(M,A){M.diffuse.value.copy(A.color),M.opacity.value=A.opacity,A.map&&(M.map.value=A.map,t(A.map,M.mapTransform))}function c(M,A){M.dashSize.value=A.dashSize,M.totalSize.value=A.dashSize+A.gapSize,M.scale.value=A.scale}function u(M,A,R,N){M.diffuse.value.copy(A.color),M.opacity.value=A.opacity,M.size.value=A.size*R,M.scale.value=N*.5,A.map&&(M.map.value=A.map,t(A.map,M.uvTransform)),A.alphaMap&&(M.alphaMap.value=A.alphaMap,t(A.alphaMap,M.alphaMapTransform)),A.alphaTest>0&&(M.alphaTest.value=A.alphaTest)}function h(M,A){M.diffuse.value.copy(A.color),M.opacity.value=A.opacity,M.rotation.value=A.rotation,A.map&&(M.map.value=A.map,t(A.map,M.mapTransform)),A.alphaMap&&(M.alphaMap.value=A.alphaMap,t(A.alphaMap,M.alphaMapTransform)),A.alphaTest>0&&(M.alphaTest.value=A.alphaTest)}function m(M,A){M.specular.value.copy(A.specular),M.shininess.value=Math.max(A.shininess,1e-4)}function x(M,A){A.gradientMap&&(M.gradientMap.value=A.gradientMap)}function g(M,A){M.metalness.value=A.metalness,A.metalnessMap&&(M.metalnessMap.value=A.metalnessMap,t(A.metalnessMap,M.metalnessMapTransform)),M.roughness.value=A.roughness,A.roughnessMap&&(M.roughnessMap.value=A.roughnessMap,t(A.roughnessMap,M.roughnessMapTransform)),A.envMap&&(M.envMapIntensity.value=A.envMapIntensity)}function b(M,A,R){M.ior.value=A.ior,A.sheen>0&&(M.sheenColor.value.copy(A.sheenColor).multiplyScalar(A.sheen),M.sheenRoughness.value=A.sheenRoughness,A.sheenColorMap&&(M.sheenColorMap.value=A.sheenColorMap,t(A.sheenColorMap,M.sheenColorMapTransform)),A.sheenRoughnessMap&&(M.sheenRoughnessMap.value=A.sheenRoughnessMap,t(A.sheenRoughnessMap,M.sheenRoughnessMapTransform))),A.clearcoat>0&&(M.clearcoat.value=A.clearcoat,M.clearcoatRoughness.value=A.clearcoatRoughness,A.clearcoatMap&&(M.clearcoatMap.value=A.clearcoatMap,t(A.clearcoatMap,M.clearcoatMapTransform)),A.clearcoatRoughnessMap&&(M.clearcoatRoughnessMap.value=A.clearcoatRoughnessMap,t(A.clearcoatRoughnessMap,M.clearcoatRoughnessMapTransform)),A.clearcoatNormalMap&&(M.clearcoatNormalMap.value=A.clearcoatNormalMap,t(A.clearcoatNormalMap,M.clearcoatNormalMapTransform),M.clearcoatNormalScale.value.copy(A.clearcoatNormalScale),A.side===fr&&M.clearcoatNormalScale.value.negate())),A.dispersion>0&&(M.dispersion.value=A.dispersion),A.iridescence>0&&(M.iridescence.value=A.iridescence,M.iridescenceIOR.value=A.iridescenceIOR,M.iridescenceThicknessMinimum.value=A.iridescenceThicknessRange[0],M.iridescenceThicknessMaximum.value=A.iridescenceThicknessRange[1],A.iridescenceMap&&(M.iridescenceMap.value=A.iridescenceMap,t(A.iridescenceMap,M.iridescenceMapTransform)),A.iridescenceThicknessMap&&(M.iridescenceThicknessMap.value=A.iridescenceThicknessMap,t(A.iridescenceThicknessMap,M.iridescenceThicknessMapTransform))),A.transmission>0&&(M.transmission.value=A.transmission,M.transmissionSamplerMap.value=R.texture,M.transmissionSamplerSize.value.set(R.width,R.height),A.transmissionMap&&(M.transmissionMap.value=A.transmissionMap,t(A.transmissionMap,M.transmissionMapTransform)),M.thickness.value=A.thickness,A.thicknessMap&&(M.thicknessMap.value=A.thicknessMap,t(A.thicknessMap,M.thicknessMapTransform)),M.attenuationDistance.value=A.attenuationDistance,M.attenuationColor.value.copy(A.attenuationColor)),A.anisotropy>0&&(M.anisotropyVector.value.set(A.anisotropy*Math.cos(A.anisotropyRotation),A.anisotropy*Math.sin(A.anisotropyRotation)),A.anisotropyMap&&(M.anisotropyMap.value=A.anisotropyMap,t(A.anisotropyMap,M.anisotropyMapTransform))),M.specularIntensity.value=A.specularIntensity,M.specularColor.value.copy(A.specularColor),A.specularColorMap&&(M.specularColorMap.value=A.specularColorMap,t(A.specularColorMap,M.specularColorMapTransform)),A.specularIntensityMap&&(M.specularIntensityMap.value=A.specularIntensityMap,t(A.specularIntensityMap,M.specularIntensityMapTransform))}function S(M,A){A.matcap&&(M.matcap.value=A.matcap)}function C(M,A){const R=e.get(A).light;M.referencePosition.value.setFromMatrixPosition(R.matrixWorld),M.nearDistance.value=R.shadow.camera.near,M.farDistance.value=R.shadow.camera.far}return{refreshFogUniforms:n,refreshMaterialUniforms:i}}function OI(s,e,t,n){let i={},a={},o=[];const c=s.getParameter(s.MAX_UNIFORM_BUFFER_BINDINGS);function u(R,N){const B=N.program;n.uniformBlockBinding(R,B)}function h(R,N){let B=i[R.id];B===void 0&&(S(R),B=m(R),i[R.id]=B,R.addEventListener("dispose",M));const F=N.program;n.updateUBOMapping(R,F);const U=e.render.frame;a[R.id]!==U&&(g(R),a[R.id]=U)}function m(R){const N=x();R.__bindingPointIndex=N;const B=s.createBuffer(),F=R.__size,U=R.usage;return s.bindBuffer(s.UNIFORM_BUFFER,B),s.bufferData(s.UNIFORM_BUFFER,F,U),s.bindBuffer(s.UNIFORM_BUFFER,null),s.bindBufferBase(s.UNIFORM_BUFFER,N,B),B}function x(){for(let R=0;R<c;R++)if(o.indexOf(R)===-1)return o.push(R),R;return Xn("WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function g(R){const N=i[R.id],B=R.uniforms,F=R.__cache;s.bindBuffer(s.UNIFORM_BUFFER,N);for(let U=0,z=B.length;U<z;U++){const P=Array.isArray(B[U])?B[U]:[B[U]];for(let L=0,O=P.length;L<O;L++){const ee=P[L];if(b(ee,U,L,F)===!0){const Q=ee.__offset,te=Array.isArray(ee.value)?ee.value:[ee.value];let ne=0;for(let re=0;re<te.length;re++){const j=te[re],ae=C(j);typeof j=="number"||typeof j=="boolean"?(ee.__data[0]=j,s.bufferSubData(s.UNIFORM_BUFFER,Q+ne,ee.__data)):j.isMatrix3?(ee.__data[0]=j.elements[0],ee.__data[1]=j.elements[1],ee.__data[2]=j.elements[2],ee.__data[3]=0,ee.__data[4]=j.elements[3],ee.__data[5]=j.elements[4],ee.__data[6]=j.elements[5],ee.__data[7]=0,ee.__data[8]=j.elements[6],ee.__data[9]=j.elements[7],ee.__data[10]=j.elements[8],ee.__data[11]=0):(j.toArray(ee.__data,ne),ne+=ae.storage/Float32Array.BYTES_PER_ELEMENT)}s.bufferSubData(s.UNIFORM_BUFFER,Q,ee.__data)}}}s.bindBuffer(s.UNIFORM_BUFFER,null)}function b(R,N,B,F){const U=R.value,z=N+"_"+B;if(F[z]===void 0)return typeof U=="number"||typeof U=="boolean"?F[z]=U:F[z]=U.clone(),!0;{const P=F[z];if(typeof U=="number"||typeof U=="boolean"){if(P!==U)return F[z]=U,!0}else if(P.equals(U)===!1)return P.copy(U),!0}return!1}function S(R){const N=R.uniforms;let B=0;const F=16;for(let z=0,P=N.length;z<P;z++){const L=Array.isArray(N[z])?N[z]:[N[z]];for(let O=0,ee=L.length;O<ee;O++){const Q=L[O],te=Array.isArray(Q.value)?Q.value:[Q.value];for(let ne=0,re=te.length;ne<re;ne++){const j=te[ne],ae=C(j),J=B%F,ie=J%ae.boundary,se=J+ie;B+=ie,se!==0&&F-se<ae.storage&&(B+=F-se),Q.__data=new Float32Array(ae.storage/Float32Array.BYTES_PER_ELEMENT),Q.__offset=B,B+=ae.storage}}}const U=B%F;return U>0&&(B+=F-U),R.__size=B,R.__cache={},this}function C(R){const N={boundary:0,storage:0};return typeof R=="number"||typeof R=="boolean"?(N.boundary=4,N.storage=4):R.isVector2?(N.boundary=8,N.storage=8):R.isVector3||R.isColor?(N.boundary=16,N.storage=12):R.isVector4?(N.boundary=16,N.storage=16):R.isMatrix3?(N.boundary=48,N.storage=48):R.isMatrix4?(N.boundary=64,N.storage=64):R.isTexture?un("WebGLRenderer: Texture samplers can not be part of an uniforms group."):un("WebGLRenderer: Unsupported uniform value type.",R),N}function M(R){const N=R.target;N.removeEventListener("dispose",M);const B=o.indexOf(N.__bindingPointIndex);o.splice(B,1),s.deleteBuffer(i[N.id]),delete i[N.id],delete a[N.id]}function A(){for(const R in i)s.deleteBuffer(i[R]);o=[],i={},a={}}return{bind:u,update:h,dispose:A}}const II=new Uint16Array([11481,15204,11534,15171,11808,15015,12385,14843,12894,14716,13396,14600,13693,14483,13976,14366,14237,14171,14405,13961,14511,13770,14605,13598,14687,13444,14760,13305,14822,13066,14876,12857,14923,12675,14963,12517,14997,12379,15025,12230,15049,12023,15070,11843,15086,11687,15100,11551,15111,11433,15120,11330,15127,11217,15132,11060,15135,10922,15138,10801,15139,10695,15139,10600,13012,14923,13020,14917,13064,14886,13176,14800,13349,14666,13513,14526,13724,14398,13960,14230,14200,14020,14383,13827,14488,13651,14583,13491,14667,13348,14740,13132,14803,12908,14856,12713,14901,12542,14938,12394,14968,12241,14992,12017,15010,11822,15024,11654,15034,11507,15041,11380,15044,11269,15044,11081,15042,10913,15037,10764,15031,10635,15023,10520,15014,10419,15003,10330,13657,14676,13658,14673,13670,14660,13698,14622,13750,14547,13834,14442,13956,14317,14112,14093,14291,13889,14407,13704,14499,13538,14586,13389,14664,13201,14733,12966,14792,12758,14842,12577,14882,12418,14915,12272,14940,12033,14959,11826,14972,11646,14980,11490,14983,11355,14983,11212,14979,11008,14971,10830,14961,10675,14950,10540,14936,10420,14923,10315,14909,10204,14894,10041,14089,14460,14090,14459,14096,14452,14112,14431,14141,14388,14186,14305,14252,14130,14341,13941,14399,13756,14467,13585,14539,13430,14610,13272,14677,13026,14737,12808,14790,12617,14833,12449,14869,12303,14896,12065,14916,11845,14929,11655,14937,11490,14939,11347,14936,11184,14930,10970,14921,10783,14912,10621,14900,10480,14885,10356,14867,10247,14848,10062,14827,9894,14805,9745,14400,14208,14400,14206,14402,14198,14406,14174,14415,14122,14427,14035,14444,13913,14469,13767,14504,13613,14548,13463,14598,13324,14651,13082,14704,12858,14752,12658,14795,12483,14831,12330,14860,12106,14881,11875,14895,11675,14903,11501,14905,11351,14903,11178,14900,10953,14892,10757,14880,10589,14865,10442,14847,10313,14827,10162,14805,9965,14782,9792,14757,9642,14731,9507,14562,13883,14562,13883,14563,13877,14566,13862,14570,13830,14576,13773,14584,13689,14595,13582,14613,13461,14637,13336,14668,13120,14704,12897,14741,12695,14776,12516,14808,12358,14835,12150,14856,11910,14870,11701,14878,11519,14882,11361,14884,11187,14880,10951,14871,10748,14858,10572,14842,10418,14823,10286,14801,10099,14777,9897,14751,9722,14725,9567,14696,9430,14666,9309,14702,13604,14702,13604,14702,13600,14703,13591,14705,13570,14707,13533,14709,13477,14712,13400,14718,13305,14727,13106,14743,12907,14762,12716,14784,12539,14807,12380,14827,12190,14844,11943,14855,11727,14863,11539,14870,11376,14871,11204,14868,10960,14858,10748,14845,10565,14829,10406,14809,10269,14786,10058,14761,9852,14734,9671,14705,9512,14674,9374,14641,9253,14608,9076,14821,13366,14821,13365,14821,13364,14821,13358,14821,13344,14821,13320,14819,13252,14817,13145,14815,13011,14814,12858,14817,12698,14823,12539,14832,12389,14841,12214,14850,11968,14856,11750,14861,11558,14866,11390,14867,11226,14862,10972,14853,10754,14840,10565,14823,10401,14803,10259,14780,10032,14754,9820,14725,9635,14694,9473,14661,9333,14627,9203,14593,8988,14557,8798,14923,13014,14922,13014,14922,13012,14922,13004,14920,12987,14919,12957,14915,12907,14909,12834,14902,12738,14894,12623,14888,12498,14883,12370,14880,12203,14878,11970,14875,11759,14873,11569,14874,11401,14872,11243,14865,10986,14855,10762,14842,10568,14825,10401,14804,10255,14781,10017,14754,9799,14725,9611,14692,9445,14658,9301,14623,9139,14587,8920,14548,8729,14509,8562,15008,12672,15008,12672,15008,12671,15007,12667,15005,12656,15001,12637,14997,12605,14989,12556,14978,12490,14966,12407,14953,12313,14940,12136,14927,11934,14914,11742,14903,11563,14896,11401,14889,11247,14879,10992,14866,10767,14851,10570,14833,10400,14812,10252,14789,10007,14761,9784,14731,9592,14698,9424,14663,9279,14627,9088,14588,8868,14548,8676,14508,8508,14467,8360,15080,12386,15080,12386,15079,12385,15078,12383,15076,12378,15072,12367,15066,12347,15057,12315,15045,12253,15030,12138,15012,11998,14993,11845,14972,11685,14951,11530,14935,11383,14920,11228,14904,10981,14887,10762,14870,10567,14850,10397,14827,10248,14803,9997,14774,9771,14743,9578,14710,9407,14674,9259,14637,9048,14596,8826,14555,8632,14514,8464,14471,8317,14427,8182,15139,12008,15139,12008,15138,12008,15137,12007,15135,12003,15130,11990,15124,11969,15115,11929,15102,11872,15086,11794,15064,11693,15041,11581,15013,11459,14987,11336,14966,11170,14944,10944,14921,10738,14898,10552,14875,10387,14850,10239,14824,9983,14794,9758,14762,9563,14728,9392,14692,9244,14653,9014,14611,8791,14569,8597,14526,8427,14481,8281,14436,8110,14391,7885,15188,11617,15188,11617,15187,11617,15186,11618,15183,11617,15179,11612,15173,11601,15163,11581,15150,11546,15133,11495,15110,11427,15083,11346,15051,11246,15024,11057,14996,10868,14967,10687,14938,10517,14911,10362,14882,10206,14853,9956,14821,9737,14787,9543,14752,9375,14715,9228,14675,8980,14632,8760,14589,8565,14544,8395,14498,8248,14451,8049,14404,7824,14357,7630,15228,11298,15228,11298,15227,11299,15226,11301,15223,11303,15219,11302,15213,11299,15204,11290,15191,11271,15174,11217,15150,11129,15119,11015,15087,10886,15057,10744,15024,10599,14990,10455,14957,10318,14924,10143,14891,9911,14856,9701,14820,9516,14782,9352,14744,9200,14703,8946,14659,8725,14615,8533,14568,8366,14521,8220,14472,7992,14423,7770,14374,7578,14315,7408,15260,10819,15260,10819,15259,10822,15258,10826,15256,10832,15251,10836,15246,10841,15237,10838,15225,10821,15207,10788,15183,10734,15151,10660,15120,10571,15087,10469,15049,10359,15012,10249,14974,10041,14937,9837,14900,9647,14860,9475,14820,9320,14779,9147,14736,8902,14691,8688,14646,8499,14598,8335,14549,8189,14499,7940,14448,7720,14397,7529,14347,7363,14256,7218,15285,10410,15285,10411,15285,10413,15284,10418,15282,10425,15278,10434,15272,10442,15264,10449,15252,10445,15235,10433,15210,10403,15179,10358,15149,10301,15113,10218,15073,10059,15033,9894,14991,9726,14951,9565,14909,9413,14865,9273,14822,9073,14777,8845,14730,8641,14682,8459,14633,8300,14583,8129,14531,7883,14479,7670,14426,7482,14373,7321,14305,7176,14201,6939,15305,9939,15305,9940,15305,9945,15304,9955,15302,9967,15298,9989,15293,10010,15286,10033,15274,10044,15258,10045,15233,10022,15205,9975,15174,9903,15136,9808,15095,9697,15053,9578,15009,9451,14965,9327,14918,9198,14871,8973,14825,8766,14775,8579,14725,8408,14675,8259,14622,8058,14569,7821,14515,7615,14460,7435,14405,7276,14350,7108,14256,6866,14149,6653,15321,9444,15321,9445,15321,9448,15320,9458,15317,9470,15314,9490,15310,9515,15302,9540,15292,9562,15276,9579,15251,9577,15226,9559,15195,9519,15156,9463,15116,9389,15071,9304,15025,9208,14978,9023,14927,8838,14878,8661,14827,8496,14774,8344,14722,8206,14667,7973,14612,7749,14556,7555,14499,7382,14443,7229,14385,7025,14322,6791,14210,6588,14100,6409,15333,8920,15333,8921,15332,8927,15332,8943,15329,8965,15326,9002,15322,9048,15316,9106,15307,9162,15291,9204,15267,9221,15244,9221,15212,9196,15175,9134,15133,9043,15088,8930,15040,8801,14990,8665,14938,8526,14886,8391,14830,8261,14775,8087,14719,7866,14661,7664,14603,7482,14544,7322,14485,7178,14426,6936,14367,6713,14281,6517,14166,6348,14054,6198,15341,8360,15341,8361,15341,8366,15341,8379,15339,8399,15336,8431,15332,8473,15326,8527,15318,8585,15302,8632,15281,8670,15258,8690,15227,8690,15191,8664,15149,8612,15104,8543,15055,8456,15001,8360,14948,8259,14892,8122,14834,7923,14776,7734,14716,7558,14656,7397,14595,7250,14534,7070,14472,6835,14410,6628,14350,6443,14243,6283,14125,6135,14010,5889,15348,7715,15348,7717,15348,7725,15347,7745,15345,7780,15343,7836,15339,7905,15334,8e3,15326,8103,15310,8193,15293,8239,15270,8270,15240,8287,15204,8283,15163,8260,15118,8223,15067,8143,15014,8014,14958,7873,14899,7723,14839,7573,14778,7430,14715,7293,14652,7164,14588,6931,14524,6720,14460,6531,14396,6362,14330,6210,14207,6015,14086,5781,13969,5576,15352,7114,15352,7116,15352,7128,15352,7159,15350,7195,15348,7237,15345,7299,15340,7374,15332,7457,15317,7544,15301,7633,15280,7703,15251,7754,15216,7775,15176,7767,15131,7733,15079,7670,15026,7588,14967,7492,14906,7387,14844,7278,14779,7171,14714,6965,14648,6770,14581,6587,14515,6420,14448,6269,14382,6123,14299,5881,14172,5665,14049,5477,13929,5310,15355,6329,15355,6330,15355,6339,15355,6362,15353,6410,15351,6472,15349,6572,15344,6688,15337,6835,15323,6985,15309,7142,15287,7220,15260,7277,15226,7310,15188,7326,15142,7318,15090,7285,15036,7239,14976,7177,14914,7045,14849,6892,14782,6736,14714,6581,14645,6433,14576,6293,14506,6164,14438,5946,14369,5733,14270,5540,14140,5369,14014,5216,13892,5043,15357,5483,15357,5484,15357,5496,15357,5528,15356,5597,15354,5692,15351,5835,15347,6011,15339,6195,15328,6317,15314,6446,15293,6566,15268,6668,15235,6746,15197,6796,15152,6811,15101,6790,15046,6748,14985,6673,14921,6583,14854,6479,14785,6371,14714,6259,14643,6149,14571,5946,14499,5750,14428,5567,14358,5401,14242,5250,14109,5111,13980,4870,13856,4657,15359,4555,15359,4557,15358,4573,15358,4633,15357,4715,15355,4841,15353,5061,15349,5216,15342,5391,15331,5577,15318,5770,15299,5967,15274,6150,15243,6223,15206,6280,15161,6310,15111,6317,15055,6300,14994,6262,14928,6208,14860,6141,14788,5994,14715,5838,14641,5684,14566,5529,14492,5384,14418,5247,14346,5121,14216,4892,14079,4682,13948,4496,13822,4330,15359,3498,15359,3501,15359,3520,15359,3598,15358,3719,15356,3860,15355,4137,15351,4305,15344,4563,15334,4809,15321,5116,15303,5273,15280,5418,15250,5547,15214,5653,15170,5722,15120,5761,15064,5763,15002,5733,14935,5673,14865,5597,14792,5504,14716,5400,14640,5294,14563,5185,14486,5041,14410,4841,14335,4655,14191,4482,14051,4325,13918,4183,13790,4012,15360,2282,15360,2285,15360,2306,15360,2401,15359,2547,15357,2748,15355,3103,15352,3349,15345,3675,15336,4020,15324,4272,15307,4496,15285,4716,15255,4908,15220,5086,15178,5170,15128,5214,15072,5234,15010,5231,14943,5206,14871,5166,14796,5102,14718,4971,14639,4833,14559,4687,14480,4541,14402,4401,14315,4268,14167,4142,14025,3958,13888,3747,13759,3556,15360,923,15360,925,15360,946,15360,1052,15359,1214,15357,1494,15356,1892,15352,2274,15346,2663,15338,3099,15326,3393,15309,3679,15288,3980,15260,4183,15226,4325,15185,4437,15136,4517,15080,4570,15018,4591,14950,4581,14877,4545,14800,4485,14720,4411,14638,4325,14556,4231,14475,4136,14395,3988,14297,3803,14145,3628,13999,3465,13861,3314,13729,3177,15360,263,15360,264,15360,272,15360,325,15359,407,15358,548,15356,780,15352,1144,15347,1580,15339,2099,15328,2425,15312,2795,15292,3133,15264,3329,15232,3517,15191,3689,15143,3819,15088,3923,15025,3978,14956,3999,14882,3979,14804,3931,14722,3855,14639,3756,14554,3645,14470,3529,14388,3409,14279,3289,14124,3173,13975,3055,13834,2848,13701,2658,15360,49,15360,49,15360,52,15360,75,15359,111,15358,201,15356,283,15353,519,15348,726,15340,1045,15329,1415,15314,1795,15295,2173,15269,2410,15237,2649,15197,2866,15150,3054,15095,3140,15032,3196,14963,3228,14888,3236,14808,3224,14725,3191,14639,3146,14553,3088,14466,2976,14382,2836,14262,2692,14103,2549,13952,2409,13808,2278,13674,2154,15360,4,15360,4,15360,4,15360,13,15359,33,15358,59,15357,112,15353,199,15348,302,15341,456,15331,628,15316,827,15297,1082,15272,1332,15241,1601,15202,1851,15156,2069,15101,2172,15039,2256,14970,2314,14894,2348,14813,2358,14728,2344,14640,2311,14551,2263,14463,2203,14376,2133,14247,2059,14084,1915,13930,1761,13784,1609,13648,1464,15360,0,15360,0,15360,0,15360,3,15359,18,15358,26,15357,53,15354,80,15348,97,15341,165,15332,238,15318,326,15299,427,15275,529,15245,654,15207,771,15161,885,15108,994,15046,1089,14976,1170,14900,1229,14817,1266,14731,1284,14641,1282,14550,1260,14460,1223,14370,1174,14232,1116,14066,1050,13909,981,13761,910,13623,839]);let Lu=null;function zI(){return Lu===null&&(Lu=new wl(II,32,32,cy,xs),Lu.minFilter=bi,Lu.magFilter=bi,Lu.wrapS=Pa,Lu.wrapT=Pa,Lu.generateMipmaps=!1,Lu.needsUpdate=!0),Lu}class YS{constructor(e={}){const{canvas:t=cC(),context:n=null,depth:i=!0,stencil:a=!1,alpha:o=!1,antialias:c=!1,premultipliedAlpha:u=!0,preserveDrawingBuffer:h=!1,powerPreference:m="default",failIfMajorPerformanceCaveat:x=!1,reversedDepthBuffer:g=!1}=e;this.isWebGLRenderer=!0;let b;if(n!==null){if(typeof WebGLRenderingContext<"u"&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");b=n.getContextAttributes().alpha}else b=o;const S=new Set([fy,uy,Ax]),C=new Set([uo,Qc,Pp,Gp,oy,ly]),M=new Uint32Array(4),A=new Int32Array(4);let R=null,N=null;const B=[],F=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=qc,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const U=this;let z=!1;this._outputColorSpace=Hs;let P=0,L=0,O=null,ee=-1,Q=null;const te=new oi,ne=new oi;let re=null;const j=new qt(0);let ae=0,J=t.width,ie=t.height,se=1,I=null,W=null;const fe=new oi(0,0,J,ie),Z=new oi(0,0,J,ie);let me=!1;const $=new s0;let pe=!1,ve=!1;const ze=new wn,Ge=new k,Fe=new oi,Qe={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let lt=!1;function De(){return O===null?se:1}let le=n;function Ye(K,be){return t.getContext(K,be)}try{const K={alpha:!0,depth:i,stencil:a,antialias:c,premultipliedAlpha:u,preserveDrawingBuffer:h,powerPreference:m,failIfMajorPerformanceCaveat:x};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${n0}`),t.addEventListener("webglcontextlost",dt,!1),t.addEventListener("webglcontextrestored",Ke,!1),t.addEventListener("webglcontextcreationerror",Lt,!1),le===null){const be="webgl2";if(le=Ye(be,K),le===null)throw Ye(be)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(K){throw K("WebGLRenderer: "+K.message),K}let Ze,je,He,et,Ne,st,oe,X,Ae,Pe,Ue,Be,bt,vt,It,zt,qe,We,ft,ge,Ie,ht,ye,Re;function pt(){Ze=new WL(le),Ze.init(),ht=new oT(le,Ze),je=new FL(le,Ze,e,ht),He=new CI(le,Ze),je.reversedDepthBuffer&&g&&He.buffers.depth.setReversed(!0),et=new ZL(le),Ne=new pI,st=new TI(le,Ze,He,Ne,je,ht,et),oe=new GL(U),X=new YL(U),Ae=new e4(le),ye=new IL(le,Ae),Pe=new qL(le,Ae,et,ye),Ue=new QL(le,Pe,Ae,et),ft=new KL(le,je,st),zt=new PL(Ne),Be=new dI(U,oe,X,Ze,je,ye,zt),bt=new LI(U,Ne),vt=new xI,It=new SI(Ze),We=new OL(U,oe,X,He,Ue,b,u),qe=new wI(U,Ue,je),Re=new OI(le,et,je,He),ge=new zL(le,Ze,et),Ie=new JL(le,Ze,et),et.programs=Be.programs,U.capabilities=je,U.extensions=Ze,U.properties=Ne,U.renderLists=vt,U.shadowMap=qe,U.state=He,U.info=et}pt();const Rt=new DI(U,le);this.xr=Rt,this.getContext=function(){return le},this.getContextAttributes=function(){return le.getContextAttributes()},this.forceContextLoss=function(){const K=Ze.get("WEBGL_lose_context");K&&K.loseContext()},this.forceContextRestore=function(){const K=Ze.get("WEBGL_lose_context");K&&K.restoreContext()},this.getPixelRatio=function(){return se},this.setPixelRatio=function(K){K!==void 0&&(se=K,this.setSize(J,ie,!1))},this.getSize=function(K){return K.set(J,ie)},this.setSize=function(K,be,xe=!0){if(Rt.isPresenting){un("WebGLRenderer: Can't change size while VR device is presenting.");return}J=K,ie=be,t.width=Math.floor(K*se),t.height=Math.floor(be*se),xe===!0&&(t.style.width=K+"px",t.style.height=be+"px"),this.setViewport(0,0,K,be)},this.getDrawingBufferSize=function(K){return K.set(J*se,ie*se).floor()},this.setDrawingBufferSize=function(K,be,xe){J=K,ie=be,se=xe,t.width=Math.floor(K*xe),t.height=Math.floor(be*xe),this.setViewport(0,0,K,be)},this.getCurrentViewport=function(K){return K.copy(te)},this.getViewport=function(K){return K.copy(fe)},this.setViewport=function(K,be,xe,Oe){K.isVector4?fe.set(K.x,K.y,K.z,K.w):fe.set(K,be,xe,Oe),He.viewport(te.copy(fe).multiplyScalar(se).round())},this.getScissor=function(K){return K.copy(Z)},this.setScissor=function(K,be,xe,Oe){K.isVector4?Z.set(K.x,K.y,K.z,K.w):Z.set(K,be,xe,Oe),He.scissor(ne.copy(Z).multiplyScalar(se).round())},this.getScissorTest=function(){return me},this.setScissorTest=function(K){He.setScissorTest(me=K)},this.setOpaqueSort=function(K){I=K},this.setTransparentSort=function(K){W=K},this.getClearColor=function(K){return K.copy(We.getClearColor())},this.setClearColor=function(){We.setClearColor(...arguments)},this.getClearAlpha=function(){return We.getClearAlpha()},this.setClearAlpha=function(){We.setClearAlpha(...arguments)},this.clear=function(K=!0,be=!0,xe=!0){let Oe=0;if(K){let Me=!1;if(O!==null){const $e=O.texture.format;Me=S.has($e)}if(Me){const $e=O.texture.type,yt=C.has($e),Mt=We.getClearColor(),Ft=We.getClearAlpha(),mt=Mt.r,Pt=Mt.g,en=Mt.b;yt?(M[0]=mt,M[1]=Pt,M[2]=en,M[3]=Ft,le.clearBufferuiv(le.COLOR,0,M)):(A[0]=mt,A[1]=Pt,A[2]=en,A[3]=Ft,le.clearBufferiv(le.COLOR,0,A))}else Oe|=le.COLOR_BUFFER_BIT}be&&(Oe|=le.DEPTH_BUFFER_BIT),xe&&(Oe|=le.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),le.clear(Oe)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",dt,!1),t.removeEventListener("webglcontextrestored",Ke,!1),t.removeEventListener("webglcontextcreationerror",Lt,!1),We.dispose(),vt.dispose(),It.dispose(),Ne.dispose(),oe.dispose(),X.dispose(),Ue.dispose(),ye.dispose(),Re.dispose(),Be.dispose(),Rt.dispose(),Rt.removeEventListener("sessionstart",qi),Rt.removeEventListener("sessionend",la),di.stop()};function dt(K){K.preventDefault(),ux("WebGLRenderer: Context Lost."),z=!0}function Ke(){ux("WebGLRenderer: Context Restored."),z=!1;const K=et.autoReset,be=qe.enabled,xe=qe.autoUpdate,Oe=qe.needsUpdate,Me=qe.type;pt(),et.autoReset=K,qe.enabled=be,qe.autoUpdate=xe,qe.needsUpdate=Oe,qe.type=Me}function Lt(K){Xn("WebGLRenderer: A WebGL context could not be created. Reason: ",K.statusMessage)}function Vt(K){const be=K.target;be.removeEventListener("dispose",Vt),Kt(be)}function Kt(K){on(K),Ne.remove(K)}function on(K){const be=Ne.get(K).programs;be!==void 0&&(be.forEach(function(xe){Be.releaseProgram(xe)}),K.isShaderMaterial&&Be.releaseShaderCache(K))}this.renderBufferDirect=function(K,be,xe,Oe,Me,$e){be===null&&(be=Qe);const yt=Me.isMesh&&Me.matrixWorld.determinant()<0,Mt=Je(K,be,xe,Oe,Me);He.setMaterial(Oe,yt);let Ft=xe.index,mt=1;if(Oe.wireframe===!0){if(Ft=Pe.getWireframeAttribute(xe),Ft===void 0)return;mt=2}const Pt=xe.drawRange,en=xe.attributes.position;let Qt=Pt.start*mt,yn=(Pt.start+Pt.count)*mt;$e!==null&&(Qt=Math.max(Qt,$e.start*mt),yn=Math.min(yn,($e.start+$e.count)*mt)),Ft!==null?(Qt=Math.max(Qt,0),yn=Math.min(yn,Ft.count)):en!=null&&(Qt=Math.max(Qt,0),yn=Math.min(yn,en.count));const ln=yn-Qt;if(ln<0||ln===1/0)return;ye.setup(Me,Oe,Mt,xe,Ft);let xn,Un=ge;if(Ft!==null&&(xn=Ae.get(Ft),Un=Ie,Un.setIndex(xn)),Me.isMesh)Oe.wireframe===!0?(He.setLineWidth(Oe.wireframeLinewidth*De()),Un.setMode(le.LINES)):Un.setMode(le.TRIANGLES);else if(Me.isLine){let an=Oe.linewidth;an===void 0&&(an=1),He.setLineWidth(an*De()),Me.isLineSegments?Un.setMode(le.LINES):Me.isLineLoop?Un.setMode(le.LINE_LOOP):Un.setMode(le.LINE_STRIP)}else Me.isPoints?Un.setMode(le.POINTS):Me.isSprite&&Un.setMode(le.TRIANGLES);if(Me.isBatchedMesh)if(Me._multiDrawInstances!==null)Yp("WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),Un.renderMultiDrawInstances(Me._multiDrawStarts,Me._multiDrawCounts,Me._multiDrawCount,Me._multiDrawInstances);else if(Ze.get("WEBGL_multi_draw"))Un.renderMultiDraw(Me._multiDrawStarts,Me._multiDrawCounts,Me._multiDrawCount);else{const an=Me._multiDrawStarts,Bn=Me._multiDrawCounts,tn=Me._multiDrawCount,Hn=Ft?Ae.get(Ft).bytesPerElement:1,kn=Ne.get(Oe).currentProgram.getUniforms();for(let hn=0;hn<tn;hn++)kn.setValue(le,"_gl_DrawID",hn),Un.render(an[hn]/Hn,Bn[hn])}else if(Me.isInstancedMesh)Un.renderInstances(Qt,ln,Me.count);else if(xe.isInstancedBufferGeometry){const an=xe._maxInstanceCount!==void 0?xe._maxInstanceCount:1/0,Bn=Math.min(xe.instanceCount,an);Un.renderInstances(Qt,ln,Bn)}else Un.render(Qt,ln)};function Gn(K,be,xe){K.transparent===!0&&K.side===Oi&&K.forceSinglePass===!1?(K.side=fr,K.needsUpdate=!0,q(K,be,xe),K.side=Zc,K.needsUpdate=!0,q(K,be,xe),K.side=Oi):q(K,be,xe)}this.compile=function(K,be,xe=null){xe===null&&(xe=K),N=It.get(xe),N.init(be),F.push(N),xe.traverseVisible(function(Me){Me.isLight&&Me.layers.test(be.layers)&&(N.pushLight(Me),Me.castShadow&&N.pushShadow(Me))}),K!==xe&&K.traverseVisible(function(Me){Me.isLight&&Me.layers.test(be.layers)&&(N.pushLight(Me),Me.castShadow&&N.pushShadow(Me))}),N.setupLights();const Oe=new Set;return K.traverse(function(Me){if(!(Me.isMesh||Me.isPoints||Me.isLine||Me.isSprite))return;const $e=Me.material;if($e)if(Array.isArray($e))for(let yt=0;yt<$e.length;yt++){const Mt=$e[yt];Gn(Mt,xe,Me),Oe.add(Mt)}else Gn($e,xe,Me),Oe.add($e)}),N=F.pop(),Oe},this.compileAsync=function(K,be,xe=null){const Oe=this.compile(K,be,xe);return new Promise(Me=>{function $e(){if(Oe.forEach(function(yt){Ne.get(yt).currentProgram.isReady()&&Oe.delete(yt)}),Oe.size===0){Me(K);return}setTimeout($e,10)}Ze.get("KHR_parallel_shader_compile")!==null?$e():setTimeout($e,10)})};let En=null;function li(K){En&&En(K)}function qi(){di.stop()}function la(){di.start()}const di=new nT;di.setAnimationLoop(li),typeof self<"u"&&di.setContext(self),this.setAnimationLoop=function(K){En=K,Rt.setAnimationLoop(K),K===null?di.stop():di.start()},Rt.addEventListener("sessionstart",qi),Rt.addEventListener("sessionend",la),this.render=function(K,be){if(be!==void 0&&be.isCamera!==!0){Xn("WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(z===!0)return;if(K.matrixWorldAutoUpdate===!0&&K.updateMatrixWorld(),be.parent===null&&be.matrixWorldAutoUpdate===!0&&be.updateMatrixWorld(),Rt.enabled===!0&&Rt.isPresenting===!0&&(Rt.cameraAutoUpdate===!0&&Rt.updateCamera(be),be=Rt.getCamera()),K.isScene===!0&&K.onBeforeRender(U,K,be,O),N=It.get(K,F.length),N.init(be),F.push(N),ze.multiplyMatrices(be.projectionMatrix,be.matrixWorldInverse),$.setFromProjectionMatrix(ze,Yo,be.reversedDepth),ve=this.localClippingEnabled,pe=zt.init(this.clippingPlanes,ve),R=vt.get(K,B.length),R.init(),B.push(R),Rt.enabled===!0&&Rt.isPresenting===!0){const $e=U.xr.getDepthSensingMesh();$e!==null&&Qi($e,be,-1/0,U.sortObjects)}Qi(K,be,0,U.sortObjects),R.finish(),U.sortObjects===!0&&R.sort(I,W),lt=Rt.enabled===!1||Rt.isPresenting===!1||Rt.hasDepthSensing()===!1,lt&&We.addToRenderList(R,K),this.info.render.frame++,pe===!0&&zt.beginShadows();const xe=N.state.shadowsArray;qe.render(xe,K,be),pe===!0&&zt.endShadows(),this.info.autoReset===!0&&this.info.reset();const Oe=R.opaque,Me=R.transmissive;if(N.setupLights(),be.isArrayCamera){const $e=be.cameras;if(Me.length>0)for(let yt=0,Mt=$e.length;yt<Mt;yt++){const Ft=$e[yt];mn(Oe,Me,K,Ft)}lt&&We.render(K);for(let yt=0,Mt=$e.length;yt<Mt;yt++){const Ft=$e[yt];Mi(R,K,Ft,Ft.viewport)}}else Me.length>0&&mn(Oe,Me,K,be),lt&&We.render(K),Mi(R,K,be);O!==null&&L===0&&(st.updateMultisampleRenderTarget(O),st.updateRenderTargetMipmap(O)),K.isScene===!0&&K.onAfterRender(U,K,be),ye.resetDefaultState(),ee=-1,Q=null,F.pop(),F.length>0?(N=F[F.length-1],pe===!0&&zt.setGlobalState(U.clippingPlanes,N.state.camera)):N=null,B.pop(),B.length>0?R=B[B.length-1]:R=null};function Qi(K,be,xe,Oe){if(K.visible===!1)return;if(K.layers.test(be.layers)){if(K.isGroup)xe=K.renderOrder;else if(K.isLOD)K.autoUpdate===!0&&K.update(be);else if(K.isLight)N.pushLight(K),K.castShadow&&N.pushShadow(K);else if(K.isSprite){if(!K.frustumCulled||$.intersectsSprite(K)){Oe&&Fe.setFromMatrixPosition(K.matrixWorld).applyMatrix4(ze);const yt=Ue.update(K),Mt=K.material;Mt.visible&&R.push(K,yt,Mt,xe,Fe.z,null)}}else if((K.isMesh||K.isLine||K.isPoints)&&(!K.frustumCulled||$.intersectsObject(K))){const yt=Ue.update(K),Mt=K.material;if(Oe&&(K.boundingSphere!==void 0?(K.boundingSphere===null&&K.computeBoundingSphere(),Fe.copy(K.boundingSphere.center)):(yt.boundingSphere===null&&yt.computeBoundingSphere(),Fe.copy(yt.boundingSphere.center)),Fe.applyMatrix4(K.matrixWorld).applyMatrix4(ze)),Array.isArray(Mt)){const Ft=yt.groups;for(let mt=0,Pt=Ft.length;mt<Pt;mt++){const en=Ft[mt],Qt=Mt[en.materialIndex];Qt&&Qt.visible&&R.push(K,yt,Qt,xe,Fe.z,en)}}else Mt.visible&&R.push(K,yt,Mt,xe,Fe.z,null)}}const $e=K.children;for(let yt=0,Mt=$e.length;yt<Mt;yt++)Qi($e[yt],be,xe,Oe)}function Mi(K,be,xe,Oe){const{opaque:Me,transmissive:$e,transparent:yt}=K;N.setupLightsView(xe),pe===!0&&zt.setGlobalState(U.clippingPlanes,xe),Oe&&He.viewport(te.copy(Oe)),Me.length>0&&jn(Me,be,xe),$e.length>0&&jn($e,be,xe),yt.length>0&&jn(yt,be,xe),He.buffers.depth.setTest(!0),He.buffers.depth.setMask(!0),He.buffers.color.setMask(!0),He.setPolygonOffset(!1)}function mn(K,be,xe,Oe){if((xe.isScene===!0?xe.overrideMaterial:null)!==null)return;N.state.transmissionRenderTarget[Oe.id]===void 0&&(N.state.transmissionRenderTarget[Oe.id]=new qo(1,1,{generateMipmaps:!0,type:Ze.has("EXT_color_buffer_half_float")||Ze.has("EXT_color_buffer_float")?xs:uo,minFilter:Al,samples:4,stencilBuffer:a,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:Ri.workingColorSpace}));const $e=N.state.transmissionRenderTarget[Oe.id],yt=Oe.viewport||te;$e.setSize(yt.z*U.transmissionResolutionScale,yt.w*U.transmissionResolutionScale);const Mt=U.getRenderTarget(),Ft=U.getActiveCubeFace(),mt=U.getActiveMipmapLevel();U.setRenderTarget($e),U.getClearColor(j),ae=U.getClearAlpha(),ae<1&&U.setClearColor(16777215,.5),U.clear(),lt&&We.render(xe);const Pt=U.toneMapping;U.toneMapping=qc;const en=Oe.viewport;if(Oe.viewport!==void 0&&(Oe.viewport=void 0),N.setupLightsView(Oe),pe===!0&&zt.setGlobalState(U.clippingPlanes,Oe),jn(K,xe,Oe),st.updateMultisampleRenderTarget($e),st.updateRenderTargetMipmap($e),Ze.has("WEBGL_multisampled_render_to_texture")===!1){let Qt=!1;for(let yn=0,ln=be.length;yn<ln;yn++){const xn=be[yn],{object:Un,geometry:an,material:Bn,group:tn}=xn;if(Bn.side===Oi&&Un.layers.test(Oe.layers)){const Hn=Bn.side;Bn.side=fr,Bn.needsUpdate=!0,bn(Un,xe,Oe,an,Bn,tn),Bn.side=Hn,Bn.needsUpdate=!0,Qt=!0}}Qt===!0&&(st.updateMultisampleRenderTarget($e),st.updateRenderTargetMipmap($e))}U.setRenderTarget(Mt,Ft,mt),U.setClearColor(j,ae),en!==void 0&&(Oe.viewport=en),U.toneMapping=Pt}function jn(K,be,xe){const Oe=be.isScene===!0?be.overrideMaterial:null;for(let Me=0,$e=K.length;Me<$e;Me++){const yt=K[Me],{object:Mt,geometry:Ft,group:mt}=yt;let Pt=yt.material;Pt.allowOverride===!0&&Oe!==null&&(Pt=Oe),Mt.layers.test(xe.layers)&&bn(Mt,be,xe,Ft,Pt,mt)}}function bn(K,be,xe,Oe,Me,$e){K.onBeforeRender(U,be,xe,Oe,Me,$e),K.modelViewMatrix.multiplyMatrices(xe.matrixWorldInverse,K.matrixWorld),K.normalMatrix.getNormalMatrix(K.modelViewMatrix),Me.onBeforeRender(U,be,xe,Oe,K,$e),Me.transparent===!0&&Me.side===Oi&&Me.forceSinglePass===!1?(Me.side=fr,Me.needsUpdate=!0,U.renderBufferDirect(xe,be,Oe,Me,K,$e),Me.side=Zc,Me.needsUpdate=!0,U.renderBufferDirect(xe,be,Oe,Me,K,$e),Me.side=Oi):U.renderBufferDirect(xe,be,Oe,Me,K,$e),K.onAfterRender(U,be,xe,Oe,Me,$e)}function q(K,be,xe){be.isScene!==!0&&(be=Qe);const Oe=Ne.get(K),Me=N.state.lights,$e=N.state.shadowsArray,yt=Me.state.version,Mt=Be.getParameters(K,Me.state,$e,be,xe),Ft=Be.getProgramCacheKey(Mt);let mt=Oe.programs;Oe.environment=K.isMeshStandardMaterial?be.environment:null,Oe.fog=be.fog,Oe.envMap=(K.isMeshStandardMaterial?X:oe).get(K.envMap||Oe.environment),Oe.envMapRotation=Oe.environment!==null&&K.envMap===null?be.environmentRotation:K.envMapRotation,mt===void 0&&(K.addEventListener("dispose",Vt),mt=new Map,Oe.programs=mt);let Pt=mt.get(Ft);if(Pt!==void 0){if(Oe.currentProgram===Pt&&Oe.lightsStateVersion===yt)return we(K,Mt),Pt}else Mt.uniforms=Be.getUniforms(K),K.onBeforeCompile(Mt,U),Pt=Be.acquireProgram(Mt,Ft),mt.set(Ft,Pt),Oe.uniforms=Mt.uniforms;const en=Oe.uniforms;return(!K.isShaderMaterial&&!K.isRawShaderMaterial||K.clipping===!0)&&(en.clippingPlanes=zt.uniform),we(K,Mt),Oe.needsLights=ct(K),Oe.lightsStateVersion=yt,Oe.needsLights&&(en.ambientLightColor.value=Me.state.ambient,en.lightProbe.value=Me.state.probe,en.directionalLights.value=Me.state.directional,en.directionalLightShadows.value=Me.state.directionalShadow,en.spotLights.value=Me.state.spot,en.spotLightShadows.value=Me.state.spotShadow,en.rectAreaLights.value=Me.state.rectArea,en.ltc_1.value=Me.state.rectAreaLTC1,en.ltc_2.value=Me.state.rectAreaLTC2,en.pointLights.value=Me.state.point,en.pointLightShadows.value=Me.state.pointShadow,en.hemisphereLights.value=Me.state.hemi,en.directionalShadowMap.value=Me.state.directionalShadowMap,en.directionalShadowMatrix.value=Me.state.directionalShadowMatrix,en.spotShadowMap.value=Me.state.spotShadowMap,en.spotLightMatrix.value=Me.state.spotLightMatrix,en.spotLightMap.value=Me.state.spotLightMap,en.pointShadowMap.value=Me.state.pointShadowMap,en.pointShadowMatrix.value=Me.state.pointShadowMatrix),Oe.currentProgram=Pt,Oe.uniformsList=null,Pt}function he(K){if(K.uniformsList===null){const be=K.currentProgram.getUniforms();K.uniformsList=Zv.seqWithValue(be.seq,K.uniforms)}return K.uniformsList}function we(K,be){const xe=Ne.get(K);xe.outputColorSpace=be.outputColorSpace,xe.batching=be.batching,xe.batchingColor=be.batchingColor,xe.instancing=be.instancing,xe.instancingColor=be.instancingColor,xe.instancingMorph=be.instancingMorph,xe.skinning=be.skinning,xe.morphTargets=be.morphTargets,xe.morphNormals=be.morphNormals,xe.morphColors=be.morphColors,xe.morphTargetsCount=be.morphTargetsCount,xe.numClippingPlanes=be.numClippingPlanes,xe.numIntersection=be.numClipIntersection,xe.vertexAlphas=be.vertexAlphas,xe.vertexTangents=be.vertexTangents,xe.toneMapping=be.toneMapping}function Je(K,be,xe,Oe,Me){be.isScene!==!0&&(be=Qe),st.resetTextureUnits();const $e=be.fog,yt=Oe.isMeshStandardMaterial?be.environment:null,Mt=O===null?U.outputColorSpace:O.isXRRenderTarget===!0?O.texture.colorSpace:uc,Ft=(Oe.isMeshStandardMaterial?X:oe).get(Oe.envMap||yt),mt=Oe.vertexColors===!0&&!!xe.attributes.color&&xe.attributes.color.itemSize===4,Pt=!!xe.attributes.tangent&&(!!Oe.normalMap||Oe.anisotropy>0),en=!!xe.morphAttributes.position,Qt=!!xe.morphAttributes.normal,yn=!!xe.morphAttributes.color;let ln=qc;Oe.toneMapped&&(O===null||O.isXRRenderTarget===!0)&&(ln=U.toneMapping);const xn=xe.morphAttributes.position||xe.morphAttributes.normal||xe.morphAttributes.color,Un=xn!==void 0?xn.length:0,an=Ne.get(Oe),Bn=N.state.lights;if(pe===!0&&(ve===!0||K!==Q)){const ki=K===Q&&Oe.id===ee;zt.setState(Oe,K,ki)}let tn=!1;Oe.version===an.__version?(an.needsLights&&an.lightsStateVersion!==Bn.state.version||an.outputColorSpace!==Mt||Me.isBatchedMesh&&an.batching===!1||!Me.isBatchedMesh&&an.batching===!0||Me.isBatchedMesh&&an.batchingColor===!0&&Me.colorTexture===null||Me.isBatchedMesh&&an.batchingColor===!1&&Me.colorTexture!==null||Me.isInstancedMesh&&an.instancing===!1||!Me.isInstancedMesh&&an.instancing===!0||Me.isSkinnedMesh&&an.skinning===!1||!Me.isSkinnedMesh&&an.skinning===!0||Me.isInstancedMesh&&an.instancingColor===!0&&Me.instanceColor===null||Me.isInstancedMesh&&an.instancingColor===!1&&Me.instanceColor!==null||Me.isInstancedMesh&&an.instancingMorph===!0&&Me.morphTexture===null||Me.isInstancedMesh&&an.instancingMorph===!1&&Me.morphTexture!==null||an.envMap!==Ft||Oe.fog===!0&&an.fog!==$e||an.numClippingPlanes!==void 0&&(an.numClippingPlanes!==zt.numPlanes||an.numIntersection!==zt.numIntersection)||an.vertexAlphas!==mt||an.vertexTangents!==Pt||an.morphTargets!==en||an.morphNormals!==Qt||an.morphColors!==yn||an.toneMapping!==ln||an.morphTargetsCount!==Un)&&(tn=!0):(tn=!0,an.__version=Oe.version);let Hn=an.currentProgram;tn===!0&&(Hn=q(Oe,be,Me));let kn=!1,hn=!1,Ni=!1;const Yn=Hn.getUniforms(),Wn=an.uniforms;if(He.useProgram(Hn.program)&&(kn=!0,hn=!0,Ni=!0),Oe.id!==ee&&(ee=Oe.id,hn=!0),kn||Q!==K){He.buffers.depth.getReversed()&&K.reversedDepth!==!0&&(K._reversedDepth=!0,K.updateProjectionMatrix()),Yn.setValue(le,"projectionMatrix",K.projectionMatrix),Yn.setValue(le,"viewMatrix",K.matrixWorldInverse);const Di=Yn.map.cameraPosition;Di!==void 0&&Di.setValue(le,Ge.setFromMatrixPosition(K.matrixWorld)),je.logarithmicDepthBuffer&&Yn.setValue(le,"logDepthBufFC",2/(Math.log(K.far+1)/Math.LN2)),(Oe.isMeshPhongMaterial||Oe.isMeshToonMaterial||Oe.isMeshLambertMaterial||Oe.isMeshBasicMaterial||Oe.isMeshStandardMaterial||Oe.isShaderMaterial)&&Yn.setValue(le,"isOrthographic",K.isOrthographicCamera===!0),Q!==K&&(Q=K,hn=!0,Ni=!0)}if(Me.isSkinnedMesh){Yn.setOptional(le,Me,"bindMatrix"),Yn.setOptional(le,Me,"bindMatrixInverse");const ki=Me.skeleton;ki&&(ki.boneTexture===null&&ki.computeBoneTexture(),Yn.setValue(le,"boneTexture",ki.boneTexture,st))}Me.isBatchedMesh&&(Yn.setOptional(le,Me,"batchingTexture"),Yn.setValue(le,"batchingTexture",Me._matricesTexture,st),Yn.setOptional(le,Me,"batchingIdTexture"),Yn.setValue(le,"batchingIdTexture",Me._indirectTexture,st),Yn.setOptional(le,Me,"batchingColorTexture"),Me._colorsTexture!==null&&Yn.setValue(le,"batchingColorTexture",Me._colorsTexture,st));const xi=xe.morphAttributes;if((xi.position!==void 0||xi.normal!==void 0||xi.color!==void 0)&&ft.update(Me,xe,Hn),(hn||an.receiveShadow!==Me.receiveShadow)&&(an.receiveShadow=Me.receiveShadow,Yn.setValue(le,"receiveShadow",Me.receiveShadow)),Oe.isMeshGouraudMaterial&&Oe.envMap!==null&&(Wn.envMap.value=Ft,Wn.flipEnvMap.value=Ft.isCubeTexture&&Ft.isRenderTargetTexture===!1?-1:1),Oe.isMeshStandardMaterial&&Oe.envMap===null&&be.environment!==null&&(Wn.envMapIntensity.value=be.environmentIntensity),Wn.dfgLUT!==void 0&&(Wn.dfgLUT.value=zI()),hn&&(Yn.setValue(le,"toneMappingExposure",U.toneMappingExposure),an.needsLights&&ot(Wn,Ni),$e&&Oe.fog===!0&&bt.refreshFogUniforms(Wn,$e),bt.refreshMaterialUniforms(Wn,Oe,se,ie,N.state.transmissionRenderTarget[K.id]),Zv.upload(le,he(an),Wn,st)),Oe.isShaderMaterial&&Oe.uniformsNeedUpdate===!0&&(Zv.upload(le,he(an),Wn,st),Oe.uniformsNeedUpdate=!1),Oe.isSpriteMaterial&&Yn.setValue(le,"center",Me.center),Yn.setValue(le,"modelViewMatrix",Me.modelViewMatrix),Yn.setValue(le,"normalMatrix",Me.normalMatrix),Yn.setValue(le,"modelMatrix",Me.matrixWorld),Oe.isShaderMaterial||Oe.isRawShaderMaterial){const ki=Oe.uniformsGroups;for(let Di=0,Ga=ki.length;Di<Ga;Di++){const Ka=ki[Di];Re.update(Ka,Hn),Re.bind(Ka,Hn)}}return Hn}function ot(K,be){K.ambientLightColor.needsUpdate=be,K.lightProbe.needsUpdate=be,K.directionalLights.needsUpdate=be,K.directionalLightShadows.needsUpdate=be,K.pointLights.needsUpdate=be,K.pointLightShadows.needsUpdate=be,K.spotLights.needsUpdate=be,K.spotLightShadows.needsUpdate=be,K.rectAreaLights.needsUpdate=be,K.hemisphereLights.needsUpdate=be}function ct(K){return K.isMeshLambertMaterial||K.isMeshToonMaterial||K.isMeshPhongMaterial||K.isMeshStandardMaterial||K.isShadowMaterial||K.isShaderMaterial&&K.lights===!0}this.getActiveCubeFace=function(){return P},this.getActiveMipmapLevel=function(){return L},this.getRenderTarget=function(){return O},this.setRenderTargetTextures=function(K,be,xe){const Oe=Ne.get(K);Oe.__autoAllocateDepthBuffer=K.resolveDepthBuffer===!1,Oe.__autoAllocateDepthBuffer===!1&&(Oe.__useRenderToTexture=!1),Ne.get(K.texture).__webglTexture=be,Ne.get(K.depthTexture).__webglTexture=Oe.__autoAllocateDepthBuffer?void 0:xe,Oe.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(K,be){const xe=Ne.get(K);xe.__webglFramebuffer=be,xe.__useDefaultFramebuffer=be===void 0};const Ot=le.createFramebuffer();this.setRenderTarget=function(K,be=0,xe=0){O=K,P=be,L=xe;let Oe=!0,Me=null,$e=!1,yt=!1;if(K){const Ft=Ne.get(K);if(Ft.__useDefaultFramebuffer!==void 0)He.bindFramebuffer(le.FRAMEBUFFER,null),Oe=!1;else if(Ft.__webglFramebuffer===void 0)st.setupRenderTarget(K);else if(Ft.__hasExternalTextures)st.rebindTextures(K,Ne.get(K.texture).__webglTexture,Ne.get(K.depthTexture).__webglTexture);else if(K.depthBuffer){const en=K.depthTexture;if(Ft.__boundDepthTexture!==en){if(en!==null&&Ne.has(en)&&(K.width!==en.image.width||K.height!==en.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");st.setupDepthRenderbuffer(K)}}const mt=K.texture;(mt.isData3DTexture||mt.isDataArrayTexture||mt.isCompressedArrayTexture)&&(yt=!0);const Pt=Ne.get(K).__webglFramebuffer;K.isWebGLCubeRenderTarget?(Array.isArray(Pt[be])?Me=Pt[be][xe]:Me=Pt[be],$e=!0):K.samples>0&&st.useMultisampledRTT(K)===!1?Me=Ne.get(K).__webglMultisampledFramebuffer:Array.isArray(Pt)?Me=Pt[xe]:Me=Pt,te.copy(K.viewport),ne.copy(K.scissor),re=K.scissorTest}else te.copy(fe).multiplyScalar(se).floor(),ne.copy(Z).multiplyScalar(se).floor(),re=me;if(xe!==0&&(Me=Ot),He.bindFramebuffer(le.FRAMEBUFFER,Me)&&Oe&&He.drawBuffers(K,Me),He.viewport(te),He.scissor(ne),He.setScissorTest(re),$e){const Ft=Ne.get(K.texture);le.framebufferTexture2D(le.FRAMEBUFFER,le.COLOR_ATTACHMENT0,le.TEXTURE_CUBE_MAP_POSITIVE_X+be,Ft.__webglTexture,xe)}else if(yt){const Ft=be;for(let mt=0;mt<K.textures.length;mt++){const Pt=Ne.get(K.textures[mt]);le.framebufferTextureLayer(le.FRAMEBUFFER,le.COLOR_ATTACHMENT0+mt,Pt.__webglTexture,xe,Ft)}}else if(K!==null&&xe!==0){const Ft=Ne.get(K.texture);le.framebufferTexture2D(le.FRAMEBUFFER,le.COLOR_ATTACHMENT0,le.TEXTURE_2D,Ft.__webglTexture,xe)}ee=-1},this.readRenderTargetPixels=function(K,be,xe,Oe,Me,$e,yt,Mt=0){if(!(K&&K.isWebGLRenderTarget)){Xn("WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Ft=Ne.get(K).__webglFramebuffer;if(K.isWebGLCubeRenderTarget&&yt!==void 0&&(Ft=Ft[yt]),Ft){He.bindFramebuffer(le.FRAMEBUFFER,Ft);try{const mt=K.textures[Mt],Pt=mt.format,en=mt.type;if(!je.textureFormatReadable(Pt)){Xn("WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!je.textureTypeReadable(en)){Xn("WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}be>=0&&be<=K.width-Oe&&xe>=0&&xe<=K.height-Me&&(K.textures.length>1&&le.readBuffer(le.COLOR_ATTACHMENT0+Mt),le.readPixels(be,xe,Oe,Me,ht.convert(Pt),ht.convert(en),$e))}finally{const mt=O!==null?Ne.get(O).__webglFramebuffer:null;He.bindFramebuffer(le.FRAMEBUFFER,mt)}}},this.readRenderTargetPixelsAsync=async function(K,be,xe,Oe,Me,$e,yt,Mt=0){if(!(K&&K.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Ft=Ne.get(K).__webglFramebuffer;if(K.isWebGLCubeRenderTarget&&yt!==void 0&&(Ft=Ft[yt]),Ft)if(be>=0&&be<=K.width-Oe&&xe>=0&&xe<=K.height-Me){He.bindFramebuffer(le.FRAMEBUFFER,Ft);const mt=K.textures[Mt],Pt=mt.format,en=mt.type;if(!je.textureFormatReadable(Pt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!je.textureTypeReadable(en))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const Qt=le.createBuffer();le.bindBuffer(le.PIXEL_PACK_BUFFER,Qt),le.bufferData(le.PIXEL_PACK_BUFFER,$e.byteLength,le.STREAM_READ),K.textures.length>1&&le.readBuffer(le.COLOR_ATTACHMENT0+Mt),le.readPixels(be,xe,Oe,Me,ht.convert(Pt),ht.convert(en),0);const yn=O!==null?Ne.get(O).__webglFramebuffer:null;He.bindFramebuffer(le.FRAMEBUFFER,yn);const ln=le.fenceSync(le.SYNC_GPU_COMMANDS_COMPLETE,0);return le.flush(),await uB(le,ln,4),le.bindBuffer(le.PIXEL_PACK_BUFFER,Qt),le.getBufferSubData(le.PIXEL_PACK_BUFFER,0,$e),le.deleteBuffer(Qt),le.deleteSync(ln),$e}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")},this.copyFramebufferToTexture=function(K,be=null,xe=0){const Oe=Math.pow(2,-xe),Me=Math.floor(K.image.width*Oe),$e=Math.floor(K.image.height*Oe),yt=be!==null?be.x:0,Mt=be!==null?be.y:0;st.setTexture2D(K,0),le.copyTexSubImage2D(le.TEXTURE_2D,xe,0,0,yt,Mt,Me,$e),He.unbindTexture()};const Dt=le.createFramebuffer(),Nt=le.createFramebuffer();this.copyTextureToTexture=function(K,be,xe=null,Oe=null,Me=0,$e=null){$e===null&&(Me!==0?(Yp("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),$e=Me,Me=0):$e=0);let yt,Mt,Ft,mt,Pt,en,Qt,yn,ln;const xn=K.isCompressedTexture?K.mipmaps[$e]:K.image;if(xe!==null)yt=xe.max.x-xe.min.x,Mt=xe.max.y-xe.min.y,Ft=xe.isBox3?xe.max.z-xe.min.z:1,mt=xe.min.x,Pt=xe.min.y,en=xe.isBox3?xe.min.z:0;else{const xi=Math.pow(2,-Me);yt=Math.floor(xn.width*xi),Mt=Math.floor(xn.height*xi),K.isDataArrayTexture?Ft=xn.depth:K.isData3DTexture?Ft=Math.floor(xn.depth*xi):Ft=1,mt=0,Pt=0,en=0}Oe!==null?(Qt=Oe.x,yn=Oe.y,ln=Oe.z):(Qt=0,yn=0,ln=0);const Un=ht.convert(be.format),an=ht.convert(be.type);let Bn;be.isData3DTexture?(st.setTexture3D(be,0),Bn=le.TEXTURE_3D):be.isDataArrayTexture||be.isCompressedArrayTexture?(st.setTexture2DArray(be,0),Bn=le.TEXTURE_2D_ARRAY):(st.setTexture2D(be,0),Bn=le.TEXTURE_2D),le.pixelStorei(le.UNPACK_FLIP_Y_WEBGL,be.flipY),le.pixelStorei(le.UNPACK_PREMULTIPLY_ALPHA_WEBGL,be.premultiplyAlpha),le.pixelStorei(le.UNPACK_ALIGNMENT,be.unpackAlignment);const tn=le.getParameter(le.UNPACK_ROW_LENGTH),Hn=le.getParameter(le.UNPACK_IMAGE_HEIGHT),kn=le.getParameter(le.UNPACK_SKIP_PIXELS),hn=le.getParameter(le.UNPACK_SKIP_ROWS),Ni=le.getParameter(le.UNPACK_SKIP_IMAGES);le.pixelStorei(le.UNPACK_ROW_LENGTH,xn.width),le.pixelStorei(le.UNPACK_IMAGE_HEIGHT,xn.height),le.pixelStorei(le.UNPACK_SKIP_PIXELS,mt),le.pixelStorei(le.UNPACK_SKIP_ROWS,Pt),le.pixelStorei(le.UNPACK_SKIP_IMAGES,en);const Yn=K.isDataArrayTexture||K.isData3DTexture,Wn=be.isDataArrayTexture||be.isData3DTexture;if(K.isDepthTexture){const xi=Ne.get(K),ki=Ne.get(be),Di=Ne.get(xi.__renderTarget),Ga=Ne.get(ki.__renderTarget);He.bindFramebuffer(le.READ_FRAMEBUFFER,Di.__webglFramebuffer),He.bindFramebuffer(le.DRAW_FRAMEBUFFER,Ga.__webglFramebuffer);for(let Ka=0;Ka<Ft;Ka++)Yn&&(le.framebufferTextureLayer(le.READ_FRAMEBUFFER,le.COLOR_ATTACHMENT0,Ne.get(K).__webglTexture,Me,en+Ka),le.framebufferTextureLayer(le.DRAW_FRAMEBUFFER,le.COLOR_ATTACHMENT0,Ne.get(be).__webglTexture,$e,ln+Ka)),le.blitFramebuffer(mt,Pt,yt,Mt,Qt,yn,yt,Mt,le.DEPTH_BUFFER_BIT,le.NEAREST);He.bindFramebuffer(le.READ_FRAMEBUFFER,null),He.bindFramebuffer(le.DRAW_FRAMEBUFFER,null)}else if(Me!==0||K.isRenderTargetTexture||Ne.has(K)){const xi=Ne.get(K),ki=Ne.get(be);He.bindFramebuffer(le.READ_FRAMEBUFFER,Dt),He.bindFramebuffer(le.DRAW_FRAMEBUFFER,Nt);for(let Di=0;Di<Ft;Di++)Yn?le.framebufferTextureLayer(le.READ_FRAMEBUFFER,le.COLOR_ATTACHMENT0,xi.__webglTexture,Me,en+Di):le.framebufferTexture2D(le.READ_FRAMEBUFFER,le.COLOR_ATTACHMENT0,le.TEXTURE_2D,xi.__webglTexture,Me),Wn?le.framebufferTextureLayer(le.DRAW_FRAMEBUFFER,le.COLOR_ATTACHMENT0,ki.__webglTexture,$e,ln+Di):le.framebufferTexture2D(le.DRAW_FRAMEBUFFER,le.COLOR_ATTACHMENT0,le.TEXTURE_2D,ki.__webglTexture,$e),Me!==0?le.blitFramebuffer(mt,Pt,yt,Mt,Qt,yn,yt,Mt,le.COLOR_BUFFER_BIT,le.NEAREST):Wn?le.copyTexSubImage3D(Bn,$e,Qt,yn,ln+Di,mt,Pt,yt,Mt):le.copyTexSubImage2D(Bn,$e,Qt,yn,mt,Pt,yt,Mt);He.bindFramebuffer(le.READ_FRAMEBUFFER,null),He.bindFramebuffer(le.DRAW_FRAMEBUFFER,null)}else Wn?K.isDataTexture||K.isData3DTexture?le.texSubImage3D(Bn,$e,Qt,yn,ln,yt,Mt,Ft,Un,an,xn.data):be.isCompressedArrayTexture?le.compressedTexSubImage3D(Bn,$e,Qt,yn,ln,yt,Mt,Ft,Un,xn.data):le.texSubImage3D(Bn,$e,Qt,yn,ln,yt,Mt,Ft,Un,an,xn):K.isDataTexture?le.texSubImage2D(le.TEXTURE_2D,$e,Qt,yn,yt,Mt,Un,an,xn.data):K.isCompressedTexture?le.compressedTexSubImage2D(le.TEXTURE_2D,$e,Qt,yn,xn.width,xn.height,Un,xn.data):le.texSubImage2D(le.TEXTURE_2D,$e,Qt,yn,yt,Mt,Un,an,xn);le.pixelStorei(le.UNPACK_ROW_LENGTH,tn),le.pixelStorei(le.UNPACK_IMAGE_HEIGHT,Hn),le.pixelStorei(le.UNPACK_SKIP_PIXELS,kn),le.pixelStorei(le.UNPACK_SKIP_ROWS,hn),le.pixelStorei(le.UNPACK_SKIP_IMAGES,Ni),$e===0&&be.generateMipmaps&&le.generateMipmap(Bn),He.unbindTexture()},this.initRenderTarget=function(K){Ne.get(K).__webglFramebuffer===void 0&&st.setupRenderTarget(K)},this.initTexture=function(K){K.isCubeTexture?st.setTextureCube(K,0):K.isData3DTexture?st.setTexture3D(K,0):K.isDataArrayTexture||K.isCompressedArrayTexture?st.setTexture2DArray(K,0):st.setTexture2D(K,0),He.unbindTexture()},this.resetState=function(){P=0,L=0,O=null,He.reset(),ye.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Yo}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=Ri._getDrawingBufferColorSpace(e),t.unpackColorSpace=Ri._getUnpackColorSpace()}}const lT=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:sS,AddEquation:wf,AddOperation:H3,AdditiveAnimationBlendMode:uS,AdditiveBlending:t1,AgXToneMapping:Y3,AlphaFormat:lS,AlwaysCompare:oC,AlwaysDepth:s1,AlwaysStencilFunc:T_,AmbientLight:XC,AnimationAction:eT,AnimationClip:$p,AnimationLoader:KD,AnimationMixer:S5,AnimationObjectGroup:b5,AnimationUtils:WD,ArcCurve:_C,ArrayCamera:KC,ArrowHelper:X5,AttachedBindMode:E_,Audio:QC,AudioAnalyser:u5,AudioContext:GS,AudioListener:o5,AudioLoader:a5,AxesHelper:Y5,BackSide:fr,BasicDepthPacking:$3,BasicShadowMap:S3,BatchedMesh:gC,Bone:vy,BooleanKeyframeTrack:cd,Box2:N5,Box3:Yi,Box3Helper:k5,BoxGeometry:ks,BoxHelper:H5,BufferAttribute:Ii,BufferGeometry:Rn,BufferGeometryLoader:JC,ByteType:sy,Cache:Wc,Camera:my,CameraHelper:j5,CanvasTexture:yC,CapsuleGeometry:Sy,CatmullRomCurve3:_l,CineonToneMapping:V3,CircleGeometry:Ay,ClampToEdgeWrapping:Pa,Clock:jS,Color:qt,ColorKeyframeTrack:LS,ColorManagement:Ri,CompressedArrayTexture:mD,CompressedCubeTexture:xD,CompressedTexture:by,CompressedTextureLoader:QD,ConeGeometry:Cx,ConstantAlphaFactor:P3,ConstantColorFactor:z3,Controls:q5,CubeCamera:dC,CubeReflectionMapping:Kc,CubeRefractionMapping:Lf,CubeTexture:Mx,CubeTextureLoader:HC,CubeUVReflectionMapping:i0,CubicBezierCurve:wS,CubicBezierCurve3:SC,CubicInterpolant:FC,CullFaceBack:A_,CullFaceFront:_3,CullFaceFrontBack:TN,CullFaceNone:b3,Curve:fc,CurvePath:MC,CustomBlending:A3,CustomToneMapping:X3,CylinderGeometry:Lr,Cylindrical:R5,Data3DTexture:py,DataArrayTexture:dy,DataTexture:wl,DataTextureLoader:OS,DataUtils:Wh,DecrementStencilOp:FN,DecrementWrapStencilOp:GN,DefaultLoadingManager:jC,DepthFormat:jp,DepthStencilFormat:Hp,DepthTexture:_y,DetachedBindMode:q3,DirectionalLight:PS,DirectionalLightHelper:G5,DiscreteInterpolant:PC,DodecahedronGeometry:My,DoubleSide:Oi,DstAlphaFactor:D3,DstColorFactor:L3,DynamicCopyUsage:tB,DynamicDrawUsage:JN,DynamicReadUsage:QN,EdgesGeometry:bC,EllipseCurve:wy,EqualCompare:iC,EqualDepth:o1,EqualStencilFunc:VN,EquirectangularReflectionMapping:zp,EquirectangularRefractionMapping:sx,Euler:hi,EventDispatcher:eu,ExternalTexture:AS,ExtrudeGeometry:id,FileLoader:Xs,Float16BufferAttribute:WB,Float32BufferAttribute:$t,FloatType:Da,Fog:gy,FogExp2:xy,FramebufferTexture:pD,FrontSide:Zc,Frustum:s0,FrustumArray:yy,GLBufferAttribute:E5,GLSL1:iB,GLSL3:R_,GreaterCompare:aC,GreaterDepth:c1,GreaterEqualCompare:rC,GreaterEqualDepth:l1,GreaterEqualStencilFunc:qN,GreaterStencilFunc:YN,GridHelper:F5,Group:Yc,HalfFloatType:xs,HemisphereLight:VC,HemisphereLightHelper:z5,IcosahedronGeometry:Tx,ImageBitmapLoader:ZC,ImageLoader:px,ImageUtils:uC,IncrementStencilOp:zN,IncrementWrapStencilOp:PN,InstancedBufferAttribute:Ff,InstancedBufferGeometry:Oy,InstancedInterleavedBuffer:V1,InstancedMesh:_S,Int16BufferAttribute:XB,Int32BufferAttribute:YB,Int8BufferAttribute:HB,IntType:_x,InterleavedBuffer:wx,InterleavedBufferAttribute:Co,Interpolant:o0,InterpolateDiscrete:kp,InterpolateLinear:Vp,InterpolateSmooth:qv,InterpolationSamplingMode:rB,InterpolationSamplingType:sB,InvertStencilOp:jN,KeepStencilOp:Hh,KeyframeTrack:Tl,LOD:xC,LatheGeometry:Qp,Layers:qp,LessCompare:nC,LessDepth:r1,LessEqualCompare:dS,LessEqualDepth:td,LessEqualStencilFunc:XN,LessStencilFunc:kN,Light:Hf,LightProbe:qC,Line:ui,Line3:XS,LineBasicMaterial:gs,LineCurve:ES,LineCurve3:AC,LineDashedMaterial:OC,LineLoop:SS,LineSegments:Jo,LinearFilter:bi,LinearInterpolant:US,LinearMipMapLinearFilter:C_,LinearMipMapNearestFilter:BN,LinearMipmapLinearFilter:Al,LinearMipmapNearestFilter:Dp,LinearSRGBColorSpace:uc,LinearToneMapping:k3,LinearTransfer:ox,Loader:Ws,LoaderUtils:Df,LoadingManager:Uy,LoopOnce:J3,LoopPingPong:K3,LoopRepeat:Z3,MOUSE:Gh,Material:os,MaterialLoader:Ly,MathUtils:zf,Matrix2:VS,Matrix3:Qn,Matrix4:wn,MaxEquation:C3,Mesh:sn,MeshBasicMaterial:ur,MeshDepthMaterial:By,MeshDistanceMaterial:Dy,MeshLambertMaterial:UC,MeshMatcapMaterial:LC,MeshNormalMaterial:DC,MeshPhongMaterial:BS,MeshPhysicalMaterial:Cl,MeshStandardMaterial:Rx,MeshToonMaterial:BC,MinEquation:E3,MirroredRepeatWrapping:Fp,MixOperation:j3,MultiplyBlending:w_,MultiplyOperation:bx,NearestFilter:Vs,NearestMipMapLinearFilter:NN,NearestMipMapNearestFilter:RN,NearestMipmapLinearFilter:Vh,NearestMipmapNearestFilter:ay,NeutralToneMapping:W3,NeverCompare:tC,NeverDepth:a1,NeverStencilFunc:HN,NoBlending:cc,NoColorSpace:zu,NoToneMapping:qc,NormalAnimationBlendMode:hy,NormalBlending:Kh,NotEqualCompare:sC,NotEqualDepth:u1,NotEqualStencilFunc:WN,NumberKeyframeTrack:ad,Object3D:ai,ObjectLoader:n5,ObjectSpaceNormalMap:eC,OctahedronGeometry:bl,OneFactor:R3,OneMinusConstantAlphaFactor:G3,OneMinusConstantColorFactor:F3,OneMinusDstAlphaFactor:U3,OneMinusDstColorFactor:O3,OneMinusSrcAlphaFactor:i1,OneMinusSrcColorFactor:B3,OrthographicCamera:El,PCFShadowMap:iy,PCFSoftShadowMap:Ym,PMREMGenerator:I_,Path:k1,PerspectiveCamera:Ba,Plane:rc,PlaneGeometry:is,PlaneHelper:V5,PointLight:FS,PointLightHelper:O5,Points:Lp,PointsMaterial:Tf,PolarGridHelper:P5,PolyhedronGeometry:jf,PositionalAudio:c5,PropertyBinding:Bi,PropertyMixer:$C,QuadraticBezierCurve:CS,QuadraticBezierCurve3:TS,Quaternion:Fn,QuaternionKeyframeTrack:sd,QuaternionLinearInterpolant:GC,RED_GREEN_RGTC2_Format:z1,RED_RGTC1_Format:O1,REVISION:n0,RGBADepthPacking:hS,RGBAFormat:ss,RGBAIntegerFormat:fy,RGBA_ASTC_10x10_Format:R1,RGBA_ASTC_10x5_Format:E1,RGBA_ASTC_10x6_Format:C1,RGBA_ASTC_10x8_Format:T1,RGBA_ASTC_12x10_Format:N1,RGBA_ASTC_12x12_Format:B1,RGBA_ASTC_4x4_Format:v1,RGBA_ASTC_5x4_Format:y1,RGBA_ASTC_5x5_Format:b1,RGBA_ASTC_6x5_Format:_1,RGBA_ASTC_6x6_Format:S1,RGBA_ASTC_8x5_Format:A1,RGBA_ASTC_8x6_Format:M1,RGBA_ASTC_8x8_Format:w1,RGBA_BPTC_Format:D1,RGBA_ETC2_EAC_Format:g1,RGBA_PVRTC_2BPPV1_Format:p1,RGBA_PVRTC_4BPPV1_Format:d1,RGBA_S3TC_DXT1_Format:qm,RGBA_S3TC_DXT3_Format:Jm,RGBA_S3TC_DXT5_Format:Zm,RGBDepthPacking:UN,RGBFormat:cS,RGBIntegerFormat:DN,RGB_BPTC_SIGNED_Format:U1,RGB_BPTC_UNSIGNED_Format:L1,RGB_ETC1_Format:m1,RGB_ETC2_Format:x1,RGB_PVRTC_2BPPV1_Format:h1,RGB_PVRTC_4BPPV1_Format:f1,RGB_S3TC_DXT1_Format:Wm,RGDepthPacking:LN,RGFormat:cy,RGIntegerFormat:uy,RawShaderMaterial:NC,Ray:ld,Raycaster:zy,RectAreaLight:YC,RedFormat:Sx,RedIntegerFormat:Ax,ReinhardToneMapping:aS,RenderTarget:mS,RenderTarget3D:A5,RepeatWrapping:Of,ReplaceStencilOp:IN,ReverseSubtractEquation:w3,RingGeometry:Ey,SIGNED_RED_GREEN_RGTC2_Format:F1,SIGNED_RED_RGTC1_Format:I1,SRGBColorSpace:Hs,SRGBTransfer:ta,Scene:a0,ShaderChunk:ni,ShaderLib:oc,ShaderMaterial:Ys,ShadowMaterial:RC,Shape:Jc,ShapeGeometry:Cy,ShapePath:W5,ShapeUtils:Ml,ShortType:ry,Skeleton:Ex,SkeletonHelper:L5,SkinnedMesh:bS,Source:Cf,Sphere:rs,SphereGeometry:r0,Spherical:X1,SphericalHarmonics3:WC,SplineCurve:RS,SpotLight:zS,SpotLightHelper:U5,Sprite:mC,SpriteMaterial:yS,SrcAlphaFactor:n1,SrcAlphaSaturateFactor:I3,SrcColorFactor:N3,StaticCopyUsage:eB,StaticDrawUsage:lx,StaticReadUsage:KN,StereoCamera:s5,StreamCopyUsage:nB,StreamDrawUsage:ZN,StreamReadUsage:$N,StringKeyframeTrack:ud,SubtractEquation:M3,SubtractiveBlending:M_,TOUCH:jh,TangentSpaceNormalMap:Gf,TetrahedronGeometry:Ty,Texture:Wi,TextureLoader:kC,TextureUtils:$5,Timer:C5,TimestampQuery:aB,TorusGeometry:Rf,TorusKnotGeometry:Ry,Triangle:Ef,TriangleFanDrawMode:P1,TriangleStripDrawMode:fS,TrianglesDrawMode:Q3,TubeGeometry:Ny,UVMapping:Uf,Uint16BufferAttribute:xS,Uint32BufferAttribute:gS,Uint8BufferAttribute:kB,Uint8ClampedBufferAttribute:VB,Uniform:Iy,UniformsGroup:w5,UniformsLib:rn,UniformsUtils:Zp,UnsignedByteType:uo,UnsignedInt101111Type:oS,UnsignedInt248Type:Gp,UnsignedInt5999Type:rS,UnsignedIntType:Qc,UnsignedShort4444Type:oy,UnsignedShort5551Type:ly,UnsignedShortType:Pp,VSMShadowMap:sc,Vector2:gt,Vector3:k,Vector4:oi,VectorKeyframeTrack:rd,VideoFrameTexture:dD,VideoTexture:vC,WebGL3DRenderTarget:BB,WebGLArrayRenderTarget:NB,WebGLCoordinateSystem:Yo,WebGLCubeRenderTarget:vS,WebGLRenderTarget:qo,WebGLRenderer:YS,WebGLUtils:oT,WebGPUCoordinateSystem:Xp,WebXRController:Jv,WireframeGeometry:NS,WrapAroundEnding:rx,ZeroCurvatureEnding:Xh,ZeroFactor:T3,ZeroSlopeEnding:Yh,ZeroStencilOp:ON,createCanvasElement:cC,error:Xn,getConsoleFunction:cB,log:ux,setConsoleFunction:lB,warn:un,warnOnce:Yp},Symbol.toStringTag,{value:"Module"}));/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FI=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),PI=s=>s.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase()),Yw=s=>{const e=PI(s);return e.charAt(0).toUpperCase()+e.slice(1)},cT=(...s)=>s.filter((e,t,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===t).join(" ").trim(),GI=s=>{for(const e in s)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var jI={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HI=Y.forwardRef(({color:s="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:n,className:i="",children:a,iconNode:o,...c},u)=>Y.createElement("svg",{ref:u,...jI,width:e,height:e,stroke:s,strokeWidth:n?Number(t)*24/Number(e):t,className:cT("lucide",i),...!a&&!GI(c)&&{"aria-hidden":"true"},...c},[...o.map(([h,m])=>Y.createElement(h,m)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yt=(s,e)=>{const t=Y.forwardRef(({className:n,...i},a)=>Y.createElement(HI,{ref:a,iconNode:e,className:cT(`lucide-${FI(Yw(s))}`,`lucide-${s}`,n),...i}));return t.displayName=Yw(s),t};/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kI=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],_2=Yt("activity",kI);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VI=[["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}],["path",{d:"M10 4v4",key:"pp8u80"}],["path",{d:"M2 8h20",key:"d11cs7"}],["path",{d:"M6 4v4",key:"1svtjw"}]],Ww=Yt("app-window",VI);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XI=[["path",{d:"M12 17V3",key:"1cwfxf"}],["path",{d:"m6 11 6 6 6-6",key:"12ii2o"}],["path",{d:"M19 21H5",key:"150jfl"}]],qw=Yt("arrow-down-to-line",XI);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YI=[["path",{d:"M8 3 4 7l4 4",key:"9rb6wj"}],["path",{d:"M4 7h16",key:"6tx8e3"}],["path",{d:"m16 21 4-4-4-4",key:"siv7j2"}],["path",{d:"M20 17H4",key:"h6l3hr"}]],S2=Yt("arrow-left-right",YI);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WI=[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]],A2=Yt("arrow-right-left",WI);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qI=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],JI=Yt("arrow-right",qI);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZI=[["path",{d:"m18 9-6-6-6 6",key:"kcunyi"}],["path",{d:"M12 3v14",key:"7cf3v8"}],["path",{d:"M5 21h14",key:"11awu3"}]],M2=Yt("arrow-up-from-line",ZI);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KI=[["path",{d:"M10 22V7a1 1 0 0 0-1-1H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-5a1 1 0 0 0-1-1H2",key:"1ah6g2"}],["rect",{x:"14",y:"2",width:"8",height:"8",rx:"1",key:"88lufb"}]],w2=Yt("blocks",KI);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QI=[["path",{d:"m20 13.7-2.1-2.1a2 2 0 0 0-2.8 0L9.7 17",key:"q6ojf0"}],["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}],["circle",{cx:"10",cy:"8",r:"2",key:"2qkj4p"}]],$I=Yt("book-image",QI);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ez=[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]],kc=Yt("box",ez);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tz=[["path",{d:"m11 10 3 3",key:"fzmg1i"}],["path",{d:"M6.5 21A3.5 3.5 0 1 0 3 17.5a2.62 2.62 0 0 1-.708 1.792A1 1 0 0 0 3 21z",key:"p4q2r7"}],["path",{d:"M9.969 17.031 21.378 5.624a1 1 0 0 0-3.002-3.002L6.967 14.031",key:"wy6l02"}]],Jw=Yt("brush",tz);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nz=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],Zw=Yt("camera",nz);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iz=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],az=Yt("chart-pie",iz);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sz=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Mv=Yt("check",sz);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rz=[["path",{d:"M10.1 2.182a10 10 0 0 1 3.8 0",key:"5ilxe3"}],["path",{d:"M13.9 21.818a10 10 0 0 1-3.8 0",key:"11zvb9"}],["path",{d:"M17.609 3.721a10 10 0 0 1 2.69 2.7",key:"1iw5b2"}],["path",{d:"M2.182 13.9a10 10 0 0 1 0-3.8",key:"c0bmvh"}],["path",{d:"M20.279 17.609a10 10 0 0 1-2.7 2.69",key:"1ruxm7"}],["path",{d:"M21.818 10.1a10 10 0 0 1 0 3.8",key:"qkgqxc"}],["path",{d:"M3.721 6.391a10 10 0 0 1 2.7-2.69",key:"1mcia2"}],["path",{d:"M6.391 20.279a10 10 0 0 1-2.69-2.7",key:"1fvljs"}]],oz=Yt("circle-dashed",rz);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lz=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{x:"9",y:"9",width:"6",height:"6",rx:"1",key:"1ssd4o"}]],E2=Yt("circle-stop",lz);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cz=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Nm=Yt("circle",cz);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uz=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],C2=Yt("code",uz);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fz=[["path",{d:"m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z",key:"9ktpf1"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],hz=Yt("compass",fz);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dz=[["path",{d:"M15.536 11.293a1 1 0 0 0 0 1.414l2.376 2.377a1 1 0 0 0 1.414 0l2.377-2.377a1 1 0 0 0 0-1.414l-2.377-2.377a1 1 0 0 0-1.414 0z",key:"1uwlt4"}],["path",{d:"M2.297 11.293a1 1 0 0 0 0 1.414l2.377 2.377a1 1 0 0 0 1.414 0l2.377-2.377a1 1 0 0 0 0-1.414L6.088 8.916a1 1 0 0 0-1.414 0z",key:"10291m"}],["path",{d:"M8.916 17.912a1 1 0 0 0 0 1.415l2.377 2.376a1 1 0 0 0 1.414 0l2.377-2.376a1 1 0 0 0 0-1.415l-2.377-2.376a1 1 0 0 0-1.414 0z",key:"1tqoq1"}],["path",{d:"M8.916 4.674a1 1 0 0 0 0 1.414l2.377 2.376a1 1 0 0 0 1.414 0l2.377-2.376a1 1 0 0 0 0-1.414l-2.377-2.377a1 1 0 0 0-1.414 0z",key:"1x6lto"}]],Bm=Yt("component",dz);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pz=[["line",{x1:"15",x2:"15",y1:"12",y2:"18",key:"1p7wdc"}],["line",{x1:"12",x2:"18",y1:"15",y2:"15",key:"1nscbv"}],["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],T2=Yt("copy-plus",pz);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mz=[["path",{d:"M20 4v7a4 4 0 0 1-4 4H4",key:"6o5b7l"}],["path",{d:"m9 10-5 5 5 5",key:"1kshq7"}]],xz=Yt("corner-down-left",mz);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gz=[["path",{d:"M20 20v-7a4 4 0 0 0-4-4H4",key:"1nkjon"}],["path",{d:"M9 14 4 9l5-5",key:"102s5s"}]],vz=Yt("corner-up-left",gz);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yz=[["path",{d:"m21.12 6.4-6.05-4.06a2 2 0 0 0-2.17-.05L2.95 8.41a2 2 0 0 0-.95 1.7v5.82a2 2 0 0 0 .88 1.66l6.05 4.07a2 2 0 0 0 2.17.05l9.95-6.12a2 2 0 0 0 .95-1.7V8.06a2 2 0 0 0-.88-1.66Z",key:"1u2ovd"}],["path",{d:"M10 22v-8L2.25 9.15",key:"11pn4q"}],["path",{d:"m10 14 11.77-6.87",key:"1kt1wh"}]],R2=Yt("cuboid",yz);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bz=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5v14a9 3 0 0 0 18 0V5",key:"aqi0yr"}]],Dm=Yt("cylinder",bz);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _z=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],wv=Yt("database",_z);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sz=[["path",{d:"M2.7 10.3a2.41 2.41 0 0 0 0 3.41l7.59 7.59a2.41 2.41 0 0 0 3.41 0l7.59-7.59a2.41 2.41 0 0 0 0-3.41l-7.59-7.59a2.41 2.41 0 0 0-3.41 0Z",key:"1f1r0c"}]],Az=Yt("diamond",Sz);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mz=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Ih=Yt("download",Mz);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wz=[["path",{d:"M12 22a7 7 0 0 0 7-7c0-2-1-3.9-3-5.5s-3.5-4-4-6.5c-.5 2.5-2 4.9-4 6.5C6 11.1 5 13 5 15a7 7 0 0 0 7 7z",key:"c7niix"}]],Ev=Yt("droplet",wz);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ez=[["path",{d:"M21 21H8a2 2 0 0 1-1.42-.587l-3.994-3.999a2 2 0 0 1 0-2.828l10-10a2 2 0 0 1 2.829 0l5.999 6a2 2 0 0 1 0 2.828L12.834 21",key:"g5wo59"}],["path",{d:"m5.082 11.09 8.828 8.828",key:"1wx5vj"}]],Kw=Yt("eraser",Ez);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cz=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],Tz=Yt("eye-off",Cz);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rz=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],zh=Yt("eye",Rz);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nz=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]],Bz=Yt("file-up",Nz);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dz=[["path",{d:"M8 3H5a2 2 0 0 0-2 2v14c0 1.1.9 2 2 2h3",key:"1i73f7"}],["path",{d:"M16 3h3a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-3",key:"saxlbk"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"M12 14v2",key:"8jcxud"}],["path",{d:"M12 8v2",key:"1woqiv"}],["path",{d:"M12 2v2",key:"tus03m"}]],Qw=Yt("flip-horizontal",Dz);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uz=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],Lz=Yt("folder-open",Uz);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oz=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],Iz=Yt("globe",Oz);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zz=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],Sp=Yt("grid-3x3",zz);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fz=[["circle",{cx:"12",cy:"9",r:"1",key:"124mty"}],["circle",{cx:"19",cy:"9",r:"1",key:"1ruzo2"}],["circle",{cx:"5",cy:"9",r:"1",key:"1a8b28"}],["circle",{cx:"12",cy:"15",r:"1",key:"1e56xg"}],["circle",{cx:"19",cy:"15",r:"1",key:"1a92ep"}],["circle",{cx:"5",cy:"15",r:"1",key:"5r1jwy"}]],Pz=Yt("grip-horizontal",Fz);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gz=[["path",{d:"m15 12-9.373 9.373a1 1 0 0 1-3.001-3L12 9",key:"1hayfq"}],["path",{d:"m18 15 4-4",key:"16gjal"}],["path",{d:"m21.5 11.5-1.914-1.914A2 2 0 0 1 19 8.172v-.344a2 2 0 0 0-.586-1.414l-1.657-1.657A6 6 0 0 0 12.516 3H9l1.243 1.243A6 6 0 0 1 12 8.485V10l2 2h1.172a2 2 0 0 1 1.414.586L18.5 14.5",key:"15ts47"}]],N2=Yt("hammer",Gz);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jz=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],Hz=Yt("heart",jz);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kz=[["path",{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z",key:"yt0hxn"}]],Vz=Yt("hexagon",kz);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xz=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],uT=Yt("layers",Xz);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yz=[["rect",{width:"18",height:"7",x:"3",y:"3",rx:"1",key:"f1a2em"}],["rect",{width:"9",height:"7",x:"3",y:"14",rx:"1",key:"jqznyg"}],["rect",{width:"5",height:"7",x:"16",y:"14",rx:"1",key:"q5h2i8"}]],Wz=Yt("layout-template",Yz);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qz=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],Jz=Yt("link",qz);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zz=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]],$w=Yt("lock-open",Zz);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kz=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],Cv=Yt("lock",Kz);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qz=[["path",{d:"m12 15 4 4",key:"lnac28"}],["path",{d:"M2.352 10.648a1.205 1.205 0 0 0 0 1.704l2.296 2.296a1.205 1.205 0 0 0 1.704 0l6.029-6.029a1 1 0 1 1 3 3l-6.029 6.029a1.205 1.205 0 0 0 0 1.704l2.296 2.296a1.205 1.205 0 0 0 1.704 0l6.365-6.367A1 1 0 0 0 8.716 4.282z",key:"nlhkjb"}],["path",{d:"m5 8 4 4",key:"j6kj7e"}]],$z=Yt("magnet",Qz);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e6=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],eE=Yt("map-pin",e6);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t6=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],B2=Yt("monitor",t6);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n6=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],i6=Yt("moon",n6);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a6=[["path",{d:"M4.037 4.688a.495.495 0 0 1 .651-.651l16 6.5a.5.5 0 0 1-.063.947l-6.124 1.58a2 2 0 0 0-1.438 1.435l-1.579 6.126a.5.5 0 0 1-.947.063z",key:"edeuup"}]],F_=Yt("mouse-pointer-2",a6);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s6=[["path",{d:"M14 4.1 12 6",key:"ita8i4"}],["path",{d:"m5.1 8-2.9-.8",key:"1go3kf"}],["path",{d:"m6 12-1.9 2",key:"mnht97"}],["path",{d:"M7.2 2.2 8 5.1",key:"1cfko1"}],["path",{d:"M9.037 9.69a.498.498 0 0 1 .653-.653l11 4.5a.5.5 0 0 1-.074.949l-4.349 1.041a1 1 0 0 0-.74.739l-1.04 4.35a.5.5 0 0 1-.95.074z",key:"s0h3yz"}]],tE=Yt("mouse-pointer-click",s6);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r6=[["path",{d:"M12 2v20",key:"t6zp3m"}],["path",{d:"m15 19-3 3-3-3",key:"11eu04"}],["path",{d:"m19 9 3 3-3 3",key:"1mg7y2"}],["path",{d:"M2 12h20",key:"9i4pu4"}],["path",{d:"m5 9-3 3 3 3",key:"j64kie"}],["path",{d:"m9 5 3-3 3 3",key:"l8vdw6"}]],nE=Yt("move",r6);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o6=[["path",{d:"m19 11-8-8-8.6 8.6a2 2 0 0 0 0 2.8l5.2 5.2c.8.8 2 .8 2.8 0L19 11Z",key:"irua1i"}],["path",{d:"m5 2 5 5",key:"1lls2c"}],["path",{d:"M2 13h15",key:"1hkzvu"}],["path",{d:"M22 20a2 2 0 1 1-4 0c0-1.6 1.7-2.4 2-4 .3 1.6 2 2.4 2 4Z",key:"xk76lq"}]],l6=Yt("paint-bucket",o6);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c6=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],u6=Yt("palette",c6);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f6=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],D2=Yt("pause",f6);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h6=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],Tv=Yt("pencil",h6);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d6=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],Ap=Yt("play",d6);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p6=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],iE=Yt("plus",p6);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m6=[["path",{d:"M13 22H4a2 2 0 0 1 0-4h12",key:"bt3f23"}],["path",{d:"M13.236 18a3 3 0 0 0-2.2-5",key:"1tbvmo"}],["path",{d:"M16 9h.01",key:"1bdo4e"}],["path",{d:"M16.82 3.94a3 3 0 1 1 3.237 4.868l1.815 2.587a1.5 1.5 0 0 1-1.5 2.1l-2.872-.453a3 3 0 0 0-3.5 3",key:"9ch7kn"}],["path",{d:"M17 4.988a3 3 0 1 0-5.2 2.052A7 7 0 0 0 4 14.015 4 4 0 0 0 8 18",key:"3s7e9i"}]],x6=Yt("rat",m6);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g6=[["path",{d:"m15 14 5-5-5-5",key:"12vg1m"}],["path",{d:"M20 9H9.5A5.5 5.5 0 0 0 4 14.5A5.5 5.5 0 0 0 9.5 20H13",key:"6uklza"}]],v6=Yt("redo-2",g6);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y6=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Um=Yt("refresh-cw",y6);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b6=[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]],_6=Yt("repeat",b6);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S6=[["path",{d:"M16.466 7.5C15.643 4.237 13.952 2 12 2 9.239 2 7 6.477 7 12s2.239 10 5 10c.342 0 .677-.069 1-.2",key:"10n0gc"}],["path",{d:"m15.194 13.707 3.814 1.86-1.86 3.814",key:"16shm9"}],["path",{d:"M19 15.57c-1.804.885-4.274 1.43-7 1.43-5.523 0-10-2.239-10-5s4.477-5 10-5c4.838 0 8.873 1.718 9.8 4",key:"1lxi77"}]],A6=Yt("rotate-3d",S6);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M6=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],w6=Yt("rotate-ccw",M6);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E6=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],Lm=Yt("rotate-cw",E6);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C6=[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]],U2=Yt("route",C6);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T6=[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]],L2=Yt("ruler",T6);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R6=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],N6=Yt("save",R6);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B6=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M14 15H9v-5",key:"pi4jk9"}],["path",{d:"M16 3h5v5",key:"1806ms"}],["path",{d:"M21 3 9 15",key:"15kdhq"}]],Rv=Yt("scaling",B6);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D6=[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["path",{d:"M9 9h.01",key:"1q5me6"}],["path",{d:"M15 9h.01",key:"x1ddxp"}]],U6=Yt("scan-face",D6);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L6=[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]],O6=Yt("scissors",L6);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I6=[["path",{d:"m18 14 4 4-4 4",key:"10pe0f"}],["path",{d:"m18 2 4 4-4 4",key:"pucp1d"}],["path",{d:"M2 18h1.973a4 4 0 0 0 3.3-1.7l5.454-8.6a4 4 0 0 1 3.3-1.7H22",key:"1ailkh"}],["path",{d:"M2 6h1.972a4 4 0 0 1 3.6 2.2",key:"km57vx"}],["path",{d:"M22 18h-6.041a4 4 0 0 1-3.3-1.8l-.359-.45",key:"os18l9"}]],O2=Yt("shuffle",I6);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z6=[["path",{d:"M22 2 2 22",key:"y4kqgn"}]],F6=Yt("slash",z6);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P6=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],G6=Yt("sparkles",P6);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j6=[["circle",{cx:"19",cy:"5",r:"2",key:"mhkx31"}],["circle",{cx:"5",cy:"19",r:"2",key:"v8kfzx"}],["path",{d:"M5 17A12 12 0 0 1 17 5",key:"1okkup"}]],aE=Yt("spline",j6);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H6=[["path",{d:"M5 3a2 2 0 0 0-2 2",key:"y57alp"}],["path",{d:"M19 3a2 2 0 0 1 2 2",key:"18rm91"}],["path",{d:"M21 19a2 2 0 0 1-2 2",key:"1j7049"}],["path",{d:"M5 21a2 2 0 0 1-2-2",key:"sbafld"}],["path",{d:"M9 3h1",key:"1yesri"}],["path",{d:"M9 21h1",key:"15o7lz"}],["path",{d:"M14 3h1",key:"1ec4yj"}],["path",{d:"M14 21h1",key:"v9vybs"}],["path",{d:"M3 9v1",key:"1r0deq"}],["path",{d:"M21 9v1",key:"mxsmne"}],["path",{d:"M3 14v1",key:"vnatye"}],["path",{d:"M21 14v1",key:"169vum"}]],sE=Yt("square-dashed",H6);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k6=[["path",{d:"M8 19H5c-1 0-2-1-2-2V7c0-1 1-2 2-2h3",key:"lubmu8"}],["path",{d:"M16 5h3c1 0 2 1 2 2v10c0 1-1 2-2 2h-3",key:"1ag34g"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]],I2=Yt("square-split-horizontal",k6);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V6=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],Mp=Yt("square",V6);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X6=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],Y6=Yt("star",X6);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W6=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],z2=Yt("sun",W6);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q6=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],F2=Yt("target",q6);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J6=[["path",{d:"M12 19h8",key:"baeox8"}],["path",{d:"m4 17 6-6-6-6",key:"1yngyt"}]],Z6=Yt("terminal",J6);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K6=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Nv=Yt("trash-2",K6);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q6=[["path",{d:"M13.73 4a2 2 0 0 0-3.46 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"14u9p9"}]],P_=Yt("triangle",Q6);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $6=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],Om=Yt("type",$6);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eF=[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]],tF=Yt("undo-2",eF);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nF=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],rE=Yt("upload",nF);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iF=[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]],Bv=Yt("waves",iF);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aF=[["circle",{cx:"12",cy:"4.5",r:"2.5",key:"r5ysbb"}],["path",{d:"m10.2 6.3-3.9 3.9",key:"1nzqf6"}],["circle",{cx:"4.5",cy:"12",r:"2.5",key:"jydg6v"}],["path",{d:"M7 12h10",key:"b7w52i"}],["circle",{cx:"19.5",cy:"12",r:"2.5",key:"1piiel"}],["path",{d:"m13.8 17.7 3.9-3.9",key:"1wyg1y"}],["circle",{cx:"12",cy:"19.5",r:"2.5",key:"13o1pw"}]],oE=Yt("waypoints",aF);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sF=[["rect",{width:"8",height:"8",x:"3",y:"3",rx:"2",key:"by2w9f"}],["path",{d:"M7 11v4a2 2 0 0 0 2 2h4",key:"xkn7yn"}],["rect",{width:"8",height:"8",x:"13",y:"13",rx:"2",key:"1cgmvn"}]],P2=Yt("workflow",sF);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rF=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],G_=Yt("x",rF);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oF=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],lF=Yt("zap",oF),j_=["#ef4444","#f97316","#eab308","#22c55e","#06b6d4","#3b82f6","#a855f7","#ec4899","#ffffff"],cF=P_,uF=[{category:"1. GRIS CLARO  Volmenes",desc:"Masa y volumen",colors:[{name:"Gris Muy Claro",hex:"#f5f5f5"},{name:"Gris Claro",hex:"#e6e6e6"},{name:"Gris Clido Claro",hex:"#e8e2dc"},{name:"Gris Neutro Suave",hex:"#e1e1e1"}]},{category:"2. GRIS MEDIO  Sombras",desc:"Forma slida",colors:[{name:"Gris Medio",hex:"#c8c8c8"},{name:"Gris Medio Clido",hex:"#cec6bc"},{name:"Gris 3040%",hex:"#b4b4b4"}]},{category:"3. GRIS OSCURO  Contraste",desc:"Sombras profundas",colors:[{name:"Gris Oscuro",hex:"#828282"},{name:"Gris Muy Oscuro",hex:"#5a5a5a"},{name:"Gris Oscuro Clido",hex:"#6e665f"},{name:"Gris 70%",hex:"#646464"}]},{category:"4. NEGRO  Detalles",desc:"Contornos y lneas",colors:[{name:"Negro trazado",hex:"#000000"},{name:"Negro suave",hex:"#141414"}]},{category:"5. ACENTOS  Vida",desc:"Puntos focales",colors:[{name:"Azul Tcnico Claro",hex:"#add8e6"},{name:"Azul Tcnico Medio",hex:"#6495ed"},{name:"Azul Conceptual",hex:"#4682b4"},{name:"Rojo Claro",hex:"#ff6347"},{name:"Rojo Industrial",hex:"#dc143c"},{name:"Naranja Industrial",hex:"#ff8c00"}]},{category:"6. BLANCO  Highlights",desc:"Brillos y reflejos",colors:[{name:"Blanco puro",hex:"#ffffff"},{name:"Blanco suave",hex:"#fafafa"}]}],lE=[{category:"Sketching (HD)",brushes:[{name:"Realistic Pencil",mode:"draw-tube",width:.6,startWidth:.1,endWidth:.1,color:"#4b5563",intensity:.5,opacity:1,tubularSegments:200,radialSegments:32},{name:"Mechanical 0.5",mode:"draw-tube",width:.15,startWidth:.15,endWidth:.15,color:"#374151",intensity:.6,opacity:1,tubularSegments:200,radialSegments:16},{name:"Soft Charcoal",mode:"draw-tube",width:1.2,startWidth:.4,endWidth:.2,color:"#1f2937",intensity:.4,opacity:1,tubularSegments:128,radialSegments:32}]},{category:"High Def Tubes",brushes:[{name:"Fine Fiber (HD)",mode:"draw-tube",width:.1,startWidth:.1,endWidth:.1,color:"#ffffff",intensity:2,opacity:1,tubularSegments:200,radialSegments:32},{name:"Neon Cable (HD)",mode:"draw-tube",width:.2,startWidth:.2,endWidth:.2,color:"#06b6d4",intensity:3,opacity:1,tubularSegments:200,radialSegments:32},{name:"Smooth Pipe",mode:"draw-tube",width:.8,startWidth:.8,endWidth:.8,color:"#94a3b8",intensity:1,opacity:1,tubularSegments:200,radialSegments:32},{name:"Gold Wire",mode:"draw-tube",width:.15,startWidth:.15,endWidth:.15,color:"#fbbf24",intensity:1.5,opacity:1,tubularSegments:200,radialSegments:16}]},{category:"Variable Flow",brushes:[{name:"Magma Flow",mode:"draw-tube",width:1.5,startWidth:.5,endWidth:2.5,color:"#ef4444",intensity:2,opacity:1,tubularSegments:128,radialSegments:12},{name:"Chrome Snake",mode:"draw-tube",width:1.2,startWidth:1.2,endWidth:.2,color:"#ffffff",intensity:.8,opacity:1,tubularSegments:100,radialSegments:16},{name:"Hyperloop",mode:"draw-tube",width:2,startWidth:2,endWidth:2,color:"rainbow",intensity:1.5,opacity:.9,tubularSegments:128,radialSegments:16},{name:"Vine Taper",mode:"draw-tube",width:1,startWidth:.2,endWidth:1.5,color:"#22c55e",intensity:1,opacity:1,tubularSegments:64,radialSegments:8}]},{category:"Neon & Light",brushes:[{name:"Classic Neon",mode:"draw-spline",width:1.5,color:"#3b82f6",intensity:2,opacity:1},{name:"Cyber Pink",mode:"draw-spline",width:2,color:"#ec4899",intensity:3,opacity:1},{name:"Soft Glow",mode:"draw-spline",width:4,color:"#a855f7",intensity:1,opacity:.4},{name:"High Voltage",mode:"draw-polyline",width:.5,color:"#ffffff",intensity:5,opacity:1}]},{category:"Technical",brushes:[{name:"Blueprint",mode:"draw-polyline",width:.5,color:"#06b6d4",intensity:1,opacity:.8,dashed:!0,dashScale:1,dashRatio:"1:1"},{name:"Warning",mode:"draw-polyline",width:1,color:"#eab308",intensity:1.5,opacity:1,dashed:!0,dashScale:.5,dashRatio:"1:1"},{name:"Grid Line",mode:"draw-polyline",width:.2,color:"#ffffff",intensity:.5,opacity:.3},{name:"Connector",mode:"draw-polyline",width:.8,color:"#22c55e",intensity:1.2,opacity:1,dashed:!0,dashScale:2,dashRatio:"2:1"}]},{category:"Shapes",brushes:[{name:"Filled Rect",mode:"draw-rectangle",width:1,color:"#3b82f6",intensity:1,opacity:.5,filled:!0},{name:"Neon Circle",mode:"draw-circle",width:2,color:"#f97316",intensity:2,opacity:1,filled:!1},{name:"Glass Hex",mode:"draw-hexagon",width:.5,color:"#ffffff",intensity:1,opacity:.2,filled:!0}]}],G2={tools:!0,properties:!0,layers:!0,view:!0,script:!1,brushes:!0,layout:!1,cubes:!1,camera:!1,grid:!1,shapes:!1,annotations:!1,objects:!0,voxelPainter:!1,colorLibrary:!1,modifiers:!1,animation:!1,timeline:!1,materials:!1,export:!1,models:!1,commandLine:!0,symmetry:!1,kokraf:!1},Ra=({title:s,initialPosition:e,children:t,onClose:n,visible:i=!0,className:a=""})=>{const[o,c]=Y.useState(e),[u,h]=Y.useState(!1),m=Y.useRef({x:0,y:0}),x=Y.useRef(null);Y.useEffect(()=>{const b=()=>{c(S=>{const C=Math.max(0,window.innerWidth-50),M=Math.max(0,window.innerHeight-50);let A=S.x,R=S.y;return A>C&&(A=Math.max(0,window.innerWidth-300)),A<0&&(A=0),R>M&&(R=Math.max(0,window.innerHeight-300)),R<0&&(R=0),A!==S.x||R!==S.y?{x:A,y:R}:S})};return b(),window.addEventListener("resize",b),()=>window.removeEventListener("resize",b)},[]);const g=b=>{h(!0),m.current={x:b.clientX-o.x,y:b.clientY-o.y}};return Y.useEffect(()=>{const b=C=>{if(u){const M=C.clientX-m.current.x,A=C.clientY-m.current.y;c({x:Math.max(0,Math.min(window.innerWidth-30,M)),y:Math.max(0,Math.min(window.innerHeight-30,A))})}},S=()=>h(!1);return u&&(window.addEventListener("mousemove",b),window.addEventListener("mouseup",S)),()=>{window.removeEventListener("mousemove",b),window.removeEventListener("mouseup",S)}},[u]),i?y.jsxs("div",{ref:x,className:`absolute flex flex-col bg-[#0a0a0a]/95 backdrop-blur-xl border border-white/10 rounded-xl shadow-2xl pointer-events-auto transition-opacity duration-200 ${a}`,style:{left:o.x,top:o.y,zIndex:u?50:10},children:[y.jsxs("div",{className:"h-8 bg-white/5 border-b border-white/5 flex items-center justify-between px-3 cursor-grab active:cursor-grabbing select-none rounded-t-xl",onMouseDown:g,children:[y.jsxs("div",{className:"flex items-center gap-2 text-white/60 text-xs font-bold uppercase tracking-wider",children:[y.jsx(Pz,{size:14}),s]}),n&&y.jsx("button",{onClick:n,className:"text-white/40 hover:text-red-400 transition-colors",children:y.jsx(G_,{size:14})})]}),y.jsx("div",{className:"p-3 h-full relative",children:t})]}):null},fF=({color:s,setColor:e,width:t,setWidth:n,isDashed:i,setIsDashed:a,dashScale:o,setDashScale:c,dashRatio:u,setDashRatio:h,opacity:m,setOpacity:x,intensity:g,setIntensity:b,tubularSegments:S,setTubularSegments:C,radialSegments:M,setRadialSegments:A,startWidth:R,setStartWidth:N,endWidth:B,setEndWidth:F,filled:U,setFilled:z,mode:P,setMode:L,transformMode:O,setTransformMode:ee,onClear:Q,onUndo:te,onRedo:ne,onDeleteSelected:re,onChangeView:j,lineCount:ae,planePointsCount:J,onResetPlane:ie,hasCustomPlane:se,selectedLineId:I,selectedModelId:W,onFinishPath:fe,isDrawingPath:Z,isViewLocked:me,onToggleViewLock:$,drawingAids:pe,setDrawingAids:ve,layers:ze,activeLayerId:Ge,setActiveLayerId:Fe,onAddLayer:Qe,onDeleteLayer:lt,onToggleLayerVisibility:De,onToggleLayerLock:le,onRenameLayer:Ye,onOffset:Ze,onDuplicate:je,onMirror:He,onToggleCloseLoop:et,onToggleFill:Ne,onSubdivide:st,onReverse:oe,onToggleType:X,onExplode:Ae,selectedLength:Pe,onSave:Ue,onLoad:Be,onImportModel:bt,onExportOBJ:vt,onChamfer:It,onFillet:zt,activePointIndex:qe,onRunScript:We,onCreateCube:ft,customBrushes:ge,onSaveBrush:Ie,onDeleteBrush:ht,onSelectCustomBrush:ye,onExportBrushes:Re,onImportBrushes:pt,cameraFov:Rt,setCameraFov:dt,exposure:Ke,setExposure:Lt,bgColor:Vt,setBgColor:Kt,drawingPlaneMode:on,setDrawingPlaneMode:Gn,gridSettings:En,setGridSettings:li,isGridSelected:qi,onToggleGridSelection:la,onResetGrid:di,annotationText:Qi,setAnnotationText:Mi,objectColor:mn,setObjectColor:jn,objectOpacity:bn,setObjectOpacity:q,objectDensity:he,setObjectDensity:we,objectScale:Je,setObjectScale:ot,onCancel:ct,isWireframe:Ot,setIsWireframe:Dt,onUploadHDRI:Nt,hdriUrl:K,showHdriBackground:be,setShowHdriBackground:xe,showStars:Oe,setShowStars:Me,starSettings:$e,setStarSettings:yt,voxelSize:Mt,setVoxelSize:Ft,symmetrySettings:mt,setSymmetrySettings:Pt,onSetPlaneToSymmetry:en,onApplySymmetryToSelection:Qt,turntableSettings:yn,setTurntableSettings:ln,extrudeDepth:xn,setExtrudeDepth:Un,bevelEnabled:an,setBevelEnabled:Bn,bevelThickness:tn,setBevelThickness:Hn,bevelSize:kn,setBevelSize:hn,bevelSegments:Ni,setBevelSegments:Yn,latheSegments:Wn,setLatheSegments:xi,latheAngle:ki,setLatheAngle:Di,latheAxis:Ga,setLatheAxis:Ka,latheStartAngle:hr,setLatheStartAngle:To,loftDivisions:vs,setLoftDivisions:Nl,loftClosed:dr,setLoftClosed:ys,loftSmooth:da,setLoftSmooth:qs,sweepSteps:ho,setSweepSteps:bs,sweepTwist:ja,setSweepTwist:Or,sweepScale:Ir,setSweepScale:pr,sweepRotation:Ha,setSweepRotation:pa,sweepTaper:gn,setSweepTaper:zr,sweepAlignToPath:_s,setSweepAlignToPath:Ro,revolveSegments:Ns,setRevolveSegments:No,revolveAngle:mr,setRevolveAngle:Js,revolveAxis:Fr,setRevolveAxis:Vi,revolveOffset:Bs,setRevolveOffset:ma,revolveStartAngle:ka,setRevolveStartAngle:xr,revolveCapEnds:Pr,setRevolveCapEnds:Zs,onExtrude:gr,onLathe:xa,onLoft:hc,onSweep:na,onRevolve:Gr,onFlow:Bl,selectedLineIds:jr,onCommand:ga})=>{var su;const[Qa,ca]=Y.useState(""),Ds=V=>{V.preventDefault(),ga==null||ga(Qa),ca("")},[Zo,tu]=Y.useState(!1),[vr,nu]=Y.useState(!0),[zi,Ss]=Y.useState(0),[Bo,iu]=Y.useState(.2),Dl=Y.useRef(null),[qn,Ko]=Y.useState(()=>{const V=localStorage.getItem("neonflow_ui_windows");return V?{...G2,...JSON.parse(V)}:G2});Y.useEffect(()=>{localStorage.setItem("neonflow_ui_windows",JSON.stringify(qn))},[qn]);const fi=V=>Ko(Wt=>({...Wt,[V]:!Wt[V]})),Va=Y.useCallback(()=>{Ko(G2),Ss(V=>V+1)},[]);Y.useEffect(()=>{P==="voxel-paint"&&Ko(V=>({...V,voxelPainter:!0}))},[P]);const[po,kf]=Y.useState("Sketching (HD)"),[dc,mo]=Y.useState(null),[Ks,ua]=Y.useState("presets"),[Qo,xo]=Y.useState(""),[Hr,Do]=Y.useState(`// Acceso a variables: lines, setLines, THREE

const newLines = [...lines];
const layerId = lines.length > 0 ? lines[0].layerId : 'layer-1';

function addLine(points, color = '#ffffff') {
    newLines.push({
        id: THREE.MathUtils.generateUUID(),
        points: points,
        type: 'polyline',
        layerId: layerId, // Usa la capa de la primera linea o default
        color: color,
        width: 0.1,
        opacity: 1
    });
}

// 1. Linea Recta 2D (Roja)
addLine([new THREE.Vector3(-5, 5, 0), new THREE.Vector3(5, 5, 0)], '#ff0000');

// 2. Linea Recta 3D (Verde)
addLine([new THREE.Vector3(-5, 0, 0), new THREE.Vector3(5, 2, 5)], '#00ff00');

// 3. Circulo (Azul)
const circlePoints = [];
const cRadius = 3;
const cSegments = 32;
for(let i=0; i<=cSegments; i++) {
    const theta = (i/cSegments) * Math.PI * 2;
    circlePoints.push(new THREE.Vector3(
        Math.cos(theta) * cRadius,
        Math.sin(theta) * cRadius - 5,
        0
    ));
}
addLine(circlePoints, '#0000ff');

// 4. Cuadrado (Amarillo)
const squarePoints = [
    new THREE.Vector3(-8, -5, 0),
    new THREE.Vector3(-4, -5, 0),
    new THREE.Vector3(-4, -1, 0),
    new THREE.Vector3(-8, -1, 0),
    new THREE.Vector3(-8, -5, 0)
];
addLine(squarePoints, '#ffff00');

// 5. Rectangulo con Cantos Redondos (Magenta)
const rrPoints = [];
const shape = new THREE.Shape();
const x=2, y=-8, w=4, h=4, r=1;
shape.moveTo(x+r, y);
shape.lineTo(x+w-r, y);
shape.quadraticCurveTo(x+w, y, x+w, y+r);
shape.lineTo(x+w, y+h-r);
shape.quadraticCurveTo(x+w, y+h, x+w-r, y+h);
shape.lineTo(x+r, y+h);
shape.quadraticCurveTo(x, y+h, x, y+h-r);
shape.lineTo(x, y+r);
shape.quadraticCurveTo(x, y, x+r, y);
const pts = shape.getPoints(50);
pts.forEach(p => rrPoints.push(new THREE.Vector3(p.x, p.y, 0)));
addLine(rrPoints, '#ff00ff');

// Aplicar cambios
setLines(newLines);`),va=["draw-rectangle","draw-circle","draw-circle-2pt","draw-ellipse","draw-triangle","draw-hexagon","draw-line","draw-star","draw-rhombus","draw-semicircle","draw-quartercircle","draw-teardrop","draw-heart","draw-golden-spiral","draw-golden-rect"].includes(P),$o=P==="draw-tube"||I&&ae>0;Y.useEffect(()=>{qn.kokraf&&P!=="polygonal-modeling"?L("polygonal-modeling"):!qn.kokraf&&P==="polygonal-modeling"&&L("view")},[qn.kokraf]),Y.useEffect(()=>{P==="polygonal-modeling"&&!qn.kokraf&&fi("kokraf")},[P]),Y.useEffect(()=>{const V=Wt=>{document.activeElement instanceof HTMLInputElement||document.activeElement instanceof HTMLTextAreaElement||(Wt.code==="Space"&&(Wt.preventDefault(),nu(Ui=>!Ui)),Wt.code==="Escape"&&(Wt.preventDefault(),ct()),Wt.shiftKey&&Wt.code==="KeyR"&&(Wt.preventDefault(),Va()),(Wt.code==="Delete"||Wt.code==="Backspace")&&(Wt.preventDefault(),re()))};return window.addEventListener("keydown",V),()=>window.removeEventListener("keydown",V)},[ct,Va,re]);const au=V=>{n(V.width),V.color&&e(V.color),V.mode&&L(V.mode),x(V.opacity??1),b(V.intensity??1.5),a(!!V.dashed),V.dashed&&(c(V.dashScale??1),h(V.dashRatio??"1:1")),C(V.tubularSegments??64),A(V.radialSegments??8),N(V.startWidth??V.width),F(V.endWidth??V.width),mo(V.name)},Ul=()=>{Qo.trim()&&(Ie(Qo),xo(""))},Uo=V=>V==="draw"?y.jsx(Tv,{size:12}):V==="draw-spline"?y.jsx(U2,{size:12}):V==="draw-polyline"?y.jsx(_2,{size:12}):V==="draw-tube"?y.jsx(Dm,{size:12}):V==="draw-rectangle"?y.jsx(Mp,{size:12}):V==="draw-circle"?y.jsx(Nm,{size:12}):V==="draw-text"?y.jsx(Om,{size:12}):V==="draw-dimension"?y.jsx(L2,{size:12}):V==="voxel-paint"?y.jsx(w2,{size:12}):y.jsx(Jw,{size:12}),kr=V=>Math.max(20,window.innerHeight-V),Xa=V=>Math.max(20,window.innerWidth-V);return y.jsx("div",{className:"absolute inset-0 pointer-events-none overflow-hidden",children:vr&&y.jsxs(y.Fragment,{children:[y.jsx(Ra,{title:"Project",initialPosition:{x:20,y:20},className:"w-64",children:y.jsxs("div",{className:"flex flex-col gap-3",children:[y.jsxs("div",{className:"flex justify-between items-center",children:[y.jsxs("div",{children:[y.jsx("h1",{className:"text-xl font-bold bg-gradient-to-r from-purple-400 to-pink-600 bg-clip-text text-transparent",children:"NeonFlow"}),y.jsxs("p",{className:"text-white/50 text-[10px]",children:[ae," ",ae===1?"stroke":"strokes"]})]}),y.jsxs("div",{className:"flex gap-1",children:[y.jsx("button",{onClick:Ue,className:"p-2 hover:bg-white/10 rounded text-white/70 hover:text-green-400",title:"Save JSON",children:y.jsx(N6,{size:16})}),y.jsx("button",{onClick:Be,className:"p-2 hover:bg-white/10 rounded text-white/70 hover:text-blue-400",title:"Load JSON",children:y.jsx(Lz,{size:16})}),y.jsx("button",{onClick:bt,className:"p-2 hover:bg-white/10 rounded text-white/70 hover:text-purple-400",title:"Import Model",children:y.jsx(rE,{size:16})}),y.jsx("button",{onClick:vt,className:"p-2 hover:bg-white/10 rounded text-white/70 hover:text-orange-400",title:"Export OBJ",children:y.jsx(kc,{size:16})})]})]}),y.jsx("div",{className:"h-px bg-white/10"}),y.jsxs("div",{className:"flex justify-between items-center",children:[y.jsxs("div",{className:"flex gap-1",children:[y.jsx("button",{onClick:te,className:"p-2 hover:bg-white/10 rounded text-white/70",title:"Undo",children:y.jsx(tF,{size:16})}),y.jsx("button",{onClick:ne,className:"p-2 hover:bg-white/10 rounded text-white/70",title:"Redo",children:y.jsx(v6,{size:16})}),y.jsx("button",{onClick:Q,className:"p-2 hover:bg-white/10 rounded text-red-400 hover:bg-red-500/10",title:"Clear All",children:y.jsx(Nv,{size:16})}),y.jsx("button",{onClick:Va,className:"p-2 hover:bg-white/10 rounded text-yellow-400 hover:bg-yellow-500/10",title:"Reset Layout (Rescue Windows)",children:y.jsx(Ww,{size:16})})]}),y.jsx("div",{className:"relative",children:y.jsx("button",{onClick:()=>fi("layout"),className:`flex items-center gap-2 px-3 py-1.5 rounded-lg border transition-all ${qn.layout?"bg-white/20 border-white text-white":"border-white/10 text-white/60 hover:text-white"}`,title:"Interface Layout",children:y.jsx(Wz,{size:14})})})]}),se&&y.jsxs("div",{className:"flex items-center justify-between text-green-400 text-[10px] font-mono bg-green-900/20 px-2 py-1 rounded border border-green-500/30",children:[y.jsx("span",{children:"Custom Plane Active"}),y.jsx("button",{onClick:ie,className:"hover:text-white",children:y.jsx(G_,{size:10})})]})]})},`project-${zi}`),y.jsx(Ra,{title:"Show Windows",visible:qn.layout,onClose:()=>fi("layout"),initialPosition:{x:window.innerWidth/2-96,y:window.innerHeight/2-140},className:"w-48",children:y.jsxs("div",{className:"flex flex-col gap-1",children:[[{k:"tools",l:"Tools",i:y.jsx(Tv,{size:12})},{k:"voxelPainter",l:"Voxel Painter",i:y.jsx(w2,{size:12})},{k:"modifiers",l:"Modifiers",i:y.jsx(Bm,{size:12})},{k:"animation",l:"Animation",i:y.jsx(Ap,{size:12})},{k:"timeline",l:"Timeline",i:y.jsx(wv,{size:12})},{k:"materials",l:"Materials",i:y.jsx(Ev,{size:12})},{k:"models",l:"3D Models",i:y.jsx(kc,{size:12})},{k:"export",l:"Export Scene",i:y.jsx(Ih,{size:12})},{k:"colorLibrary",l:"Color Library",i:y.jsx($I,{size:12})},{k:"shapes",l:"Shapes",i:y.jsx(Mp,{size:12})},{k:"annotations",l:"Annotations",i:y.jsx(Om,{size:12})},{k:"objects",l:"Objects",i:y.jsx(R2,{size:12})},{k:"properties",l:"Properties",i:y.jsx(u6,{size:12})},{k:"grid",l:"Grid Settings",i:y.jsx(Sp,{size:12})},{k:"cubes",l:"Cube Gen",i:y.jsx(kc,{size:12})},{k:"camera",l:"Camera & Render",i:y.jsx(Zw,{size:12})},{k:"symmetry",l:"Symmetry",i:y.jsx(I2,{size:12})},{k:"layers",l:"Layers",i:y.jsx(uT,{size:12})},{k:"view",l:"View & Aid",i:y.jsx(B2,{size:12})},{k:"script",l:"Script Editor",i:y.jsx(C2,{size:12})},{k:"brushes",l:"Brush Studio",i:y.jsx(Jw,{size:12})},{k:"commandLine",l:"Command Line",i:y.jsx(Z6,{size:12})},{k:"kokraf",l:"Polygonal Modeling",i:y.jsx(N2,{size:12})}].map(V=>y.jsxs("button",{onClick:()=>fi(V.k),className:`flex items-center justify-between px-2 py-1.5 rounded text-xs hover:bg-white/10 border ${qn[V.k]?"border-green-500/30 bg-green-500/10 text-white":"border-transparent text-white/40"}`,children:[y.jsxs("div",{className:"flex items-center gap-2",children:[V.i," ",V.l]}),qn[V.k]&&y.jsx(Mv,{size:10,className:"text-green-400"})]},V.k)),y.jsx("div",{className:"h-px bg-white/10 my-1"}),y.jsxs("button",{onClick:Va,className:"text-xs text-yellow-400 hover:text-white py-1 text-center hover:bg-white/5 rounded transition-colors flex items-center justify-center gap-2",children:[y.jsx(Ww,{size:12})," Reset Layout (Shift+R)"]})]})},`layout-${zi}`),y.jsx(Ra,{title:"Modifiers",visible:qn.modifiers,onClose:()=>fi("modifiers"),initialPosition:{x:Xa(500),y:350},className:"w-56",children:y.jsxs("div",{className:"flex flex-col gap-3 max-h-[500px] overflow-y-auto pr-1 scrollbar-thin scrollbar-thumb-white/20 scrollbar-track-transparent hover:scrollbar-thumb-white/30",children:[y.jsxs("div",{className:"flex flex-col gap-2 p-2 bg-white/5 rounded border border-white/5",children:[y.jsxs("span",{className:"text-[10px] text-white/40 font-bold uppercase flex items-center gap-1",children:[y.jsx(kc,{size:10})," Extrude Generator"]}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("span",{className:"text-[9px] text-white/50 w-12",children:"Depth"}),y.jsx("input",{type:"range",min:"0.1",max:"10",step:"0.1",value:xn,onChange:V=>Un(parseFloat(V.target.value)),className:"flex-1 h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-blue-500"}),y.jsx("span",{className:"text-[9px] text-white/50 w-8",children:xn.toFixed(1)})]}),y.jsxs("div",{className:"flex justify-between items-center bg-white/5 px-2 py-1 rounded",children:[y.jsx("span",{className:"text-[9px] text-white/50",children:"Bevel"}),y.jsx("button",{onClick:()=>Bn(!an),className:`w-8 h-4 rounded-full relative transition-colors ${an?"bg-blue-600":"bg-white/20"}`,children:y.jsx("div",{className:`absolute top-0.5 left-0.5 w-3 h-3 bg-white rounded-full transition-transform ${an?"translate-x-4":"translate-x-0"}`})})]}),an&&y.jsxs("div",{className:"flex flex-col gap-1 pl-2 border-l-2 border-blue-500/30",children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("span",{className:"text-[8px] text-white/40 w-12",children:"Thick"}),y.jsx("input",{type:"range",min:"0.01",max:"1",step:"0.01",value:tn,onChange:V=>Hn(parseFloat(V.target.value)),className:"flex-1 h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-blue-400"}),y.jsx("span",{className:"text-[8px] text-white/40 w-8",children:tn.toFixed(2)})]}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("span",{className:"text-[8px] text-white/40 w-12",children:"Size"}),y.jsx("input",{type:"range",min:"0.01",max:"1",step:"0.01",value:kn,onChange:V=>hn(parseFloat(V.target.value)),className:"flex-1 h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-blue-400"}),y.jsx("span",{className:"text-[8px] text-white/40 w-8",children:kn.toFixed(2)})]}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("span",{className:"text-[8px] text-white/40 w-12",children:"Segs"}),y.jsx("input",{type:"range",min:"1",max:"10",step:"1",value:Ni,onChange:V=>Yn(parseInt(V.target.value)),className:"flex-1 h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-blue-400"}),y.jsx("span",{className:"text-[8px] text-white/40 w-8",children:Ni})]})]}),y.jsxs("button",{onClick:gr,className:"w-full py-1.5 bg-blue-600/20 hover:bg-blue-600/40 text-blue-300 rounded text-[10px] border border-blue-500/30 transition-colors flex items-center justify-center gap-1",children:[y.jsx(M2,{size:12})," Extrude Shape"]})]}),y.jsxs("div",{className:"flex flex-col gap-2 p-2 bg-white/5 rounded border border-white/5",children:[y.jsxs("span",{className:"text-[10px] text-white/40 font-bold uppercase flex items-center gap-1",children:[y.jsx(Dm,{size:10})," Lathe Generator"]}),y.jsxs("div",{className:"flex gap-2",children:[y.jsxs("div",{className:"flex flex-col flex-1",children:[y.jsx("span",{className:"text-[9px] text-white/50 mb-0.5",children:"Segs"}),y.jsx("input",{type:"number",min:"3",max:"128",value:Wn,onChange:V=>xi(parseInt(V.target.value)),className:"w-full bg-black/30 border border-white/10 rounded px-1 py-0.5 text-[10px] text-white focus:outline-none",onKeyDown:V=>V.stopPropagation()})]}),y.jsxs("div",{className:"flex flex-col flex-1",children:[y.jsx("span",{className:"text-[9px] text-white/50 mb-0.5",children:"Sweep"}),y.jsx("input",{type:"number",min:"0",max:"360",value:ki,onChange:V=>Di(parseFloat(V.target.value)),className:"w-full bg-black/30 border border-white/10 rounded px-1 py-0.5 text-[10px] text-white focus:outline-none",onKeyDown:V=>V.stopPropagation()})]})]}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("span",{className:"text-[9px] text-white/50 w-12",children:"Start"}),y.jsx("input",{type:"range",min:"0",max:"360",step:"1",value:hr,onChange:V=>To(parseFloat(V.target.value)),className:"flex-1 h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-purple-500"}),y.jsxs("span",{className:"text-[9px] text-white/50 w-8",children:[hr,""]})]}),y.jsx("div",{className:"flex gap-1 mt-1",children:["x","y","z"].map(V=>y.jsx("button",{onClick:()=>Ka(V),className:`flex-1 py-1 rounded text-[9px] uppercase border transition-colors ${Ga===V?"bg-white/20 border-white text-white font-bold":"border-transparent text-white/40 hover:bg-white/5"}`,children:V},V))}),y.jsxs("button",{onClick:xa,className:"w-full py-1.5 bg-purple-600/20 hover:bg-purple-600/40 text-purple-300 rounded text-[10px] border border-purple-500/30 transition-colors flex items-center justify-center gap-1",children:[y.jsx(Um,{size:12})," Lathe Profile"]})]}),y.jsxs("div",{className:"flex flex-col gap-2 p-2 bg-white/5 rounded border border-white/5",children:[y.jsxs("span",{className:"text-[10px] text-white/40 font-bold uppercase flex items-center gap-1",children:[y.jsx(aE,{size:10})," Loft Generator"]}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("span",{className:"text-[9px] text-white/50 w-12",children:"Divs"}),y.jsx("input",{type:"range",min:"10",max:"200",step:"10",value:vs,onChange:V=>Nl(parseInt(V.target.value)),className:"flex-1 h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-pink-500"}),y.jsx("span",{className:"text-[9px] text-white/50 w-8",children:vs})]}),y.jsxs("div",{className:"flex gap-2",children:[y.jsxs("div",{className:"flex justify-between items-center flex-1 bg-white/5 px-2 py-1 rounded",children:[y.jsx("span",{className:"text-[8px] text-white/50",children:"Closed"}),y.jsx("button",{onClick:()=>ys(!dr),className:`w-6 h-3 rounded-full relative transition-colors ${dr?"bg-pink-600":"bg-white/20"}`,children:y.jsx("div",{className:`absolute top-0.5 left-0.5 w-2 h-2 bg-white rounded-full transition-transform ${dr?"translate-x-3":"translate-x-0"}`})})]}),y.jsxs("div",{className:"flex justify-between items-center flex-1 bg-white/5 px-2 py-1 rounded",children:[y.jsx("span",{className:"text-[8px] text-white/50",children:"Smooth"}),y.jsx("button",{onClick:()=>qs(!da),className:`w-6 h-3 rounded-full relative transition-colors ${da?"bg-pink-600":"bg-white/20"}`,children:y.jsx("div",{className:`absolute top-0.5 left-0.5 w-2 h-2 bg-white rounded-full transition-transform ${da?"translate-x-3":"translate-x-0"}`})})]})]}),y.jsx("div",{className:"text-[9px] text-white/50 italic text-center",children:"Select 2+ shapes  Order matters"}),y.jsxs("button",{onClick:hc,className:"w-full py-1.5 bg-pink-600/20 hover:bg-pink-600/40 text-pink-300 rounded text-[10px] border border-pink-500/30 transition-colors flex items-center justify-center gap-1",children:[y.jsx(Bv,{size:12})," Create Loft"]})]}),y.jsxs("div",{className:"flex flex-col gap-2 p-2 bg-white/5 rounded border border-white/5",children:[y.jsxs("span",{className:"text-[10px] text-white/40 font-bold uppercase flex items-center gap-1",children:[y.jsx(Bv,{size:10})," Sweep (Barrido)"]}),y.jsxs("div",{className:"flex gap-2",children:[y.jsxs("div",{className:"flex flex-col flex-1",children:[y.jsx("span",{className:"text-[9px] text-white/50 mb-0.5",children:"Steps"}),y.jsx("input",{type:"number",min:"10",max:"200",value:ho,onChange:V=>bs(parseInt(V.target.value)),className:"w-full bg-black/30 border border-white/10 rounded px-1 py-0.5 text-[10px] text-white focus:outline-none",onKeyDown:V=>V.stopPropagation()})]}),y.jsxs("div",{className:"flex flex-col flex-1",children:[y.jsx("span",{className:"text-[9px] text-white/50 mb-0.5",children:"Twist"}),y.jsx("input",{type:"number",min:"-360",max:"360",value:ja,onChange:V=>Or(parseFloat(V.target.value)),className:"w-full bg-black/30 border border-white/10 rounded px-1 py-0.5 text-[10px] text-white focus:outline-none",onKeyDown:V=>V.stopPropagation()})]})]}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("span",{className:"text-[9px] text-white/50 w-10",children:"Scale"}),y.jsx("input",{type:"range",min:"0.1",max:"3",step:"0.1",value:Ir,onChange:V=>pr(parseFloat(V.target.value)),className:"flex-1 h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-orange-500"}),y.jsx("span",{className:"text-[9px] text-white/50 w-8",children:Ir.toFixed(1)})]}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("span",{className:"text-[9px] text-white/50 w-10",children:"Rot"}),y.jsx("input",{type:"range",min:"0",max:"360",step:"1",value:Ha,onChange:V=>pa(parseFloat(V.target.value)),className:"flex-1 h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-orange-400"}),y.jsxs("span",{className:"text-[9px] text-white/50 w-8",children:[Ha,""]})]}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("span",{className:"text-[9px] text-white/50 w-10",children:"Taper"}),y.jsx("input",{type:"range",min:"0",max:"1",step:"0.05",value:gn,onChange:V=>zr(parseFloat(V.target.value)),className:"flex-1 h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-orange-400"}),y.jsx("span",{className:"text-[9px] text-white/50 w-8",children:gn.toFixed(2)})]}),y.jsxs("div",{className:"flex justify-between items-center bg-white/5 px-2 py-1 rounded",children:[y.jsx("span",{className:"text-[8px] text-white/50",children:"Align to Path"}),y.jsx("button",{onClick:()=>Ro(!_s),className:`w-6 h-3 rounded-full relative transition-colors ${_s?"bg-orange-600":"bg-white/20"}`,children:y.jsx("div",{className:`absolute top-0.5 left-0.5 w-2 h-2 bg-white rounded-full transition-transform ${_s?"translate-x-3":"translate-x-0"}`})})]}),y.jsx("div",{className:"text-[9px] text-white/50 italic text-center",children:"Profile + Shift+Click Path"}),y.jsxs("button",{onClick:na,className:"w-full py-1.5 bg-orange-600/20 hover:bg-orange-600/40 text-orange-300 rounded text-[10px] border border-orange-500/30 transition-colors flex items-center justify-center gap-1",children:[y.jsx(P2,{size:12})," Sweep Along Path"]})]}),y.jsxs("div",{className:"flex flex-col gap-2 p-2 bg-white/5 rounded border border-white/5",children:[y.jsxs("span",{className:"text-[10px] text-white/40 font-bold uppercase flex items-center gap-1",children:[y.jsx(Lm,{size:10})," Revolve (Enhanced)"]}),y.jsxs("div",{className:"flex gap-2",children:[y.jsxs("div",{className:"flex flex-col flex-1",children:[y.jsx("span",{className:"text-[9px] text-white/50 mb-0.5",children:"Segs"}),y.jsx("input",{type:"number",min:"3",max:"128",value:Ns,onChange:V=>No(parseInt(V.target.value)),className:"w-full bg-black/30 border border-white/10 rounded px-1 py-0.5 text-[10px] text-white focus:outline-none",onKeyDown:V=>V.stopPropagation()})]}),y.jsxs("div",{className:"flex flex-col flex-1",children:[y.jsx("span",{className:"text-[9px] text-white/50 mb-0.5",children:"Sweep"}),y.jsx("input",{type:"number",min:"0",max:"360",value:mr,onChange:V=>Js(parseFloat(V.target.value)),className:"w-full bg-black/30 border border-white/10 rounded px-1 py-0.5 text-[10px] text-white focus:outline-none",onKeyDown:V=>V.stopPropagation()})]})]}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("span",{className:"text-[9px] text-white/50 w-12",children:"Offset"}),y.jsx("input",{type:"range",min:"0",max:"5",step:"0.1",value:Bs,onChange:V=>ma(parseFloat(V.target.value)),className:"flex-1 h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-cyan-500"}),y.jsx("span",{className:"text-[9px] text-white/50 w-8",children:Bs.toFixed(1)})]}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("span",{className:"text-[9px] text-white/50 w-12",children:"Start"}),y.jsx("input",{type:"range",min:"0",max:"360",step:"1",value:ka,onChange:V=>xr(parseFloat(V.target.value)),className:"flex-1 h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-cyan-400"}),y.jsxs("span",{className:"text-[9px] text-white/50 w-8",children:[ka,""]})]}),y.jsx("div",{className:"flex gap-1 mt-1",children:["x","y","z"].map(V=>y.jsx("button",{onClick:()=>Vi(V),className:`flex-1 py-1 rounded text-[9px] uppercase border transition-colors ${Fr===V?"bg-white/20 border-white text-white font-bold":"border-transparent text-white/40 hover:bg-white/5"}`,children:V},V))}),y.jsxs("div",{className:"flex justify-between items-center bg-white/5 px-2 py-1 rounded",children:[y.jsx("span",{className:"text-[8px] text-white/50",children:"Cap Ends"}),y.jsx("button",{onClick:()=>Zs(!Pr),className:`w-6 h-3 rounded-full relative transition-colors ${Pr?"bg-cyan-600":"bg-white/20"}`,children:y.jsx("div",{className:`absolute top-0.5 left-0.5 w-2 h-2 bg-white rounded-full transition-transform ${Pr?"translate-x-3":"translate-x-0"}`})})]}),y.jsxs("button",{onClick:Gr,className:"w-full py-1.5 bg-cyan-600/20 hover:bg-cyan-600/40 text-cyan-300 rounded text-[10px] border border-cyan-500/30 transition-colors flex items-center justify-center gap-1",children:[y.jsx(Um,{size:12})," Revolve Profile"]})]}),y.jsxs("div",{className:"flex flex-col gap-2 p-2 bg-white/5 rounded border border-white/5",children:[y.jsxs("span",{className:"text-[10px] text-white/40 font-bold uppercase flex items-center gap-1",children:[y.jsx(P2,{size:10})," Flow (Legacy)"]}),y.jsxs("div",{className:"text-[9px] text-white/50 italic",children:["1. Select Shape (Profile)",y.jsx("br",{}),"2. Shift+Select Path (Line)"]}),y.jsxs("button",{onClick:Bl,className:"w-full py-1.5 bg-green-600/20 hover:bg-green-600/40 text-green-300 rounded text-[10px] border border-green-500/30 transition-colors flex items-center justify-center gap-1",children:[y.jsx(Bv,{size:12})," Flow Along Path"]})]})]})},`modifiers-${zi}`),y.jsx(Ra,{title:"Animation Tools",visible:qn.animation,onClose:()=>fi("animation"),initialPosition:{x:Xa(750),y:100},className:"w-64",children:y.jsxs("div",{className:"flex flex-col gap-3 max-h-[500px] overflow-y-auto pr-1 scrollbar-thin scrollbar-thumb-white/20 scrollbar-track-transparent hover:scrollbar-thumb-white/30",children:[y.jsxs("div",{className:"flex flex-col gap-2 p-2 bg-white/5 rounded border border-white/5",children:[y.jsxs("span",{className:"text-[10px] text-white/40 font-bold uppercase flex items-center gap-1",children:[y.jsx(Ap,{size:10})," Keyframe Animation"]}),y.jsxs("div",{className:"flex gap-2",children:[y.jsx("button",{className:"flex-1 py-1.5 bg-green-600/20 hover:bg-green-600/40 text-green-300 rounded text-[9px] border border-green-500/30 transition-colors",children:"Set Key"}),y.jsx("button",{className:"flex-1 py-1.5 bg-red-600/20 hover:bg-red-600/40 text-red-300 rounded text-[9px] border border-red-500/30 transition-colors",children:"Clear"})]}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("span",{className:"text-[9px] text-white/50 w-12",children:"Frame"}),y.jsx("input",{type:"number",min:"0",max:"1000",defaultValue:"0",className:"flex-1 bg-black/30 border border-white/10 rounded px-1 py-0.5 text-[10px] text-white focus:outline-none",onKeyDown:V=>V.stopPropagation()})]})]}),y.jsxs("div",{className:"flex flex-col gap-2 p-2 bg-white/5 rounded border border-white/5",children:[y.jsxs("span",{className:"text-[10px] text-white/40 font-bold uppercase flex items-center gap-1",children:[y.jsx(U2,{size:10})," Path Animation"]}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("span",{className:"text-[9px] text-white/50 w-12",children:"Duration"}),y.jsx("input",{type:"range",min:"1",max:"10",step:"0.5",defaultValue:"3",className:"flex-1 h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-blue-500"}),y.jsx("span",{className:"text-[9px] text-white/50 w-8",children:"3s"})]}),y.jsxs("div",{className:"flex justify-between items-center bg-white/5 px-2 py-1 rounded",children:[y.jsx("span",{className:"text-[8px] text-white/50",children:"Loop"}),y.jsx("button",{className:"w-6 h-3 rounded-full relative transition-colors bg-white/20",children:y.jsx("div",{className:"absolute top-0.5 left-0.5 w-2 h-2 bg-white rounded-full transition-transform translate-x-0"})})]}),y.jsx("button",{className:"w-full py-1.5 bg-blue-600/20 hover:bg-blue-600/40 text-blue-300 rounded text-[10px] border border-blue-500/30 transition-colors",children:"Animate Along Path"})]}),y.jsxs("div",{className:"flex flex-col gap-2 p-2 bg-white/5 rounded border border-white/5",children:[y.jsxs("span",{className:"text-[10px] text-white/40 font-bold uppercase flex items-center gap-1",children:[y.jsx(Lm,{size:10})," Rotation"]}),y.jsxs("div",{className:"flex gap-2",children:[y.jsxs("div",{className:"flex flex-col flex-1",children:[y.jsx("span",{className:"text-[9px] text-white/50 mb-0.5",children:"Speed"}),y.jsx("input",{type:"number",min:"0",max:"360",step:"10",defaultValue:"45",className:"w-full bg-black/30 border border-white/10 rounded px-1 py-0.5 text-[10px] text-white focus:outline-none",onKeyDown:V=>V.stopPropagation()})]}),y.jsxs("div",{className:"flex flex-col flex-1",children:[y.jsx("span",{className:"text-[9px] text-white/50 mb-0.5",children:"Axis"}),y.jsxs("select",{className:"w-full bg-black/30 border border-white/10 rounded px-1 py-0.5 text-[10px] text-white focus:outline-none",children:[y.jsx("option",{children:"Y"}),y.jsx("option",{children:"X"}),y.jsx("option",{children:"Z"})]})]})]}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("span",{className:"text-[9px] text-white/50 w-12",children:"From"}),y.jsx("input",{type:"range",min:"0.1",max:"3",step:"0.1",defaultValue:"1",className:"flex-1 h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-orange-500"}),y.jsx("span",{className:"text-[9px] text-white/50 w-8",children:"1.0"})]}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("span",{className:"text-[9px] text-white/50 w-12",children:"To"}),y.jsx("input",{type:"range",min:"0.1",max:"3",step:"0.1",defaultValue:"2",className:"flex-1 h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-orange-500"}),y.jsx("span",{className:"text-[9px] text-white/50 w-8",children:"2.0"})]}),y.jsx("button",{className:"w-full py-1.5 bg-orange-600/20 hover:bg-orange-600/40 text-orange-300 rounded text-[10px] border border-orange-500/30 transition-colors",children:"Animate Scale"})]}),y.jsxs("div",{className:"flex flex-col gap-2 p-2 bg-white/5 rounded border border-white/5",children:[y.jsxs("span",{className:"text-[10px] text-white/40 font-bold uppercase flex items-center gap-1",children:[y.jsx(P2,{size:10})," Morph / Blend"]}),y.jsx("div",{className:"text-[9px] text-white/50 italic text-center",children:"Select 2 shapes to morph"}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("span",{className:"text-[9px] text-white/50 w-12",children:"Steps"}),y.jsx("input",{type:"range",min:"10",max:"100",step:"10",defaultValue:"30",className:"flex-1 h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-pink-500"}),y.jsx("span",{className:"text-[9px] text-white/50 w-8",children:"30"})]}),y.jsx("button",{className:"w-full py-1.5 bg-pink-600/20 hover:bg-pink-600/40 text-pink-300 rounded text-[10px] border border-pink-500/30 transition-colors",children:"Create Morph"})]}),y.jsxs("div",{className:"flex flex-col gap-2 p-2 bg-white/5 rounded border border-white/5",children:[y.jsxs("span",{className:"text-[10px] text-white/40 font-bold uppercase flex items-center gap-1",children:[y.jsx(_2,{size:10})," Easing"]}),y.jsxs("select",{className:"w-full bg-black/30 border border-white/10 rounded px-2 py-1 text-[10px] text-white focus:outline-none",children:[y.jsx("option",{children:"Linear"}),y.jsx("option",{children:"Ease In"}),y.jsx("option",{children:"Ease Out"}),y.jsx("option",{children:"Ease In-Out"}),y.jsx("option",{children:"Bounce"}),y.jsx("option",{children:"Elastic"}),y.jsx("option",{children:"Back"})]})]}),y.jsxs("div",{className:"flex flex-col gap-2 p-2 bg-white/5 rounded border border-white/5",children:[y.jsxs("span",{className:"text-[10px] text-white/40 font-bold uppercase flex items-center gap-1",children:[y.jsx(wv,{size:10})," Timeline"]}),y.jsxs("div",{className:"flex gap-1",children:[y.jsx("button",{className:"flex-1 py-1 bg-white/10 hover:bg-white/20 text-white rounded text-[9px] transition-colors",children:y.jsx(Ap,{size:12,className:"mx-auto"})}),y.jsx("button",{className:"flex-1 py-1 bg-white/10 hover:bg-white/20 text-white rounded text-[9px] transition-colors",children:y.jsx(D2,{size:12,className:"mx-auto"})}),y.jsx("button",{className:"flex-1 py-1 bg-white/10 hover:bg-white/20 text-white rounded text-[9px] transition-colors",children:y.jsx(E2,{size:12,className:"mx-auto"})})]}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("span",{className:"text-[9px] text-white/50 w-12",children:"FPS"}),y.jsxs("select",{className:"flex-1 bg-black/30 border border-white/10 rounded px-1 py-0.5 text-[10px] text-white focus:outline-none",children:[y.jsx("option",{children:"24"}),y.jsx("option",{children:"30"}),y.jsx("option",{selected:!0,children:"60"})]})]})]}),y.jsxs("div",{className:"flex flex-col gap-2 p-2 bg-white/5 rounded border border-white/5",children:[y.jsxs("span",{className:"text-[10px] text-white/40 font-bold uppercase flex items-center gap-1",children:[y.jsx(Ih,{size:10})," Export"]}),y.jsx("button",{className:"w-full py-1.5 bg-teal-600/20 hover:bg-teal-600/40 text-teal-300 rounded text-[10px] border border-teal-500/30 transition-colors",children:"Export Animation (GIF)"}),y.jsx("button",{className:"w-full py-1.5 bg-teal-600/20 hover:bg-teal-600/40 text-teal-300 rounded text-[10px] border border-teal-500/30 transition-colors",children:"Export as Video (MP4)"})]})]})},`animation-${zi}`),y.jsx(Ra,{title:"Timeline",visible:qn.timeline,onClose:()=>fi("timeline"),initialPosition:{x:20,y:kr(220)},className:"w-[calc(100vw-40px)]",children:y.jsxs("div",{className:"flex flex-col gap-2",children:[y.jsxs("div",{className:"flex items-center gap-3 p-2 bg-white/5 rounded border border-white/5",children:[y.jsxs("div",{className:"flex gap-1",children:[y.jsx("button",{className:"p-1.5 bg-white/10 hover:bg-white/20 text-white rounded transition-colors",title:"First Frame",children:y.jsx(qw,{size:14,className:"rotate-180"})}),y.jsx("button",{className:"p-1.5 bg-white/10 hover:bg-white/20 text-white rounded transition-colors",title:"Previous Frame",children:y.jsx(S2,{size:14,className:"rotate-180"})}),y.jsx("button",{className:"p-1.5 bg-green-600/30 hover:bg-green-600/50 text-green-300 rounded transition-colors",title:"Play",children:y.jsx(Ap,{size:14})}),y.jsx("button",{className:"p-1.5 bg-white/10 hover:bg-white/20 text-white rounded transition-colors",title:"Pause",children:y.jsx(D2,{size:14})}),y.jsx("button",{className:"p-1.5 bg-red-600/30 hover:bg-red-600/50 text-red-300 rounded transition-colors",title:"Stop",children:y.jsx(E2,{size:14})}),y.jsx("button",{className:"p-1.5 bg-white/10 hover:bg-white/20 text-white rounded transition-colors",title:"Next Frame",children:y.jsx(A2,{size:14})}),y.jsx("button",{className:"p-1.5 bg-white/10 hover:bg-white/20 text-white rounded transition-colors",title:"Last Frame",children:y.jsx(M2,{size:14,className:"rotate-180"})})]}),y.jsx("div",{className:"h-6 w-px bg-white/10"}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("span",{className:"text-[9px] text-white/50",children:"Frame:"}),y.jsx("input",{type:"number",min:"0",max:"1000",defaultValue:"0",className:"w-16 bg-black/30 border border-white/10 rounded px-1 py-0.5 text-[10px] text-white focus:outline-none",onKeyDown:V=>V.stopPropagation()}),y.jsx("span",{className:"text-[9px] text-white/50",children:"/"}),y.jsx("input",{type:"number",min:"1",max:"10000",defaultValue:"300",className:"w-16 bg-black/30 border border-white/10 rounded px-1 py-0.5 text-[10px] text-white focus:outline-none",onKeyDown:V=>V.stopPropagation()})]}),y.jsx("div",{className:"h-6 w-px bg-white/10"}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("span",{className:"text-[9px] text-white/50",children:"FPS:"}),y.jsxs("select",{className:"bg-black/30 border border-white/10 rounded px-1 py-0.5 text-[10px] text-white focus:outline-none",children:[y.jsx("option",{children:"24"}),y.jsx("option",{children:"30"}),y.jsx("option",{selected:!0,children:"60"})]})]}),y.jsx("div",{className:"h-6 w-px bg-white/10"}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("button",{className:"p-1.5 bg-blue-600/30 hover:bg-blue-600/50 text-blue-300 rounded transition-colors",title:"Add Keyframe",children:y.jsx(eE,{size:14})}),y.jsx("button",{className:"p-1.5 bg-orange-600/30 hover:bg-orange-600/50 text-orange-300 rounded transition-colors",title:"Delete Keyframe",children:y.jsx(Nv,{size:14})})]}),y.jsx("div",{className:"flex-1"}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("span",{className:"text-[9px] text-white/50",children:"Zoom:"}),y.jsx("input",{type:"range",min:"10",max:"200",defaultValue:"100",className:"w-24 h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-teal-500"})]})]}),y.jsxs("div",{className:"flex flex-col gap-1 bg-white/5 rounded border border-white/5 p-2 max-h-[120px] overflow-y-auto scrollbar-thin scrollbar-thumb-white/20 scrollbar-track-transparent",children:[y.jsxs("div",{className:"flex gap-2 mb-1",children:[y.jsx("div",{className:"w-32 text-[9px] text-white/40 font-bold uppercase",children:"Layers"}),y.jsxs("div",{className:"flex-1 relative h-6 bg-black/30 rounded",children:[y.jsx("div",{className:"absolute inset-0 flex",children:Array.from({length:31}).map((V,Wt)=>y.jsx("div",{className:"flex-1 border-l border-white/10 relative",children:Wt%5===0&&y.jsx("span",{className:"absolute -top-3 left-0 text-[8px] text-white/30",children:Wt*10})},Wt))}),y.jsx("div",{className:"absolute top-0 left-0 w-0.5 h-full bg-red-500 z-10",style:{left:"0%"},children:y.jsx("div",{className:"absolute -top-1 -left-1 w-2 h-2 bg-red-500 rounded-full"})})]})]}),["Camera","Object 1","Object 2","Light"].map((V,Wt)=>y.jsxs("div",{className:"flex gap-2 items-center",children:[y.jsxs("div",{className:"w-32 flex items-center gap-1",children:[y.jsx("button",{className:"p-0.5 hover:bg-white/10 rounded",children:y.jsx(zh,{size:10,className:"text-white/50"})}),y.jsx("button",{className:"p-0.5 hover:bg-white/10 rounded",children:y.jsx(Cv,{size:10,className:"text-white/50"})}),y.jsx("span",{className:"text-[9px] text-white/70 truncate flex-1",children:V})]}),y.jsx("div",{className:"flex-1 relative h-6 bg-black/20 rounded border border-white/5",children:[15,45,75,120].map((Ui,Ji)=>y.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 w-2 h-2 bg-blue-500 rounded-sm",style:{left:`${Ui/300*100}%`}},Ji))})]},Wt))]}),y.jsxs("div",{className:"flex items-center gap-2 p-2 bg-white/5 rounded border border-white/5",children:[y.jsx("span",{className:"text-[9px] text-white/50 w-16",children:"Time:"}),y.jsxs("div",{className:"flex-1 relative h-2 bg-black/30 rounded cursor-pointer group",children:[y.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-teal-600/30 to-blue-600/30 rounded",style:{width:"0%"}}),y.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 w-3 h-3 bg-teal-500 rounded-full shadow-lg group-hover:scale-125 transition-transform",style:{left:"0%"}})]}),y.jsx("span",{className:"text-[9px] text-white/50 w-16 text-right",children:"00:00.00"})]})]})},`timeline-${zi}`),y.jsx(Ra,{title:"Materials (MatCap)",visible:qn.materials,onClose:()=>fi("materials"),initialPosition:{x:Xa(520),y:120},className:"w-72",children:y.jsxs("div",{className:"flex flex-col gap-3 max-h-[500px] overflow-y-auto pr-1 scrollbar-thin scrollbar-thumb-white/20 scrollbar-track-transparent hover:scrollbar-thumb-white/30",children:[y.jsx("div",{className:"flex gap-1",children:["Metal","Plastic","Glass","Organic"].map(V=>y.jsx("button",{className:"flex-1 py-1 bg-white/10 hover:bg-white/20 text-white/70 hover:text-white rounded text-[9px] transition-colors",children:V},V))}),y.jsxs("div",{className:"flex flex-col gap-2 p-2 bg-white/5 rounded border border-white/5",children:[y.jsxs("span",{className:"text-[10px] text-white/40 font-bold uppercase flex items-center gap-1",children:[y.jsx(Ev,{size:10})," Metals"]}),y.jsx("div",{className:"grid grid-cols-3 gap-2",children:[{name:"Chrome",color:"linear-gradient(135deg, #e8e8e8 0%, #ffffff 50%, #c0c0c0 100%)"},{name:"Gold",color:"linear-gradient(135deg, #d4af37 0%, #ffd700 50%, #b8860b 100%)"},{name:"Copper",color:"linear-gradient(135deg, #b87333 0%, #e77200 50%, #8b4513 100%)"},{name:"Silver",color:"linear-gradient(135deg, #c0c0c0 0%, #f5f5f5 50%, #a8a8a8 100%)"},{name:"Bronze",color:"linear-gradient(135deg, #cd7f32 0%, #e89b5a 50%, #8b5a2b 100%)"},{name:"Steel",color:"linear-gradient(135deg, #71797e 0%, #a9b4c2 50%, #5a6268 100%)"}].map(V=>y.jsxs("button",{className:"flex flex-col items-center gap-1 p-2 rounded hover:bg-white/10 transition-colors group",children:[y.jsx("div",{className:"w-full aspect-square rounded-lg border border-white/20 shadow-lg",style:{background:V.color}}),y.jsx("span",{className:"text-[8px] text-white/50 group-hover:text-white/80",children:V.name})]},V.name))})]}),y.jsxs("div",{className:"flex flex-col gap-2 p-2 bg-white/5 rounded border border-white/5",children:[y.jsxs("span",{className:"text-[10px] text-white/40 font-bold uppercase flex items-center gap-1",children:[y.jsx(Nm,{size:10})," Plastics"]}),y.jsx("div",{className:"grid grid-cols-3 gap-2",children:[{name:"Glossy Red",color:"linear-gradient(135deg, #ff0000 0%, #ff6b6b 50%, #cc0000 100%)"},{name:"Matte Blue",color:"linear-gradient(135deg, #4169e1 0%, #6495ed 50%, #1e3a8a 100%)"},{name:"Glossy White",color:"linear-gradient(135deg, #f8f9fa 0%, #ffffff 50%, #e9ecef 100%)"},{name:"Matte Black",color:"linear-gradient(135deg, #2d3748 0%, #4a5568 50%, #1a202c 100%)"},{name:"Glossy Green",color:"linear-gradient(135deg, #10b981 0%, #34d399 50%, #059669 100%)"},{name:"Glossy Orange",color:"linear-gradient(135deg, #f97316 0%, #fb923c 50%, #ea580c 100%)"}].map(V=>y.jsxs("button",{className:"flex flex-col items-center gap-1 p-2 rounded hover:bg-white/10 transition-colors group",children:[y.jsx("div",{className:"w-full aspect-square rounded-lg border border-white/20 shadow-lg",style:{background:V.color}}),y.jsx("span",{className:"text-[8px] text-white/50 group-hover:text-white/80",children:V.name})]},V.name))})]}),y.jsxs("div",{className:"flex flex-col gap-2 p-2 bg-white/5 rounded border border-white/5",children:[y.jsxs("span",{className:"text-[10px] text-white/40 font-bold uppercase flex items-center gap-1",children:[y.jsx(zh,{size:10})," Glass & Transparent"]}),y.jsx("div",{className:"grid grid-cols-3 gap-2",children:[{name:"Clear Glass",color:"linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.3) 50%, rgba(200,200,200,0.2) 100%)"},{name:"Frosted",color:"linear-gradient(135deg, rgba(240,240,240,0.5) 0%, rgba(255,255,255,0.6) 50%, rgba(220,220,220,0.4) 100%)"},{name:"Blue Glass",color:"linear-gradient(135deg, rgba(59,130,246,0.3) 0%, rgba(96,165,250,0.5) 50%, rgba(37,99,235,0.2) 100%)"},{name:"Green Glass",color:"linear-gradient(135deg, rgba(16,185,129,0.3) 0%, rgba(52,211,153,0.5) 50%, rgba(5,150,105,0.2) 100%)"},{name:"Amber Glass",color:"linear-gradient(135deg, rgba(245,158,11,0.4) 0%, rgba(251,191,36,0.6) 50%, rgba(217,119,6,0.3) 100%)"},{name:"Ice",color:"linear-gradient(135deg, rgba(191,219,254,0.4) 0%, rgba(224,242,254,0.6) 50%, rgba(147,197,253,0.3) 100%)"}].map(V=>y.jsxs("button",{className:"flex flex-col items-center gap-1 p-2 rounded hover:bg-white/10 transition-colors group",children:[y.jsx("div",{className:"w-full aspect-square rounded-lg border border-white/20 shadow-lg backdrop-blur-sm",style:{background:V.color}}),y.jsx("span",{className:"text-[8px] text-white/50 group-hover:text-white/80",children:V.name})]},V.name))})]}),y.jsxs("div",{className:"flex flex-col gap-2 p-2 bg-white/5 rounded border border-white/5",children:[y.jsxs("span",{className:"text-[10px] text-white/40 font-bold uppercase flex items-center gap-1",children:[y.jsx(z2,{size:10})," Organic & Natural"]}),y.jsx("div",{className:"grid grid-cols-3 gap-2",children:[{name:"Clay",color:"linear-gradient(135deg, #d4a574 0%, #e6c8a0 50%, #b8865f 100%)"},{name:"Marble",color:"linear-gradient(135deg, #f8f9fa 0%, #e9ecef 30%, #dee2e6 60%, #f1f3f5 100%)"},{name:"Wood",color:"linear-gradient(135deg, #8b4513 0%, #a0522d 50%, #654321 100%)"},{name:"Stone",color:"linear-gradient(135deg, #6c757d 0%, #adb5bd 50%, #495057 100%)"},{name:"Skin",color:"linear-gradient(135deg, #f5cba7 0%, #fad7a0 50%, #e59866 100%)"},{name:"Wax",color:"linear-gradient(135deg, #fff8dc 0%, #fffacd 50%, #f0e68c 100%)"}].map(V=>y.jsxs("button",{className:"flex flex-col items-center gap-1 p-2 rounded hover:bg-white/10 transition-colors group",children:[y.jsx("div",{className:"w-full aspect-square rounded-lg border border-white/20 shadow-lg",style:{background:V.color}}),y.jsx("span",{className:"text-[8px] text-white/50 group-hover:text-white/80",children:V.name})]},V.name))})]}),y.jsxs("div",{className:"flex flex-col gap-2 p-2 bg-white/5 rounded border border-white/5",children:[y.jsxs("span",{className:"text-[10px] text-white/40 font-bold uppercase flex items-center gap-1",children:[y.jsx(Rv,{size:10})," Properties"]}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("span",{className:"text-[9px] text-white/50 w-16",children:"Metalness"}),y.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",defaultValue:"0",className:"flex-1 h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-blue-500"}),y.jsx("span",{className:"text-[9px] text-white/50 w-8",children:"0.0"})]}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("span",{className:"text-[9px] text-white/50 w-16",children:"Roughness"}),y.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",defaultValue:"0.5",className:"flex-1 h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-orange-500"}),y.jsx("span",{className:"text-[9px] text-white/50 w-8",children:"0.5"})]}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("span",{className:"text-[9px] text-white/50 w-16",children:"Opacity"}),y.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",defaultValue:"1",className:"flex-1 h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-teal-500"}),y.jsx("span",{className:"text-[9px] text-white/50 w-8",children:"1.0"})]})]}),y.jsx("button",{className:"w-full py-2 bg-gradient-to-r from-purple-600/30 to-pink-600/30 hover:from-purple-600/50 hover:to-pink-600/50 text-white rounded text-[11px] border border-purple-500/30 transition-all font-bold",children:"Apply Material to Selection"})]})},`materials-${zi}`),y.jsx(Ra,{title:"Export Scene",visible:qn.export,onClose:()=>fi("export"),initialPosition:{x:Xa(300),y:150},className:"w-80",children:y.jsxs("div",{className:"flex flex-col gap-3 max-h-[500px] overflow-y-auto pr-1 scrollbar-thin scrollbar-thumb-white/20 scrollbar-track-transparent hover:scrollbar-thumb-white/30",children:[y.jsxs("div",{className:"flex flex-col gap-2 p-2 bg-white/5 rounded border border-white/5",children:[y.jsxs("span",{className:"text-[10px] text-white/40 font-bold uppercase flex items-center gap-1",children:[y.jsx(Ih,{size:10})," Export Formats"]}),y.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[y.jsxs("button",{className:"flex flex-col items-center gap-1 p-3 rounded bg-gradient-to-br from-blue-600/20 to-cyan-600/20 hover:from-blue-600/40 hover:to-cyan-600/40 border border-blue-500/30 transition-all group",children:[y.jsx(C2,{size:20,className:"text-blue-300"}),y.jsx("span",{className:"text-[10px] text-white/80 font-bold",children:"HTML"}),y.jsx("span",{className:"text-[8px] text-white/50",children:"Standalone"})]}),y.jsxs("button",{className:"flex flex-col items-center gap-1 p-3 rounded bg-gradient-to-br from-purple-600/20 to-pink-600/20 hover:from-purple-600/40 hover:to-pink-600/40 border border-purple-500/30 transition-all group",children:[y.jsx(wv,{size:20,className:"text-purple-300"}),y.jsx("span",{className:"text-[10px] text-white/80 font-bold",children:"JSON"}),y.jsx("span",{className:"text-[8px] text-white/50",children:"Scene Data"})]}),y.jsxs("button",{className:"flex flex-col items-center gap-1 p-3 rounded bg-gradient-to-br from-green-600/20 to-emerald-600/20 hover:from-green-600/40 hover:to-emerald-600/40 border border-green-500/30 transition-all group",children:[y.jsx(kc,{size:20,className:"text-green-300"}),y.jsx("span",{className:"text-[10px] text-white/80 font-bold",children:"GLTF"}),y.jsx("span",{className:"text-[8px] text-white/50",children:"3D Model"})]}),y.jsxs("button",{className:"flex flex-col items-center gap-1 p-3 rounded bg-gradient-to-br from-orange-600/20 to-red-600/20 hover:from-orange-600/40 hover:to-red-600/40 border border-orange-500/30 transition-all group",children:[y.jsx(Bm,{size:20,className:"text-orange-300"}),y.jsx("span",{className:"text-[10px] text-white/80 font-bold",children:"OBJ"}),y.jsx("span",{className:"text-[8px] text-white/50",children:"Mesh Only"})]})]})]}),y.jsxs("div",{className:"flex flex-col gap-2 p-2 bg-white/5 rounded border border-white/5",children:[y.jsxs("span",{className:"text-[10px] text-white/40 font-bold uppercase flex items-center gap-1",children:[y.jsx(C2,{size:10})," HTML Options"]}),y.jsxs("div",{className:"flex justify-between items-center bg-white/5 px-2 py-1.5 rounded",children:[y.jsx("span",{className:"text-[9px] text-white/70",children:"Include Animation"}),y.jsx("button",{className:"w-6 h-3 rounded-full relative transition-colors bg-teal-600",children:y.jsx("div",{className:"absolute top-0.5 left-0.5 w-2 h-2 bg-white rounded-full transition-transform translate-x-3"})})]}),y.jsxs("div",{className:"flex justify-between items-center bg-white/5 px-2 py-1.5 rounded",children:[y.jsx("span",{className:"text-[9px] text-white/70",children:"Include Controls"}),y.jsx("button",{className:"w-6 h-3 rounded-full relative transition-colors bg-teal-600",children:y.jsx("div",{className:"absolute top-0.5 left-0.5 w-2 h-2 bg-white rounded-full transition-transform translate-x-3"})})]}),y.jsxs("div",{className:"flex justify-between items-center bg-white/5 px-2 py-1.5 rounded",children:[y.jsx("span",{className:"text-[9px] text-white/70",children:"Auto-play Animation"}),y.jsx("button",{className:"w-6 h-3 rounded-full relative transition-colors bg-white/20",children:y.jsx("div",{className:"absolute top-0.5 left-0.5 w-2 h-2 bg-white rounded-full transition-transform translate-x-0"})})]}),y.jsxs("div",{className:"flex justify-between items-center bg-white/5 px-2 py-1.5 rounded",children:[y.jsx("span",{className:"text-[9px] text-white/70",children:"Minify Code"}),y.jsx("button",{className:"w-6 h-3 rounded-full relative transition-colors bg-white/20",children:y.jsx("div",{className:"absolute top-0.5 left-0.5 w-2 h-2 bg-white rounded-full transition-transform translate-x-0"})})]})]}),y.jsxs("div",{className:"flex flex-col gap-2 p-2 bg-white/5 rounded border border-white/5",children:[y.jsxs("span",{className:"text-[10px] text-white/40 font-bold uppercase flex items-center gap-1",children:[y.jsx(B2,{size:10})," Scene Settings"]}),y.jsxs("div",{className:"flex flex-col gap-1",children:[y.jsx("span",{className:"text-[9px] text-white/50",children:"Canvas Size"}),y.jsxs("div",{className:"flex gap-2",children:[y.jsx("input",{type:"number",defaultValue:"1920",className:"flex-1 bg-black/30 border border-white/10 rounded px-2 py-1 text-[10px] text-white focus:outline-none",placeholder:"Width",onKeyDown:V=>V.stopPropagation()}),y.jsx("span",{className:"text-white/50",children:""}),y.jsx("input",{type:"number",defaultValue:"1080",className:"flex-1 bg-black/30 border border-white/10 rounded px-2 py-1 text-[10px] text-white focus:outline-none",placeholder:"Height",onKeyDown:V=>V.stopPropagation()})]})]}),y.jsxs("div",{className:"flex flex-col gap-1",children:[y.jsx("span",{className:"text-[9px] text-white/50",children:"Background Color"}),y.jsxs("div",{className:"flex gap-2",children:[y.jsx("input",{type:"color",defaultValue:"#000000",className:"w-12 h-8 bg-black/30 border border-white/10 rounded cursor-pointer"}),y.jsx("input",{type:"text",defaultValue:"#000000",className:"flex-1 bg-black/30 border border-white/10 rounded px-2 py-1 text-[10px] text-white focus:outline-none",onKeyDown:V=>V.stopPropagation()})]})]}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("span",{className:"text-[9px] text-white/50 w-20",children:"Camera FOV"}),y.jsx("input",{type:"range",min:"30",max:"120",defaultValue:"75",className:"flex-1 h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-blue-500"}),y.jsx("span",{className:"text-[9px] text-white/50 w-8",children:"75"})]})]}),y.jsx("div",{className:"flex flex-col gap-2 p-2 bg-blue-600/10 rounded border border-blue-500/30",children:y.jsxs("div",{className:"flex items-start gap-2",children:[y.jsx(zh,{size:12,className:"text-blue-400 mt-0.5"}),y.jsxs("div",{className:"flex-1",children:[y.jsx("p",{className:"text-[9px] text-blue-200 font-bold mb-1",children:"HTML Export Info"}),y.jsx("p",{className:"text-[8px] text-blue-300/80 leading-relaxed",children:"Creates a standalone HTML file with Three.js embedded. The file will include your entire 3D scene, animations, and interactive controls. Perfect for sharing or embedding in websites."})]})]})}),y.jsxs("div",{className:"flex flex-col gap-2 p-2 bg-white/5 rounded border border-white/5",children:[y.jsxs("span",{className:"text-[10px] text-white/40 font-bold uppercase flex items-center gap-1",children:[y.jsx(Om,{size:10})," File Name"]}),y.jsx("input",{type:"text",defaultValue:"my-3d-scene",className:"w-full bg-black/30 border border-white/10 rounded px-2 py-1.5 text-[10px] text-white focus:outline-none focus:border-teal-500",placeholder:"Enter filename...",onKeyDown:V=>V.stopPropagation()})]}),y.jsxs("div",{className:"flex flex-col gap-2",children:[y.jsxs("button",{className:"w-full py-3 bg-gradient-to-r from-teal-600/40 to-blue-600/40 hover:from-teal-600/60 hover:to-blue-600/60 text-white rounded-lg text-[11px] border border-teal-500/50 transition-all font-bold flex items-center justify-center gap-2 shadow-lg",children:[y.jsx(Ih,{size:16}),"Download HTML Scene"]}),y.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[y.jsxs("button",{className:"py-2 bg-white/10 hover:bg-white/20 text-white/80 hover:text-white rounded text-[10px] border border-white/10 transition-all flex items-center justify-center gap-1",children:[y.jsx(zh,{size:12}),"Preview"]}),y.jsxs("button",{className:"py-2 bg-white/10 hover:bg-white/20 text-white/80 hover:text-white rounded text-[10px] border border-white/10 transition-all flex items-center justify-center gap-1",children:[y.jsx(T2,{size:12}),"Copy Code"]})]})]}),y.jsxs("div",{className:"flex flex-col gap-2 p-2 bg-white/5 rounded border border-white/5",children:[y.jsxs("span",{className:"text-[10px] text-white/40 font-bold uppercase flex items-center gap-1",children:[y.jsx(O2,{size:10})," Quick Exports"]}),y.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[y.jsx("button",{className:"py-1.5 bg-purple-600/20 hover:bg-purple-600/40 text-purple-300 rounded text-[9px] border border-purple-500/30 transition-colors",children:"JSON Data"}),y.jsx("button",{className:"py-1.5 bg-green-600/20 hover:bg-green-600/40 text-green-300 rounded text-[9px] border border-green-500/30 transition-colors",children:"GLTF Model"}),y.jsx("button",{className:"py-1.5 bg-orange-600/20 hover:bg-orange-600/40 text-orange-300 rounded text-[9px] border border-orange-500/30 transition-colors",children:"OBJ Mesh"}),y.jsx("button",{className:"py-1.5 bg-pink-600/20 hover:bg-pink-600/40 text-pink-300 rounded text-[9px] border border-pink-500/30 transition-colors",children:"Screenshot"})]})]})]})},`export-${zi}`),y.jsx(Ra,{title:"3D Models Gallery",visible:qn.models,onClose:()=>fi("models"),initialPosition:{x:Xa(600),y:80},className:"w-80",children:y.jsxs("div",{className:"flex flex-col gap-3 max-h-[550px] overflow-y-auto pr-1 scrollbar-thin scrollbar-thumb-white/20 scrollbar-track-transparent hover:scrollbar-thumb-white/30",children:[y.jsx("div",{className:"flex gap-1",children:["Primitives","Organic","Architecture","Characters"].map(V=>y.jsx("button",{className:"flex-1 py-1 bg-white/10 hover:bg-white/20 text-white/70 hover:text-white rounded text-[9px] transition-colors",children:V},V))}),y.jsxs("div",{className:"flex flex-col gap-2 p-2 bg-white/5 rounded border border-white/5",children:[y.jsxs("span",{className:"text-[10px] text-white/40 font-bold uppercase flex items-center gap-1",children:[y.jsx(kc,{size:10})," Primitive Shapes"]}),y.jsx("div",{className:"grid grid-cols-3 gap-2",children:[{name:"Sphere",icon:"",desc:"Perfect sphere"},{name:"Cube",icon:"",desc:"Box shape"},{name:"Cylinder",icon:"",desc:"Tube shape"},{name:"Cone",icon:"",desc:"Pyramid cone"},{name:"Torus",icon:"",desc:"Donut shape"},{name:"Plane",icon:"",desc:"Flat surface"},{name:"Icosahedron",icon:"",desc:"D20 dice"},{name:"Octahedron",icon:"",desc:"D8 dice"},{name:"Tetrahedron",icon:"",desc:"D4 dice"}].map(V=>y.jsxs("button",{onClick:()=>{alert(` ${V.name} Added to Scene!

Model: ${V.name}
Type: Primitive Shape
Material: Chrome (default)
Position: Center (0, 0, 0)

The ${V.name.toLowerCase()} has been added to your scene.
You can now transform, animate, or apply materials to it!`)},className:"flex flex-col items-center gap-1 p-2 rounded bg-gradient-to-br from-white/5 to-white/10 hover:from-white/10 hover:to-white/20 border border-white/10 hover:border-white/30 transition-all group cursor-pointer",children:[y.jsx("div",{className:"text-2xl",children:V.icon}),y.jsx("span",{className:"text-[9px] text-white/70 group-hover:text-white font-bold",children:V.name}),y.jsx("span",{className:"text-[7px] text-white/40",children:V.desc})]},V.name))})]}),y.jsxs("div",{className:"flex flex-col gap-2 p-2 bg-white/5 rounded border border-white/5",children:[y.jsxs("span",{className:"text-[10px] text-white/40 font-bold uppercase flex items-center gap-1",children:[y.jsx(z2,{size:10})," Organic Shapes"]}),y.jsx("div",{className:"grid grid-cols-3 gap-2",children:[{name:"Capsule",icon:"",desc:"Pill shape"},{name:"Egg",icon:"",desc:"Oval shape"},{name:"Blob",icon:"",desc:"Organic blob"},{name:"Rock",icon:"",desc:"Stone shape"},{name:"Cloud",icon:"",desc:"Fluffy cloud"},{name:"Drop",icon:"",desc:"Water drop"}].map(V=>y.jsxs("button",{onClick:()=>{alert(` ${V.name} Added to Scene!

Model: ${V.name}
Type: Organic Shape
Material: Clay (default)
Position: Center (0, 0, 0)

The ${V.name.toLowerCase()} has been added to your scene.
Perfect for organic modeling and natural forms!`)},className:"flex flex-col items-center gap-1 p-2 rounded bg-gradient-to-br from-green-600/10 to-emerald-600/10 hover:from-green-600/20 hover:to-emerald-600/20 border border-green-500/20 hover:border-green-500/40 transition-all group cursor-pointer",children:[y.jsx("div",{className:"text-2xl",children:V.icon}),y.jsx("span",{className:"text-[9px] text-white/70 group-hover:text-white font-bold",children:V.name}),y.jsx("span",{className:"text-[7px] text-white/40",children:V.desc})]},V.name))})]}),y.jsxs("div",{className:"flex flex-col gap-2 p-2 bg-white/5 rounded border border-white/5",children:[y.jsxs("span",{className:"text-[10px] text-white/40 font-bold uppercase flex items-center gap-1",children:[y.jsx(Bm,{size:10})," Architectural"]}),y.jsx("div",{className:"grid grid-cols-3 gap-2",children:[{name:"Column",icon:"",desc:"Pillar"},{name:"Arch",icon:"",desc:"Arc shape"},{name:"Stairs",icon:"",desc:"Step stairs"},{name:"Wall",icon:"",desc:"Brick wall"},{name:"Roof",icon:"",desc:"House roof"},{name:"Window",icon:"",desc:"Frame"}].map(V=>y.jsxs("button",{onClick:()=>{alert(` ${V.name} Added to Scene!

Model: ${V.name}
Type: Architectural Element
Material: Stone (default)
Position: Center (0, 0, 0)

The ${V.name.toLowerCase()} has been added to your scene.
Great for architectural visualization!`)},className:"flex flex-col items-center gap-1 p-2 rounded bg-gradient-to-br from-blue-600/10 to-cyan-600/10 hover:from-blue-600/20 hover:to-cyan-600/20 border border-blue-500/20 hover:border-blue-500/40 transition-all group cursor-pointer",children:[y.jsx("div",{className:"text-2xl",children:V.icon}),y.jsx("span",{className:"text-[9px] text-white/70 group-hover:text-white font-bold",children:V.name}),y.jsx("span",{className:"text-[7px] text-white/40",children:V.desc})]},V.name))})]}),y.jsxs("div",{className:"flex flex-col gap-2 p-3 bg-gradient-to-br from-purple-600/10 to-pink-600/10 rounded border border-purple-500/30",children:[y.jsxs("span",{className:"text-[10px] text-white/40 font-bold uppercase flex items-center gap-1",children:[y.jsx(zh,{size:10})," Selected Model"]}),y.jsxs("div",{className:"flex items-center gap-3",children:[y.jsx("div",{className:"w-20 h-20 bg-black/30 rounded-lg border border-white/20 flex items-center justify-center text-3xl",children:""}),y.jsxs("div",{className:"flex-1",children:[y.jsx("p",{className:"text-[11px] text-white font-bold mb-1",children:"Sphere"}),y.jsx("p",{className:"text-[8px] text-white/60 mb-2",children:"Perfect geometric sphere with smooth surface"}),y.jsxs("div",{className:"flex gap-1",children:[y.jsx("span",{className:"text-[7px] bg-white/10 px-1.5 py-0.5 rounded text-white/70",children:"Vertices: 482"}),y.jsx("span",{className:"text-[7px] bg-white/10 px-1.5 py-0.5 rounded text-white/70",children:"Faces: 960"})]})]})]})]}),y.jsxs("div",{className:"flex flex-col gap-2 p-2 bg-white/5 rounded border border-white/5",children:[y.jsxs("span",{className:"text-[10px] text-white/40 font-bold uppercase flex items-center gap-1",children:[y.jsx(Ih,{size:10})," Download Model"]}),y.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[y.jsxs("button",{onClick:()=>{const V=`# Sphere Model
v 0 1 0
v 0.707 0.707 0
v 1 0 0
v 0.707 -0.707 0
v 0 -1 0
v -0.707 -0.707 0
v -1 0 0
v -0.707 0.707 0
f 1 2 3
f 1 3 4
f 1 4 5
f 1 5 6
f 1 6 7
f 1 7 8
f 1 8 2`,Wt=new Blob([V],{type:"text/plain"}),Ui=URL.createObjectURL(Wt),Ji=document.createElement("a");Ji.href=Ui,Ji.download="sphere.obj",Ji.click(),URL.revokeObjectURL(Ui)},className:"flex flex-col items-center gap-1 p-2 rounded bg-gradient-to-br from-blue-600/20 to-cyan-600/20 hover:from-blue-600/40 hover:to-cyan-600/40 border border-blue-500/30 transition-all cursor-pointer",children:[y.jsx(Bm,{size:16,className:"text-blue-300"}),y.jsx("span",{className:"text-[9px] text-white/80 font-bold",children:"OBJ"}),y.jsx("span",{className:"text-[7px] text-white/50",children:"Universal"})]}),y.jsxs("button",{onClick:()=>{const V=`solid Sphere
facet normal 0 0 1
outer loop
vertex 0 0 0
vertex 1 0 0
vertex 0 1 0
endloop
endfacet
endsolid Sphere`,Wt=new Blob([V],{type:"text/plain"}),Ui=URL.createObjectURL(Wt),Ji=document.createElement("a");Ji.href=Ui,Ji.download="sphere.stl",Ji.click(),URL.revokeObjectURL(Ui)},className:"flex flex-col items-center gap-1 p-2 rounded bg-gradient-to-br from-green-600/20 to-emerald-600/20 hover:from-green-600/40 hover:to-emerald-600/40 border border-green-500/30 transition-all cursor-pointer",children:[y.jsx(kc,{size:16,className:"text-green-300"}),y.jsx("span",{className:"text-[9px] text-white/80 font-bold",children:"STL"}),y.jsx("span",{className:"text-[7px] text-white/50",children:"3D Print"})]}),y.jsxs("button",{onClick:()=>{const V=JSON.stringify({asset:{version:"2.0",generator:"NeonFlow 3D"},scene:0,scenes:[{nodes:[0]}],nodes:[{mesh:0}],meshes:[{primitives:[{attributes:{POSITION:0},indices:1}]}]},null,2),Wt=new Blob([V],{type:"application/json"}),Ui=URL.createObjectURL(Wt),Ji=document.createElement("a");Ji.href=Ui,Ji.download="sphere.gltf",Ji.click(),URL.revokeObjectURL(Ui)},className:"flex flex-col items-center gap-1 p-2 rounded bg-gradient-to-br from-purple-600/20 to-pink-600/20 hover:from-purple-600/40 hover:to-pink-600/40 border border-purple-500/30 transition-all cursor-pointer",children:[y.jsx(wv,{size:16,className:"text-purple-300"}),y.jsx("span",{className:"text-[9px] text-white/80 font-bold",children:"GLTF"}),y.jsx("span",{className:"text-[7px] text-white/50",children:"Web/AR"})]}),y.jsxs("button",{onClick:()=>{const V=`; FBX 7.4.0 project file
; Created by NeonFlow 3D

FBXHeaderExtension:  {
	FBXHeaderVersion: 1003
	FBXVersion: 7400
}
Objects:  {
	Geometry: 1, "Geometry::Sphere", "Mesh" {
		Vertices: *24 {
			a: 0,1,0,0.707,0.707,0,1,0,0,0.707,-0.707,0,0,-1,0,-0.707,-0.707,0,-1,0,0,-0.707,0.707,0
		}
	}
}`,Wt=new Blob([V],{type:"text/plain"}),Ui=URL.createObjectURL(Wt),Ji=document.createElement("a");Ji.href=Ui,Ji.download="sphere.fbx",Ji.click(),URL.revokeObjectURL(Ui)},className:"flex flex-col items-center gap-1 p-2 rounded bg-gradient-to-br from-orange-600/20 to-red-600/20 hover:from-orange-600/40 hover:to-red-600/40 border border-orange-500/30 transition-all cursor-pointer",children:[y.jsx(R2,{size:16,className:"text-orange-300"}),y.jsx("span",{className:"text-[9px] text-white/80 font-bold",children:"FBX"}),y.jsx("span",{className:"text-[7px] text-white/50",children:"Animation"})]})]}),y.jsxs("button",{onClick:()=>{alert(`Downloading all formats as ZIP...

This will download:
- sphere.obj
- sphere.stl
- sphere.gltf
- sphere.fbx

Feature coming soon!`)},className:"w-full py-2 bg-gradient-to-r from-teal-600/30 to-blue-600/30 hover:from-teal-600/50 hover:to-blue-600/50 text-white rounded text-[10px] border border-teal-500/30 transition-all font-bold flex items-center justify-center gap-2 cursor-pointer",children:[y.jsx(Ih,{size:14}),"Download All Formats (.zip)"]})]}),y.jsxs("div",{className:"flex flex-col gap-2 p-2 bg-white/5 rounded border border-white/5",children:[y.jsxs("span",{className:"text-[10px] text-white/40 font-bold uppercase flex items-center gap-1",children:[y.jsx(Ev,{size:10})," Apply Material"]}),y.jsx("div",{className:"grid grid-cols-4 gap-1",children:[{name:"Chrome",color:"linear-gradient(135deg, #e8e8e8 0%, #ffffff 50%, #c0c0c0 100%)"},{name:"Gold",color:"linear-gradient(135deg, #d4af37 0%, #ffd700 50%, #b8860b 100%)"},{name:"Copper",color:"linear-gradient(135deg, #b87333 0%, #e77200 50%, #8b4513 100%)"},{name:"Blue",color:"linear-gradient(135deg, #4169e1 0%, #6495ed 50%, #1e3a8a 100%)"},{name:"Red",color:"linear-gradient(135deg, #ff0000 0%, #ff6b6b 50%, #cc0000 100%)"},{name:"Green",color:"linear-gradient(135deg, #10b981 0%, #34d399 50%, #059669 100%)"},{name:"Glass",color:"linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.3) 50%, rgba(200,200,200,0.2) 100%)"},{name:"Clay",color:"linear-gradient(135deg, #d4a574 0%, #e6c8a0 50%, #b8865f 100%)"}].map(V=>y.jsx("button",{className:"aspect-square rounded border border-white/20 hover:border-white/50 transition-all hover:scale-110",style:{background:V.color},title:V.name},V.name))})]}),y.jsxs("div",{className:"flex flex-col gap-2 p-2 bg-white/5 rounded border border-white/5",children:[y.jsxs("span",{className:"text-[10px] text-white/40 font-bold uppercase flex items-center gap-1",children:[y.jsx(Rv,{size:10})," Model Properties"]}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("span",{className:"text-[9px] text-white/50 w-16",children:"Scale"}),y.jsx("input",{type:"range",min:"0.1",max:"5",step:"0.1",defaultValue:"1",className:"flex-1 h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-purple-500"}),y.jsx("span",{className:"text-[9px] text-white/50 w-8",children:"1.0"})]}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("span",{className:"text-[9px] text-white/50 w-16",children:"Segments"}),y.jsx("input",{type:"range",min:"8",max:"128",step:"8",defaultValue:"32",className:"flex-1 h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-blue-500"}),y.jsx("span",{className:"text-[9px] text-white/50 w-8",children:"32"})]}),y.jsxs("div",{className:"flex justify-between items-center bg-white/5 px-2 py-1.5 rounded",children:[y.jsx("span",{className:"text-[9px] text-white/70",children:"Wireframe"}),y.jsx("button",{className:"w-6 h-3 rounded-full relative transition-colors bg-white/20",children:y.jsx("div",{className:"absolute top-0.5 left-0.5 w-2 h-2 bg-white rounded-full transition-transform translate-x-0"})})]})]}),y.jsxs("button",{onClick:()=>{alert(` Model Added to Scene!

Model: Sphere
Material: Chrome (default)
Scale: 1.0
Segments: 32

The model has been added to the center of the scene.
You can now:
 Transform it using the Transform tools
 Apply different materials
 Animate it using the Animation window

Feature: Full integration coming soon!`)},className:"w-full py-3 bg-gradient-to-r from-purple-600/40 to-pink-600/40 hover:from-purple-600/60 hover:to-pink-600/60 text-white rounded-lg text-[11px] border border-purple-500/50 transition-all font-bold flex items-center justify-center gap-2 shadow-lg cursor-pointer",children:[y.jsx(T2,{size:16}),"Add Model to Scene"]}),y.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[y.jsxs("button",{onClick:()=>{alert(` Randomizing Model...

Generated random properties:
 Scale: `+(Math.random()*3+.5).toFixed(2)+`
 Rotation: `+Math.floor(Math.random()*360)+`
 Segments: `+(Math.floor(Math.random()*15)*8+8)+`
 Material: Random

Click "Add Model to Scene" to apply!`)},className:"py-2 bg-white/10 hover:bg-white/20 text-white/80 hover:text-white rounded text-[10px] border border-white/10 transition-all flex items-center justify-center gap-1 cursor-pointer",children:[y.jsx(Um,{size:12}),"Randomize"]}),y.jsxs("button",{onClick:()=>{alert(` Creating Variations...

Available variations:
1. Low-poly version (8 segments)
2. High-poly version (128 segments)
3. Wireframe version
4. Subdivided version
5. Smoothed version

Select a variation to apply!`)},className:"py-2 bg-white/10 hover:bg-white/20 text-white/80 hover:text-white rounded text-[10px] border border-white/10 transition-all flex items-center justify-center gap-1 cursor-pointer",children:[y.jsx(O2,{size:12}),"Variations"]})]})]})},`models-${zi}`),y.jsx(Ra,{title:"Shapes",visible:qn.shapes,onClose:()=>fi("shapes"),initialPosition:{x:170,y:180},className:"w-48",children:y.jsx("div",{className:"grid grid-cols-2 gap-1 max-h-[300px] overflow-y-auto pr-1 custom-scrollbar",children:[{m:"draw-line",i:y.jsx(F6,{size:18}),l:"Line"},{m:"draw-rectangle",i:y.jsx(Mp,{size:18}),l:"Rectangle"},{m:"draw-circle",i:y.jsx(Nm,{size:18}),l:"Circle"},{m:"draw-circle-2pt",i:y.jsx(oz,{size:18}),l:"2-Pt Circle"},{m:"draw-ellipse",i:y.jsx(Nm,{size:18,className:"scale-x-150"}),l:"Ellipse"},{m:"draw-triangle",i:y.jsx(cF,{size:18}),l:"Triangle"},{m:"draw-star",i:y.jsx(Y6,{size:18}),l:"Star"},{m:"draw-hexagon",i:y.jsx(Vz,{size:18}),l:"Hexagon"},{m:"draw-rhombus",i:y.jsx(Az,{size:18}),l:"Rhombus"},{m:"draw-semicircle",i:y.jsx(i6,{size:18,className:"rotate-90"}),l:"Semi-Circle"},{m:"draw-quartercircle",i:y.jsx(az,{size:18}),l:"1/4 Circle"},{m:"draw-teardrop",i:y.jsx(Ev,{size:18}),l:"Teardrop"},{m:"draw-heart",i:y.jsx(Hz,{size:18}),l:"Heart"},{m:"draw-golden-rect",i:y.jsx(Mp,{size:18,className:"scale-x-150"}),l:"Golden Rect"},{m:"draw-golden-spiral",i:y.jsx(x6,{size:18}),l:"Golden Spiral"}].map(V=>y.jsxs("button",{onClick:()=>L(V.m),className:`flex flex-col items-center justify-center p-2 rounded-lg transition-all ${P===V.m?"bg-teal-600 text-white":"text-white/60 hover:bg-white/10"}`,children:[V.i,y.jsx("span",{className:"text-[9px] mt-1",children:V.l})]},V.m))})},`shapes-${zi}`),y.jsx(Ra,{title:"Annotations",visible:qn.annotations,onClose:()=>fi("annotations"),initialPosition:{x:170,y:100},className:"w-56",children:y.jsxs("div",{className:"flex flex-col gap-3",children:[y.jsxs("div",{className:"flex flex-col gap-2 p-2 bg-white/5 rounded border border-white/5",children:[y.jsxs("span",{className:"text-[10px] text-white/40 font-bold uppercase flex items-center gap-1",children:[y.jsx(Om,{size:10})," Text Label"]}),y.jsx("textarea",{className:"w-full bg-black/30 border border-white/10 rounded p-2 text-xs text-white focus:border-teal-500 focus:outline-none resize-none h-16",placeholder:"Enter text here...",value:Qi,onChange:V=>Mi&&Mi(V.target.value),onKeyDown:V=>V.stopPropagation()}),y.jsx("button",{onClick:()=>L("draw-text"),className:`w-full py-1.5 rounded text-xs transition-all ${P==="draw-text"?"bg-teal-600 text-white":"bg-white/10 text-white/70 hover:bg-white/20"}`,children:"Place Text"})]}),y.jsx("div",{className:"h-px bg-white/10"}),y.jsxs("div",{className:"flex flex-col gap-1",children:[y.jsxs("span",{className:"text-[10px] text-white/40 font-bold uppercase mb-1 flex items-center gap-1",children:[y.jsx(L2,{size:10})," Dimensions"]}),y.jsxs("div",{className:"grid grid-cols-3 gap-1",children:[y.jsxs("button",{onClick:()=>L("draw-dimension"),className:`flex flex-col items-center justify-center p-2 rounded-lg transition-all ${P==="draw-dimension"?"bg-teal-600 text-white":"bg-white/5 border border-transparent hover:bg-white/10"}`,title:"Linear Distance (2 points)",children:[y.jsx(L2,{size:16}),y.jsx("span",{className:"text-[8px] mt-1",children:"Linear"})]}),y.jsxs("button",{onClick:()=>L("draw-dimension-radius"),className:`flex flex-col items-center justify-center p-2 rounded-lg transition-all ${P==="draw-dimension-radius"?"bg-teal-600 text-white":"bg-white/5 border border-transparent hover:bg-white/10"}`,title:"Radius (Center -> Edge)",children:[y.jsx(F2,{size:16}),y.jsx("span",{className:"text-[8px] mt-1",children:"Radius"})]}),y.jsxs("button",{onClick:()=>L("draw-dimension-angle"),className:`flex flex-col items-center justify-center p-2 rounded-lg transition-all ${P==="draw-dimension-angle"?"bg-teal-600 text-white":"bg-white/5 border border-transparent hover:bg-white/10"}`,title:"Angle (Vertex -> P1 -> P2)",children:[y.jsx(P_,{size:16}),y.jsx("span",{className:"text-[8px] mt-1",children:"Angle"})]})]})]})]})},`annotations-${zi}`),y.jsx(Ra,{title:"Properties",visible:qn.properties,onClose:()=>fi("properties"),initialPosition:{x:Xa(250),y:20},className:"w-56",children:y.jsxs("div",{className:"flex flex-col gap-3",children:[y.jsxs("div",{className:"flex gap-2",children:[y.jsxs("div",{className:"flex-1",children:[y.jsx("div",{className:"flex justify-between text-white/50 text-[10px] font-bold uppercase tracking-wider mb-1",children:y.jsx("span",{children:"Color"})}),y.jsxs("div",{className:"flex gap-1 mb-2 flex-wrap",children:[j_.map(V=>y.jsx("button",{onClick:()=>e(V),className:`w-4 h-4 rounded-full border ${s===V?"border-white scale-110":"border-transparent hover:scale-110"} transition-transform`,style:{backgroundColor:V}},V)),y.jsx("button",{onClick:()=>e("rainbow"),className:`w-4 h-4 rounded-full border ${s==="rainbow"?"border-white scale-110":"border-transparent hover:scale-110"} transition-transform bg-gradient-to-br from-red-500 via-green-500 to-blue-500`,title:"Rainbow"})]}),y.jsx("input",{type:"color",value:s==="rainbow"?"#ffffff":s,onChange:V=>e(V.target.value),className:"w-full h-6 bg-transparent border border-white/20 rounded cursor-pointer"})]}),y.jsxs("div",{className:"flex-1",children:[y.jsxs("div",{className:"flex justify-between text-white/50 text-[10px] font-bold uppercase tracking-wider mb-1",children:[y.jsx("span",{children:"Width"}),y.jsx("span",{children:t.toFixed(1)})]}),y.jsx("input",{type:"range",min:"0.1",max:"10",step:"0.1",value:t,onKeyDown:V=>V.stopPropagation(),onChange:V=>n(parseFloat(V.target.value)),className:"w-full h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-blue-500"})]})]}),y.jsx("div",{className:"h-px bg-white/10"}),y.jsxs("div",{className:"flex flex-col gap-2",children:[y.jsx("span",{className:"text-[10px] font-bold text-white/40 uppercase tracking-wider",children:"Appearance"}),y.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[y.jsxs("div",{children:[y.jsx("div",{className:"flex justify-between text-[9px] text-white/50 mb-1",children:"Opacity"}),y.jsx("input",{type:"range",min:"0.1",max:"1",step:"0.1",value:m,onKeyDown:V=>V.stopPropagation(),onChange:V=>x(parseFloat(V.target.value)),className:"w-full h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-blue-500"})]}),y.jsxs("div",{children:[y.jsx("div",{className:"flex justify-between text-[9px] text-white/50 mb-1",children:"Glow"}),y.jsx("input",{type:"range",min:"0.5",max:"5",step:"0.1",value:g,onKeyDown:V=>V.stopPropagation(),onChange:V=>b(parseFloat(V.target.value)),className:"w-full h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-blue-500"})]})]})]}),va&&y.jsxs("div",{className:"flex justify-between items-center bg-white/5 p-2 rounded",children:[y.jsx("span",{className:"text-[10px] text-white/60",children:"Fill Shape"}),y.jsx("button",{onClick:()=>z(!U),className:`w-8 h-4 rounded-full relative transition-colors ${U?"bg-blue-600":"bg-white/20"}`,children:y.jsx("div",{className:`absolute top-0.5 left-0.5 w-3 h-3 bg-white rounded-full transition-transform ${U?"translate-x-4":"translate-x-0"}`})})]}),$o&&y.jsxs("div",{className:"flex flex-col gap-2 bg-white/5 p-2 rounded border border-white/5",children:[y.jsxs("span",{className:"text-[9px] font-bold text-white/40 uppercase tracking-wider flex items-center gap-1",children:[y.jsx(Dm,{size:10})," Tube Props"]}),y.jsxs("div",{children:[y.jsx("div",{className:"flex justify-between text-[9px] text-white/50",children:"Start Width"}),y.jsx("input",{type:"range",min:"0.1",max:"5",step:"0.1",value:R,onKeyDown:V=>V.stopPropagation(),onChange:V=>N(parseFloat(V.target.value)),className:"w-full h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-pink-500"})]}),y.jsxs("div",{children:[y.jsx("div",{className:"flex justify-between text-[9px] text-white/50",children:"End Width"}),y.jsx("input",{type:"range",min:"0.1",max:"5",step:"0.1",value:B,onKeyDown:V=>V.stopPropagation(),onChange:V=>F(parseFloat(V.target.value)),className:"w-full h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-pink-500"})]}),y.jsxs("div",{children:[y.jsxs("div",{className:"flex justify-between text-[9px] text-white/50",children:["Rad. Segs (",M,")"]}),y.jsx("input",{type:"range",min:"3",max:"16",step:"1",value:M,onKeyDown:V=>V.stopPropagation(),onChange:V=>A(parseInt(V.target.value)),className:"w-full h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-pink-500"})]})]}),!$o&&!va&&y.jsxs("div",{className:"flex flex-col gap-2 bg-white/5 p-2 rounded border border-white/5",children:[y.jsxs("div",{className:"flex justify-between items-center",children:[y.jsx("span",{className:"text-[10px] text-white/60",children:"Dashed Line"}),y.jsx("button",{onClick:()=>a(!i),className:`w-8 h-4 rounded-full relative transition-colors ${i?"bg-blue-600":"bg-white/20"}`,children:y.jsx("div",{className:`absolute top-0.5 left-0.5 w-3 h-3 bg-white rounded-full transition-transform ${i?"translate-x-4":"translate-x-0"}`})})]}),i&&y.jsxs("div",{className:"flex flex-col gap-1",children:[y.jsxs("div",{className:"flex gap-1",children:[y.jsx("button",{onClick:()=>h("1:1"),className:`flex-1 text-[8px] py-1 rounded border ${u==="1:1"?"bg-blue-500/20 border-blue-500 text-blue-400":"border-white/10 text-white/40"}`,children:"1:1"}),y.jsx("button",{onClick:()=>h("2:1"),className:`flex-1 text-[8px] py-1 rounded border ${u==="2:1"?"bg-blue-500/20 border-blue-500 text-blue-400":"border-white/10 text-white/40"}`,children:"2:1"}),y.jsx("button",{onClick:()=>h("1:2"),className:`flex-1 text-[8px] py-1 rounded border ${u==="1:2"?"bg-blue-500/20 border-blue-500 text-blue-400":"border-white/10 text-white/40"}`,children:"1:2"})]}),y.jsxs("div",{children:[y.jsx("div",{className:"flex justify-between text-[9px] text-white/50",children:"Scale"}),y.jsx("input",{type:"range",min:"0.1",max:"5",step:"0.1",value:o,onKeyDown:V=>V.stopPropagation(),onChange:V=>c(parseFloat(V.target.value)),className:"w-full h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-blue-500"})]})]})]}),(I||W||qi||jr&&jr.size>0)&&y.jsxs("div",{className:"flex flex-col gap-1 mt-2 pt-2 border-t border-white/10",children:[y.jsx("span",{className:"text-[10px] font-bold text-white/40 uppercase tracking-wider mb-1",children:"Actions"}),y.jsxs("div",{className:"grid grid-cols-3 gap-1",children:[y.jsxs("button",{onClick:je,className:"p-1.5 bg-white/5 hover:bg-white/10 rounded text-white/70 text-[9px] flex flex-col items-center gap-1",children:[y.jsx(T2,{size:12})," Clone"]}),y.jsxs("button",{onClick:()=>He("horizontal"),className:"p-1.5 bg-white/5 hover:bg-white/10 rounded text-white/70 text-[9px] flex flex-col items-center gap-1",children:[y.jsx(Qw,{size:12})," Mirror X"]}),y.jsxs("button",{onClick:()=>He("vertical"),className:"p-1.5 bg-white/5 hover:bg-white/10 rounded text-white/70 text-[9px] flex flex-col items-center gap-1",children:[y.jsx(Qw,{size:12,className:"rotate-90"})," Mirror Y"]}),I&&y.jsxs(y.Fragment,{children:[y.jsxs("div",{className:"col-span-3 flex items-center gap-2 bg-white/5 px-2 py-1 rounded border border-white/5 my-0.5",children:[y.jsx("span",{className:"text-[9px] text-white/50 uppercase tracking-wider",children:"Offset Dist"}),y.jsx("input",{type:"number",step:"0.1",value:Bo,onChange:V=>iu(parseFloat(V.target.value)),className:"flex-1 w-full bg-black/30 border border-white/10 rounded px-1 py-0.5 text-[10px] text-white focus:outline-none focus:border-blue-500",onKeyDown:V=>V.stopPropagation()})]}),y.jsxs("button",{onClick:()=>L(P==="edit-points"?"select-object":"edit-points"),className:`p-1.5 rounded text-white/70 text-[9px] flex flex-col items-center gap-1 ${P==="edit-points"?"bg-blue-600/30 text-white":"bg-white/5 hover:bg-white/10"}`,children:[y.jsx(F_,{size:12})," Pts ",P==="edit-points"?"On":"Off"]}),y.jsxs("button",{onClick:()=>Ze(Bo),className:"p-1.5 bg-white/5 hover:bg-white/10 rounded text-white/70 text-[9px] flex flex-col items-center gap-1",children:[y.jsx(M2,{size:12})," Offset +"]}),y.jsxs("button",{onClick:()=>Ze(-Bo),className:"p-1.5 bg-white/5 hover:bg-white/10 rounded text-white/70 text-[9px] flex flex-col items-center gap-1",children:[y.jsx(qw,{size:12})," Offset -"]}),y.jsxs("button",{onClick:et,className:"p-1.5 bg-white/5 hover:bg-white/10 rounded text-white/70 text-[9px] flex flex-col items-center gap-1",children:[y.jsx(Jz,{size:12})," Loop"]}),y.jsxs("button",{onClick:Ne,className:"p-1.5 bg-white/5 hover:bg-white/10 rounded text-white/70 text-[9px] flex flex-col items-center gap-1",children:[y.jsx(l6,{size:12})," Fill"]}),y.jsxs("button",{onClick:st,className:"p-1.5 bg-white/5 hover:bg-white/10 rounded text-white/70 text-[9px] flex flex-col items-center gap-1",children:[y.jsx(aE,{size:12})," Smooth"]}),y.jsxs("button",{onClick:oe,className:"p-1.5 bg-white/5 hover:bg-white/10 rounded text-white/70 text-[9px] flex flex-col items-center gap-1",children:[y.jsx(S2,{size:12})," Flip Dir"]}),y.jsxs("button",{onClick:X,className:"p-1.5 bg-white/5 hover:bg-white/10 rounded text-white/70 text-[9px] flex flex-col items-center gap-1",children:[y.jsx(Bv,{size:12})," Type"]}),y.jsxs("button",{onClick:Ae,className:"p-1.5 bg-white/5 hover:bg-white/10 rounded text-white/70 text-[9px] flex flex-col items-center gap-1",children:[y.jsx(O6,{size:12})," Explode"]}),y.jsxs("button",{onClick:It,className:"p-1.5 bg-white/5 hover:bg-white/10 rounded text-white/70 text-[9px] flex flex-col items-center gap-1",children:[y.jsx(vz,{size:12})," Chamfer"]}),y.jsxs("button",{onClick:zt,className:"p-1.5 bg-white/5 hover:bg-white/10 rounded text-white/70 text-[9px] flex flex-col items-center gap-1",children:[y.jsx(xz,{size:12})," Fillet"]}),y.jsxs("button",{onClick:re,className:"p-1.5 bg-white/5 hover:bg-white/10 hover:bg-red-500/20 hover:text-red-400 rounded text-white/70 text-[9px] flex flex-col items-center gap-1",children:[y.jsx(Kw,{size:12})," Erase"]})]}),W&&y.jsxs("button",{onClick:()=>L("polygonal-modeling"),className:`col-span-3 p-1.5 rounded text-white/70 text-[9px] flex items-center justify-center gap-2 ${P==="polygonal-modeling"?"bg-orange-600 font-bold text-white":"bg-white/5 hover:bg-white/10"}`,children:[y.jsx(N2,{size:12})," Edit Mesh"]})]}),y.jsxs("div",{className:"flex bg-white/5 rounded p-0.5 mt-1",children:[y.jsx("button",{onClick:()=>ee("translate"),className:`flex-1 py-1 text-[9px] rounded ${O==="translate"?"bg-white/20 text-white font-bold":"text-white/50 hover:text-white"}`,children:"Move"}),y.jsx("button",{onClick:()=>ee("rotate"),className:`flex-1 py-1 text-[9px] rounded ${O==="rotate"?"bg-white/20 text-white font-bold":"text-white/50 hover:text-white"}`,children:"Rotate"}),y.jsx("button",{onClick:()=>ee("scale"),className:`flex-1 py-1 text-[9px] rounded ${O==="scale"?"bg-white/20 text-white font-bold":"text-white/50 hover:text-white"}`,children:"Scale"})]})]})]})},`properties-${zi}`),y.jsx(Ra,{title:"Color Library",visible:qn.colorLibrary,onClose:()=>fi("colorLibrary"),initialPosition:{x:Xa(500),y:20},className:"w-56 h-[500px]",children:y.jsxs("div",{className:"flex flex-col h-full overflow-y-auto custom-scrollbar pr-1 gap-4",children:[uF.map((V,Wt)=>y.jsxs("div",{className:"flex flex-col gap-1",children:[y.jsxs("div",{className:"flex justify-between items-end",children:[y.jsx("span",{className:"text-[10px] font-bold text-white/60 uppercase",children:V.category}),y.jsx("span",{className:"text-[8px] text-white/30 italic",children:V.desc})]}),y.jsx("div",{className:"grid grid-cols-4 gap-1.5",children:V.colors.map((Ui,Ji)=>y.jsx("button",{onClick:()=>{e(Ui.hex),jn&&jn(Ui.hex)},className:"group relative w-full aspect-square rounded-md border border-white/10 hover:border-white/50 transition-all hover:scale-105",style:{backgroundColor:Ui.hex},title:`${Ui.name} (${Ui.hex})`,children:s===Ui.hex&&y.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:y.jsx("div",{className:"w-1.5 h-1.5 bg-white rounded-full shadow-sm",style:{boxShadow:"0 0 4px rgba(0,0,0,0.5)"}})})},Ji))})]},Wt)),y.jsx("div",{className:"p-2 bg-white/5 rounded border border-white/5 text-[9px] text-white/40 italic text-center",children:"Clicking a color updates both Line and Object settings."})]})},`colorLibrary-${zi}`),y.jsx(Ra,{title:"Layers",visible:qn.layers,onClose:()=>fi("layers"),initialPosition:{x:Xa(250),y:400},className:"w-56 h-64",children:y.jsxs("div",{className:"flex flex-col h-full",children:[y.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar flex flex-col gap-1 pr-1",children:ze.map(V=>y.jsxs("div",{className:`flex items-center gap-2 p-2 rounded text-xs group transition-colors ${Ge===V.id?"bg-blue-600/20 border border-blue-500/50":"hover:bg-white/5 border border-transparent"}`,onClick:()=>Fe(V.id),children:[y.jsx("button",{onClick:Wt=>{Wt.stopPropagation(),De(V.id)},className:`hover:text-white ${V.visible?"text-white/80":"text-white/20"}`,children:V.visible?y.jsx(zh,{size:14}):y.jsx(Tz,{size:14})}),y.jsx("button",{onClick:Wt=>{Wt.stopPropagation(),le(V.id)},className:`hover:text-white ${V.locked?"text-red-400":"text-white/20"}`,children:V.locked?y.jsx(Cv,{size:14}):y.jsx($w,{size:14})}),y.jsx("input",{type:"text",value:V.name,onChange:Wt=>Ye(V.id,Wt.target.value),className:"bg-transparent border-none focus:outline-none flex-1 text-white truncate",onClick:Wt=>Wt.stopPropagation()}),Ge===V.id&&y.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500 shadow-[0_0_8px_rgba(59,130,246,0.8)]"}),y.jsx("button",{onClick:Wt=>{Wt.stopPropagation(),lt(V.id)},className:"opacity-0 group-hover:opacity-100 hover:text-red-400 transition-opacity",children:y.jsx(Nv,{size:12})})]},V.id))}),y.jsxs("button",{onClick:Qe,className:"mt-2 w-full py-1.5 bg-white/10 hover:bg-white/20 rounded text-xs flex items-center justify-center gap-2 transition-colors",children:[y.jsx(iE,{size:14})," New Layer"]})]})},`layers-${zi}`),y.jsx(Ra,{title:"Objects",visible:qn.objects,onClose:()=>fi("objects"),initialPosition:{x:170,y:350},className:"w-56",children:y.jsxs("div",{className:"flex flex-col gap-3",children:[y.jsxs("div",{className:"flex flex-col gap-2",children:[y.jsx("div",{className:"flex justify-between items-center",children:y.jsx("span",{className:"text-[10px] text-white/40 font-bold uppercase tracking-wider",children:"Primitives"})}),y.jsxs("div",{className:"grid grid-cols-4 gap-1",children:[y.jsxs("button",{onClick:()=>L("place-primitive-plane"),className:`flex flex-col items-center justify-center p-2 rounded-lg transition-all ${P==="place-primitive-plane"?"bg-teal-600 text-white":"bg-white/5 border border-transparent hover:bg-white/10"}`,title:"Place Plane",children:[y.jsx(Mp,{size:16}),y.jsx("span",{className:"text-[8px] mt-1",children:"Plane"})]}),y.jsxs("button",{onClick:()=>L("place-primitive-cube"),className:`flex flex-col items-center justify-center p-2 rounded-lg transition-all ${P==="place-primitive-cube"?"bg-teal-600 text-white":"bg-white/5 border border-transparent hover:bg-white/10"}`,title:"Place Cube",children:[y.jsx(R2,{size:16}),y.jsx("span",{className:"text-[8px] mt-1",children:"Cube"})]}),y.jsxs("button",{onClick:()=>L("place-primitive-sphere"),className:`flex flex-col items-center justify-center p-2 rounded-lg transition-all ${P==="place-primitive-sphere"?"bg-teal-600 text-white":"bg-white/5 border border-transparent hover:bg-white/10"}`,title:"Place Sphere",children:[y.jsx(Nm,{size:16}),y.jsx("span",{className:"text-[8px] mt-1",children:"Sphere"})]}),y.jsxs("button",{onClick:()=>L("place-primitive-cylinder"),className:`flex flex-col items-center justify-center p-2 rounded-lg transition-all ${P==="place-primitive-cylinder"?"bg-teal-600 text-white":"bg-white/5 border border-transparent hover:bg-white/10"}`,title:"Place Cylinder",children:[y.jsx(Dm,{size:16}),y.jsx("span",{className:"text-[8px] mt-1",children:"Cylinder"})]})]})]}),y.jsx("div",{className:"h-px bg-white/10"}),y.jsxs("div",{className:"flex flex-col gap-3",children:[y.jsx("span",{className:"text-[10px] text-white/40 font-bold uppercase tracking-wider",children:"Properties"}),ot&&Je&&y.jsxs("div",{className:"grid grid-cols-3 gap-1",children:[y.jsxs("div",{children:[y.jsxs("div",{className:"flex justify-between text-[9px] text-white/50 mb-1",children:[y.jsx("span",{children:"Size X"}),y.jsx("span",{children:Je[0].toFixed(1)})]}),y.jsx("input",{type:"range",min:"0.1",max:"10",step:"0.1",value:Je[0],onChange:V=>ot([parseFloat(V.target.value),Je[1],Je[2]]),onKeyDown:V=>V.stopPropagation(),className:"w-full h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-blue-500"})]}),y.jsxs("div",{children:[y.jsxs("div",{className:"flex justify-between text-[9px] text-white/50 mb-1",children:[y.jsx("span",{children:"Size Y"}),y.jsx("span",{children:Je[1].toFixed(1)})]}),y.jsx("input",{type:"range",min:"0.1",max:"10",step:"0.1",value:Je[1],onChange:V=>ot([Je[0],parseFloat(V.target.value),Je[2]]),onKeyDown:V=>V.stopPropagation(),className:"w-full h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-blue-500"})]}),y.jsxs("div",{children:[y.jsxs("div",{className:"flex justify-between text-[9px] text-white/50 mb-1",children:[y.jsx("span",{children:"Size Z"}),y.jsx("span",{children:Je[2].toFixed(1)})]}),y.jsx("input",{type:"range",min:"0.1",max:"10",step:"0.1",value:Je[2],onChange:V=>ot([Je[0],Je[1],parseFloat(V.target.value)]),onKeyDown:V=>V.stopPropagation(),className:"w-full h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-blue-500"})]})]}),q&&bn!==void 0&&y.jsxs("div",{children:[y.jsxs("div",{className:"flex justify-between text-[9px] text-white/50 mb-1 font-bold uppercase",children:[y.jsx("span",{children:"Opacity"}),y.jsxs("span",{children:[Math.round(bn*100),"%"]})]}),y.jsx("input",{type:"range",min:"0",max:"1",step:"0.05",value:bn,onChange:V=>q(parseFloat(V.target.value)),onKeyDown:V=>V.stopPropagation(),className:"w-full h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-blue-500"})]}),we&&he!==void 0&&y.jsxs("div",{children:[y.jsxs("div",{className:"flex justify-between text-[9px] text-white/50 mb-1 font-bold uppercase",children:[y.jsx("span",{children:"Density (Segs)"}),y.jsx("span",{children:he})]}),y.jsx("input",{type:"range",min:"1",max:"128",step:"1",value:he,onChange:V=>we(parseInt(V.target.value)),onKeyDown:V=>V.stopPropagation(),className:"w-full h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-blue-500"})]}),jn&&mn&&y.jsxs("div",{className:"flex flex-col gap-1",children:[y.jsx("span",{className:"text-[9px] text-white/50 font-bold uppercase",children:"Color"}),y.jsx("div",{className:"flex items-center gap-2",children:y.jsx("input",{type:"color",value:mn,onChange:V=>jn(V.target.value),className:"w-full h-6 bg-transparent border border-white/20 rounded cursor-pointer"})})]}),y.jsxs("div",{className:"p-2 bg-blue-500/10 border border-blue-500/20 rounded text-[10px] text-blue-300 flex items-start gap-2",children:[y.jsx(F2,{size:12,className:"mt-0.5 shrink-0"}),y.jsx("span",{children:"You can paint directly on these objects."})]})]})]})},`objects-${zi}`),En&&li&&y.jsx(Ra,{title:"Grid Settings",visible:qn.grid,onClose:()=>fi("grid"),initialPosition:{x:Xa(300),y:320},className:"w-56",children:y.jsxs("div",{className:"flex flex-col gap-3",children:[y.jsxs("div",{className:"flex items-center justify-between",children:[y.jsx("span",{className:"text-[10px] font-bold text-white/40 uppercase tracking-wider",children:"Visible"}),y.jsx("button",{onClick:()=>li(V=>({...V,visible:!V.visible})),className:`w-8 h-4 rounded-full relative transition-colors ${En.visible?"bg-blue-600":"bg-white/20"}`,children:y.jsx("div",{className:`absolute top-0.5 left-0.5 w-3 h-3 bg-white rounded-full transition-transform ${En.visible?"translate-x-4":"translate-x-0"}`})})]}),En.visible&&y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"h-px bg-white/10"}),y.jsxs("div",{children:[y.jsxs("div",{className:"flex justify-between text-white/50 text-[10px] font-bold uppercase tracking-wider mb-1",children:[y.jsx("span",{children:"Cell Size"}),y.jsx("span",{children:En.cellSize})]}),y.jsx("input",{type:"range",min:"0.1",max:"5",step:"0.1",value:En.cellSize,onKeyDown:V=>V.stopPropagation(),onChange:V=>li(Wt=>({...Wt,cellSize:parseFloat(V.target.value)})),className:"w-full h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-blue-500"})]}),y.jsxs("div",{children:[y.jsxs("div",{className:"flex justify-between text-white/50 text-[10px] font-bold uppercase tracking-wider mb-1",children:[y.jsx("span",{children:"Section Size"}),y.jsx("span",{children:En.sectionSize})]}),y.jsx("input",{type:"range",min:"1",max:"20",step:"1",value:En.sectionSize,onKeyDown:V=>V.stopPropagation(),onChange:V=>li(Wt=>({...Wt,sectionSize:parseFloat(V.target.value)})),className:"w-full h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-blue-500"})]}),y.jsxs("div",{children:[y.jsxs("div",{className:"flex justify-between text-white/50 text-[10px] font-bold uppercase tracking-wider mb-1",children:[y.jsx("span",{children:"Fade Dist"}),y.jsx("span",{children:En.fadeDistance})]}),y.jsx("input",{type:"range",min:"10",max:"200",step:"5",value:En.fadeDistance,onKeyDown:V=>V.stopPropagation(),onChange:V=>li(Wt=>({...Wt,fadeDistance:parseFloat(V.target.value)})),className:"w-full h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-blue-500"})]}),y.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-2",children:[y.jsxs("div",{className:"flex flex-col gap-1",children:[y.jsx("span",{className:"text-[9px] text-white/40 uppercase",children:"Cell Color"}),y.jsx("input",{type:"color",value:En.cellColor,onChange:V=>li(Wt=>({...Wt,cellColor:V.target.value})),className:"w-full h-6 bg-transparent border border-white/20 rounded cursor-pointer"})]}),y.jsxs("div",{className:"flex flex-col gap-1",children:[y.jsx("span",{className:"text-[9px] text-white/40 uppercase",children:"Sect Color"}),y.jsx("input",{type:"color",value:En.sectionColor,onChange:V=>li(Wt=>({...Wt,sectionColor:V.target.value})),className:"w-full h-6 bg-transparent border border-white/20 rounded cursor-pointer"})]})]}),y.jsxs("div",{className:"flex justify-between items-center mt-2 border-t border-white/10 pt-2",children:[y.jsx("span",{className:"text-[9px] text-white/40 uppercase font-bold tracking-wider",children:"Double Side"}),y.jsx("button",{onClick:()=>li(V=>({...V,doubleSide:!V.doubleSide})),className:`w-8 h-4 rounded-full relative transition-colors ${En.doubleSide?"bg-blue-600":"bg-white/20"}`,children:y.jsx("div",{className:`absolute top-0.5 left-0.5 w-3 h-3 bg-white rounded-full transition-transform ${En.doubleSide?"translate-x-4":"translate-x-0"}`})})]}),y.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-2 border-t border-white/10 pt-2",children:[y.jsxs("button",{onClick:la,className:`flex items-center justify-center gap-1 py-1.5 rounded text-[10px] border transition-colors ${qi?"bg-blue-600 border-blue-500 text-white":"bg-white/5 border-transparent text-white/60 hover:text-white"}`,children:[y.jsx(nE,{size:12})," Select Grid"]}),y.jsxs("button",{onClick:di,className:"flex items-center justify-center gap-1 py-1.5 rounded text-[10px] bg-white/5 border border-transparent hover:bg-white/10 text-white/60 hover:text-white transition-colors",children:[y.jsx(w6,{size:12})," Reset Grid"]})]})]})]})},`grid-${zi}`),mt&&Pt&&y.jsx(Ra,{title:"Symmetry",visible:qn.symmetry,onClose:()=>fi("symmetry"),initialPosition:{x:Xa(300),y:250},className:"w-64",children:y.jsxs("div",{className:"flex flex-col gap-3",children:[y.jsxs("div",{className:"flex justify-between items-center",children:[y.jsxs("span",{className:"text-[10px] text-white/40 font-bold uppercase flex items-center gap-1",children:[y.jsx(I2,{size:12})," Enable Symmetry"]}),y.jsx("button",{onClick:()=>Pt(V=>({...V,enabled:!V.enabled})),className:`w-8 h-4 rounded-full relative transition-colors ${mt.enabled?"bg-teal-600":"bg-white/20"}`,children:y.jsx("div",{className:`absolute top-0.5 left-0.5 w-3 h-3 bg-white rounded-full transition-transform ${mt.enabled?"translate-x-4":"translate-x-0"}`})})]}),mt.enabled&&y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"h-px bg-white/10"}),y.jsxs("div",{className:"flex flex-col gap-2",children:[y.jsx("span",{className:"text-[10px] text-white/40 font-bold uppercase",children:"Mode"}),y.jsxs("div",{className:"grid grid-cols-3 gap-1 p-0.5 bg-black/40 rounded",children:[y.jsxs("button",{onClick:()=>Pt(V=>({...V,mode:"mirror"})),className:`flex items-center justify-center gap-1 py-1.5 rounded text-[9px] transition-all ${mt.mode==="mirror"?"bg-teal-600 text-white shadow font-bold":"text-white/50 hover:text-white"}`,children:[y.jsx(A2,{size:10})," Mirror"]}),y.jsxs("button",{onClick:()=>Pt(V=>({...V,mode:"radial"})),className:`flex items-center justify-center gap-1 py-1.5 rounded text-[9px] transition-all ${mt.mode==="radial"?"bg-teal-600 text-white shadow font-bold":"text-white/50 hover:text-white"}`,children:[y.jsx(Lm,{size:10})," Radial"]}),y.jsxs("button",{onClick:()=>Pt(V=>({...V,mode:"array"})),className:`flex items-center justify-center gap-1 py-1.5 rounded text-[9px] transition-all ${mt.mode==="array"?"bg-teal-600 text-white shadow font-bold":"text-white/50 hover:text-white"}`,children:[y.jsx(Sp,{size:10})," Matriz"]}),y.jsxs("button",{onClick:()=>Pt(V=>({...V,mode:"path"})),className:`flex items-center justify-center gap-1 py-1.5 rounded text-[9px] transition-all ${mt.mode==="path"?"bg-teal-600 text-white shadow font-bold":"text-white/50 hover:text-white"}`,children:[y.jsx(oE,{size:10})," Path"]})]})]}),y.jsx("div",{className:"h-px bg-white/10"}),mt.mode==="mirror"&&y.jsxs("div",{className:"flex flex-col gap-2 p-2 bg-white/5 rounded border border-white/5",children:[y.jsxs("span",{className:"text-[10px] text-white/40 font-bold uppercase flex items-center gap-1",children:[y.jsx(A2,{size:10})," Mirror Axes"]}),y.jsxs("div",{className:"flex justify-between items-center",children:[y.jsx("span",{className:"text-[9px] text-white/50",children:"Active Axes"}),y.jsx("div",{className:"flex gap-1",children:["X","Y","Z"].map(V=>y.jsx("button",{onClick:()=>Pt(Wt=>({...Wt,[`mirror${V}`]:!Wt[`mirror${V}`]})),className:`w-8 h-8 rounded flex items-center justify-center text-[11px] font-bold border transition-colors ${mt[`mirror${V}`]?"bg-teal-600/30 border-teal-500 text-teal-400":"bg-white/5 border-transparent text-white/30 hover:bg-white/10"}`,children:V},V))})]}),y.jsx("div",{className:"text-[8px] text-white/40 italic text-center mt-1",children:"Select one or more axes to mirror across"})]}),mt.mode==="radial"&&y.jsxs("div",{className:"flex flex-col gap-2 p-2 bg-white/5 rounded border border-white/5",children:[y.jsxs("span",{className:"text-[10px] text-white/40 font-bold uppercase flex items-center gap-1",children:[y.jsx(Lm,{size:10})," Radial Settings"]}),y.jsxs("div",{className:"flex flex-col gap-2",children:[y.jsxs("div",{className:"flex justify-between text-[9px] text-white/50",children:[y.jsxs("span",{children:["Count: ",mt.radialCount]}),y.jsx("span",{children:"Rotation Axis"})]}),y.jsxs("div",{className:"flex gap-2",children:[y.jsx("input",{type:"range",min:"1",max:"36",step:"1",value:mt.radialCount,onChange:V=>Pt(Wt=>({...Wt,radialCount:parseInt(V.target.value)})),className:"flex-1 h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-teal-500 mt-2"}),y.jsx("div",{className:"flex gap-0.5",children:["x","y","z"].map(V=>y.jsx("button",{onClick:()=>Pt(Wt=>({...Wt,radialAxis:V})),className:`w-6 h-6 rounded text-[9px] font-bold uppercase transition-colors ${mt.radialAxis===V?"bg-teal-600 text-white":"bg-white/10 text-white/40"}`,children:V},V))})]})]}),y.jsx("div",{className:"text-[8px] text-white/40 italic text-center mt-1",children:"Copies will be distributed around the selected axis"})]}),mt.mode==="array"&&y.jsxs("div",{className:"flex flex-col gap-2 p-2 bg-white/5 rounded border border-white/5",children:[y.jsxs("span",{className:"text-[10px] text-white/40 font-bold uppercase flex items-center gap-1",children:[y.jsx(Sp,{size:10})," Array Settings"]}),y.jsxs("div",{className:"flex flex-col gap-2",children:[y.jsx("span",{className:"text-[9px] text-white/50 font-bold",children:"Repetitions"}),y.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[y.jsxs("div",{className:"flex flex-col gap-1",children:[y.jsxs("span",{className:"text-[8px] text-white/40 uppercase",children:["X: ",mt.arrayCountX]}),y.jsx("input",{type:"range",min:"1",max:"20",step:"1",value:mt.arrayCountX,onChange:V=>Pt(Wt=>({...Wt,arrayCountX:parseInt(V.target.value)})),className:"w-full h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-red-500"})]}),y.jsxs("div",{className:"flex flex-col gap-1",children:[y.jsxs("span",{className:"text-[8px] text-white/40 uppercase",children:["Y: ",mt.arrayCountY]}),y.jsx("input",{type:"range",min:"1",max:"20",step:"1",value:mt.arrayCountY,onChange:V=>Pt(Wt=>({...Wt,arrayCountY:parseInt(V.target.value)})),className:"w-full h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-green-500"})]}),y.jsxs("div",{className:"flex flex-col gap-1",children:[y.jsxs("span",{className:"text-[8px] text-white/40 uppercase",children:["Z: ",mt.arrayCountZ]}),y.jsx("input",{type:"range",min:"1",max:"20",step:"1",value:mt.arrayCountZ,onChange:V=>Pt(Wt=>({...Wt,arrayCountZ:parseInt(V.target.value)})),className:"w-full h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-blue-500"})]})]})]}),y.jsxs("div",{className:"flex flex-col gap-2 mt-2",children:[y.jsx("span",{className:"text-[9px] text-white/50 font-bold",children:"Spacing"}),y.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[y.jsxs("div",{className:"flex flex-col gap-1",children:[y.jsxs("span",{className:"text-[8px] text-white/40 uppercase",children:["X: ",mt.arraySpacingX.toFixed(1)]}),y.jsx("input",{type:"range",min:"0.1",max:"10",step:"0.1",value:mt.arraySpacingX,onChange:V=>Pt(Wt=>({...Wt,arraySpacingX:parseFloat(V.target.value)})),className:"w-full h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-red-500"})]}),y.jsxs("div",{className:"flex flex-col gap-1",children:[y.jsxs("span",{className:"text-[8px] text-white/40 uppercase",children:["Y: ",mt.arraySpacingY.toFixed(1)]}),y.jsx("input",{type:"range",min:"0.1",max:"10",step:"0.1",value:mt.arraySpacingY,onChange:V=>Pt(Wt=>({...Wt,arraySpacingY:parseFloat(V.target.value)})),className:"w-full h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-green-500"})]}),y.jsxs("div",{className:"flex flex-col gap-1",children:[y.jsxs("span",{className:"text-[8px] text-white/40 uppercase",children:["Z: ",mt.arraySpacingZ.toFixed(1)]}),y.jsx("input",{type:"range",min:"0.1",max:"10",step:"0.1",value:mt.arraySpacingZ,onChange:V=>Pt(Wt=>({...Wt,arraySpacingZ:parseFloat(V.target.value)})),className:"w-full h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-blue-500"})]})]})]}),y.jsxs("div",{className:"flex items-center justify-between bg-teal-600/10 px-2 py-1.5 rounded border border-teal-500/30 mt-1",children:[y.jsx("span",{className:"text-[9px] text-teal-300 font-bold",children:"Total Copies:"}),y.jsx("span",{className:"text-[10px] text-teal-400 font-bold",children:mt.arrayCountX*mt.arrayCountY*mt.arrayCountZ})]}),y.jsx("button",{onClick:()=>Qt==null?void 0:Qt(),className:"w-full py-1.5 mt-2 rounded bg-teal-600 hover:bg-teal-500 text-white text-[9px] font-bold uppercase transition-colors",title:"Duplicate selected object into the grid",children:"Apply to Selection"}),y.jsx("div",{className:"text-[8px] text-white/40 italic text-center mt-1",children:"Creates a 3D grid of copies with custom spacing"})]}),mt.mode==="path"&&y.jsxs("div",{className:"flex flex-col gap-2 p-2 bg-white/5 rounded border border-white/5",children:[y.jsxs("span",{className:"text-[10px] text-white/40 font-bold uppercase flex items-center gap-1",children:[y.jsx(oE,{size:10})," Path Settings"]}),y.jsxs("div",{className:"flex flex-col gap-1",children:[y.jsx("span",{className:"text-[9px] text-white/50 font-bold",children:"Target Path"}),y.jsxs("div",{className:"flex gap-2",children:[y.jsx("button",{onClick:()=>L("pick-symmetry-path"),className:`flex-1 py-1.5 rounded text-[9px] font-bold uppercase transition-colors flex items-center justify-center gap-1 ${P==="pick-symmetry-path"?"bg-blue-600 text-white animate-pulse":mt.pathId?"bg-teal-600/20 text-teal-400 border border-teal-500/50":"bg-white/10 text-white/50 hover:bg-white/20"}`,children:P==="pick-symmetry-path"?"Select a Line...":mt.pathId?"Path Selected":"Pick Path"}),mt.pathId&&y.jsx("button",{onClick:()=>Pt(V=>({...V,pathId:void 0})),className:"p-1.5 bg-white/5 hover:bg-red-500/20 text-white/40 hover:text-red-400 rounded transition-colors",children:y.jsx(G_,{size:12})})]})]}),y.jsxs("div",{className:"flex flex-col gap-1 mt-1",children:[y.jsx("div",{className:"flex justify-between text-[9px] text-white/50",children:y.jsxs("span",{children:["Count: ",mt.pathCount]})}),y.jsx("input",{type:"range",min:"2",max:"50",step:"1",value:mt.pathCount,onChange:V=>Pt(Wt=>({...Wt,pathCount:parseInt(V.target.value)})),className:"w-full h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-teal-500"})]}),y.jsxs("div",{className:"flex justify-between items-center mt-1 border-t border-white/5 pt-2",children:[y.jsx("span",{className:"text-[9px] text-white/50 font-bold uppercase",children:"Align to Path"}),y.jsx("button",{onClick:()=>Pt(V=>({...V,pathAlign:!V.pathAlign})),className:`w-8 h-4 rounded-full relative transition-colors ${mt.pathAlign?"bg-teal-600":"bg-white/20"}`,children:y.jsx("div",{className:`absolute top-0.5 left-0.5 w-3 h-3 bg-white rounded-full transition-transform ${mt.pathAlign?"translate-x-4":"translate-x-0"}`})})]}),y.jsx("button",{onClick:()=>Qt==null?void 0:Qt(),disabled:!mt.pathId,className:`w-full py-1.5 mt-2 rounded text-white text-[9px] font-bold uppercase transition-colors ${mt.pathId?"bg-teal-600 hover:bg-teal-500":"bg-white/5 text-white/20 cursor-not-allowed"}`,title:"Duplicate selected object along the path",children:"Apply to Selection"}),y.jsx("div",{className:"text-[8px] text-white/40 italic text-center mt-1",children:"Distributes copies along a selected curve"})]}),y.jsx("div",{className:"h-px bg-white/10"}),y.jsxs("div",{className:"flex flex-col gap-2",children:[y.jsx("span",{className:"text-[10px] text-white/40 font-bold uppercase",children:"Gizmo Visibility"}),y.jsxs("div",{className:"flex justify-between items-center bg-white/5 px-2 py-1.5 rounded",children:[y.jsx("span",{className:"text-[9px] text-white/70",children:"Show Symmetry Gizmo"}),y.jsx("button",{onClick:()=>Pt(V=>({...V,visible:!V.visible})),className:`w-8 h-4 rounded-full relative transition-colors ${mt.visible?"bg-blue-600":"bg-white/20"}`,children:y.jsx("div",{className:`absolute top-0.5 left-0.5 w-3 h-3 bg-white rounded-full transition-transform ${mt.visible?"translate-x-4":"translate-x-0"}`})})]})]}),y.jsx("div",{className:"h-px bg-white/10"}),y.jsxs("div",{className:"flex flex-col gap-2",children:[y.jsx("span",{className:"text-[10px] text-white/40 font-bold uppercase",children:"Gizmo Controls"}),y.jsxs("div",{className:"flex gap-1 justify-between items-center",children:[y.jsx("span",{className:"text-[9px] text-white/50",children:"Transform Gizmos"}),y.jsxs("div",{className:"flex gap-0.5",children:[y.jsx("button",{onClick:()=>Pt(V=>({...V,gizmoTranslate:!V.gizmoTranslate})),className:`w-8 h-8 flex items-center justify-center rounded transition-colors ${mt.gizmoTranslate?"bg-teal-600 text-white":"bg-white/5 text-white/30 hover:bg-white/10"}`,title:"Toggle Move Gizmo",children:y.jsx(nE,{size:14})}),y.jsx("button",{onClick:()=>Pt(V=>({...V,gizmoRotate:!V.gizmoRotate})),className:`w-8 h-8 flex items-center justify-center rounded transition-colors ${mt.gizmoRotate?"bg-teal-600 text-white":"bg-white/5 text-white/30 hover:bg-white/10"}`,title:"Toggle Rotate Gizmo",children:y.jsx(Um,{size:14})}),y.jsx("button",{onClick:()=>Pt(V=>({...V,gizmoScale:!V.gizmoScale})),className:`w-8 h-8 flex items-center justify-center rounded transition-colors ${mt.gizmoScale?"bg-teal-600 text-white":"bg-white/5 text-white/30 hover:bg-white/10"}`,title:"Toggle Scale Gizmo",children:y.jsx(Rv,{size:14})})]})]})]}),y.jsx("div",{className:"h-px bg-white/10"}),y.jsxs("div",{className:"flex flex-col gap-2",children:[y.jsx("span",{className:"text-[10px] text-white/40 font-bold uppercase",children:"Quick Actions"}),y.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[y.jsxs("button",{onClick:()=>Pt(V=>({...V,position:[0,0,0],rotation:[0,0,0]})),className:"flex items-center justify-center gap-1 py-1.5 rounded text-[9px] bg-white/5 border border-transparent text-white/60 hover:bg-white/10 hover:text-white transition-colors",children:[y.jsx(F2,{size:12})," Reset Center"]}),y.jsxs("button",{onClick:()=>Pt(V=>({...V,scale:[1,1,1]})),className:"flex items-center justify-center gap-1 py-1.5 rounded text-[9px] bg-white/5 border border-transparent text-white/60 hover:bg-white/10 hover:text-white transition-colors",children:[y.jsx(Rv,{size:12})," Reset Scale"]})]})]}),y.jsx("div",{className:"h-px bg-white/10"}),y.jsxs("button",{onClick:en,className:"flex items-center justify-center gap-2 w-full py-2 rounded text-[11px] bg-gradient-to-r from-teal-600/40 to-cyan-600/40 hover:from-teal-600/60 hover:to-cyan-600/60 text-white font-bold transition-all shadow-lg border border-teal-500/30",children:[y.jsx(Tv,{size:14})," Draw on Symmetry Plane"]}),y.jsx("div",{className:"flex flex-col gap-1 p-2 bg-blue-600/10 rounded border border-blue-500/30 text-[9px] text-blue-300",children:y.jsxs("div",{className:"flex items-start gap-2",children:[y.jsx(zh,{size:12,className:"text-blue-400 mt-0.5 shrink-0"}),y.jsxs("div",{className:"flex-1",children:[y.jsx("p",{className:"font-bold mb-1",children:"Symmetry Tips:"}),y.jsxs("p",{className:"text-[8px] text-blue-300/80 leading-relaxed",children:[" Use Mirror mode for bilateral symmetry",y.jsx("br",{})," Use Radial mode for circular patterns",y.jsx("br",{})," Use Matriz mode for 3D grid arrays",y.jsx("br",{})," Enable gizmos to transform the symmetry center",y.jsx("br",{}),' Click "Draw on Symmetry Plane" to align your drawing plane']})]})]})})]})]})},`symmetry-${zi}`),y.jsx(Ra,{title:"Command Line",visible:qn.commandLine,onClose:()=>fi("commandLine"),initialPosition:{x:window.innerWidth/2-200,y:window.innerHeight-100},className:"w-[400px]",children:y.jsxs("form",{onSubmit:Ds,className:"flex gap-2",children:[y.jsxs("div",{className:"relative flex-1",children:[y.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-white/40 text-xs font-mono",children:">"}),y.jsx("input",{type:"text",value:Qa,onChange:V=>ca(V.target.value),className:"w-full bg-black/50 border border-white/10 rounded px-2 pl-6 py-1 text-xs text-white font-mono focus:border-green-500 focus:outline-none",placeholder:"Enter command (e.g. 10<45 or 5)",onKeyDown:V=>V.stopPropagation(),autoFocus:!0})]}),y.jsx("button",{type:"submit",className:"px-3 py-1 bg-white/10 hover:bg-green-500/20 text-white/70 hover:text-green-400 rounded text-xs transition-colors border border-white/5",children:"Run"})]})},`cmd-${zi}`),y.jsx(Ra,{title:"Camera & Render",visible:qn.camera,onClose:()=>fi("camera"),initialPosition:{x:Xa(300),y:180},className:"w-56",children:y.jsxs("div",{className:"flex flex-col gap-3",children:[y.jsxs("div",{children:[y.jsxs("div",{className:"flex justify-between text-white/50 text-[10px] font-bold uppercase tracking-wider mb-1",children:[y.jsxs("span",{className:"flex items-center gap-1",children:[y.jsx(Zw,{size:10})," FOV"]}),y.jsxs("span",{children:[Rt,""]})]}),y.jsx("input",{type:"range",min:"10",max:"120",step:"1",value:Rt,onKeyDown:V=>V.stopPropagation(),onChange:V=>dt(parseInt(V.target.value)),className:"w-full h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-purple-500"})]}),y.jsxs("div",{children:[y.jsxs("div",{className:"flex justify-between text-white/50 text-[10px] font-bold uppercase tracking-wider mb-1",children:[y.jsxs("span",{className:"flex items-center gap-1",children:[y.jsx(z2,{size:10})," Exposure"]}),y.jsx("span",{children:Ke.toFixed(1)})]}),y.jsx("input",{type:"range",min:"0.1",max:"5.0",step:"0.1",value:Ke,onKeyDown:V=>V.stopPropagation(),onChange:V=>Lt(parseFloat(V.target.value)),className:"w-full h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-yellow-500"})]}),y.jsx("div",{className:"h-px bg-white/10"}),yn&&ln&&y.jsxs("div",{className:"flex flex-col gap-2",children:[y.jsxs("span",{className:"text-[10px] font-bold text-white/40 uppercase tracking-wider flex items-center gap-1",children:[y.jsx(Lm,{size:10})," Product Turntable"]}),y.jsxs("div",{className:"flex gap-1 bg-white/5 p-1 rounded",children:[y.jsx("button",{onClick:()=>ln(V=>({...V,active:!V.active})),className:`flex-1 flex items-center justify-center py-1.5 rounded transition-colors ${yn.active?"bg-red-500/20 text-red-400":"bg-green-500/20 text-green-400"}`,title:yn.active?"Pause Animation":"Play Animation",children:yn.active?y.jsx(D2,{size:14,fill:"currentColor"}):y.jsx(Ap,{size:14,fill:"currentColor"})}),y.jsx("button",{onClick:()=>ln(V=>({...V,active:!1})),className:"flex-1 flex items-center justify-center py-1.5 rounded hover:bg-white/10 text-white/60 hover:text-white",title:"Stop / Reset",children:y.jsx(E2,{size:14})}),y.jsx("button",{onClick:()=>ln(V=>({...V,direction:V.direction*-1})),className:"flex-1 flex items-center justify-center py-1.5 rounded hover:bg-white/10 text-white/60 hover:text-white",title:"Invert Direction",children:y.jsx(S2,{size:14})}),y.jsx("button",{onClick:()=>ln(V=>({...V,loop:!V.loop})),className:`flex-1 flex items-center justify-center py-1.5 rounded transition-colors ${yn.loop?"bg-blue-500/20 text-blue-400":"text-white/30 hover:text-white"}`,title:"Toggle Loop",children:y.jsx(_6,{size:14})})]}),y.jsx("div",{className:"flex gap-1",children:[90,180,360].map(V=>y.jsxs("button",{onClick:()=>ln(Wt=>({...Wt,range:V})),className:`flex-1 text-[9px] py-1 rounded border transition-colors ${yn.range===V?"bg-white/20 border-white/40 text-white font-bold":"border-transparent text-white/40 hover:bg-white/5"}`,children:[V,""]},V))}),y.jsxs("div",{className:"flex justify-between items-center mt-1",children:[y.jsxs("div",{className:"flex flex-col flex-1 mr-2",children:[y.jsx("span",{className:"text-[8px] text-white/40 uppercase mb-0.5",children:"Speed"}),y.jsx("input",{type:"range",min:"0.1",max:"5",step:"0.1",value:yn.speed,onChange:V=>ln(Wt=>({...Wt,speed:parseFloat(V.target.value)})),className:"w-full h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-blue-500"})]}),y.jsxs("button",{onClick:()=>ln(V=>({...V,showGizmo:!V.showGizmo})),className:`flex items-center gap-1 px-2 py-1.5 rounded text-[9px] border transition-colors ${yn.showGizmo?"bg-orange-500/20 border-orange-500 text-orange-400":"bg-white/5 border-transparent text-white/50 hover:text-white"}`,title:"Place Rotation Center Gizmo",children:[y.jsx(eE,{size:10})," Edit Pivot"]})]})]}),y.jsx("div",{className:"h-px bg-white/10"}),y.jsxs("div",{className:"flex justify-between items-center",children:[y.jsx("span",{className:"text-[10px] font-bold text-white/40 uppercase tracking-wider",children:"Background"}),y.jsxs("div",{className:"relative group w-6 h-6 border border-white/20 rounded overflow-hidden",children:[y.jsx("input",{type:"color",value:Vt,onChange:V=>Kt(V.target.value),className:"absolute inset-0 opacity-0 cursor-pointer w-full h-full z-10"}),y.jsx("div",{className:"w-full h-full",style:{backgroundColor:Vt}})]})]}),y.jsxs("div",{className:"flex justify-between items-center mt-2 border-t border-white/10 pt-2",children:[y.jsx("span",{className:"text-[10px] font-bold text-white/40 uppercase tracking-wider",children:"Wireframe"}),y.jsx("button",{onClick:()=>Dt&&Dt(!Ot),className:`w-8 h-4 rounded-full relative transition-colors ${Ot?"bg-blue-600":"bg-white/20"}`,children:y.jsx("div",{className:`absolute top-0.5 left-0.5 w-3 h-3 bg-white rounded-full transition-transform ${Ot?"translate-x-4":"translate-x-0"}`})})]}),y.jsxs("div",{className:"flex flex-col gap-2 mt-1 border-t border-white/10 pt-2",children:[y.jsx("span",{className:"text-[10px] font-bold text-white/40 uppercase tracking-wider",children:"Environment (HDRI)"}),K?y.jsxs("div",{className:"flex flex-col gap-2",children:[y.jsxs("div",{className:"flex items-center justify-between text-[9px] bg-green-500/10 border border-green-500/30 text-green-400 px-2 py-1 rounded",children:[y.jsx("span",{className:"truncate flex-1",children:"Loaded"}),y.jsx("button",{onClick:()=>{var V;return(V=Dl.current)==null?void 0:V.click()},className:"ml-2 hover:text-white",children:y.jsx(Um,{size:10})})]}),y.jsxs("div",{className:"flex justify-between items-center",children:[y.jsx("span",{className:"text-[9px] text-white/60",children:"BG Visible"}),y.jsx("button",{onClick:()=>xe&&xe(!be),className:`w-6 h-3 rounded-full relative transition-colors ${be?"bg-green-600":"bg-white/20"}`,children:y.jsx("div",{className:`absolute top-0.5 left-0.5 w-2 h-2 bg-white rounded-full transition-transform ${be?"translate-x-3":"translate-x-0"}`})})]})]}):y.jsx("div",{className:"flex gap-2 items-center",children:y.jsxs("button",{onClick:()=>{var V;return(V=Dl.current)==null?void 0:V.click()},className:"flex items-center justify-center gap-2 bg-white/10 hover:bg-white/20 text-white/70 hover:text-white px-2 py-1.5 rounded text-[10px] border border-white/5 transition-colors w-full",children:[y.jsx(Bz,{size:12})," Upload .hdr / .exr"]})}),y.jsx("input",{ref:Dl,type:"file",accept:".hdr,.exr,.jpg,.jpeg,.png",onChange:Nt,hidden:!0})]}),yt&&$e&&y.jsxs("div",{className:"flex flex-col gap-2 mt-1 border-t border-white/10 pt-2",children:[y.jsxs("div",{className:"flex justify-between items-center",children:[y.jsxs("span",{className:"text-[10px] font-bold text-white/40 uppercase tracking-wider flex items-center gap-1",children:[y.jsx(G6,{size:10})," Stars"]}),y.jsx("button",{onClick:()=>Me&&Me(!Oe),className:`w-8 h-4 rounded-full relative transition-colors ${Oe?"bg-purple-600":"bg-white/20"}`,children:y.jsx("div",{className:`absolute top-0.5 left-0.5 w-3 h-3 bg-white rounded-full transition-transform ${Oe?"translate-x-4":"translate-x-0"}`})})]}),Oe&&y.jsxs(y.Fragment,{children:[y.jsxs("div",{children:[y.jsxs("div",{className:"flex justify-between text-white/50 text-[9px] mb-1",children:[y.jsx("span",{children:"Count"}),y.jsx("span",{children:$e.count})]}),y.jsx("input",{type:"range",min:"100",max:"10000",step:"100",value:$e.count,onKeyDown:V=>V.stopPropagation(),onChange:V=>yt(Wt=>({...Wt,count:parseInt(V.target.value)})),className:"w-full h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-purple-500"})]}),y.jsxs("div",{children:[y.jsxs("div",{className:"flex justify-between text-white/50 text-[9px] mb-1",children:[y.jsx("span",{children:"Depth"}),y.jsx("span",{children:$e.depth})]}),y.jsx("input",{type:"range",min:"10",max:"200",step:"10",value:$e.depth,onKeyDown:V=>V.stopPropagation(),onChange:V=>yt(Wt=>({...Wt,depth:parseInt(V.target.value)})),className:"w-full h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-purple-500"})]})]})]})]})},`camera-${zi}`),y.jsx(Ra,{title:"Cube Generator",visible:qn.cubes,onClose:()=>fi("cubes"),initialPosition:{x:300,y:100},className:"w-56",children:y.jsxs("div",{className:"flex flex-col gap-3",children:[y.jsxs("div",{className:"flex flex-col gap-1",children:[y.jsx("span",{className:"text-[10px] text-white/40 font-bold uppercase tracking-wider",children:"Instant"}),y.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[y.jsxs("button",{onClick:()=>ft==null?void 0:ft("basic"),className:"flex flex-col items-center justify-center p-2 bg-white/5 hover:bg-white/10 rounded border border-white/5 text-white/70",children:[y.jsx(kc,{size:16,className:"mb-1"}),y.jsx("span",{className:"text-[10px]",children:"Basic 1x1"})]}),y.jsxs("button",{onClick:()=>ft==null?void 0:ft("random"),className:"flex flex-col items-center justify-center p-2 bg-white/5 hover:bg-white/10 rounded border border-white/5 text-white/70",children:[y.jsx(O2,{size:16,className:"mb-1"}),y.jsx("span",{className:"text-[10px]",children:"Random 50"})]}),y.jsxs("button",{onClick:()=>ft==null?void 0:ft("grid"),className:"col-span-2 flex items-center justify-center gap-2 p-2 bg-white/5 hover:bg-white/10 rounded border border-white/5 text-white/70",children:[y.jsx(Sp,{size:14}),y.jsx("span",{className:"text-[10px]",children:"Matrix 10x10"})]})]})]}),y.jsx("div",{className:"h-px bg-white/10"}),y.jsxs("div",{className:"flex flex-col gap-1",children:[y.jsx("span",{className:"text-[10px] text-white/40 font-bold uppercase tracking-wider",children:"Interactive"}),y.jsxs("button",{onClick:()=>L("create-cube-click"),className:`flex items-center gap-2 px-2 py-1.5 rounded text-xs border ${P==="create-cube-click"?"bg-blue-600 border-blue-500 text-white":"bg-white/5 border-transparent text-white/70 hover:bg-white/10"}`,children:[y.jsx(tE,{size:14})," Click to Place"]}),y.jsxs("button",{onClick:()=>L("create-cube-2pt"),className:`flex items-center gap-2 px-2 py-1.5 rounded text-xs border ${P==="create-cube-2pt"?"bg-blue-600 border-blue-500 text-white":"bg-white/5 border-transparent text-white/70 hover:bg-white/10"}`,children:[y.jsx(sE,{size:14})," 2-Point Box"]})]}),y.jsx("div",{className:"p-2 bg-blue-500/10 border border-blue-500/20 rounded text-[10px] text-blue-300",children:" Interactive modes use current color setting."})]})},`cubes-${zi}`),y.jsx(Ra,{title:"Voxel Painter",visible:qn.voxelPainter,onClose:()=>fi("voxelPainter"),initialPosition:{x:Xa(540),y:180},className:"w-56",children:y.jsx("div",{className:"flex flex-col gap-3",children:Ft&&Mt!==void 0&&y.jsxs("div",{className:"flex flex-col gap-2",children:[y.jsxs("div",{children:[y.jsxs("div",{className:"flex justify-between text-green-400 text-[10px] font-bold uppercase tracking-wider mb-1",children:[y.jsx("span",{children:"Voxel Size"}),y.jsx("span",{children:Mt.toFixed(1)})]}),y.jsx("input",{type:"range",min:"0.1",max:"5.0",step:"0.1",value:Mt,onKeyDown:V=>V.stopPropagation(),onChange:V=>Ft(parseFloat(V.target.value)),className:"w-full h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-green-500"})]}),jn&&mn&&y.jsxs("div",{children:[y.jsx("div",{className:"flex justify-between text-green-400 text-[10px] font-bold uppercase tracking-wider mb-1",children:y.jsx("span",{children:"Voxel Color"})}),y.jsxs("div",{className:"flex gap-2 items-center",children:[y.jsx("input",{type:"color",value:mn,onChange:V=>jn(V.target.value),className:"w-8 h-8 bg-transparent border border-green-500/30 rounded cursor-pointer"}),y.jsx("div",{className:"text-[10px] text-white/50 uppercase",children:mn})]})]}),q&&bn!==void 0&&y.jsxs("div",{children:[y.jsxs("div",{className:"flex justify-between text-green-400 text-[10px] font-bold uppercase tracking-wider mb-1",children:[y.jsx("span",{children:"Opacity"}),y.jsxs("span",{children:[Math.round(bn*100),"%"]})]}),y.jsx("input",{type:"range",min:"0",max:"1",step:"0.05",value:bn,onChange:V=>q(parseFloat(V.target.value)),onKeyDown:V=>V.stopPropagation(),className:"w-full h-1 bg-white/10 rounded-lg appearance-none cursor-pointer accent-green-500"})]}),y.jsx("div",{className:"h-px bg-white/10 my-1"}),y.jsxs("div",{className:"flex flex-col gap-1",children:[y.jsxs("div",{className:"text-[9px] text-green-400/60 flex items-center gap-2",children:[y.jsx(tE,{size:10})," Click to Add Voxel"]}),y.jsxs("div",{className:"text-[9px] text-red-400/60 mt-0.5 flex items-center gap-2",children:[y.jsx(kc,{size:10})," Shift+Click to Remove"]})]})]})})},`voxel-${zi}`),y.jsx(Ra,{title:"Script Editor",visible:qn.script,onClose:()=>fi("script"),initialPosition:{x:Math.max(20,window.innerWidth/2-275),y:Math.max(20,window.innerHeight/2-200)},className:"w-[550px] h-[450px]",children:y.jsxs("div",{className:"flex flex-col h-full gap-2 relative",children:[y.jsx("div",{className:"flex-1 bg-[#1e1e1e] rounded border border-white/10 overflow-hidden relative group",children:y.jsx("textarea",{className:"w-full h-full bg-transparent text-gray-300 font-mono text-xs p-3 resize-none focus:outline-none custom-scrollbar",spellCheck:!1,placeholder:"// Write your script here...",value:Hr,onChange:V=>Do(V.target.value),onKeyDown:V=>V.stopPropagation()})}),y.jsx("div",{className:"flex justify-between items-center",children:y.jsx("div",{className:"flex gap-2",children:y.jsxs("button",{className:"flex items-center gap-2 bg-white/10 hover:bg-green-600/50 hover:text-green-200 text-white/70 px-3 py-1.5 rounded text-xs transition-all border border-white/5",onClick:()=>We(Hr),children:[y.jsx(Ap,{size:12,fill:"currentColor"})," Run Script"]})})})]})},`script-${zi}`),y.jsx(Ra,{title:"Tools",visible:qn.tools,onClose:()=>fi("tools"),initialPosition:{x:20,y:180},className:"gap-2",children:y.jsxs("div",{className:"grid grid-cols-2 gap-1 w-32",children:[y.jsxs("button",{onClick:()=>L("draw"),className:`flex flex-col items-center justify-center p-3 rounded-lg transition-all ${P==="draw"?"bg-blue-600 text-white":"text-white/60 hover:bg-white/10"}`,children:[y.jsx(Tv,{size:20}),y.jsx("span",{className:"text-[9px] mt-1",children:"Draw"})]}),y.jsxs("button",{onClick:()=>L("draw-spline"),className:`flex flex-col items-center justify-center p-3 rounded-lg transition-all ${P==="draw-spline"?"bg-cyan-600 text-white":"text-white/60 hover:bg-white/10"}`,children:[y.jsx(U2,{size:20}),y.jsx("span",{className:"text-[9px] mt-1",children:"Spline"})]}),y.jsxs("button",{onClick:()=>L("draw-polyline"),className:`flex flex-col items-center justify-center p-3 rounded-lg transition-all ${P==="draw-polyline"?"bg-indigo-600 text-white":"text-white/60 hover:bg-white/10"}`,children:[y.jsx(_2,{size:20}),y.jsx("span",{className:"text-[9px] mt-1",children:"Line"})]}),y.jsxs("button",{onClick:()=>L("draw-tube"),className:`flex flex-col items-center justify-center p-3 rounded-lg transition-all ${P==="draw-tube"?"bg-pink-600 text-white":"text-white/60 hover:bg-white/10"}`,children:[y.jsx(Dm,{size:20}),y.jsx("span",{className:"text-[9px] mt-1",children:"Tube"})]}),y.jsxs("button",{onClick:()=>fi("shapes"),className:`flex flex-col items-center justify-center p-3 rounded-lg transition-all ${va?"bg-teal-600 text-white":qn.shapes?"bg-white/20 text-white":"text-white/60 hover:bg-white/10"}`,children:[y.jsx(Mp,{size:20}),y.jsx("span",{className:"text-[9px] mt-1",children:"Shapes"})]}),y.jsxs("button",{onClick:()=>L("voxel-paint"),className:`flex flex-col items-center justify-center p-3 rounded-lg transition-all ${P==="voxel-paint"?"bg-green-600 text-white":"text-white/60 hover:bg-white/10"}`,children:[y.jsx(w2,{size:20}),y.jsx("span",{className:"text-[9px] mt-1",children:"Voxel"})]}),y.jsxs("button",{onClick:()=>fi("annotations"),className:`flex flex-col items-center justify-center p-3 rounded-lg transition-all ${qn.annotations?"bg-teal-600 text-white":"text-white/60 hover:bg-white/10"}`,children:[y.jsx(Om,{size:20}),y.jsx("span",{className:"text-[9px] mt-1",children:"Notes"})]}),y.jsxs("button",{onClick:()=>L("create-cube-click"),className:`flex flex-col items-center justify-center p-3 rounded-lg transition-all ${P==="create-cube-click"?"bg-orange-600 text-white":"text-white/60 hover:bg-white/10"}`,children:[y.jsx(P_,{size:20}),y.jsx("span",{className:"text-[9px] mt-1",children:"Plane"})]}),y.jsxs("button",{onClick:()=>L("select-object"),className:`flex flex-col items-center justify-center p-3 rounded-lg transition-all ${P==="select-object"?"bg-green-600 text-white":"text-white/60 hover:bg-white/10"}`,children:[y.jsx(F_,{size:20}),y.jsx("span",{className:"text-[9px] mt-1",children:"Select"})]}),y.jsxs("button",{onClick:()=>L("box-select"),className:`flex flex-col items-center justify-center p-3 rounded-lg transition-all ${P==="box-select"?"bg-green-600 text-white":"text-white/60 hover:bg-white/10"}`,children:[y.jsx(sE,{size:20}),y.jsx("span",{className:"text-[9px] mt-1",children:"Box Sel"})]}),y.jsxs("button",{onClick:()=>{I||W||jr&&jr.size>0?re():L("erase")},className:`flex flex-col items-center justify-center p-3 rounded-lg transition-all ${P==="erase"?"bg-red-600 text-white":"text-white/60 hover:bg-white/10"}`,children:[y.jsx(Kw,{size:20}),y.jsx("span",{className:"text-[9px] mt-1",children:"Eraser"})]}),y.jsxs("button",{onClick:()=>L("view"),className:`flex flex-col items-center justify-center p-3 rounded-lg transition-all ${P==="view"?"bg-purple-600 text-white":"text-white/60 hover:bg-white/10"}`,children:[y.jsx(A6,{size:20}),y.jsx("span",{className:"text-[9px] mt-1",children:"View"})]}),y.jsxs("button",{onClick:$,className:`flex flex-col items-center justify-center p-3 rounded-lg transition-all ${me?"bg-red-600 text-white":"text-white/60 hover:bg-white/10"}`,children:[me?y.jsx(Cv,{size:20}):y.jsx($w,{size:20}),y.jsx("span",{className:"text-[9px] mt-1",children:me?"Locked":"Unlock"})]}),y.jsxs("button",{onClick:()=>fi("view"),className:`flex flex-col items-center justify-center p-3 rounded-lg transition-all ${qn.view?"bg-white/20 text-white":"text-white/60 hover:bg-white/10"}`,children:[y.jsx(B2,{size:20}),y.jsx("span",{className:"text-[9px] mt-1",children:"Aids"})]}),y.jsxs("button",{onClick:()=>fi("grid"),className:`flex flex-col items-center justify-center p-3 rounded-lg transition-all ${qn.grid?"bg-white/20 text-white":"text-white/60 hover:bg-white/10"}`,children:[y.jsx(Sp,{size:20}),y.jsx("span",{className:"text-[9px] mt-1",children:"Grid"})]}),y.jsxs("button",{onClick:()=>L("polygonal-modeling"),className:`flex flex-col items-center justify-center p-3 rounded-lg transition-all ${P==="polygonal-modeling"?"bg-orange-600 text-white":"text-white/60 hover:bg-white/10"}`,children:[y.jsx(N2,{size:20}),y.jsx("span",{className:"text-[9px] mt-1",children:"Poly Edit"})]}),y.jsxs("button",{onClick:()=>fi("modifiers"),className:`col-span-2 flex flex-col items-center justify-center p-3 rounded-lg transition-all ${qn.modifiers?"bg-white/20 text-white":"text-white/60 hover:bg-white/10"}`,children:[y.jsx(Bm,{size:20}),y.jsx("span",{className:"text-[9px] mt-1",children:"Modifiers"})]})]})},`tools-${zi}`),qn.brushes&&y.jsx(Ra,{title:"Brush Studio",visible:qn.brushes,onClose:()=>fi("brushes"),initialPosition:{x:170,y:350},className:"w-64 h-[450px]",children:y.jsxs("div",{className:"flex flex-col h-full gap-2",children:[y.jsxs("div",{className:"flex gap-1 p-1 bg-white/5 rounded-lg",children:[y.jsx("button",{onClick:()=>ua("presets"),className:`flex-1 py-1 text-[10px] rounded transition-all ${Ks==="presets"?"bg-blue-600 text-white font-bold shadow-sm":"text-white/50 hover:text-white hover:bg-white/10"}`,children:"Presets"}),y.jsx("button",{onClick:()=>ua("custom"),className:`flex-1 py-1 text-[10px] rounded transition-all ${Ks==="custom"?"bg-purple-600 text-white font-bold shadow-sm":"text-white/50 hover:text-white hover:bg-white/10"}`,children:"My Brushes"})]}),Ks==="presets"?y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"flex overflow-x-auto gap-1 pb-2 border-b border-white/10 custom-scrollbar",children:lE.map(V=>y.jsx("button",{onClick:()=>kf(V.category),className:`px-2 py-1 rounded text-[10px] whitespace-nowrap transition-colors border ${po===V.category?"bg-white/20 border-white/30 text-white font-bold":"bg-transparent border-transparent text-white/50 hover:text-white/80"}`,children:V.category},V.category))}),y.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar flex flex-col gap-1 pr-1",children:(su=lE.find(V=>V.category===po))==null?void 0:su.brushes.map((V,Wt)=>y.jsxs("button",{onClick:()=>au(V),className:`flex items-center justify-between p-2 rounded text-left group transition-all border ${dc===V.name?"bg-blue-600/30 border-blue-500/50":"bg-white/5 border-transparent hover:bg-white/10"}`,children:[y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("div",{className:"text-white/50",children:Uo(V.mode)}),y.jsx("div",{className:`w-1 h-4 ${V.mode==="draw-spline"?"rounded-full":"rounded-sm"}`,style:{backgroundColor:V.color==="rainbow"?"white":V.color,background:V.color==="rainbow"?"linear-gradient(to bottom, red, blue)":void 0,width:Math.max(4,Math.min(12,V.width*2))}}),y.jsxs("div",{className:"flex flex-col",children:[y.jsx("span",{className:`text-xs ${dc===V.name?"text-white font-bold":"text-white/70"}`,children:V.name}),y.jsxs("span",{className:"text-[9px] text-white/30",children:[V.width.toFixed(1),"px ",V.mode==="draw-tube"?" Tube":""]})]})]}),dc===V.name&&y.jsx(Mv,{size:12,className:"text-blue-400"})]},Wt))})]}):y.jsxs(y.Fragment,{children:[y.jsxs("div",{className:"flex flex-col gap-2 p-2 bg-white/5 rounded border border-white/5",children:[y.jsx("span",{className:"text-[10px] text-white/40 font-bold uppercase",children:"Create from Current"}),y.jsxs("div",{className:"flex gap-1",children:[y.jsx("input",{type:"text",value:Qo,onChange:V=>xo(V.target.value),placeholder:"Brush Name...",className:"flex-1 bg-black/30 border border-white/10 rounded px-2 py-1 text-xs text-white focus:border-purple-500 focus:outline-none",onKeyDown:V=>{V.key==="Enter"&&Ul(),V.stopPropagation()}}),y.jsx("button",{onClick:Ul,disabled:!Qo.trim(),className:"bg-purple-600 hover:bg-purple-500 disabled:opacity-50 disabled:cursor-not-allowed text-white p-1.5 rounded",children:y.jsx(iE,{size:14})})]})]}),y.jsxs("div",{className:"flex gap-1",children:[y.jsxs("button",{onClick:pt,className:"flex-1 flex items-center justify-center gap-2 bg-white/5 hover:bg-white/10 text-white/70 hover:text-white py-1.5 rounded text-[10px] border border-white/5 transition-colors",children:[y.jsx(rE,{size:12})," Import"]}),y.jsxs("button",{onClick:Re,className:"flex-1 flex items-center justify-center gap-2 bg-white/5 hover:bg-white/10 text-white/70 hover:text-white py-1.5 rounded text-[10px] border border-white/5 transition-colors",children:[y.jsx(Ih,{size:12})," Export"]})]}),y.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar flex flex-col gap-1 pr-1 mt-1",children:[ge.length===0&&y.jsx("div",{className:"text-center text-white/30 text-xs py-4",children:"No custom brushes yet."}),ge.map(V=>y.jsxs("div",{className:"flex items-center gap-1 group",children:[y.jsx("button",{onClick:()=>ye(V),className:"flex-1 flex items-center justify-between p-2 rounded text-left transition-all border bg-white/5 border-transparent hover:bg-white/10",children:y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx("div",{className:"text-white/50",children:Uo(V.mode)}),y.jsx("div",{className:"w-px h-3 bg-white/10"}),y.jsx("div",{className:"w-1 h-4 rounded-sm",style:{backgroundColor:V.color==="rainbow"?"white":V.color,background:V.color==="rainbow"?"linear-gradient(to bottom, red, blue)":void 0,width:Math.max(4,Math.min(12,V.width*2))}}),y.jsxs("div",{className:"flex flex-col",children:[y.jsx("span",{className:"text-xs text-white/80 font-bold",children:V.name}),y.jsxs("span",{className:"text-[9px] text-white/40",children:[V.width.toFixed(1),"px ",V.mode==="draw-tube"?" Tube":""]})]})]})}),y.jsx("button",{onClick:()=>ht(V.id),className:"p-2 text-white/20 hover:text-red-400 hover:bg-red-500/10 rounded transition-all",children:y.jsx(Nv,{size:12})})]},V.id))]})]})]})},`brushes-${zi}`),y.jsx(Ra,{title:"View & Aid",visible:qn.view,onClose:()=>fi("view"),initialPosition:{x:Xa(540),y:kr(540)},className:"w-56",children:y.jsxs("div",{className:"flex flex-col gap-2",children:[y.jsxs("div",{className:"flex gap-1",children:[y.jsx("button",{onClick:$,className:`flex-1 py-1 rounded text-xs border ${me?"bg-red-500/20 border-red-500 text-red-400":"border-white/10 text-white/60 hover:text-white"}`,children:me?"Locked":"Unlock"}),y.jsx("button",{onClick:()=>L("view"),className:`flex-1 py-1 rounded text-xs border ${P==="view"?"bg-purple-500/20 border-purple-500 text-purple-400":"border-white/10 text-white/60 hover:text-white"}`,children:"Orbit"}),y.jsx("button",{onClick:ie,className:"flex-1 py-1 rounded text-xs border border-white/10 text-white/60 hover:text-white",children:"Reset"})]}),y.jsx("div",{className:"grid grid-cols-3 gap-1",children:["TOP","FRONT","LEFT","BOTTOM","BACK","RIGHT"].map(V=>y.jsx("button",{onClick:()=>j(V),className:"text-[10px] py-1 bg-white/5 hover:bg-white/10 rounded text-white/50 hover:text-white transition-colors",children:V},V))}),y.jsx("div",{className:"h-px bg-white/10 my-1"}),y.jsxs("div",{className:"flex gap-1 justify-between",children:[y.jsxs("div",{className:"relative",children:[y.jsxs("button",{onClick:()=>tu(!Zo),className:`flex items-center gap-1 px-2 py-1 rounded text-xs border ${pe.snap?"bg-yellow-500/20 border-yellow-500 text-yellow-400":"border-white/10 text-white/40"}`,children:[y.jsx($z,{size:12})," Snap"]}),Zo&&y.jsxs("div",{className:"absolute bottom-full left-0 mb-1 bg-[#0a0a0a] border border-white/20 rounded p-1 w-32 flex flex-col gap-0.5 z-50 shadow-xl",children:[Object.entries(pe.snapOptions).map(([V,Wt])=>y.jsxs("button",{onClick:()=>ve({...pe,snapOptions:{...pe.snapOptions,[V]:!Wt}}),className:`flex justify-between text-[10px] px-2 py-1 hover:bg-white/10 rounded ${Wt?"text-yellow-400":"text-white/50"}`,children:[y.jsx("span",{className:"capitalize",children:V}),Wt&&y.jsx(Mv,{size:10})]},V))," ",y.jsx("div",{className:"h-px bg-white/10 my-1"})," ",y.jsx("button",{onClick:()=>ve({...pe,snap:!pe.snap}),className:"text-[10px] px-2 py-1 bg-white/10 rounded text-center text-white",children:pe.snap?"Disable All":"Enable All"})]})]}),y.jsxs("button",{onClick:()=>ve({...pe,ortho:!pe.ortho,polar:!1}),className:`flex items-center gap-1 px-2 py-1 rounded text-xs border ${pe.ortho?"bg-cyan-500/20 border-cyan-500 text-cyan-400":"border-white/10 text-white/40"}`,children:[y.jsx(Sp,{size:12})," Ortho"]}),y.jsxs("button",{onClick:()=>ve({...pe,polar:!pe.polar,ortho:!1}),className:`flex items-center gap-1 px-2 py-1 rounded text-xs border ${pe.polar?"bg-purple-500/20 border-purple-500 text-purple-400":"border-white/10 text-white/40"}`,children:[y.jsx(hz,{size:12})," Polar"]})]}),y.jsx("div",{className:"h-px bg-white/10 my-1"}),y.jsxs("div",{className:"flex items-center justify-between",children:[y.jsx("span",{className:"text-[10px] text-white/40 font-bold uppercase",children:"Drawing Plane"}),y.jsxs("div",{className:"flex bg-white/10 rounded p-0.5",children:[y.jsxs("button",{onClick:()=>Gn("view"),className:`px-2 py-1 rounded text-[10px] flex items-center gap-1 transition-all ${on==="view"?"bg-white text-black shadow-sm font-bold":"text-white/50 hover:text-white"}`,title:"Draw relative to View",children:[y.jsx(U6,{size:10})," View"]}),y.jsxs("button",{onClick:()=>Gn("ground"),className:`px-2 py-1 rounded text-[10px] flex items-center gap-1 transition-all ${on==="ground"?"bg-white text-black shadow-sm font-bold":"text-white/50 hover:text-white"}`,title:"Draw on Ground Plane",children:[y.jsx(Iz,{size:10})," Ground"]})]})]})]})},`view-${zi}`),y.jsxs("div",{className:"absolute bottom-8 left-1/2 -translate-x-1/2 flex flex-col items-center gap-3 pointer-events-none z-30",children:[Z&&y.jsxs("button",{onClick:fe,className:"pointer-events-auto flex items-center gap-2 bg-green-600 hover:bg-green-500 text-white px-6 py-2 rounded-full font-bold shadow-lg shadow-green-500/30 transition-all",children:[y.jsx(Mv,{size:18})," Finish (Enter)"]}),y.jsxs("div",{className:"bg-black/60 backdrop-blur-md px-4 py-2 rounded-full border border-white/10 text-white/60 text-xs font-mono shadow-xl flex items-center gap-3",children:[P==="define-plane"?y.jsxs("span",{className:"text-orange-400 font-bold",children:["Set Plane Point ",J+1,"/3"]}):y.jsxs("span",{className:"flex items-center gap-2",children:[y.jsx("span",{className:"opacity-50",children:"MODE:"}),y.jsx("span",{className:"font-bold text-white",children:P.replace("draw-","").replace("create-","").replace("place-primitive-","").toUpperCase()})]}),me&&y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"w-px h-3 bg-white/20"}),y.jsxs("span",{className:"text-red-400 font-bold flex items-center gap-1",children:[y.jsx(Cv,{size:10})," LOCKED"]})]}),mt&&mt.enabled&&y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"w-px h-3 bg-white/20"}),y.jsxs("span",{className:"text-teal-400 font-bold flex items-center gap-1",children:[y.jsx(I2,{size:10})," ",mt.mode==="radial"?`RADIAL (${mt.radialCount})`:"MIRROR"]})]})]})]})]})})};var j2={exports:{}},Ou={};/**
 * @license React
 * react-reconciler-constants.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cE;function hF(){return cE||(cE=1,Ou.ConcurrentRoot=1,Ou.ContinuousEventPriority=8,Ou.DefaultEventPriority=32,Ou.DiscreteEventPriority=2,Ou.IdleEventPriority=268435456,Ou.LegacyRoot=0,Ou.NoEventPriority=0),Ou}var uE;function dF(){return uE||(uE=1,j2.exports=hF()),j2.exports}var Kv=dF(),H2={exports:{}},k2={},V2={exports:{}},X2={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fE;function pF(){if(fE)return X2;fE=1;var s=t0();function e(x,g){return x===g&&(x!==0||1/x===1/g)||x!==x&&g!==g}var t=typeof Object.is=="function"?Object.is:e,n=s.useState,i=s.useEffect,a=s.useLayoutEffect,o=s.useDebugValue;function c(x,g){var b=g(),S=n({inst:{value:b,getSnapshot:g}}),C=S[0].inst,M=S[1];return a(function(){C.value=b,C.getSnapshot=g,u(C)&&M({inst:C})},[x,b,g]),i(function(){return u(C)&&M({inst:C}),x(function(){u(C)&&M({inst:C})})},[x]),o(b),b}function u(x){var g=x.getSnapshot;x=x.value;try{var b=g();return!t(x,b)}catch{return!0}}function h(x,g){return g()}var m=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?h:c;return X2.useSyncExternalStore=s.useSyncExternalStore!==void 0?s.useSyncExternalStore:m,X2}var hE;function mF(){return hE||(hE=1,V2.exports=pF()),V2.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dE;function xF(){if(dE)return k2;dE=1;var s=t0(),e=mF();function t(h,m){return h===m&&(h!==0||1/h===1/m)||h!==h&&m!==m}var n=typeof Object.is=="function"?Object.is:t,i=e.useSyncExternalStore,a=s.useRef,o=s.useEffect,c=s.useMemo,u=s.useDebugValue;return k2.useSyncExternalStoreWithSelector=function(h,m,x,g,b){var S=a(null);if(S.current===null){var C={hasValue:!1,value:null};S.current=C}else C=S.current;S=c(function(){function A(U){if(!R){if(R=!0,N=U,U=g(U),b!==void 0&&C.hasValue){var z=C.value;if(b(z,U))return B=z}return B=U}if(z=B,n(N,U))return z;var P=g(U);return b!==void 0&&b(z,P)?(N=U,z):(N=U,B=P)}var R=!1,N,B,F=x===void 0?null:x;return[function(){return A(m())},F===null?void 0:function(){return A(F())}]},[m,x,g,b]);var M=i(h,S[0],S[1]);return o(function(){C.hasValue=!0,C.value=M},[M]),u(M),M},k2}var pE;function gF(){return pE||(pE=1,H2.exports=xF()),H2.exports}var vF=gF();const yF=ny(vF),mE=s=>{let e;const t=new Set,n=(h,m)=>{const x=typeof h=="function"?h(e):h;if(!Object.is(x,e)){const g=e;e=m??(typeof x!="object"||x===null)?x:Object.assign({},e,x),t.forEach(b=>b(e,g))}},i=()=>e,c={setState:n,getState:i,getInitialState:()=>u,subscribe:h=>(t.add(h),()=>t.delete(h))},u=e=s(n,i,c);return c},bF=(s=>s?mE(s):mE),{useSyncExternalStoreWithSelector:_F}=yF,SF=s=>s;function AF(s,e=SF,t){const n=_F(s.subscribe,s.getState,s.getInitialState,e,t);return v3.useDebugValue(n),n}const xE=(s,e)=>{const t=bF(s),n=(i,a=e)=>AF(t,i,a);return Object.assign(n,t),n},fT=((s,e)=>s?xE(s,e):xE),MF=s=>typeof s=="object"&&typeof s.then=="function",Jh=[];function hT(s,e,t=(n,i)=>n===i){if(s===e)return!0;if(!s||!e)return!1;const n=s.length;if(e.length!==n)return!1;for(let i=0;i<n;i++)if(!t(s[i],e[i]))return!1;return!0}function dT(s,e=null,t=!1,n={}){e===null&&(e=[s]);for(const a of Jh)if(hT(e,a.keys,a.equal)){if(t)return;if(Object.prototype.hasOwnProperty.call(a,"error"))throw a.error;if(Object.prototype.hasOwnProperty.call(a,"response"))return n.lifespan&&n.lifespan>0&&(a.timeout&&clearTimeout(a.timeout),a.timeout=setTimeout(a.remove,n.lifespan)),a.response;if(!t)throw a.promise}const i={keys:e,equal:n.equal,remove:()=>{const a=Jh.indexOf(i);a!==-1&&Jh.splice(a,1)},promise:(MF(s)?s:s(...e)).then(a=>{i.response=a,n.lifespan&&n.lifespan>0&&(i.timeout=setTimeout(i.remove,n.lifespan))}).catch(a=>i.error=a)};if(Jh.push(i),!t)throw i.promise}const pT=(s,e,t)=>dT(s,e,!1,t),wF=(s,e,t)=>void dT(s,e,!0,t),EF=s=>{if(s===void 0||s.length===0)Jh.splice(0,Jh.length);else{const e=Jh.find(t=>hT(s,t.keys,t.equal));e&&e.remove()}};var Y2={exports:{}},W2={exports:{}},q2={exports:{}},J2={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gE;function CF(){return gE||(gE=1,(function(s){function e(j,ae){var J=j.length;j.push(ae);e:for(;0<J;){var ie=J-1>>>1,se=j[ie];if(0<i(se,ae))j[ie]=ae,j[J]=se,J=ie;else break e}}function t(j){return j.length===0?null:j[0]}function n(j){if(j.length===0)return null;var ae=j[0],J=j.pop();if(J!==ae){j[0]=J;e:for(var ie=0,se=j.length,I=se>>>1;ie<I;){var W=2*(ie+1)-1,fe=j[W],Z=W+1,me=j[Z];if(0>i(fe,J))Z<se&&0>i(me,fe)?(j[ie]=me,j[Z]=J,ie=Z):(j[ie]=fe,j[W]=J,ie=W);else if(Z<se&&0>i(me,J))j[ie]=me,j[Z]=J,ie=Z;else break e}}return ae}function i(j,ae){var J=j.sortIndex-ae.sortIndex;return J!==0?J:j.id-ae.id}if(s.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;s.unstable_now=function(){return a.now()}}else{var o=Date,c=o.now();s.unstable_now=function(){return o.now()-c}}var u=[],h=[],m=1,x=null,g=3,b=!1,S=!1,C=!1,M=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,R=typeof setImmediate<"u"?setImmediate:null;function N(j){for(var ae=t(h);ae!==null;){if(ae.callback===null)n(h);else if(ae.startTime<=j)n(h),ae.sortIndex=ae.expirationTime,e(u,ae);else break;ae=t(h)}}function B(j){if(C=!1,N(j),!S)if(t(u)!==null)S=!0,ne();else{var ae=t(h);ae!==null&&re(B,ae.startTime-j)}}var F=!1,U=-1,z=5,P=-1;function L(){return!(s.unstable_now()-P<z)}function O(){if(F){var j=s.unstable_now();P=j;var ae=!0;try{e:{S=!1,C&&(C=!1,A(U),U=-1),b=!0;var J=g;try{t:{for(N(j),x=t(u);x!==null&&!(x.expirationTime>j&&L());){var ie=x.callback;if(typeof ie=="function"){x.callback=null,g=x.priorityLevel;var se=ie(x.expirationTime<=j);if(j=s.unstable_now(),typeof se=="function"){x.callback=se,N(j),ae=!0;break t}x===t(u)&&n(u),N(j)}else n(u);x=t(u)}if(x!==null)ae=!0;else{var I=t(h);I!==null&&re(B,I.startTime-j),ae=!1}}break e}finally{x=null,g=J,b=!1}ae=void 0}}finally{ae?ee():F=!1}}}var ee;if(typeof R=="function")ee=function(){R(O)};else if(typeof MessageChannel<"u"){var Q=new MessageChannel,te=Q.port2;Q.port1.onmessage=O,ee=function(){te.postMessage(null)}}else ee=function(){M(O,0)};function ne(){F||(F=!0,ee())}function re(j,ae){U=M(function(){j(s.unstable_now())},ae)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(j){j.callback=null},s.unstable_continueExecution=function(){S||b||(S=!0,ne())},s.unstable_forceFrameRate=function(j){0>j||125<j?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):z=0<j?Math.floor(1e3/j):5},s.unstable_getCurrentPriorityLevel=function(){return g},s.unstable_getFirstCallbackNode=function(){return t(u)},s.unstable_next=function(j){switch(g){case 1:case 2:case 3:var ae=3;break;default:ae=g}var J=g;g=ae;try{return j()}finally{g=J}},s.unstable_pauseExecution=function(){},s.unstable_requestPaint=function(){},s.unstable_runWithPriority=function(j,ae){switch(j){case 1:case 2:case 3:case 4:case 5:break;default:j=3}var J=g;g=j;try{return ae()}finally{g=J}},s.unstable_scheduleCallback=function(j,ae,J){var ie=s.unstable_now();switch(typeof J=="object"&&J!==null?(J=J.delay,J=typeof J=="number"&&0<J?ie+J:ie):J=ie,j){case 1:var se=-1;break;case 2:se=250;break;case 5:se=1073741823;break;case 4:se=1e4;break;default:se=5e3}return se=J+se,j={id:m++,callback:ae,priorityLevel:j,startTime:J,expirationTime:se,sortIndex:-1},J>ie?(j.sortIndex=J,e(h,j),t(u)===null&&j===t(h)&&(C?(A(U),U=-1):C=!0,re(B,J-ie))):(j.sortIndex=se,e(u,j),S||b||(S=!0,ne())),j},s.unstable_shouldYield=L,s.unstable_wrapCallback=function(j){var ae=g;return function(){var J=g;g=ae;try{return j.apply(this,arguments)}finally{g=J}}}})(J2)),J2}var vE;function mT(){return vE||(vE=1,q2.exports=CF()),q2.exports}/**
 * @license React
 * react-reconciler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yE;function TF(){return yE||(yE=1,(function(s){s.exports=function(e){function t(f,d,_,E){return new x0(f,d,_,E)}function n(){}function i(f){var d="https://react.dev/errors/"+f;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)d+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+f+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(f){return f===null||typeof f!="object"?null:(f=A0&&f[A0]||f["@@iterator"],typeof f=="function"?f:null)}function o(f){if(f==null)return null;if(typeof f=="function")return f.$$typeof===du?null:f.displayName||f.name||null;if(typeof f=="string")return f;switch(f){case Yu:return"Fragment";case Io:return"Portal";case S0:return"Profiler";case _0:return"StrictMode";case _d:return"Suspense";case wc:return"SuspenseList"}if(typeof f=="object")switch(f.$$typeof){case sl:return(f.displayName||"Context")+".Provider";case Mc:return(f._context.displayName||"Context")+".Consumer";case Wu:var d=f.render;return f=f.displayName,f||(f=d.displayName||d.name||"",f=f!==""?"ForwardRef("+f+")":"ForwardRef"),f;case Qf:return d=f.displayName||null,d!==null?d:o(f.type)||"Memo";case zo:d=f._payload,f=f._init;try{return o(f(d))}catch{}}return null}function c(f){if(Sd===void 0)try{throw Error()}catch(_){var d=_.stack.trim().match(/\n( *(at )?)/);Sd=d&&d[1]||"",M0=-1<_.stack.indexOf(`
    at`)?" (<anonymous>)":-1<_.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Sd+f+M0}function u(f,d){if(!f||Ec)return"";Ec=!0;var _=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var E={DetermineComponentFrameRoot:function(){try{if(d){var cn=function(){throw Error()};if(Object.defineProperty(cn.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(cn,[])}catch(Vn){var pn=Vn}Reflect.construct(f,[],cn)}else{try{cn.call()}catch(Vn){pn=Vn}f.call(cn.prototype)}}else{try{throw Error()}catch(Vn){pn=Vn}(cn=f())&&typeof cn.catch=="function"&&cn.catch(function(){})}}catch(Vn){if(Vn&&pn&&typeof Vn.stack=="string")return[Vn.stack,pn.stack]}return[null,null]}};E.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var D=Object.getOwnPropertyDescriptor(E.DetermineComponentFrameRoot,"name");D&&D.configurable&&Object.defineProperty(E.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var G=E.DetermineComponentFrameRoot(),de=G[0],Ce=G[1];if(de&&Ce){var Xe=de.split(`
`),Ct=Ce.split(`
`);for(D=E=0;E<Xe.length&&!Xe[E].includes("DetermineComponentFrameRoot");)E++;for(;D<Ct.length&&!Ct[D].includes("DetermineComponentFrameRoot");)D++;if(E===Xe.length||D===Ct.length)for(E=Xe.length-1,D=Ct.length-1;1<=E&&0<=D&&Xe[E]!==Ct[D];)D--;for(;1<=E&&0<=D;E--,D--)if(Xe[E]!==Ct[D]){if(E!==1||D!==1)do if(E--,D--,0>D||Xe[E]!==Ct[D]){var Jt=`
`+Xe[E].replace(" at new "," at ");return f.displayName&&Jt.includes("<anonymous>")&&(Jt=Jt.replace("<anonymous>",f.displayName)),Jt}while(1<=E&&0<=D);break}}}finally{Ec=!1,Error.prepareStackTrace=_}return(_=f?f.displayName||f.name:"")?c(_):""}function h(f){switch(f.tag){case 26:case 27:case 5:return c(f.type);case 16:return c("Lazy");case 13:return c("Suspense");case 19:return c("SuspenseList");case 0:case 15:return f=u(f.type,!1),f;case 11:return f=u(f.type.render,!1),f;case 1:return f=u(f.type,!0),f;default:return""}}function m(f){try{var d="";do d+=h(f),f=f.return;while(f);return d}catch(_){return`
Error generating stack: `+_.message+`
`+_.stack}}function x(f){var d=f,_=f;if(f.alternate)for(;d.return;)d=d.return;else{f=d;do d=f,(d.flags&4098)!==0&&(_=d.return),f=d.return;while(f)}return d.tag===3?_:null}function g(f){if(x(f)!==f)throw Error(i(188))}function b(f){var d=f.alternate;if(!d){if(d=x(f),d===null)throw Error(i(188));return d!==f?null:f}for(var _=f,E=d;;){var D=_.return;if(D===null)break;var G=D.alternate;if(G===null){if(E=D.return,E!==null){_=E;continue}break}if(D.child===G.child){for(G=D.child;G;){if(G===_)return g(D),f;if(G===E)return g(D),d;G=G.sibling}throw Error(i(188))}if(_.return!==E.return)_=D,E=G;else{for(var de=!1,Ce=D.child;Ce;){if(Ce===_){de=!0,_=D,E=G;break}if(Ce===E){de=!0,E=D,_=G;break}Ce=Ce.sibling}if(!de){for(Ce=G.child;Ce;){if(Ce===_){de=!0,_=G,E=D;break}if(Ce===E){de=!0,E=G,_=D;break}Ce=Ce.sibling}if(!de)throw Error(i(189))}}if(_.alternate!==E)throw Error(i(190))}if(_.tag!==3)throw Error(i(188));return _.stateNode.current===_?f:d}function S(f){var d=f.tag;if(d===5||d===26||d===27||d===6)return f;for(f=f.child;f!==null;){if(d=S(f),d!==null)return d;f=f.sibling}return null}function C(f){var d=f.tag;if(d===5||d===26||d===27||d===6)return f;for(f=f.child;f!==null;){if(f.tag!==4&&(d=C(f),d!==null))return d;f=f.sibling}return null}function M(f){return{current:f}}function A(f){0>Yl||(f.current=oh[Yl],oh[Yl]=null,Yl--)}function R(f,d){Yl++,oh[Yl]=f.current,f.current=d}function N(f){return f>>>=0,f===0?32:31-(lh(f)/lg|0)|0}function B(f){var d=f&42;if(d!==0)return d;switch(f&-f){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return f&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return f&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return f}}function F(f,d){var _=f.pendingLanes;if(_===0)return 0;var E=0,D=f.suspendedLanes,G=f.pingedLanes,de=f.warmLanes;f=f.finishedLanes!==0;var Ce=_&134217727;return Ce!==0?(_=Ce&~D,_!==0?E=B(_):(G&=Ce,G!==0?E=B(G):f||(de=Ce&~de,de!==0&&(E=B(de))))):(Ce=_&~D,Ce!==0?E=B(Ce):G!==0?E=B(G):f||(de=_&~de,de!==0&&(E=B(de)))),E===0?0:d!==0&&d!==E&&(d&D)===0&&(D=E&-E,de=d&-d,D>=de||D===32&&(de&4194176)!==0)?d:E}function U(f,d){return(f.pendingLanes&~(f.suspendedLanes&~f.pingedLanes)&d)===0}function z(f,d){switch(f){case 1:case 2:case 4:case 8:return d+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function P(){var f=Ku;return Ku<<=1,(Ku&4194176)===0&&(Ku=128),f}function L(){var f=ch;return ch<<=1,(ch&62914560)===0&&(ch=4194304),f}function O(f){for(var d=[],_=0;31>_;_++)d.push(f);return d}function ee(f,d){f.pendingLanes|=d,d!==268435456&&(f.suspendedLanes=0,f.pingedLanes=0,f.warmLanes=0)}function Q(f,d,_,E,D,G){var de=f.pendingLanes;f.pendingLanes=_,f.suspendedLanes=0,f.pingedLanes=0,f.warmLanes=0,f.expiredLanes&=_,f.entangledLanes&=_,f.errorRecoveryDisabledLanes&=_,f.shellSuspendCounter=0;var Ce=f.entanglements,Xe=f.expirationTimes,Ct=f.hiddenUpdates;for(_=de&~_;0<_;){var Jt=31-Ar(_),cn=1<<Jt;Ce[Jt]=0,Xe[Jt]=-1;var pn=Ct[Jt];if(pn!==null)for(Ct[Jt]=null,Jt=0;Jt<pn.length;Jt++){var Vn=pn[Jt];Vn!==null&&(Vn.lane&=-536870913)}_&=~cn}E!==0&&te(f,E,0),G!==0&&D===0&&f.tag!==0&&(f.suspendedLanes|=G&~(de&~d))}function te(f,d,_){f.pendingLanes|=d,f.suspendedLanes&=~d;var E=31-Ar(d);f.entangledLanes|=d,f.entanglements[E]=f.entanglements[E]|1073741824|_&4194218}function ne(f,d){var _=f.entangledLanes|=d;for(f=f.entanglements;_;){var E=31-Ar(_),D=1<<E;D&d|f[E]&d&&(f[E]|=d),_&=~D}}function re(f){return f&=-f,2<f?8<f?(f&134217727)!==0?32:268435456:8:2}function j(f){if(Mr&&typeof Mr.onCommitFiberRoot=="function")try{Mr.onCommitFiberRoot($u,f,void 0,(f.current.flags&128)===128)}catch{}}function ae(f){if(typeof hg=="function"&&tm(f),Mr&&typeof Mr.setStrictMode=="function")try{Mr.setStrictMode($u,f)}catch{}}function J(f,d){return f===d&&(f!==0||1/f===1/d)||f!==f&&d!==d}function ie(f,d){if(typeof f=="object"&&f!==null){var _=Pd.get(f);return _!==void 0?_:(d={value:f,source:d,stack:m(d)},Pd.set(f,d),d)}return{value:f,source:d,stack:m(d)}}function se(f,d){fa[wa++]=hh,fa[wa++]=fh,fh=f,hh=d}function I(f,d,_){Zr[Kr++]=ul,Zr[Kr++]=yo,Zr[Kr++]=Fo,Fo=f;var E=ul;f=yo;var D=32-Ar(E)-1;E&=~(1<<D),_+=1;var G=32-Ar(d)+D;if(30<G){var de=D-D%5;G=(E&(1<<de)-1).toString(32),E>>=de,D-=de,ul=1<<32-Ar(d)+D|_<<D|E,yo=G+f}else ul=1<<G|_<<D|E,yo=f}function W(f){f.return!==null&&(se(f,1),I(f,1,0))}function fe(f){for(;f===fh;)fh=fa[--wa],fa[wa]=null,hh=fa[--wa],fa[wa]=null;for(;f===Fo;)Fo=Zr[--Kr],Zr[Kr]=null,yo=Zr[--Kr],Zr[Kr]=null,ul=Zr[--Kr],Zr[Kr]=null}function Z(f,d){R(Po,d),R(dh,f),R(ps,null),f=pu(d),A(ps),R(ps,f)}function me(){A(ps),A(dh),A(Po)}function $(f){f.memoizedState!==null&&R(ef,f);var d=ps.current,_=jx(d,f.type);d!==_&&(R(dh,f),R(ps,_))}function pe(f){dh.current===f&&(A(ps),A(dh)),ef.current===f&&(A(ef),ol?In._currentValue=Sr:In._currentValue2=Sr)}function ve(f){var d=Error(i(418,""));throw lt(ie(d,f)),ph}function ze(f,d){if(!er)throw Error(i(175));qy(f.stateNode,f.type,f.memoizedProps,d,f)||ve(f)}function Ge(f){for(zs=f.return;zs;)switch(zs.tag){case 3:case 27:bo=!0;return;case 5:case 13:bo=!1;return;default:zs=zs.return}}function Fe(f){if(!er||f!==zs)return!1;if(!wi)return Ge(f),wi=!0,!1;var d=!1;if(ws?f.tag!==3&&f.tag!==27&&(f.tag!==5||ig(f.type)&&!Rc(f.type,f.memoizedProps))&&(d=!0):f.tag!==3&&(f.tag!==5||ig(f.type)&&!Rc(f.type,f.memoizedProps))&&(d=!0),d&&Cs&&ve(f),Ge(f),f.tag===13){if(!er)throw Error(i(316));if(f=f.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(i(317));Cs=tg(f)}else Cs=zs?H0(f.stateNode):null;return!0}function Qe(){er&&(Cs=zs=null,wi=!1)}function lt(f){Qr===null?Qr=[f]:Qr.push(f)}function De(){for(var f=Bc,d=tf=Bc=0;d<f;){var _=$r[d];$r[d++]=null;var E=$r[d];$r[d++]=null;var D=$r[d];$r[d++]=null;var G=$r[d];if($r[d++]=null,E!==null&&D!==null){var de=E.pending;de===null?D.next=D:(D.next=de.next,de.next=D),E.pending=D}G!==0&&je(_,D,G)}}function le(f,d,_,E){$r[Bc++]=f,$r[Bc++]=d,$r[Bc++]=_,$r[Bc++]=E,tf|=E,f.lanes|=E,f=f.alternate,f!==null&&(f.lanes|=E)}function Ye(f,d,_,E){return le(f,d,_,E),He(f)}function Ze(f,d){return le(f,null,null,d),He(f)}function je(f,d,_){f.lanes|=_;var E=f.alternate;E!==null&&(E.lanes|=_);for(var D=!1,G=f.return;G!==null;)G.childLanes|=_,E=G.alternate,E!==null&&(E.childLanes|=_),G.tag===22&&(f=G.stateNode,f===null||f._visibility&1||(D=!0)),f=G,G=G.return;D&&d!==null&&f.tag===3&&(G=f.stateNode,D=31-Ar(_),G=G.hiddenUpdates,f=G[D],f===null?G[D]=[d]:f.push(d),d.lane=_|536870912)}function He(f){if(50<wu)throw wu=0,ir=null,Error(i(185));for(var d=f.return;d!==null;)f=d,d=f.return;return f.tag===3?f.stateNode:null}function et(f){f!==vu&&f.next===null&&(vu===null?nf=vu=f:vu=vu.next=f),xh=!0,mh||(mh=!0,Pe(st))}function Ne(f,d){if(!Go&&xh){Go=!0;do for(var _=!1,E=nf;E!==null;){if(f!==0){var D=E.pendingLanes;if(D===0)var G=0;else{var de=E.suspendedLanes,Ce=E.pingedLanes;G=(1<<31-Ar(42|f)+1)-1,G&=D&~(de&~Ce),G=G&201326677?G&201326677|1:G?G|2:0}G!==0&&(_=!0,Ae(E,G))}else G=si,G=F(E,E===ci?G:0),(G&3)===0||U(E,G)||(_=!0,Ae(E,G));E=E.next}while(_);Go=!1}}function st(){xh=mh=!1;var f=0;Dc!==0&&(Nc()&&(f=Dc),Dc=0);for(var d=Es(),_=null,E=nf;E!==null;){var D=E.next,G=oe(E,d);G===0?(E.next=null,_===null?nf=D:_.next=D,D===null&&(vu=_)):(_=E,(f!==0||(G&3)!==0)&&(xh=!0)),E=D}Ne(f)}function oe(f,d){for(var _=f.suspendedLanes,E=f.pingedLanes,D=f.expirationTimes,G=f.pendingLanes&-62914561;0<G;){var de=31-Ar(G),Ce=1<<de,Xe=D[de];Xe===-1?((Ce&_)===0||(Ce&E)!==0)&&(D[de]=z(Ce,d)):Xe<=d&&(f.expiredLanes|=Ce),G&=~Ce}if(d=ci,_=si,_=F(f,f===d?_:0),E=f.callbackNode,_===0||f===d&&Ki===2||f.cancelPendingCommit!==null)return E!==null&&E!==null&&uh(E),f.callbackNode=null,f.callbackPriority=0;if((_&3)===0||U(f,_)){if(d=_&-_,d===f.callbackPriority)return d;switch(E!==null&&uh(E),re(_)){case 2:case 8:_=fg;break;case 32:_=zd;break;case 268435456:_=Fd;break;default:_=zd}return E=X.bind(null,f),_=Qu(_,E),f.callbackPriority=d,f.callbackNode=_,d}return E!==null&&E!==null&&uh(E),f.callbackPriority=2,f.callbackNode=null,2}function X(f,d){var _=f.callbackNode;if(hs()&&f.callbackNode!==_)return null;var E=si;return E=F(f,f===ci?E:0),E===0?null:(Wf(f,E,d),oe(f,Es()),f.callbackNode!=null&&f.callbackNode===_?X.bind(null,f):null)}function Ae(f,d){if(hs())return null;Wf(f,d,!0)}function Pe(f){Ya?Ed(function(){(Tn&6)!==0?Qu(em,f):f()}):Qu(em,f)}function Ue(){return Dc===0&&(Dc=P()),Dc}function Be(f,d){if(gh===null){var _=gh=[];Gd=0,wr=Ue(),Uc={status:"pending",value:void 0,then:function(E){_.push(E)}}}return Gd++,d.then(bt,bt),d}function bt(){if(--Gd===0&&gh!==null){Uc!==null&&(Uc.status="fulfilled");var f=gh;gh=null,wr=0,Uc=null;for(var d=0;d<f.length;d++)(0,f[d])()}}function vt(f,d){var _=[],E={status:"pending",value:null,reason:null,then:function(D){_.push(D)}};return f.then(function(){E.status="fulfilled",E.value=d;for(var D=0;D<_.length;D++)(0,_[D])(d)},function(D){for(E.status="rejected",E.reason=D,D=0;D<_.length;D++)(0,_[D])(void 0)}),E}function It(f){f.updateQueue={baseState:f.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function zt(f,d){f=f.updateQueue,d.updateQueue===f&&(d.updateQueue={baseState:f.baseState,firstBaseUpdate:f.firstBaseUpdate,lastBaseUpdate:f.lastBaseUpdate,shared:f.shared,callbacks:null})}function qe(f){return{lane:f,tag:0,payload:null,callback:null,next:null}}function We(f,d,_){var E=f.updateQueue;if(E===null)return null;if(E=E.shared,(Tn&2)!==0){var D=E.pending;return D===null?d.next=d:(d.next=D.next,D.next=d),E.pending=d,d=He(f),je(f,null,_),d}return le(f,E,d,_),He(f)}function ft(f,d,_){if(d=d.updateQueue,d!==null&&(d=d.shared,(_&4194176)!==0)){var E=d.lanes;E&=f.pendingLanes,_|=E,d.lanes=_,ne(f,_)}}function ge(f,d){var _=f.updateQueue,E=f.alternate;if(E!==null&&(E=E.updateQueue,_===E)){var D=null,G=null;if(_=_.firstBaseUpdate,_!==null){do{var de={lane:_.lane,tag:_.tag,payload:_.payload,callback:null,next:null};G===null?D=G=de:G=G.next=de,_=_.next}while(_!==null);G===null?D=G=d:G=G.next=d}else D=G=d;_={baseState:E.baseState,firstBaseUpdate:D,lastBaseUpdate:G,shared:E.shared,callbacks:E.callbacks},f.updateQueue=_;return}f=_.lastBaseUpdate,f===null?_.firstBaseUpdate=d:f.next=d,_.lastBaseUpdate=d}function Ie(){if(af){var f=Uc;if(f!==null)throw f}}function ht(f,d,_,E){af=!1;var D=f.updateQueue;Wl=!1;var G=D.firstBaseUpdate,de=D.lastBaseUpdate,Ce=D.shared.pending;if(Ce!==null){D.shared.pending=null;var Xe=Ce,Ct=Xe.next;Xe.next=null,de===null?G=Ct:de.next=Ct,de=Xe;var Jt=f.alternate;Jt!==null&&(Jt=Jt.updateQueue,Ce=Jt.lastBaseUpdate,Ce!==de&&(Ce===null?Jt.firstBaseUpdate=Ct:Ce.next=Ct,Jt.lastBaseUpdate=Xe))}if(G!==null){var cn=D.baseState;de=0,Jt=Ct=Xe=null,Ce=G;do{var pn=Ce.lane&-536870913,Vn=pn!==Ce.lane;if(Vn?(si&pn)===pn:(E&pn)===pn){pn!==0&&pn===wr&&(af=!0),Jt!==null&&(Jt=Jt.next={lane:0,tag:Ce.tag,payload:Ce.payload,callback:null,next:null});e:{var Rr=f,_h=Ce;pn=d;var Eu=_;switch(_h.tag){case 1:if(Rr=_h.payload,typeof Rr=="function"){cn=Rr.call(Eu,cn,pn);break e}cn=Rr;break e;case 3:Rr.flags=Rr.flags&-65537|128;case 0:if(Rr=_h.payload,pn=typeof Rr=="function"?Rr.call(Eu,cn,pn):Rr,pn==null)break e;cn=hu({},cn,pn);break e;case 2:Wl=!0}}pn=Ce.callback,pn!==null&&(f.flags|=64,Vn&&(f.flags|=8192),Vn=D.callbacks,Vn===null?D.callbacks=[pn]:Vn.push(pn))}else Vn={lane:pn,tag:Ce.tag,payload:Ce.payload,callback:Ce.callback,next:null},Jt===null?(Ct=Jt=Vn,Xe=cn):Jt=Jt.next=Vn,de|=pn;if(Ce=Ce.next,Ce===null){if(Ce=D.shared.pending,Ce===null)break;Vn=Ce,Ce=Vn.next,Vn.next=null,D.lastBaseUpdate=Vn,D.shared.pending=null}}while(!0);Jt===null&&(Xe=cn),D.baseState=Xe,D.firstBaseUpdate=Ct,D.lastBaseUpdate=Jt,G===null&&(D.shared.lanes=0),io|=de,f.lanes=de,f.memoizedState=cn}}function ye(f,d){if(typeof f!="function")throw Error(i(191,f));f.call(d)}function Re(f,d){var _=f.callbacks;if(_!==null)for(f.callbacks=null,f=0;f<_.length;f++)ye(_[f],d)}function pt(f,d){if(Jr(f,d))return!0;if(typeof f!="object"||f===null||typeof d!="object"||d===null)return!1;var _=Object.keys(f),E=Object.keys(d);if(_.length!==E.length)return!1;for(E=0;E<_.length;E++){var D=_[E];if(!vh.call(d,D)||!Jr(f[D],d[D]))return!1}return!0}function Rt(f){return f=f.status,f==="fulfilled"||f==="rejected"}function dt(){}function Ke(f,d,_){switch(_=f[_],_===void 0?f.push(d):_!==d&&(d.then(dt,dt),d=_),d.status){case"fulfilled":return d.value;case"rejected":throw f=d.reason,f===Xi?Error(i(483)):f;default:if(typeof d.status=="string")d.then(dt,dt);else{if(f=ci,f!==null&&100<f.shellSuspendCounter)throw Error(i(482));f=d,f.status="pending",f.then(function(E){if(d.status==="pending"){var D=d;D.status="fulfilled",D.value=E}},function(E){if(d.status==="pending"){var D=d;D.status="rejected",D.reason=E}})}switch(d.status){case"fulfilled":return d.value;case"rejected":throw f=d.reason,f===Xi?Error(i(483)):f}throw yu=d,Xi}}function Lt(){if(yu===null)throw Error(i(459));var f=yu;return yu=null,f}function Vt(f){var d=_o;return _o+=1,fl===null&&(fl=[]),Ke(fl,f,d)}function Kt(f,d){d=d.props.ref,f.ref=d!==void 0?d:null}function on(f,d){throw d.$$typeof===b0?Error(i(525)):(f=Object.prototype.toString.call(d),Error(i(31,f==="[object Object]"?"object with keys {"+Object.keys(d).join(", ")+"}":f)))}function Gn(f){var d=f._init;return d(f._payload)}function En(f){function d(at,ke){if(f){var ut=at.deletions;ut===null?(at.deletions=[ke],at.flags|=16):ut.push(ke)}}function _(at,ke){if(!f)return null;for(;ke!==null;)d(at,ke),ke=ke.sibling;return null}function E(at){for(var ke=new Map;at!==null;)at.key!==null?ke.set(at.key,at):ke.set(at.index,at),at=at.sibling;return ke}function D(at,ke){return at=Os(at,ke),at.index=0,at.sibling=null,at}function G(at,ke,ut){return at.index=ut,f?(ut=at.alternate,ut!==null?(ut=ut.index,ut<ke?(at.flags|=33554434,ke):ut):(at.flags|=33554434,ke)):(at.flags|=1048576,ke)}function de(at){return f&&at.alternate===null&&(at.flags|=33554434),at}function Ce(at,ke,ut,jt){return ke===null||ke.tag!==6?(ke=Ac(ut,at.mode,jt),ke.return=at,ke):(ke=D(ke,ut),ke.return=at,ke)}function Xe(at,ke,ut,jt){var Mn=ut.type;return Mn===Yu?Jt(at,ke,ut.props.children,jt,ut.key):ke!==null&&(ke.elementType===Mn||typeof Mn=="object"&&Mn!==null&&Mn.$$typeof===zo&&Gn(Mn)===ke.type)?(ke=D(ke,ut.props),Kt(ke,ut),ke.return=at,ke):(ke=go(ut.type,ut.key,ut.props,null,at.mode,jt),Kt(ke,ut),ke.return=at,ke)}function Ct(at,ke,ut,jt){return ke===null||ke.tag!==4||ke.stateNode.containerInfo!==ut.containerInfo||ke.stateNode.implementation!==ut.implementation?(ke=Xu(ut,at.mode,jt),ke.return=at,ke):(ke=D(ke,ut.children||[]),ke.return=at,ke)}function Jt(at,ke,ut,jt,Mn){return ke===null||ke.tag!==7?(ke=jl(ut,at.mode,jt,Mn),ke.return=at,ke):(ke=D(ke,ut),ke.return=at,ke)}function cn(at,ke,ut){if(typeof ke=="string"&&ke!==""||typeof ke=="number"||typeof ke=="bigint")return ke=Ac(""+ke,at.mode,ut),ke.return=at,ke;if(typeof ke=="object"&&ke!==null){switch(ke.$$typeof){case Hl:return ut=go(ke.type,ke.key,ke.props,null,at.mode,ut),Kt(ut,ke),ut.return=at,ut;case Io:return ke=Xu(ke,at.mode,ut),ke.return=at,ke;case zo:var jt=ke._init;return ke=jt(ke._payload),cn(at,ke,ut)}if(Cc(ke)||a(ke))return ke=jl(ke,at.mode,ut,null),ke.return=at,ke;if(typeof ke.then=="function")return cn(at,Vt(ke),ut);if(ke.$$typeof===sl)return cn(at,$o(at,ke),ut);on(at,ke)}return null}function pn(at,ke,ut,jt){var Mn=ke!==null?ke.key:null;if(typeof ut=="string"&&ut!==""||typeof ut=="number"||typeof ut=="bigint")return Mn!==null?null:Ce(at,ke,""+ut,jt);if(typeof ut=="object"&&ut!==null){switch(ut.$$typeof){case Hl:return ut.key===Mn?Xe(at,ke,ut,jt):null;case Io:return ut.key===Mn?Ct(at,ke,ut,jt):null;case zo:return Mn=ut._init,ut=Mn(ut._payload),pn(at,ke,ut,jt)}if(Cc(ut)||a(ut))return Mn!==null?null:Jt(at,ke,ut,jt,null);if(typeof ut.then=="function")return pn(at,ke,Vt(ut),jt);if(ut.$$typeof===sl)return pn(at,ke,$o(at,ut),jt);on(at,ut)}return null}function Vn(at,ke,ut,jt,Mn){if(typeof jt=="string"&&jt!==""||typeof jt=="number"||typeof jt=="bigint")return at=at.get(ut)||null,Ce(ke,at,""+jt,Mn);if(typeof jt=="object"&&jt!==null){switch(jt.$$typeof){case Hl:return at=at.get(jt.key===null?ut:jt.key)||null,Xe(ke,at,jt,Mn);case Io:return at=at.get(jt.key===null?ut:jt.key)||null,Ct(ke,at,jt,Mn);case zo:var aa=jt._init;return jt=aa(jt._payload),Vn(at,ke,ut,jt,Mn)}if(Cc(jt)||a(jt))return at=at.get(ut)||null,Jt(ke,at,jt,Mn,null);if(typeof jt.then=="function")return Vn(at,ke,ut,Vt(jt),Mn);if(jt.$$typeof===sl)return Vn(at,ke,ut,$o(ke,jt),Mn);on(ke,jt)}return null}function Rr(at,ke,ut,jt){for(var Mn=null,aa=null,zn=ke,Ci=ke=0,ts=null;zn!==null&&Ci<ut.length;Ci++){zn.index>Ci?(ts=zn,zn=null):ts=zn.sibling;var Ti=pn(at,zn,ut[Ci],jt);if(Ti===null){zn===null&&(zn=ts);break}f&&zn&&Ti.alternate===null&&d(at,zn),ke=G(Ti,ke,Ci),aa===null?Mn=Ti:aa.sibling=Ti,aa=Ti,zn=ts}if(Ci===ut.length)return _(at,zn),wi&&se(at,Ci),Mn;if(zn===null){for(;Ci<ut.length;Ci++)zn=cn(at,ut[Ci],jt),zn!==null&&(ke=G(zn,ke,Ci),aa===null?Mn=zn:aa.sibling=zn,aa=zn);return wi&&se(at,Ci),Mn}for(zn=E(zn);Ci<ut.length;Ci++)ts=Vn(zn,at,Ci,ut[Ci],jt),ts!==null&&(f&&ts.alternate!==null&&zn.delete(ts.key===null?Ci:ts.key),ke=G(ts,ke,Ci),aa===null?Mn=ts:aa.sibling=ts,aa=ts);return f&&zn.forEach(function(ec){return d(at,ec)}),wi&&se(at,Ci),Mn}function _h(at,ke,ut,jt){if(ut==null)throw Error(i(151));for(var Mn=null,aa=null,zn=ke,Ci=ke=0,ts=null,Ti=ut.next();zn!==null&&!Ti.done;Ci++,Ti=ut.next()){zn.index>Ci?(ts=zn,zn=null):ts=zn.sibling;var ec=pn(at,zn,Ti.value,jt);if(ec===null){zn===null&&(zn=ts);break}f&&zn&&ec.alternate===null&&d(at,zn),ke=G(ec,ke,Ci),aa===null?Mn=ec:aa.sibling=ec,aa=ec,zn=ts}if(Ti.done)return _(at,zn),wi&&se(at,Ci),Mn;if(zn===null){for(;!Ti.done;Ci++,Ti=ut.next())Ti=cn(at,Ti.value,jt),Ti!==null&&(ke=G(Ti,ke,Ci),aa===null?Mn=Ti:aa.sibling=Ti,aa=Ti);return wi&&se(at,Ci),Mn}for(zn=E(zn);!Ti.done;Ci++,Ti=ut.next())Ti=Vn(zn,at,Ci,Ti.value,jt),Ti!==null&&(f&&Ti.alternate!==null&&zn.delete(Ti.key===null?Ci:Ti.key),ke=G(Ti,ke,Ci),aa===null?Mn=Ti:aa.sibling=Ti,aa=Ti);return f&&zn.forEach(function(Jd){return d(at,Jd)}),wi&&se(at,Ci),Mn}function Eu(at,ke,ut,jt){if(typeof ut=="object"&&ut!==null&&ut.type===Yu&&ut.key===null&&(ut=ut.props.children),typeof ut=="object"&&ut!==null){switch(ut.$$typeof){case Hl:e:{for(var Mn=ut.key;ke!==null;){if(ke.key===Mn){if(Mn=ut.type,Mn===Yu){if(ke.tag===7){_(at,ke.sibling),jt=D(ke,ut.props.children),jt.return=at,at=jt;break e}}else if(ke.elementType===Mn||typeof Mn=="object"&&Mn!==null&&Mn.$$typeof===zo&&Gn(Mn)===ke.type){_(at,ke.sibling),jt=D(ke,ut.props),Kt(jt,ut),jt.return=at,at=jt;break e}_(at,ke);break}else d(at,ke);ke=ke.sibling}ut.type===Yu?(jt=jl(ut.props.children,at.mode,jt,ut.key),jt.return=at,at=jt):(jt=go(ut.type,ut.key,ut.props,null,at.mode,jt),Kt(jt,ut),jt.return=at,at=jt)}return de(at);case Io:e:{for(Mn=ut.key;ke!==null;){if(ke.key===Mn)if(ke.tag===4&&ke.stateNode.containerInfo===ut.containerInfo&&ke.stateNode.implementation===ut.implementation){_(at,ke.sibling),jt=D(ke,ut.children||[]),jt.return=at,at=jt;break e}else{_(at,ke);break}else d(at,ke);ke=ke.sibling}jt=Xu(ut,at.mode,jt),jt.return=at,at=jt}return de(at);case zo:return Mn=ut._init,ut=Mn(ut._payload),Eu(at,ke,ut,jt)}if(Cc(ut))return Rr(at,ke,ut,jt);if(a(ut)){if(Mn=a(ut),typeof Mn!="function")throw Error(i(150));return ut=Mn.call(ut),_h(at,ke,ut,jt)}if(typeof ut.then=="function")return Eu(at,ke,Vt(ut),jt);if(ut.$$typeof===sl)return Eu(at,ke,$o(at,ut),jt);on(at,ut)}return typeof ut=="string"&&ut!==""||typeof ut=="number"||typeof ut=="bigint"?(ut=""+ut,ke!==null&&ke.tag===6?(_(at,ke.sibling),jt=D(ke,ut),jt.return=at,at=jt):(_(at,ke),jt=Ac(ut,at.mode,jt),jt.return=at,at=jt),de(at)):_(at,ke)}return function(at,ke,ut,jt){try{_o=0;var Mn=Eu(at,ke,ut,jt);return fl=null,Mn}catch(zn){if(zn===Xi)throw zn;var aa=t(29,zn,null,at.mode);return aa.lanes=jt,aa.return=at,aa}finally{}}}function li(f,d){f=jo,R(eo,f),R(hl,d),jo=f|d.baseLanes}function qi(){R(eo,jo),R(hl,hl.current)}function la(){jo=eo.current,A(hl),A(eo)}function di(f){var d=f.alternate;R(Wa,Wa.current&1),R(to,f),So===null&&(d===null||hl.current!==null||d.memoizedState!==null)&&(So=f)}function Qi(f){if(f.tag===22){if(R(Wa,Wa.current),R(to,f),So===null){var d=f.alternate;d!==null&&d.memoizedState!==null&&(So=f)}}else Mi()}function Mi(){R(Wa,Wa.current),R(to,to.current)}function mn(f){A(to),So===f&&(So=null),A(Wa)}function jn(f){for(var d=f;d!==null;){if(d.tag===13){var _=d.memoizedState;if(_!==null&&(_=_.dehydrated,_===null||Bd(_)||rh(_)))return d}else if(d.tag===19&&d.memoizedProps.revealOrder!==void 0){if((d.flags&128)!==0)return d}else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===f)break;for(;d.sibling===null;){if(d.return===null||d.return===f)return null;d=d.return}d.sibling.return=d.return,d=d.sibling}return null}function bn(){throw Error(i(321))}function q(f,d){if(d===null)return!1;for(var _=0;_<d.length&&_<f.length;_++)if(!Jr(f[_],d[_]))return!1;return!0}function he(f,d,_,E,D,G){return dl=G,$n=d,d.memoizedState=null,d.updateQueue=null,d.lanes=0,Dn.H=f===null||f.memoizedState===null?qa:Fs,ql=!1,G=_(E,D),ql=!1,ha&&(G=Je(d,_,E,D)),we(f),G}function we(f){Dn.H=Ei;var d=Li!==null&&Li.next!==null;if(dl=0,La=Li=$n=null,Ao=!1,Ea=0,sf=null,d)throw Error(i(300));f===null||Oa||(f=f.dependencies,f!==null&&Hr(f)&&(Oa=!0))}function Je(f,d,_,E){$n=f;var D=0;do{if(ha&&(sf=null),Ea=0,ha=!1,25<=D)throw Error(i(301));if(D+=1,La=Li=null,f.updateQueue!=null){var G=f.updateQueue;G.lastEffect=null,G.events=null,G.stores=null,G.memoCache!=null&&(G.memoCache.index=0)}Dn.H=Oc,G=d(_,E)}while(ha);return G}function ot(){var f=Dn.H,d=f.useState()[0];return d=typeof d.then=="function"?be(d):d,f=f.useState()[0],(Li!==null?Li.memoizedState:null)!==f&&($n.flags|=1024),d}function ct(){var f=yh!==0;return yh=0,f}function Ot(f,d,_){d.updateQueue=f.updateQueue,d.flags&=-2053,f.lanes&=~_}function Dt(f){if(Ao){for(f=f.memoizedState;f!==null;){var d=f.queue;d!==null&&(d.pending=null),f=f.next}Ao=!1}dl=0,La=Li=$n=null,ha=!1,Ea=yh=0,sf=null}function Nt(){var f={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return La===null?$n.memoizedState=La=f:La=La.next=f,La}function K(){if(Li===null){var f=$n.alternate;f=f!==null?f.memoizedState:null}else f=Li.next;var d=La===null?$n.memoizedState:La.next;if(d!==null)La=d,Li=f;else{if(f===null)throw $n.alternate===null?Error(i(467)):Error(i(310));Li=f,f={memoizedState:Li.memoizedState,baseState:Li.baseState,baseQueue:Li.baseQueue,queue:Li.queue,next:null},La===null?$n.memoizedState=La=f:La=La.next=f}return La}function be(f){var d=Ea;return Ea+=1,sf===null&&(sf=[]),f=Ke(sf,f,d),d=$n,(La===null?d.memoizedState:La.next)===null&&(d=d.alternate,Dn.H=d===null||d.memoizedState===null?qa:Fs),f}function xe(f){if(f!==null&&typeof f=="object"){if(typeof f.then=="function")return be(f);if(f.$$typeof===sl)return va(f)}throw Error(i(438,String(f)))}function Oe(f){var d=null,_=$n.updateQueue;if(_!==null&&(d=_.memoCache),d==null){var E=$n.alternate;E!==null&&(E=E.updateQueue,E!==null&&(E=E.memoCache,E!=null&&(d={data:E.data.map(function(D){return D.slice()}),index:0})))}if(d==null&&(d={data:[],index:0}),_===null&&(_=Hd(),$n.updateQueue=_),_.memoCache=d,_=d.data[d.index],_===void 0)for(_=d.data[d.index]=Array(f),E=0;E<f;E++)_[E]=Gx;return d.index++,_}function Me(f,d){return typeof d=="function"?d(f):d}function $e(f){var d=K();return yt(d,Li,f)}function yt(f,d,_){var E=f.queue;if(E===null)throw Error(i(311));E.lastRenderedReducer=_;var D=f.baseQueue,G=E.pending;if(G!==null){if(D!==null){var de=D.next;D.next=G.next,G.next=de}d.baseQueue=D=G,E.pending=null}if(G=f.baseState,D===null)f.memoizedState=G;else{d=D.next;var Ce=de=null,Xe=null,Ct=d,Jt=!1;do{var cn=Ct.lane&-536870913;if(cn!==Ct.lane?(si&cn)===cn:(dl&cn)===cn){var pn=Ct.revertLane;if(pn===0)Xe!==null&&(Xe=Xe.next={lane:0,revertLane:0,action:Ct.action,hasEagerState:Ct.hasEagerState,eagerState:Ct.eagerState,next:null}),cn===wr&&(Jt=!0);else if((dl&pn)===pn){Ct=Ct.next,pn===wr&&(Jt=!0);continue}else cn={lane:0,revertLane:Ct.revertLane,action:Ct.action,hasEagerState:Ct.hasEagerState,eagerState:Ct.eagerState,next:null},Xe===null?(Ce=Xe=cn,de=G):Xe=Xe.next=cn,$n.lanes|=pn,io|=pn;cn=Ct.action,ql&&_(G,cn),G=Ct.hasEagerState?Ct.eagerState:_(G,cn)}else pn={lane:cn,revertLane:Ct.revertLane,action:Ct.action,hasEagerState:Ct.hasEagerState,eagerState:Ct.eagerState,next:null},Xe===null?(Ce=Xe=pn,de=G):Xe=Xe.next=pn,$n.lanes|=cn,io|=cn;Ct=Ct.next}while(Ct!==null&&Ct!==d);if(Xe===null?de=G:Xe.next=Ce,!Jr(G,f.memoizedState)&&(Oa=!0,Jt&&(_=Uc,_!==null)))throw _;f.memoizedState=G,f.baseState=de,f.baseQueue=Xe,E.lastRenderedState=G}return D===null&&(E.lanes=0),[f.memoizedState,E.dispatch]}function Mt(f){var d=K(),_=d.queue;if(_===null)throw Error(i(311));_.lastRenderedReducer=f;var E=_.dispatch,D=_.pending,G=d.memoizedState;if(D!==null){_.pending=null;var de=D=D.next;do G=f(G,de.action),de=de.next;while(de!==D);Jr(G,d.memoizedState)||(Oa=!0),d.memoizedState=G,d.baseQueue===null&&(d.baseState=G),_.lastRenderedState=G}return[G,E]}function Ft(f,d,_){var E=$n,D=K(),G=wi;if(G){if(_===void 0)throw Error(i(407));_=_()}else _=d();var de=!Jr((Li||D).memoizedState,_);if(de&&(D.memoizedState=_,Oa=!0),D=D.queue,vs(en.bind(null,E,D,f),[f]),D.getSnapshot!==d||de||La!==null&&La.memoizedState.tag&1){if(E.flags|=2048,Di(9,Pt.bind(null,E,D,_,d),{destroy:void 0},null),ci===null)throw Error(i(349));G||(dl&60)!==0||mt(E,d,_)}return _}function mt(f,d,_){f.flags|=16384,f={getSnapshot:d,value:_},d=$n.updateQueue,d===null?(d=Hd(),$n.updateQueue=d,d.stores=[f]):(_=d.stores,_===null?d.stores=[f]:_.push(f))}function Pt(f,d,_,E){d.value=_,d.getSnapshot=E,Qt(d)&&yn(f)}function en(f,d,_){return _(function(){Qt(d)&&yn(f)})}function Qt(f){var d=f.getSnapshot;f=f.value;try{var _=d();return!Jr(f,_)}catch{return!0}}function yn(f){var d=Ze(f,2);d!==null&&Ls(d,f,2)}function ln(f){var d=Nt();if(typeof f=="function"){var _=f;if(f=_(),ql){ae(!0);try{_()}finally{ae(!1)}}}return d.memoizedState=d.baseState=f,d.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Me,lastRenderedState:f},d}function xn(f,d,_,E){return f.baseState=_,yt(f,Li,typeof E=="function"?E:Me)}function Un(f,d,_,E,D){if(mr(f))throw Error(i(485));if(f=d.action,f!==null){var G={payload:D,action:f,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(de){G.listeners.push(de)}};Dn.T!==null?_(!0):G.isTransition=!1,E(G),_=d.pending,_===null?(G.next=d.pending=G,an(d,G)):(G.next=_.next,d.pending=_.next=G)}}function an(f,d){var _=d.action,E=d.payload,D=f.state;if(d.isTransition){var G=Dn.T,de={};Dn.T=de;try{var Ce=_(D,E),Xe=Dn.S;Xe!==null&&Xe(de,Ce),Bn(f,d,Ce)}catch(Ct){Hn(f,d,Ct)}finally{Dn.T=G}}else try{G=_(D,E),Bn(f,d,G)}catch(Ct){Hn(f,d,Ct)}}function Bn(f,d,_){_!==null&&typeof _=="object"&&typeof _.then=="function"?_.then(function(E){tn(f,d,E)},function(E){return Hn(f,d,E)}):tn(f,d,_)}function tn(f,d,_){d.status="fulfilled",d.value=_,kn(d),f.state=_,d=f.pending,d!==null&&(_=d.next,_===d?f.pending=null:(_=_.next,d.next=_,an(f,_)))}function Hn(f,d,_){var E=f.pending;if(f.pending=null,E!==null){E=E.next;do d.status="rejected",d.reason=_,kn(d),d=d.next;while(d!==E)}f.action=null}function kn(f){f=f.listeners;for(var d=0;d<f.length;d++)(0,f[d])()}function hn(f,d){return d}function Ni(f,d){if(wi){var _=ci.formState;if(_!==null){e:{var E=$n;if(wi){if(Cs){var D=Wx(Cs,bo);if(D){Cs=H0(D),E=qx(D);break e}}ve(E)}E=!1}E&&(d=_[0])}}_=Nt(),_.memoizedState=_.baseState=d,E={pending:null,lanes:0,dispatch:null,lastRenderedReducer:hn,lastRenderedState:d},_.queue=E,_=Ro.bind(null,$n,E),E.dispatch=_,E=ln(!1);var G=No.bind(null,$n,!1,E.queue);return E=Nt(),D={state:d,dispatch:null,action:f,pending:null},E.queue=D,_=Un.bind(null,$n,D,G,_),D.dispatch=_,E.memoizedState=f,[d,_,!1]}function Yn(f){var d=K();return Wn(d,Li,f)}function Wn(f,d,_){d=yt(f,d,hn)[0],f=$e(Me)[0],d=typeof d=="object"&&d!==null&&typeof d.then=="function"?be(d):d;var E=K(),D=E.queue,G=D.dispatch;return _!==E.memoizedState&&($n.flags|=2048,Di(9,xi.bind(null,D,_),{destroy:void 0},null)),[d,G,f]}function xi(f,d){f.action=d}function ki(f){var d=K(),_=Li;if(_!==null)return Wn(d,_,f);K(),d=d.memoizedState,_=K();var E=_.queue.dispatch;return _.memoizedState=f,[d,E,!1]}function Di(f,d,_,E){return f={tag:f,create:d,inst:_,deps:E,next:null},d=$n.updateQueue,d===null&&(d=Hd(),$n.updateQueue=d),_=d.lastEffect,_===null?d.lastEffect=f.next=f:(E=_.next,_.next=f,f.next=E,d.lastEffect=f),f}function Ga(){return K().memoizedState}function Ka(f,d,_,E){var D=Nt();$n.flags|=f,D.memoizedState=Di(1|d,_,{destroy:void 0},E===void 0?null:E)}function hr(f,d,_,E){var D=K();E=E===void 0?null:E;var G=D.memoizedState.inst;Li!==null&&E!==null&&q(E,Li.memoizedState.deps)?D.memoizedState=Di(d,_,G,E):($n.flags|=f,D.memoizedState=Di(1|d,_,G,E))}function To(f,d){Ka(8390656,8,f,d)}function vs(f,d){hr(2048,8,f,d)}function Nl(f,d){return hr(4,2,f,d)}function dr(f,d){return hr(4,4,f,d)}function ys(f,d){if(typeof d=="function"){f=f();var _=d(f);return function(){typeof _=="function"?_():d(null)}}if(d!=null)return f=f(),d.current=f,function(){d.current=null}}function da(f,d,_){_=_!=null?_.concat([f]):null,hr(4,4,ys.bind(null,d,f),_)}function qs(){}function ho(f,d){var _=K();d=d===void 0?null:d;var E=_.memoizedState;return d!==null&&q(d,E[1])?E[0]:(_.memoizedState=[f,d],f)}function bs(f,d){var _=K();d=d===void 0?null:d;var E=_.memoizedState;if(d!==null&&q(d,E[1]))return E[0];if(E=f(),ql){ae(!0);try{f()}finally{ae(!1)}}return _.memoizedState=[E,d],E}function ja(f,d,_){return _===void 0||(dl&1073741824)!==0?f.memoizedState=d:(f.memoizedState=_,f=tl(),$n.lanes|=f,io|=f,_)}function Or(f,d,_,E){return Jr(_,d)?_:hl.current!==null?(f=ja(f,_,E),Jr(f,d)||(Oa=!0),f):(dl&42)===0?(Oa=!0,f.memoizedState=_):(f=tl(),$n.lanes|=f,io|=f,d)}function Ir(f,d,_,E,D){var G=$a();Is(G!==0&&8>G?G:8);var de=Dn.T,Ce={};Dn.T=Ce,No(f,!1,d,_);try{var Xe=D(),Ct=Dn.S;if(Ct!==null&&Ct(Ce,Xe),Xe!==null&&typeof Xe=="object"&&typeof Xe.then=="function"){var Jt=vt(Xe,E);Ns(f,d,Jt,$s(f))}else Ns(f,d,E,$s(f))}catch(cn){Ns(f,d,{then:function(){},status:"rejected",reason:cn},$s())}finally{Is(G),Dn.T=de}}function pr(f){var d=f.memoizedState;if(d!==null)return d;d={memoizedState:Sr,baseState:Sr,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Me,lastRenderedState:Sr},next:null};var _={};return d.next={memoizedState:_,baseState:_,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Me,lastRenderedState:_},next:null},f.memoizedState=d,f=f.alternate,f!==null&&(f.memoizedState=d),d}function Ha(){return va(In)}function pa(){return K().memoizedState}function gn(){return K().memoizedState}function zr(f){for(var d=f.return;d!==null;){switch(d.tag){case 24:case 3:var _=$s();f=qe(_);var E=We(d,f,_);E!==null&&(Ls(E,d,_),ft(E,d,_)),d={cache:Ul()},f.payload=d;return}d=d.return}}function _s(f,d,_){var E=$s();_={lane:E,revertLane:0,action:_,hasEagerState:!1,eagerState:null,next:null},mr(f)?Js(d,_):(_=Ye(f,d,_,E),_!==null&&(Ls(_,f,E),Fr(_,d,E)))}function Ro(f,d,_){var E=$s();Ns(f,d,_,E)}function Ns(f,d,_,E){var D={lane:E,revertLane:0,action:_,hasEagerState:!1,eagerState:null,next:null};if(mr(f))Js(d,D);else{var G=f.alternate;if(f.lanes===0&&(G===null||G.lanes===0)&&(G=d.lastRenderedReducer,G!==null))try{var de=d.lastRenderedState,Ce=G(de,_);if(D.hasEagerState=!0,D.eagerState=Ce,Jr(Ce,de))return le(f,d,D,0),ci===null&&De(),!1}catch{}finally{}if(_=Ye(f,d,D,E),_!==null)return Ls(_,f,E),Fr(_,d,E),!0}return!1}function No(f,d,_,E){if(E={lane:2,revertLane:Ue(),action:E,hasEagerState:!1,eagerState:null,next:null},mr(f)){if(d)throw Error(i(479))}else d=Ye(f,_,E,2),d!==null&&Ls(d,f,2)}function mr(f){var d=f.alternate;return f===$n||d!==null&&d===$n}function Js(f,d){ha=Ao=!0;var _=f.pending;_===null?d.next=d:(d.next=_.next,_.next=d),f.pending=d}function Fr(f,d,_){if((_&4194176)!==0){var E=d.lanes;E&=f.pendingLanes,_|=E,d.lanes=_,ne(f,_)}}function Vi(f,d,_,E){d=f.memoizedState,_=_(E,d),_=_==null?d:hu({},d,_),f.memoizedState=_,f.lanes===0&&(f.updateQueue.baseState=_)}function Bs(f,d,_,E,D,G,de){return f=f.stateNode,typeof f.shouldComponentUpdate=="function"?f.shouldComponentUpdate(E,G,de):d.prototype&&d.prototype.isPureReactComponent?!pt(_,E)||!pt(D,G):!0}function ma(f,d,_,E){f=d.state,typeof d.componentWillReceiveProps=="function"&&d.componentWillReceiveProps(_,E),typeof d.UNSAFE_componentWillReceiveProps=="function"&&d.UNSAFE_componentWillReceiveProps(_,E),d.state!==f&&kd.enqueueReplaceState(d,d.state,null)}function ka(f,d){var _=d;if("ref"in d){_={};for(var E in d)E!=="ref"&&(_[E]=d[E])}if(f=f.defaultProps){_===d&&(_=hu({},_));for(var D in f)_[D]===void 0&&(_[D]=f[D])}return _}function xr(f,d){try{var _=f.onUncaughtError;_(d.value,{componentStack:d.stack})}catch(E){setTimeout(function(){throw E})}}function Pr(f,d,_){try{var E=f.onCaughtError;E(_.value,{componentStack:_.stack,errorBoundary:d.tag===1?d.stateNode:null})}catch(D){setTimeout(function(){throw D})}}function Zs(f,d,_){return _=qe(_),_.tag=3,_.payload={element:null},_.callback=function(){xr(f,d)},_}function gr(f){return f=qe(f),f.tag=3,f}function xa(f,d,_,E){var D=_.type.getDerivedStateFromError;if(typeof D=="function"){var G=E.value;f.payload=function(){return D(G)},f.callback=function(){Pr(d,_,E)}}var de=_.stateNode;de!==null&&typeof de.componentDidCatch=="function"&&(f.callback=function(){Pr(d,_,E),typeof D!="function"&&(so===null?so=new Set([this]):so.add(this));var Ce=E.stack;this.componentDidCatch(E.value,{componentStack:Ce!==null?Ce:""})})}function hc(f,d,_,E,D){if(_.flags|=32768,E!==null&&typeof E=="object"&&typeof E.then=="function"){if(d=_.alternate,d!==null&&xo(d,_,D,!0),_=to.current,_!==null){switch(_.tag){case 13:return So===null?_r():_.alternate===null&&Si===0&&(Si=3),_.flags&=-257,_.flags|=65536,_.lanes=D,E===jd?_.flags|=16384:(d=_.updateQueue,d===null?_.updateQueue=new Set([E]):d.add(E),yd(f,E,D)),!1;case 22:return _.flags|=65536,E===jd?_.flags|=16384:(d=_.updateQueue,d===null?(d={transitions:null,markerInstances:null,retryQueue:new Set([E])},_.updateQueue=d):(_=d.retryQueue,_===null?d.retryQueue=new Set([E]):_.add(E)),yd(f,E,D)),!1}throw Error(i(435,_.tag))}return yd(f,E,D),_r(),!1}if(wi)return d=to.current,d!==null?((d.flags&65536)===0&&(d.flags|=256),d.flags|=65536,d.lanes=D,E!==ph&&(f=Error(i(422),{cause:E}),lt(ie(f,_)))):(E!==ph&&(d=Error(i(423),{cause:E}),lt(ie(d,_))),f=f.current.alternate,f.flags|=65536,D&=-D,f.lanes|=D,E=ie(E,_),D=Zs(f.stateNode,E,D),ge(f,D),Si!==4&&(Si=2)),!1;var G=Error(i(520),{cause:E});if(G=ie(G,_),of===null?of=[G]:of.push(G),Si!==4&&(Si=2),d===null)return!0;E=ie(E,_),_=d;do{switch(_.tag){case 3:return _.flags|=65536,f=D&-D,_.lanes|=f,f=Zs(_.stateNode,E,f),ge(_,f),!1;case 1:if(d=_.type,G=_.stateNode,(_.flags&128)===0&&(typeof d.getDerivedStateFromError=="function"||G!==null&&typeof G.componentDidCatch=="function"&&(so===null||!so.has(G))))return _.flags|=65536,D&=-D,_.lanes|=D,D=gr(D),xa(D,f,_,E),ge(_,D),!1}_=_.return}while(_!==null);return!1}function na(f,d,_,E){d.child=f===null?im(d,null,_,E):Lc(d,f.child,_,E)}function Gr(f,d,_,E,D){_=_.render;var G=d.ref;if("ref"in E){var de={};for(var Ce in E)Ce!=="ref"&&(de[Ce]=E[Ce])}else de=E;return Do(d),E=he(f,d,_,de,G,D),Ce=ct(),f!==null&&!Oa?(Ot(f,d,D),Va(f,d,D)):(wi&&Ce&&W(d),d.flags|=1,na(f,d,E,D),d.child)}function Bl(f,d,_,E,D){if(f===null){var G=_.type;return typeof G=="function"&&!Pl(G)&&G.defaultProps===void 0&&_.compare===null?(d.tag=15,d.type=G,jr(f,d,G,E,D)):(f=go(_.type,null,E,d,d.mode,D),f.ref=d.ref,f.return=d,d.child=f)}if(G=f.child,!po(f,D)){var de=G.memoizedProps;if(_=_.compare,_=_!==null?_:pt,_(de,E)&&f.ref===d.ref)return Va(f,d,D)}return d.flags|=1,f=Os(G,E),f.ref=d.ref,f.return=d,d.child=f}function jr(f,d,_,E,D){if(f!==null){var G=f.memoizedProps;if(pt(G,E)&&f.ref===d.ref)if(Oa=!1,d.pendingProps=E=G,po(f,D))(f.flags&131072)!==0&&(Oa=!0);else return d.lanes=f.lanes,Va(f,d,D)}return Ds(f,d,_,E,D)}function ga(f,d,_){var E=d.pendingProps,D=E.children,G=(d.stateNode._pendingVisibility&2)!==0,de=f!==null?f.memoizedState:null;if(ca(f,d),E.mode==="hidden"||G){if((d.flags&128)!==0){if(E=de!==null?de.baseLanes|_:_,f!==null){for(D=d.child=f.child,G=0;D!==null;)G=G|D.lanes|D.childLanes,D=D.sibling;d.childLanes=G&~E}else d.childLanes=0,d.child=null;return Qa(f,d,E,_)}if((_&536870912)!==0)d.memoizedState={baseLanes:0,cachePool:null},f!==null&&Xa(d,de!==null?de.cachePool:null),de!==null?li(d,de):qi(),Qi(d);else return d.lanes=d.childLanes=536870912,Qa(f,d,de!==null?de.baseLanes|_:_,_)}else de!==null?(Xa(d,de.cachePool),li(d,de),Mi(),d.memoizedState=null):(f!==null&&Xa(d,null),qi(),Mi());return na(f,d,D,_),d.child}function Qa(f,d,_,E){var D=kr();return D=D===null?null:{parent:ol?Fi._currentValue:Fi._currentValue2,pool:D},d.memoizedState={baseLanes:_,cachePool:D},f!==null&&Xa(d,null),qi(),Qi(d),f!==null&&xo(f,d,E,!0),null}function ca(f,d){var _=d.ref;if(_===null)f!==null&&f.ref!==null&&(d.flags|=2097664);else{if(typeof _!="function"&&typeof _!="object")throw Error(i(284));(f===null||f.ref!==_)&&(d.flags|=2097664)}}function Ds(f,d,_,E,D){return Do(d),_=he(f,d,_,E,void 0,D),E=ct(),f!==null&&!Oa?(Ot(f,d,D),Va(f,d,D)):(wi&&E&&W(d),d.flags|=1,na(f,d,_,D),d.child)}function Zo(f,d,_,E,D,G){return Do(d),d.updateQueue=null,_=Je(d,E,_,D),we(f),E=ct(),f!==null&&!Oa?(Ot(f,d,G),Va(f,d,G)):(wi&&E&&W(d),d.flags|=1,na(f,d,_,G),d.child)}function tu(f,d,_,E,D){if(Do(d),d.stateNode===null){var G=gu,de=_.contextType;typeof de=="object"&&de!==null&&(G=va(de)),G=new _(E,G),d.memoizedState=G.state!==null&&G.state!==void 0?G.state:null,G.updater=kd,d.stateNode=G,G._reactInternals=d,G=d.stateNode,G.props=E,G.state=d.memoizedState,G.refs={},It(d),de=_.contextType,G.context=typeof de=="object"&&de!==null?va(de):gu,G.state=d.memoizedState,de=_.getDerivedStateFromProps,typeof de=="function"&&(Vi(d,_,de,E),G.state=d.memoizedState),typeof _.getDerivedStateFromProps=="function"||typeof G.getSnapshotBeforeUpdate=="function"||typeof G.UNSAFE_componentWillMount!="function"&&typeof G.componentWillMount!="function"||(de=G.state,typeof G.componentWillMount=="function"&&G.componentWillMount(),typeof G.UNSAFE_componentWillMount=="function"&&G.UNSAFE_componentWillMount(),de!==G.state&&kd.enqueueReplaceState(G,G.state,null),ht(d,E,G,D),Ie(),G.state=d.memoizedState),typeof G.componentDidMount=="function"&&(d.flags|=4194308),E=!0}else if(f===null){G=d.stateNode;var Ce=d.memoizedProps,Xe=ka(_,Ce);G.props=Xe;var Ct=G.context,Jt=_.contextType;de=gu,typeof Jt=="object"&&Jt!==null&&(de=va(Jt));var cn=_.getDerivedStateFromProps;Jt=typeof cn=="function"||typeof G.getSnapshotBeforeUpdate=="function",Ce=d.pendingProps!==Ce,Jt||typeof G.UNSAFE_componentWillReceiveProps!="function"&&typeof G.componentWillReceiveProps!="function"||(Ce||Ct!==de)&&ma(d,G,E,de),Wl=!1;var pn=d.memoizedState;G.state=pn,ht(d,E,G,D),Ie(),Ct=d.memoizedState,Ce||pn!==Ct||Wl?(typeof cn=="function"&&(Vi(d,_,cn,E),Ct=d.memoizedState),(Xe=Wl||Bs(d,_,Xe,E,pn,Ct,de))?(Jt||typeof G.UNSAFE_componentWillMount!="function"&&typeof G.componentWillMount!="function"||(typeof G.componentWillMount=="function"&&G.componentWillMount(),typeof G.UNSAFE_componentWillMount=="function"&&G.UNSAFE_componentWillMount()),typeof G.componentDidMount=="function"&&(d.flags|=4194308)):(typeof G.componentDidMount=="function"&&(d.flags|=4194308),d.memoizedProps=E,d.memoizedState=Ct),G.props=E,G.state=Ct,G.context=de,E=Xe):(typeof G.componentDidMount=="function"&&(d.flags|=4194308),E=!1)}else{G=d.stateNode,zt(f,d),de=d.memoizedProps,Jt=ka(_,de),G.props=Jt,cn=d.pendingProps,pn=G.context,Ct=_.contextType,Xe=gu,typeof Ct=="object"&&Ct!==null&&(Xe=va(Ct)),Ce=_.getDerivedStateFromProps,(Ct=typeof Ce=="function"||typeof G.getSnapshotBeforeUpdate=="function")||typeof G.UNSAFE_componentWillReceiveProps!="function"&&typeof G.componentWillReceiveProps!="function"||(de!==cn||pn!==Xe)&&ma(d,G,E,Xe),Wl=!1,pn=d.memoizedState,G.state=pn,ht(d,E,G,D),Ie();var Vn=d.memoizedState;de!==cn||pn!==Vn||Wl||f!==null&&f.dependencies!==null&&Hr(f.dependencies)?(typeof Ce=="function"&&(Vi(d,_,Ce,E),Vn=d.memoizedState),(Jt=Wl||Bs(d,_,Jt,E,pn,Vn,Xe)||f!==null&&f.dependencies!==null&&Hr(f.dependencies))?(Ct||typeof G.UNSAFE_componentWillUpdate!="function"&&typeof G.componentWillUpdate!="function"||(typeof G.componentWillUpdate=="function"&&G.componentWillUpdate(E,Vn,Xe),typeof G.UNSAFE_componentWillUpdate=="function"&&G.UNSAFE_componentWillUpdate(E,Vn,Xe)),typeof G.componentDidUpdate=="function"&&(d.flags|=4),typeof G.getSnapshotBeforeUpdate=="function"&&(d.flags|=1024)):(typeof G.componentDidUpdate!="function"||de===f.memoizedProps&&pn===f.memoizedState||(d.flags|=4),typeof G.getSnapshotBeforeUpdate!="function"||de===f.memoizedProps&&pn===f.memoizedState||(d.flags|=1024),d.memoizedProps=E,d.memoizedState=Vn),G.props=E,G.state=Vn,G.context=Xe,E=Jt):(typeof G.componentDidUpdate!="function"||de===f.memoizedProps&&pn===f.memoizedState||(d.flags|=4),typeof G.getSnapshotBeforeUpdate!="function"||de===f.memoizedProps&&pn===f.memoizedState||(d.flags|=1024),E=!1)}return G=E,ca(f,d),E=(d.flags&128)!==0,G||E?(G=d.stateNode,_=E&&typeof _.getDerivedStateFromError!="function"?null:G.render(),d.flags|=1,f!==null&&E?(d.child=Lc(d,f.child,null,D),d.child=Lc(d,null,_,D)):na(f,d,_,D),d.memoizedState=G.state,f=d.child):f=Va(f,d,D),f}function vr(f,d,_,E){return Qe(),d.flags|=256,na(f,d,_,E),d.child}function nu(f){return{baseLanes:f,cachePool:su()}}function zi(f,d,_){return f=f!==null?f.childLanes&~_:0,d&&(f|=Tr),f}function Ss(f,d,_){var E=d.pendingProps,D=!1,G=(d.flags&128)!==0,de;if((de=G)||(de=f!==null&&f.memoizedState===null?!1:(Wa.current&2)!==0),de&&(D=!0,d.flags&=-129),de=(d.flags&32)!==0,d.flags&=-33,f===null){if(wi){if(D?di(d):Mi(),wi){var Ce=Cs,Xe;(Xe=Ce)&&(Ce=$x(Ce,bo),Ce!==null?(d.memoizedState={dehydrated:Ce,treeContext:Fo!==null?{id:ul,overflow:yo}:null,retryLane:536870912},Xe=t(18,null,null,0),Xe.stateNode=Ce,Xe.return=d,d.child=Xe,zs=d,Cs=null,Xe=!0):Xe=!1),Xe||ve(d)}if(Ce=d.memoizedState,Ce!==null&&(Ce=Ce.dehydrated,Ce!==null))return rh(Ce)?d.lanes=16:d.lanes=536870912,null;mn(d)}return Ce=E.children,E=E.fallback,D?(Mi(),D=d.mode,Ce=iu({mode:"hidden",children:Ce},D),E=jl(E,D,_,null),Ce.return=d,E.return=d,Ce.sibling=E,d.child=Ce,D=d.child,D.memoizedState=nu(_),D.childLanes=zi(f,de,_),d.memoizedState=Ps,E):(di(d),Bo(d,Ce))}if(Xe=f.memoizedState,Xe!==null&&(Ce=Xe.dehydrated,Ce!==null)){if(G)d.flags&256?(di(d),d.flags&=-257,d=Dl(f,d,_)):d.memoizedState!==null?(Mi(),d.child=f.child,d.flags|=128,d=null):(Mi(),D=E.fallback,Ce=d.mode,E=iu({mode:"visible",children:E.children},Ce),D=jl(D,Ce,_,null),D.flags|=2,E.return=d,D.return=d,E.sibling=D,d.child=E,Lc(d,f.child,null,_),E=d.child,E.memoizedState=nu(_),E.childLanes=zi(f,de,_),d.memoizedState=Ps,d=D);else if(di(d),rh(Ce))de=Yx(Ce).digest,E=Error(i(419)),E.stack="",E.digest=de,lt({value:E,source:null,stack:null}),d=Dl(f,d,_);else if(Oa||xo(f,d,_,!1),de=(_&f.childLanes)!==0,Oa||de){if(de=ci,de!==null){if(E=_&-_,(E&42)!==0)E=1;else switch(E){case 2:E=1;break;case 8:E=4;break;case 32:E=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:E=64;break;case 268435456:E=134217728;break;default:E=0}if(E=(E&(de.suspendedLanes|_))!==0?0:E,E!==0&&E!==Xe.retryLane)throw Xe.retryLane=E,Ze(f,E),Ls(de,f,E),pg}Bd(Ce)||_r(),d=Dl(f,d,_)}else Bd(Ce)?(d.flags|=128,d.child=f.child,d=uu.bind(null,f),Wy(Ce,d),d=null):(f=Xe.treeContext,er&&(Cs=Zx(Ce),zs=d,wi=!0,Qr=null,bo=!1,f!==null&&(Zr[Kr++]=ul,Zr[Kr++]=yo,Zr[Kr++]=Fo,ul=f.id,yo=f.overflow,Fo=d)),d=Bo(d,E.children),d.flags|=4096);return d}return D?(Mi(),D=E.fallback,Ce=d.mode,Xe=f.child,G=Xe.sibling,E=Os(Xe,{mode:"hidden",children:E.children}),E.subtreeFlags=Xe.subtreeFlags&31457280,G!==null?D=Os(G,D):(D=jl(D,Ce,_,null),D.flags|=2),D.return=d,E.return=d,E.sibling=D,d.child=E,E=D,D=d.child,Ce=f.child.memoizedState,Ce===null?Ce=nu(_):(Xe=Ce.cachePool,Xe!==null?(G=ol?Fi._currentValue:Fi._currentValue2,Xe=Xe.parent!==G?{parent:G,pool:G}:Xe):Xe=su(),Ce={baseLanes:Ce.baseLanes|_,cachePool:Xe}),D.memoizedState=Ce,D.childLanes=zi(f,de,_),d.memoizedState=Ps,E):(di(d),_=f.child,f=_.sibling,_=Os(_,{mode:"visible",children:E.children}),_.return=d,_.sibling=null,f!==null&&(de=d.deletions,de===null?(d.deletions=[f],d.flags|=16):de.push(f)),d.child=_,d.memoizedState=null,_)}function Bo(f,d){return d=iu({mode:"visible",children:d},f.mode),d.return=f,f.child=d}function iu(f,d){return bd(f,d,0,null)}function Dl(f,d,_){return Lc(d,f.child,null,_),f=Bo(d,d.pendingProps.children),f.flags|=2,d.memoizedState=null,f}function qn(f,d,_){f.lanes|=d;var E=f.alternate;E!==null&&(E.lanes|=d),ua(f.return,d,_)}function Ko(f,d,_,E,D){var G=f.memoizedState;G===null?f.memoizedState={isBackwards:d,rendering:null,renderingStartTime:0,last:E,tail:_,tailMode:D}:(G.isBackwards=d,G.rendering=null,G.renderingStartTime=0,G.last=E,G.tail=_,G.tailMode=D)}function fi(f,d,_){var E=d.pendingProps,D=E.revealOrder,G=E.tail;if(na(f,d,E.children,_),E=Wa.current,(E&2)!==0)E=E&1|2,d.flags|=128;else{if(f!==null&&(f.flags&128)!==0)e:for(f=d.child;f!==null;){if(f.tag===13)f.memoizedState!==null&&qn(f,_,d);else if(f.tag===19)qn(f,_,d);else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===d)break e;for(;f.sibling===null;){if(f.return===null||f.return===d)break e;f=f.return}f.sibling.return=f.return,f=f.sibling}E&=1}switch(R(Wa,E),D){case"forwards":for(_=d.child,D=null;_!==null;)f=_.alternate,f!==null&&jn(f)===null&&(D=_),_=_.sibling;_=D,_===null?(D=d.child,d.child=null):(D=_.sibling,_.sibling=null),Ko(d,!1,D,_,G);break;case"backwards":for(_=null,D=d.child,d.child=null;D!==null;){if(f=D.alternate,f!==null&&jn(f)===null){d.child=D;break}f=D.sibling,D.sibling=_,_=D,D=f}Ko(d,!0,_,null,G);break;case"together":Ko(d,!1,null,null,void 0);break;default:d.memoizedState=null}return d.child}function Va(f,d,_){if(f!==null&&(d.dependencies=f.dependencies),io|=d.lanes,(_&d.childLanes)===0)if(f!==null){if(xo(f,d,_,!1),(_&d.childLanes)===0)return null}else return null;if(f!==null&&d.child!==f.child)throw Error(i(153));if(d.child!==null){for(f=d.child,_=Os(f,f.pendingProps),d.child=_,_.return=d;f.sibling!==null;)f=f.sibling,_=_.sibling=Os(f,f.pendingProps),_.return=d;_.sibling=null}return d.child}function po(f,d){return(f.lanes&d)!==0?!0:(f=f.dependencies,!!(f!==null&&Hr(f)))}function kf(f,d,_){switch(d.tag){case 3:Z(d,d.stateNode.containerInfo),mo(d,Fi,f.memoizedState.cache),Qe();break;case 27:case 5:$(d);break;case 4:Z(d,d.stateNode.containerInfo);break;case 10:mo(d,d.type,d.memoizedProps.value);break;case 13:var E=d.memoizedState;if(E!==null)return E.dehydrated!==null?(di(d),d.flags|=128,null):(_&d.child.childLanes)!==0?Ss(f,d,_):(di(d),f=Va(f,d,_),f!==null?f.sibling:null);di(d);break;case 19:var D=(f.flags&128)!==0;if(E=(_&d.childLanes)!==0,E||(xo(f,d,_,!1),E=(_&d.childLanes)!==0),D){if(E)return fi(f,d,_);d.flags|=128}if(D=d.memoizedState,D!==null&&(D.rendering=null,D.tail=null,D.lastEffect=null),R(Wa,Wa.current),E)break;return null;case 22:case 23:return d.lanes=0,ga(f,d,_);case 24:mo(d,Fi,f.memoizedState.cache)}return Va(f,d,_)}function dc(f,d,_){if(f!==null)if(f.memoizedProps!==d.pendingProps)Oa=!0;else{if(!po(f,_)&&(d.flags&128)===0)return Oa=!1,kf(f,d,_);Oa=(f.flags&131072)!==0}else Oa=!1,wi&&(d.flags&1048576)!==0&&I(d,hh,d.index);switch(d.lanes=0,d.tag){case 16:e:{f=d.pendingProps;var E=d.elementType,D=E._init;if(E=D(E._payload),d.type=E,typeof E=="function")Pl(E)?(f=ka(E,f),d.tag=1,d=tu(null,d,E,f,_)):(d.tag=0,d=Ds(null,d,E,f,_));else{if(E!=null){if(D=E.$$typeof,D===Wu){d.tag=11,d=Gr(null,d,E,f,_);break e}else if(D===Qf){d.tag=14,d=Bl(null,d,E,f,_);break e}}throw d=o(E)||E,Error(i(306,d,""))}}return d;case 0:return Ds(f,d,d.type,d.pendingProps,_);case 1:return E=d.type,D=ka(E,d.pendingProps),tu(f,d,E,D,_);case 3:e:{if(Z(d,d.stateNode.containerInfo),f===null)throw Error(i(387));var G=d.pendingProps;D=d.memoizedState,E=D.element,zt(f,d),ht(d,G,null,_);var de=d.memoizedState;if(G=de.cache,mo(d,Fi,G),G!==D.cache&&Qo(d,[Fi],_,!0),Ie(),G=de.element,er&&D.isDehydrated)if(D={element:G,isDehydrated:!1,cache:de.cache},d.updateQueue.baseState=D,d.memoizedState=D,d.flags&256){d=vr(f,d,G,_);break e}else if(G!==E){E=ie(Error(i(424)),d),lt(E),d=vr(f,d,G,_);break e}else for(er&&(Cs=Jx(d.stateNode.containerInfo),zs=d,wi=!0,Qr=null,bo=!0),_=im(d,null,G,_),d.child=_;_;)_.flags=_.flags&-3|4096,_=_.sibling;else{if(Qe(),G===E){d=Va(f,d,_);break e}na(f,d,G,_)}d=d.child}return d;case 26:if(qr)return ca(f,d),f===null?(_=Id(d.type,null,d.pendingProps,null))?d.memoizedState=_:wi||(d.stateNode=Jy(d.type,d.pendingProps,Po.current,d)):d.memoizedState=Id(d.type,f.memoizedProps,d.pendingProps,f.memoizedState),null;case 27:if(ws)return $(d),f===null&&ws&&wi&&(E=d.stateNode=$0(d.type,d.pendingProps,Po.current,ps.current,!1),zs=d,bo=!0,Cs=Dd(E)),E=d.pendingProps.children,f!==null||wi?na(f,d,E,_):d.child=Lc(d,null,E,_),ca(f,d),d.child;case 5:return f===null&&wi&&(ag(d.type,d.pendingProps,ps.current),(D=E=Cs)&&(E=Kx(E,d.type,d.pendingProps,bo),E!==null?(d.stateNode=E,zs=d,Cs=Dd(E),bo=!1,D=!0):D=!1),D||ve(d)),$(d),D=d.type,G=d.pendingProps,de=f!==null?f.memoizedProps:null,E=G.children,Rc(D,G)?E=null:de!==null&&Rc(D,de)&&(d.flags|=32),d.memoizedState!==null&&(D=he(f,d,ot,null,null,_),ol?In._currentValue=D:In._currentValue2=D),ca(f,d),na(f,d,E,_),d.child;case 6:return f===null&&wi&&(sg(d.pendingProps,ps.current),(f=_=Cs)&&(_=Qx(_,d.pendingProps,bo),_!==null?(d.stateNode=_,zs=d,Cs=null,f=!0):f=!1),f||ve(d)),null;case 13:return Ss(f,d,_);case 4:return Z(d,d.stateNode.containerInfo),E=d.pendingProps,f===null?d.child=Lc(d,null,E,_):na(f,d,E,_),d.child;case 11:return Gr(f,d,d.type,d.pendingProps,_);case 7:return na(f,d,d.pendingProps,_),d.child;case 8:return na(f,d,d.pendingProps.children,_),d.child;case 12:return na(f,d,d.pendingProps.children,_),d.child;case 10:return E=d.pendingProps,mo(d,d.type,E.value),na(f,d,E.children,_),d.child;case 9:return D=d.type._context,E=d.pendingProps.children,Do(d),D=va(D),E=E(D),d.flags|=1,na(f,d,E,_),d.child;case 14:return Bl(f,d,d.type,d.pendingProps,_);case 15:return jr(f,d,d.type,d.pendingProps,_);case 19:return fi(f,d,_);case 22:return ga(f,d,_);case 24:return Do(d),E=va(Fi),f===null?(D=kr(),D===null&&(D=ci,G=Ul(),D.pooledCache=G,G.refCount++,G!==null&&(D.pooledCacheLanes|=_),D=G),d.memoizedState={parent:E,cache:D},It(d),mo(d,Fi,D)):((f.lanes&_)!==0&&(zt(f,d),ht(d,null,null,_),Ie()),D=f.memoizedState,G=d.memoizedState,D.parent!==E?(D={parent:E,cache:E},d.memoizedState=D,d.lanes===0&&(d.memoizedState=d.updateQueue.baseState=D),mo(d,Fi,E)):(E=G.cache,mo(d,Fi,E),E!==D.cache&&Qo(d,[Fi],_,!0))),na(f,d,d.pendingProps.children,_),d.child;case 29:throw d.pendingProps}throw Error(i(156,d.tag))}function mo(f,d,_){ol?(R(Er,d._currentValue),d._currentValue=_):(R(Er,d._currentValue2),d._currentValue2=_)}function Ks(f){var d=Er.current;ol?f._currentValue=d:f._currentValue2=d,A(Er)}function ua(f,d,_){for(;f!==null;){var E=f.alternate;if((f.childLanes&d)!==d?(f.childLanes|=d,E!==null&&(E.childLanes|=d)):E!==null&&(E.childLanes&d)!==d&&(E.childLanes|=d),f===_)break;f=f.return}}function Qo(f,d,_,E){var D=f.child;for(D!==null&&(D.return=f);D!==null;){var G=D.dependencies;if(G!==null){var de=D.child;G=G.firstContext;e:for(;G!==null;){var Ce=G;G=D;for(var Xe=0;Xe<d.length;Xe++)if(Ce.context===d[Xe]){G.lanes|=_,Ce=G.alternate,Ce!==null&&(Ce.lanes|=_),ua(G.return,_,f),E||(de=null);break e}G=Ce.next}}else if(D.tag===18){if(de=D.return,de===null)throw Error(i(341));de.lanes|=_,G=de.alternate,G!==null&&(G.lanes|=_),ua(de,_,f),de=null}else de=D.child;if(de!==null)de.return=D;else for(de=D;de!==null;){if(de===f){de=null;break}if(D=de.sibling,D!==null){D.return=de.return,de=D;break}de=de.return}D=de}}function xo(f,d,_,E){f=null;for(var D=d,G=!1;D!==null;){if(!G){if((D.flags&524288)!==0)G=!0;else if((D.flags&262144)!==0)break}if(D.tag===10){var de=D.alternate;if(de===null)throw Error(i(387));if(de=de.memoizedProps,de!==null){var Ce=D.type;Jr(D.pendingProps.value,de.value)||(f!==null?f.push(Ce):f=[Ce])}}else if(D===ef.current){if(de=D.alternate,de===null)throw Error(i(387));de.memoizedState.memoizedState!==D.memoizedState.memoizedState&&(f!==null?f.push(In):f=[In])}D=D.return}f!==null&&Qo(d,f,_,E),d.flags|=262144}function Hr(f){for(f=f.firstContext;f!==null;){var d=f.context;if(!Jr(ol?d._currentValue:d._currentValue2,f.memoizedValue))return!0;f=f.next}return!1}function Do(f){Ic=f,Ca=null,f=f.dependencies,f!==null&&(f.firstContext=null)}function va(f){return au(Ic,f)}function $o(f,d){return Ic===null&&Do(f),au(f,d)}function au(f,d){var _=ol?d._currentValue:d._currentValue2;if(d={context:d,memoizedValue:_,next:null},Ca===null){if(f===null)throw Error(i(308));Ca=d,f.dependencies={lanes:0,firstContext:d},f.flags|=524288}else Ca=Ca.next=d;return _}function Ul(){return{controller:new mg,data:new Map,refCount:0}}function Uo(f){f.refCount--,f.refCount===0&&Jl(bu,function(){f.controller.abort()})}function kr(){var f=Zl.current;return f!==null?f:ci.pooledCache}function Xa(f,d){d===null?R(Zl,Zl.current):R(Zl,d.pool)}function su(){var f=kr();return f===null?null:{parent:ol?Fi._currentValue:Fi._currentValue2,pool:f}}function V(f){f.flags|=4}function Wt(f,d){if(f!==null&&f.child===d.child)return!1;if((d.flags&16)!==0)return!0;for(f=d.child;f!==null;){if((f.flags&13878)!==0||(f.subtreeFlags&13878)!==0)return!0;f=f.sibling}return!1}function Ui(f,d,_,E){if(Ms)for(_=d.child;_!==null;){if(_.tag===5||_.tag===6)rl(f,_.stateNode);else if(!(_.tag===4||ws&&_.tag===27)&&_.child!==null){_.child.return=_,_=_.child;continue}if(_===d)break;for(;_.sibling===null;){if(_.return===null||_.return===d)return;_=_.return}_.sibling.return=_.return,_=_.sibling}else if(Yr)for(var D=d.child;D!==null;){if(D.tag===5){var G=D.stateNode;_&&E&&(G=G0(G,D.type,D.memoizedProps)),rl(f,G)}else if(D.tag===6)G=D.stateNode,_&&E&&(G=j0(G,D.memoizedProps)),rl(f,G);else if(D.tag!==4){if(D.tag===22&&D.memoizedState!==null)G=D.child,G!==null&&(G.return=D),Ui(f,D,!0,!0);else if(D.child!==null){D.child.return=D,D=D.child;continue}}if(D===d)break;for(;D.sibling===null;){if(D.return===null||D.return===d)return;D=D.return}D.sibling.return=D.return,D=D.sibling}}function Ji(f,d,_,E){if(Yr)for(var D=d.child;D!==null;){if(D.tag===5){var G=D.stateNode;_&&E&&(G=G0(G,D.type,D.memoizedProps)),F0(f,G)}else if(D.tag===6)G=D.stateNode,_&&E&&(G=j0(G,D.memoizedProps)),F0(f,G);else if(D.tag!==4){if(D.tag===22&&D.memoizedState!==null)G=D.child,G!==null&&(G.return=D),Ji(f,D,!(D.memoizedProps!==null&&D.memoizedProps.mode==="manual"),!0);else if(D.child!==null){D.child.return=D,D=D.child;continue}}if(D===d)break;for(;D.sibling===null;){if(D.return===null||D.return===d)return;D=D.return}D.sibling.return=D.return,D=D.sibling}}function pc(f,d){if(Yr&&Wt(f,d)){f=d.stateNode;var _=f.containerInfo,E=Nd();Ji(E,d,!1,!1),f.pendingChildren=E,V(d),Xx(_,E)}}function Vf(f,d,_,E){if(Ms)f.memoizedProps!==E&&V(d);else if(Yr){var D=f.stateNode,G=f.memoizedProps;if((f=Wt(f,d))||G!==E){var de=ps.current;G=z0(D,_,G,E,!f,null),G===D?d.stateNode=D:(kl(G,_,E,de)&&V(d),d.stateNode=G,f?Ui(G,d,!1,!1):V(d))}else d.stateNode=D}}function mc(f,d,_){if(Hx(d,_)){if(f.flags|=16777216,!Vl(d,_))if(qf())f.flags|=8192;else throw yu=jd,nm}else f.flags&=-16777217}function Xf(f,d){if(rg(d)){if(f.flags|=16777216,!K0(d))if(qf())f.flags|=8192;else throw yu=jd,nm}else f.flags&=-16777217}function ru(f,d){d!==null&&(f.flags|=4),f.flags&16384&&(d=f.tag!==22?L():536870912,f.lanes|=d,Ql|=d)}function Ll(f,d){if(!wi)switch(f.tailMode){case"hidden":d=f.tail;for(var _=null;d!==null;)d.alternate!==null&&(_=d),d=d.sibling;_===null?f.tail=null:_.sibling=null;break;case"collapsed":_=f.tail;for(var E=null;_!==null;)_.alternate!==null&&(E=_),_=_.sibling;E===null?d||f.tail===null?f.tail=null:f.tail.sibling=null:E.sibling=null}}function $i(f){var d=f.alternate!==null&&f.alternate.child===f.child,_=0,E=0;if(d)for(var D=f.child;D!==null;)_|=D.lanes|D.childLanes,E|=D.subtreeFlags&31457280,E|=D.flags&31457280,D.return=f,D=D.sibling;else for(D=f.child;D!==null;)_|=D.lanes|D.childLanes,E|=D.subtreeFlags,E|=D.flags,D.return=f,D=D.sibling;return f.subtreeFlags|=E,f.childLanes=_,d}function fd(f,d,_){var E=d.pendingProps;switch(fe(d),d.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return $i(d),null;case 1:return $i(d),null;case 3:return _=d.stateNode,E=null,f!==null&&(E=f.memoizedState.cache),d.memoizedState.cache!==E&&(d.flags|=2048),Ks(Fi),me(),_.pendingContext&&(_.context=_.pendingContext,_.pendingContext=null),(f===null||f.child===null)&&(Fe(d)?V(d):f===null||f.memoizedState.isDehydrated&&(d.flags&256)===0||(d.flags|=1024,Qr!==null&&(Il(Qr),Qr=null))),pc(f,d),$i(d),null;case 26:if(qr){_=d.type;var D=d.memoizedState;return f===null?(V(d),D!==null?($i(d),Xf(d,D)):($i(d),mc(d,_,E))):D?D!==f.memoizedState?(V(d),$i(d),Xf(d,D)):($i(d),d.flags&=-16777217):(Ms?f.memoizedProps!==E&&V(d):Vf(f,d,_,E),$i(d),mc(d,_,E)),null}case 27:if(ws){if(pe(d),_=Po.current,D=d.type,f!==null&&d.stateNode!=null)Ms?f.memoizedProps!==E&&V(d):Vf(f,d,D,E);else{if(!E){if(d.stateNode===null)throw Error(i(166));return $i(d),null}f=ps.current,Fe(d)?ze(d,f):(f=$0(D,E,_,f,!0),d.stateNode=f,V(d))}return $i(d),null}case 5:if(pe(d),_=d.type,f!==null&&d.stateNode!=null)Vf(f,d,_,E);else{if(!E){if(d.stateNode===null)throw Error(i(166));return $i(d),null}f=ps.current,Fe(d)?ze(d,f):(D=E0(_,E,Po.current,f,d),Ui(D,d,!1,!1),d.stateNode=D,kl(D,_,E,f)&&V(d))}return $i(d),mc(d,d.type,d.pendingProps),null;case 6:if(f&&d.stateNode!=null)_=f.memoizedProps,Ms?_!==E&&V(d):Yr&&(_!==E?(d.stateNode=Md(E,Po.current,ps.current,d),V(d)):d.stateNode=f.stateNode);else{if(typeof E!="string"&&d.stateNode===null)throw Error(i(166));if(f=Po.current,_=ps.current,Fe(d)){if(!er)throw Error(i(176));if(f=d.stateNode,_=d.memoizedProps,E=null,D=zs,D!==null)switch(D.tag){case 27:case 5:E=D.memoizedProps}eg(f,_,d,E)||ve(d)}else d.stateNode=Md(E,f,_,d)}return $i(d),null;case 13:if(E=d.memoizedState,f===null||f.memoizedState!==null&&f.memoizedState.dehydrated!==null){if(D=Fe(d),E!==null&&E.dehydrated!==null){if(f===null){if(!D)throw Error(i(318));if(!er)throw Error(i(344));if(D=d.memoizedState,D=D!==null?D.dehydrated:null,!D)throw Error(i(317));Ju(D,d)}else Qe(),(d.flags&128)===0&&(d.memoizedState=null),d.flags|=4;$i(d),D=!1}else Qr!==null&&(Il(Qr),Qr=null),D=!0;if(!D)return d.flags&256?(mn(d),d):(mn(d),null)}if(mn(d),(d.flags&128)!==0)return d.lanes=_,d;if(_=E!==null,f=f!==null&&f.memoizedState!==null,_){E=d.child,D=null,E.alternate!==null&&E.alternate.memoizedState!==null&&E.alternate.memoizedState.cachePool!==null&&(D=E.alternate.memoizedState.cachePool.pool);var G=null;E.memoizedState!==null&&E.memoizedState.cachePool!==null&&(G=E.memoizedState.cachePool.pool),G!==D&&(E.flags|=2048)}return _!==f&&_&&(d.child.flags|=8192),ru(d,d.updateQueue),$i(d),null;case 4:return me(),pc(f,d),f===null&&R0(d.stateNode.containerInfo),$i(d),null;case 10:return Ks(d.type),$i(d),null;case 19:if(A(Wa),D=d.memoizedState,D===null)return $i(d),null;if(E=(d.flags&128)!==0,G=D.rendering,G===null)if(E)Ll(D,!1);else{if(Si!==0||f!==null&&(f.flags&128)!==0)for(f=d.child;f!==null;){if(G=jn(f),G!==null){for(d.flags|=128,Ll(D,!1),f=G.updateQueue,d.updateQueue=f,ru(d,f),d.subtreeFlags=0,f=_,_=d.child;_!==null;)Gl(_,f),_=_.sibling;return R(Wa,Wa.current&1|2),d.child}f=f.sibling}D.tail!==null&&Es()>_a&&(d.flags|=128,E=!0,Ll(D,!1),d.lanes=4194304)}else{if(!E)if(f=jn(G),f!==null){if(d.flags|=128,E=!0,f=f.updateQueue,d.updateQueue=f,ru(d,f),Ll(D,!0),D.tail===null&&D.tailMode==="hidden"&&!G.alternate&&!wi)return $i(d),null}else 2*Es()-D.renderingStartTime>_a&&_!==536870912&&(d.flags|=128,E=!0,Ll(D,!1),d.lanes=4194304);D.isBackwards?(G.sibling=d.child,d.child=G):(f=D.last,f!==null?f.sibling=G:d.child=G,D.last=G)}return D.tail!==null?(d=D.tail,D.rendering=d,D.tail=d.sibling,D.renderingStartTime=Es(),d.sibling=null,f=Wa.current,R(Wa,E?f&1|2:f&1),d):($i(d),null);case 22:case 23:return mn(d),la(),E=d.memoizedState!==null,f!==null?f.memoizedState!==null!==E&&(d.flags|=8192):E&&(d.flags|=8192),E?(_&536870912)!==0&&(d.flags&128)===0&&($i(d),d.subtreeFlags&6&&(d.flags|=8192)):$i(d),_=d.updateQueue,_!==null&&ru(d,_.retryQueue),_=null,f!==null&&f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(_=f.memoizedState.cachePool.pool),E=null,d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(E=d.memoizedState.cachePool.pool),E!==_&&(d.flags|=2048),f!==null&&A(Zl),null;case 24:return _=null,f!==null&&(_=f.memoizedState.cache),d.memoizedState.cache!==_&&(d.flags|=2048),Ks(Fi),$i(d),null;case 25:return null}throw Error(i(156,d.tag))}function ce(f,d){switch(fe(d),d.tag){case 1:return f=d.flags,f&65536?(d.flags=f&-65537|128,d):null;case 3:return Ks(Fi),me(),f=d.flags,(f&65536)!==0&&(f&128)===0?(d.flags=f&-65537|128,d):null;case 26:case 27:case 5:return pe(d),null;case 13:if(mn(d),f=d.memoizedState,f!==null&&f.dehydrated!==null){if(d.alternate===null)throw Error(i(340));Qe()}return f=d.flags,f&65536?(d.flags=f&-65537|128,d):null;case 19:return A(Wa),null;case 4:return me(),null;case 10:return Ks(d.type),null;case 22:case 23:return mn(d),la(),f!==null&&A(Zl),f=d.flags,f&65536?(d.flags=f&-65537|128,d):null;case 24:return Ks(Fi),null;case 25:return null;default:return null}}function Se(f,d){switch(fe(d),d.tag){case 3:Ks(Fi),me();break;case 26:case 27:case 5:pe(d);break;case 4:me();break;case 13:mn(d);break;case 19:A(Wa);break;case 10:Ks(d.type);break;case 22:case 23:mn(d),la(),f!==null&&A(Zl);break;case 24:Ks(Fi)}}function _e(f,d){try{var _=d.updateQueue,E=_!==null?_.lastEffect:null;if(E!==null){var D=E.next;_=D;do{if((_.tag&f)===f){E=void 0;var G=_.create,de=_.inst;E=G(),de.destroy=E}_=_.next}while(_!==D)}}catch(Ce){pi(d,d.return,Ce)}}function Ee(f,d,_){try{var E=d.updateQueue,D=E!==null?E.lastEffect:null;if(D!==null){var G=D.next;E=G;do{if((E.tag&f)===f){var de=E.inst,Ce=de.destroy;if(Ce!==void 0){de.destroy=void 0,D=d;var Xe=_;try{Ce()}catch(Ct){pi(D,Xe,Ct)}}}E=E.next}while(E!==G)}}catch(Ct){pi(d,d.return,Ct)}}function tt(f){var d=f.updateQueue;if(d!==null){var _=f.stateNode;try{Re(d,_)}catch(E){pi(f,f.return,E)}}}function St(f,d,_){_.props=ka(f.type,f.memoizedProps),_.state=f.memoizedState;try{_.componentWillUnmount()}catch(E){pi(f,d,E)}}function Ut(f,d){try{var _=f.ref;if(_!==null){var E=f.stateNode;switch(f.tag){case 26:case 27:case 5:var D=qu(E);break;default:D=E}typeof _=="function"?f.refCleanup=_(D):_.current=D}}catch(G){pi(f,d,G)}}function wt(f,d){var _=f.ref,E=f.refCleanup;if(_!==null)if(typeof E=="function")try{E()}catch(D){pi(f,d,D)}finally{f.refCleanup=null,f=f.alternate,f!=null&&(f.refCleanup=null)}else if(typeof _=="function")try{_(null)}catch(D){pi(f,d,D)}else _.current=null}function fn(f){var d=f.type,_=f.memoizedProps,E=f.stateNode;try{Yy(E,d,_,f)}catch(D){pi(f,f.return,D)}}function Ht(f,d,_){try{U0(f.stateNode,f.type,_,d,f)}catch(E){pi(f,f.return,E)}}function Et(f){return f.tag===5||f.tag===3||(qr?f.tag===26:!1)||(ws?f.tag===27:!1)||f.tag===4}function dn(f){e:for(;;){for(;f.sibling===null;){if(f.return===null||Et(f.return))return null;f=f.return}for(f.sibling.return=f.return,f=f.sibling;f.tag!==5&&f.tag!==6&&(!ws||f.tag!==27)&&f.tag!==18;){if(f.flags&2||f.child===null||f.tag===4)continue e;f.child.return=f,f=f.child}if(!(f.flags&2))return f.stateNode}}function Xt(f,d,_){var E=f.tag;if(E===5||E===6)f=f.stateNode,d?O0(_,f,d):kx(_,f);else if(!(E===4||ws&&E===27)&&(f=f.child,f!==null))for(Xt(f,d,_),f=f.sibling;f!==null;)Xt(f,d,_),f=f.sibling}function Zt(f,d,_){var E=f.tag;if(E===5||E===6)f=f.stateNode,d?L0(_,f,d):D0(_,f);else if(!(E===4||ws&&E===27)&&(f=f.child,f!==null))for(Zt(f,d,_),f=f.sibling;f!==null;)Zt(f,d,_),f=f.sibling}function Gt(f,d,_){f=f.containerInfo;try{P0(f,_)}catch(E){pi(d,d.return,E)}}function _n(f,d){for(Tc(f.containerInfo),Ta=d;Ta!==null;)if(f=Ta,d=f.child,(f.subtreeFlags&1028)!==0&&d!==null)d.return=f,Ta=d;else for(;Ta!==null;){f=Ta;var _=f.alternate;switch(d=f.flags,f.tag){case 0:break;case 11:case 15:break;case 1:if((d&1024)!==0&&_!==null){d=void 0;var E=f,D=_.memoizedProps;_=_.memoizedState;var G=E.stateNode;try{var de=ka(E.type,D,E.elementType===E.type);d=G.getSnapshotBeforeUpdate(de,_),G.__reactInternalSnapshotBeforeUpdate=d}catch(Ce){pi(E,E.return,Ce)}}break;case 3:(d&1024)!==0&&Ms&&Rd(f.stateNode.containerInfo);break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((d&1024)!==0)throw Error(i(163))}if(d=f.sibling,d!==null){d.return=f.return,Ta=d;break}Ta=f.return}return de=_u,_u=!1,de}function nn(f,d,_){var E=_.flags;switch(_.tag){case 0:case 11:case 15:el(f,_),E&4&&_e(5,_);break;case 1:if(el(f,_),E&4)if(f=_.stateNode,d===null)try{f.componentDidMount()}catch(Ce){pi(_,_.return,Ce)}else{var D=ka(_.type,d.memoizedProps);d=d.memoizedState;try{f.componentDidUpdate(D,d,f.__reactInternalSnapshotBeforeUpdate)}catch(Ce){pi(_,_.return,Ce)}}E&64&&tt(_),E&512&&Ut(_,_.return);break;case 3:if(el(f,_),E&64&&(E=_.updateQueue,E!==null)){if(f=null,_.child!==null)switch(_.child.tag){case 27:case 5:f=qu(_.child.stateNode);break;case 1:f=_.child.stateNode}try{Re(E,f)}catch(Ce){pi(_,_.return,Ce)}}break;case 26:if(qr){el(f,_),E&512&&Ut(_,_.return);break}case 27:case 5:el(f,_),d===null&&E&4&&fn(_),E&512&&Ut(_,_.return);break;case 12:el(f,_);break;case 13:el(f,_),E&4&&ya(f,_);break;case 22:if(D=_.memoizedState!==null||es,!D){d=d!==null&&d.memoizedState!==null||ba;var G=es,de=ba;es=D,(ba=d)&&!de?gc(f,_,(_.subtreeFlags&8772)!==0):el(f,_),es=G,ba=de}E&512&&(_.memoizedProps.mode==="manual"?Ut(_,_.return):wt(_,_.return));break;default:el(f,_)}}function kt(f){var d=f.alternate;d!==null&&(f.alternate=null,kt(d)),f.child=null,f.deletions=null,f.sibling=null,f.tag===5&&(d=f.stateNode,d!==null&&N0(d)),f.stateNode=null,f.return=null,f.dependencies=null,f.memoizedProps=null,f.memoizedState=null,f.pendingProps=null,f.stateNode=null,f.updateQueue=null}function An(f,d,_){for(_=_.child;_!==null;)Zn(f,d,_),_=_.sibling}function Zn(f,d,_){if(Mr&&typeof Mr.onCommitFiberUnmount=="function")try{Mr.onCommitFiberUnmount($u,_)}catch{}switch(_.tag){case 26:if(qr){ba||wt(_,d),An(f,d,_),_.memoizedState?Y0(_.memoizedState):_.stateNode&&J0(_.stateNode);break}case 27:if(ws){ba||wt(_,d);var E=Ia,D=Cr;Ia=_.stateNode,An(f,d,_),og(_.stateNode),Ia=E,Cr=D;break}case 5:ba||wt(_,d);case 6:if(Ms){if(E=Ia,D=Cr,Ia=null,An(f,d,_),Ia=E,Cr=D,Ia!==null)if(Cr)try{Ua(Ia,_.stateNode)}catch(G){pi(_,d,G)}else try{tr(Ia,_.stateNode)}catch(G){pi(_,d,G)}}else An(f,d,_);break;case 18:Ms&&Ia!==null&&(Cr?k0(Ia,_.stateNode):ng(Ia,_.stateNode));break;case 4:Ms?(E=Ia,D=Cr,Ia=_.stateNode.containerInfo,Cr=!0,An(f,d,_),Ia=E,Cr=D):(Yr&&Gt(_.stateNode,_,Nd()),An(f,d,_));break;case 0:case 11:case 14:case 15:ba||Ee(2,_,d),ba||Ee(4,_,d),An(f,d,_);break;case 1:ba||(wt(_,d),E=_.stateNode,typeof E.componentWillUnmount=="function"&&St(_,d,E)),An(f,d,_);break;case 21:An(f,d,_);break;case 22:ba||wt(_,d),ba=(E=ba)||_.memoizedState!==null,An(f,d,_),ba=E;break;default:An(f,d,_)}}function ya(f,d){if(er&&d.memoizedState===null&&(f=d.alternate,f!==null&&(f=f.memoizedState,f!==null&&(f=f.dehydrated,f!==null))))try{Ld(f)}catch(_){pi(d,d.return,_)}}function ls(f){switch(f.tag){case 13:case 19:var d=f.stateNode;return d===null&&(d=f.stateNode=new rf),d;case 22:return f=f.stateNode,d=f._retryCache,d===null&&(d=f._retryCache=new rf),d;default:throw Error(i(435,f.tag))}}function Vr(f,d){var _=ls(f);d.forEach(function(E){var D=m0.bind(null,f,E);_.has(E)||(_.add(E),E.then(D,D))})}function cs(f,d){var _=d.deletions;if(_!==null)for(var E=0;E<_.length;E++){var D=_[E],G=f,de=d;if(Ms){var Ce=de;e:for(;Ce!==null;){switch(Ce.tag){case 27:case 5:Ia=Ce.stateNode,Cr=!1;break e;case 3:Ia=Ce.stateNode.containerInfo,Cr=!0;break e;case 4:Ia=Ce.stateNode.containerInfo,Cr=!0;break e}Ce=Ce.return}if(Ia===null)throw Error(i(160));Zn(G,de,D),Ia=null,Cr=!1}else Zn(G,de,D);G=D.alternate,G!==null&&(G.return=null),D.return=null}if(d.subtreeFlags&13878)for(d=d.child;d!==null;)xc(d,f),d=d.sibling}function xc(f,d){var _=f.alternate,E=f.flags;switch(f.tag){case 0:case 11:case 14:case 15:cs(d,f),yr(f),E&4&&(Ee(3,f,f.return),_e(3,f),Ee(5,f,f.return));break;case 1:cs(d,f),yr(f),E&512&&(ba||_===null||wt(_,_.return)),E&64&&es&&(f=f.updateQueue,f!==null&&(E=f.callbacks,E!==null&&(_=f.shared.hiddenCallbacks,f.shared.hiddenCallbacks=_===null?E:_.concat(E))));break;case 26:if(qr){var D=nr;cs(d,f),yr(f),E&512&&(ba||_===null||wt(_,_.return)),E&4&&(E=_!==null?_.memoizedState:null,d=f.memoizedState,_===null?d===null?f.stateNode===null?f.stateNode=W0(D,f.type,f.memoizedProps,f):q0(D,f.type,f.stateNode):f.stateNode=X0(D,d,f.memoizedProps):E!==d?(E===null?_.stateNode!==null&&J0(_.stateNode):Y0(E),d===null?q0(D,f.type,f.stateNode):X0(D,d,f.memoizedProps)):d===null&&f.stateNode!==null&&Ht(f,f.memoizedProps,_.memoizedProps));break}case 27:if(ws&&E&4&&f.alternate===null){D=f.stateNode;var G=f.memoizedProps;try{Zy(D),Ky(f.type,G,D,f)}catch(Jt){pi(f,f.return,Jt)}}case 5:if(cs(d,f),yr(f),E&512&&(ba||_===null||wt(_,_.return)),Ms){if(f.flags&32){d=f.stateNode;try{ah(d)}catch(Jt){pi(f,f.return,Jt)}}E&4&&f.stateNode!=null&&(d=f.memoizedProps,Ht(f,d,_!==null?_.memoizedProps:d)),E&1024&&(zc=!0)}break;case 6:if(cs(d,f),yr(f),E&4&&Ms){if(f.stateNode===null)throw Error(i(162));E=f.memoizedProps,_=_!==null?_.memoizedProps:E,d=f.stateNode;try{Vx(d,_,E)}catch(Jt){pi(f,f.return,Jt)}}break;case 3:if(qr?(Z0(),D=nr,nr=Od(d.containerInfo),cs(d,f),nr=D):cs(d,f),yr(f),E&4){if(Ms&&er&&_!==null&&_.memoizedState.isDehydrated)try{Ud(d.containerInfo)}catch(Jt){pi(f,f.return,Jt)}if(Yr){E=d.containerInfo,_=d.pendingChildren;try{P0(E,_)}catch(Jt){pi(f,f.return,Jt)}}}zc&&(zc=!1,f0(f));break;case 4:qr?(_=nr,nr=Od(f.stateNode.containerInfo),cs(d,f),yr(f),nr=_):(cs(d,f),yr(f)),E&4&&Yr&&Gt(f.stateNode,f,f.stateNode.pendingChildren);break;case 12:cs(d,f),yr(f);break;case 13:cs(d,f),yr(f),f.child.flags&8192&&f.memoizedState!==null!=(_!==null&&_.memoizedState!==null)&&(pl=Es()),E&4&&(E=f.updateQueue,E!==null&&(f.updateQueue=null,Vr(f,E)));break;case 22:E&512&&(ba||_===null||wt(_,_.return)),D=f.memoizedState!==null;var de=_!==null&&_.memoizedState!==null,Ce=es,Xe=ba;if(es=Ce||D,ba=Xe||de,cs(d,f),ba=Xe,es=Ce,yr(f),d=f.stateNode,d._current=f,d._visibility&=-3,d._visibility|=d._pendingVisibility&2,E&8192&&(d._visibility=D?d._visibility&-2:d._visibility|1,D&&(d=es||ba,_===null||de||d||ju(f)),Ms&&(f.memoizedProps===null||f.memoizedProps.mode!=="manual"))){e:if(_=null,Ms)for(d=f;;){if(d.tag===5||qr&&d.tag===26||ws&&d.tag===27){if(_===null){de=_=d;try{G=de.stateNode,D?sh(G):I0(de.stateNode,de.memoizedProps)}catch(Jt){pi(de,de.return,Jt)}}}else if(d.tag===6){if(_===null){de=d;try{var Ct=de.stateNode;D?Td(Ct):Xl(Ct,de.memoizedProps)}catch(Jt){pi(de,de.return,Jt)}}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===f)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===f)break e;for(;d.sibling===null;){if(d.return===null||d.return===f)break e;_===d&&(_=null),d=d.return}_===d&&(_=null),d.sibling.return=d.return,d=d.sibling}}E&4&&(E=f.updateQueue,E!==null&&(_=E.retryQueue,_!==null&&(E.retryQueue=null,Vr(f,_))));break;case 19:cs(d,f),yr(f),E&4&&(E=f.updateQueue,E!==null&&(f.updateQueue=null,Vr(f,E)));break;case 21:break;default:cs(d,f),yr(f)}}function yr(f){var d=f.flags;if(d&2){try{if(Ms&&(!ws||f.tag!==27)){e:{for(var _=f.return;_!==null;){if(Et(_)){var E=_;break e}_=_.return}throw Error(i(160))}switch(E.tag){case 27:if(ws){var D=E.stateNode,G=dn(f);Zt(f,G,D);break}case 5:var de=E.stateNode;E.flags&32&&(ah(de),E.flags&=-33);var Ce=dn(f);Zt(f,Ce,de);break;case 3:case 4:var Xe=E.stateNode.containerInfo,Ct=dn(f);Xt(f,Ct,Xe);break;default:throw Error(i(161))}}}catch(Jt){pi(f,f.return,Jt)}f.flags&=-3}d&4096&&(f.flags&=-4097)}function f0(f){if(f.subtreeFlags&1024)for(f=f.child;f!==null;){var d=f;f0(d),d.tag===5&&d.flags&1024&&Zi(d.stateNode),f=f.sibling}}function el(f,d){if(d.subtreeFlags&8772)for(d=d.child;d!==null;)nn(f,d.alternate,d),d=d.sibling}function ju(f){for(f=f.child;f!==null;){var d=f;switch(d.tag){case 0:case 11:case 14:case 15:Ee(4,d,d.return),ju(d);break;case 1:wt(d,d.return);var _=d.stateNode;typeof _.componentWillUnmount=="function"&&St(d,d.return,_),ju(d);break;case 26:case 27:case 5:wt(d,d.return),ju(d);break;case 22:wt(d,d.return),d.memoizedState===null&&ju(d);break;default:ju(d)}f=f.sibling}}function gc(f,d,_){for(_=_&&(d.subtreeFlags&8772)!==0,d=d.child;d!==null;){var E=d.alternate,D=f,G=d,de=G.flags;switch(G.tag){case 0:case 11:case 15:gc(D,G,_),_e(4,G);break;case 1:if(gc(D,G,_),E=G,D=E.stateNode,typeof D.componentDidMount=="function")try{D.componentDidMount()}catch(Ct){pi(E,E.return,Ct)}if(E=G,D=E.updateQueue,D!==null){var Ce=E.stateNode;try{var Xe=D.shared.hiddenCallbacks;if(Xe!==null)for(D.shared.hiddenCallbacks=null,D=0;D<Xe.length;D++)ye(Xe[D],Ce)}catch(Ct){pi(E,E.return,Ct)}}_&&de&64&&tt(G),Ut(G,G.return);break;case 26:case 27:case 5:gc(D,G,_),_&&E===null&&de&4&&fn(G),Ut(G,G.return);break;case 12:gc(D,G,_);break;case 13:gc(D,G,_),_&&de&4&&ya(D,G);break;case 22:G.memoizedState===null&&gc(D,G,_),Ut(G,G.return);break;default:gc(D,G,_)}d=d.sibling}}function h0(f,d){var _=null;f!==null&&f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(_=f.memoizedState.cachePool.pool),f=null,d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(f=d.memoizedState.cachePool.pool),f!==_&&(f!=null&&f.refCount++,_!=null&&Uo(_))}function hd(f,d){f=null,d.alternate!==null&&(f=d.alternate.memoizedState.cache),d=d.memoizedState.cache,d!==f&&(d.refCount++,f!=null&&Uo(f))}function Ol(f,d,_,E){if(d.subtreeFlags&10256)for(d=d.child;d!==null;)dd(f,d,_,E),d=d.sibling}function dd(f,d,_,E){var D=d.flags;switch(d.tag){case 0:case 11:case 15:Ol(f,d,_,E),D&2048&&_e(9,d);break;case 3:Ol(f,d,_,E),D&2048&&(f=null,d.alternate!==null&&(f=d.alternate.memoizedState.cache),d=d.memoizedState.cache,d!==f&&(d.refCount++,f!=null&&Uo(f)));break;case 12:if(D&2048){Ol(f,d,_,E),f=d.stateNode;try{var G=d.memoizedProps,de=G.id,Ce=G.onPostCommit;typeof Ce=="function"&&Ce(de,d.alternate===null?"mount":"update",f.passiveEffectDuration,-0)}catch(Xe){pi(d,d.return,Xe)}}else Ol(f,d,_,E);break;case 23:break;case 22:G=d.stateNode,d.memoizedState!==null?G._visibility&4?Ol(f,d,_,E):vc(f,d):G._visibility&4?Ol(f,d,_,E):(G._visibility|=4,Us(f,d,_,E,(d.subtreeFlags&10256)!==0)),D&2048&&h0(d.alternate,d);break;case 24:Ol(f,d,_,E),D&2048&&hd(d.alternate,d);break;default:Ol(f,d,_,E)}}function Us(f,d,_,E,D){for(D=D&&(d.subtreeFlags&10256)!==0,d=d.child;d!==null;){var G=f,de=d,Ce=_,Xe=E,Ct=de.flags;switch(de.tag){case 0:case 11:case 15:Us(G,de,Ce,Xe,D),_e(8,de);break;case 23:break;case 22:var Jt=de.stateNode;de.memoizedState!==null?Jt._visibility&4?Us(G,de,Ce,Xe,D):vc(G,de):(Jt._visibility|=4,Us(G,de,Ce,Xe,D)),D&&Ct&2048&&h0(de.alternate,de);break;case 24:Us(G,de,Ce,Xe,D),D&&Ct&2048&&hd(de.alternate,de);break;default:Us(G,de,Ce,Xe,D)}d=d.sibling}}function vc(f,d){if(d.subtreeFlags&10256)for(d=d.child;d!==null;){var _=f,E=d,D=E.flags;switch(E.tag){case 22:vc(_,E),D&2048&&h0(E.alternate,E);break;case 24:vc(_,E),D&2048&&hd(E.alternate,E);break;default:vc(_,E)}d=d.sibling}}function us(f){if(f.subtreeFlags&Su)for(f=f.child;f!==null;)ou(f),f=f.sibling}function ou(f){switch(f.tag){case 26:us(f),f.flags&Su&&(f.memoizedState!==null?Q0(nr,f.memoizedState,f.memoizedProps):Aa(f.type,f.memoizedProps));break;case 5:us(f),f.flags&Su&&Aa(f.type,f.memoizedProps);break;case 3:case 4:if(qr){var d=nr;nr=Od(f.stateNode.containerInfo),us(f),nr=d}else us(f);break;case 22:f.memoizedState===null&&(d=f.alternate,d!==null&&d.memoizedState!==null?(d=Su,Su=16777216,us(f),Su=d):us(f));break;default:us(f)}}function pd(f){var d=f.alternate;if(d!==null&&(f=d.child,f!==null)){d.child=null;do d=f.sibling,f.sibling=null,f=d;while(f!==null)}}function yc(f){var d=f.deletions;if((f.flags&16)!==0){if(d!==null)for(var _=0;_<d.length;_++){var E=d[_];Ta=E,bc(E,f)}pd(f)}if(f.subtreeFlags&10256)for(f=f.child;f!==null;)Yf(f),f=f.sibling}function Yf(f){switch(f.tag){case 0:case 11:case 15:yc(f),f.flags&2048&&Ee(9,f,f.return);break;case 3:yc(f);break;case 12:yc(f);break;case 22:var d=f.stateNode;f.memoizedState!==null&&d._visibility&4&&(f.return===null||f.return.tag!==13)?(d._visibility&=-5,Hu(f)):yc(f);break;default:yc(f)}}function Hu(f){var d=f.deletions;if((f.flags&16)!==0){if(d!==null)for(var _=0;_<d.length;_++){var E=d[_];Ta=E,bc(E,f)}pd(f)}for(f=f.child;f!==null;){switch(d=f,d.tag){case 0:case 11:case 15:Ee(8,d,d.return),Hu(d);break;case 22:_=d.stateNode,_._visibility&4&&(_._visibility&=-5,Hu(d));break;default:Hu(d)}f=f.sibling}}function bc(f,d){for(;Ta!==null;){var _=Ta;switch(_.tag){case 0:case 11:case 15:Ee(8,_,d);break;case 23:case 22:if(_.memoizedState!==null&&_.memoizedState.cachePool!==null){var E=_.memoizedState.cachePool.pool;E!=null&&E.refCount++}break;case 24:Uo(_.memoizedState.cache)}if(E=_.child,E!==null)E.return=_,Ta=E;else e:for(_=f;Ta!==null;){E=Ta;var D=E.sibling,G=E.return;if(kt(E),E===_){Ta=null;break e}if(D!==null){D.return=G,Ta=D;break e}Ta=G}}}function md(f){var d=T0(f);if(d!=null){if(typeof d.memoizedProps["data-testname"]!="string")throw Error(i(364));return d}if(f=xu(f),f===null)throw Error(i(362));return f.stateNode.current}function ku(f,d){var _=f.tag;switch(d.$$typeof){case bh:if(f.type===d.value)return!0;break;case Yd:e:{for(d=d.value,f=[f,0],_=0;_<f.length;){var E=f[_++],D=E.tag,G=f[_++],de=d[G];if(D!==5&&D!==26&&D!==27||!cl(E)){for(;de!=null&&ku(E,de);)G++,de=d[G];if(G===d.length){d=!0;break e}else for(E=E.child;E!==null;)f.push(E,G),E=E.sibling}}d=!1}return d;case Wd:if((_===5||_===26||_===27)&&Xy(f.stateNode,d.value))return!0;break;case Pi:if((_===5||_===6||_===26||_===27)&&(f=ih(f),f!==null&&0<=f.indexOf(d.value)))return!0;break;case _i:if((_===5||_===26||_===27)&&(f=f.memoizedProps["data-testname"],typeof f=="string"&&f.toLowerCase()===d.value.toLowerCase()))return!0;break;default:throw Error(i(365))}return!1}function _c(f){switch(f.$$typeof){case bh:return"<"+(o(f.value)||"Unknown")+">";case Yd:return":has("+(_c(f)||"")+")";case Wd:return'[role="'+f.value+'"]';case Pi:return'"'+f.value+'"';case _i:return'[data-testname="'+f.value+'"]';default:throw Error(i(365))}}function Lx(f,d){var _=[];f=[f,0];for(var E=0;E<f.length;){var D=f[E++],G=D.tag,de=f[E++],Ce=d[de];if(G!==5&&G!==26&&G!==27||!cl(D)){for(;Ce!=null&&ku(D,Ce);)de++,Ce=d[de];if(de===d.length)_.push(D);else for(D=D.child;D!==null;)f.push(D,de),D=D.sibling}}return _}function Qs(f,d){if(!ll)throw Error(i(363));f=md(f),f=Lx(f,d),d=[],f=Array.from(f);for(var _=0;_<f.length;){var E=f[_++],D=E.tag;if(D===5||D===26||D===27)cl(E)||d.push(E.stateNode);else for(E=E.child;E!==null;)f.push(E),E=E.sibling}return d}function $s(){if((Tn&2)!==0&&si!==0)return si&-si;if(Dn.T!==null){var f=wr;return f!==0?f:Ue()}return vo()}function tl(){Tr===0&&(Tr=(si&536870912)===0||wi?P():536870912);var f=to.current;return f!==null&&(f.flags|=32),Tr}function Ls(f,d,_){(f===ci&&Ki===2||f.cancelPendingCommit!==null)&&(Oo(f,0),Lo(f,si,Tr,!1)),ee(f,_),((Tn&2)===0||f!==ci)&&(f===ci&&((Tn&2)===0&&(Ho|=_),Si===4&&Lo(f,si,Tr,!1)),et(f))}function Wf(f,d,_){if((Tn&6)!==0)throw Error(i(327));var E=!_&&(d&60)===0&&(d&f.expiredLanes)===0||U(f,d),D=E?al(f,d):nl(f,d,!0),G=E;do{if(D===0){no&&!E&&Lo(f,d,0,!1);break}else if(D===6)Lo(f,d,0,!Gi);else{if(_=f.current.alternate,G&&!Ox(_)){D=nl(f,d,!1),G=!1;continue}if(D===2){if(G=d,f.errorRecoveryDisabledLanes&G)var de=0;else de=f.pendingLanes&-536870913,de=de!==0?de:de&536870912?536870912:0;if(de!==0){d=de;e:{var Ce=f;D=of;var Xe=er&&Ce.current.memoizedState.isDehydrated;if(Xe&&(Oo(Ce,de).flags|=256),de=nl(Ce,de,!1),de!==2){if(Kl&&!Xe){Ce.errorRecoveryDisabledLanes|=G,Ho|=G,D=4;break e}G=ao,ao=D,G!==null&&Il(G)}D=de}if(G=!1,D!==2)continue}}if(D===1){Oo(f,0),Lo(f,d,0,!0);break}e:{switch(E=f,D){case 0:case 1:throw Error(i(345));case 4:if((d&4194176)===d){Lo(E,d,Tr,!Gi);break e}break;case 2:ao=null;break;case 3:case 5:break;default:throw Error(i(329))}if(E.finishedWork=_,E.finishedLanes=d,(d&62914560)===d&&(G=pl+300-Es(),10<G)){if(Lo(E,d,Tr,!Gi),F(E,0)!==0)break e;E.timeoutHandle=C0(xd.bind(null,E,_,ao,ko,lf,d,Tr,Ho,Ql,Gi,2,-0,0),G);break e}xd(E,_,ao,ko,lf,d,Tr,Ho,Ql,Gi,0,-0,0)}}break}while(!0);et(f)}function Il(f){ao===null?ao=f:ao.push.apply(ao,f)}function xd(f,d,_,E,D,G,de,Ce,Xe,Ct,Jt,cn,pn){var Vn=d.subtreeFlags;if((Vn&8192||(Vn&16785408)===16785408)&&(Wr(),ou(d),d=wd(),d!==null)){f.cancelPendingCommit=d(ia.bind(null,f,_,E,D,de,Ce,Xe,1,cn,pn)),Lo(f,G,de,!Ct);return}ia(f,_,E,D,de,Ce,Xe,Jt,cn,pn)}function Ox(f){for(var d=f;;){var _=d.tag;if((_===0||_===11||_===15)&&d.flags&16384&&(_=d.updateQueue,_!==null&&(_=_.stores,_!==null)))for(var E=0;E<_.length;E++){var D=_[E],G=D.getSnapshot;D=D.value;try{if(!Jr(G(),D))return!1}catch{return!1}}if(_=d.child,d.subtreeFlags&16384&&_!==null)_.return=d,d=_;else{if(d===f)break;for(;d.sibling===null;){if(d.return===null||d.return===f)return!0;d=d.return}d.sibling.return=d.return,d=d.sibling}}return!0}function Lo(f,d,_,E){d&=~Gs,d&=~Ho,f.suspendedLanes|=d,f.pingedLanes&=~d,E&&(f.warmLanes|=d),E=f.expirationTimes;for(var D=d;0<D;){var G=31-Ar(D),de=1<<G;E[G]=-1,D&=~de}_!==0&&te(f,_,d)}function d0(){return(Tn&6)===0?(Ne(0),!1):!0}function br(){if(Jn!==null){if(Ki===0)var f=Jn.return;else f=Jn,Ca=Ic=null,Dt(f),fl=null,_o=0,f=Jn;for(;f!==null;)Se(f.alternate,f),f=f.return;Jn=null}}function Oo(f,d){f.finishedWork=null,f.finishedLanes=0;var _=f.timeoutHandle;_!==mu&&(f.timeoutHandle=mu,nh(_)),_=f.cancelPendingCommit,_!==null&&(f.cancelPendingCommit=null,_()),br(),ci=f,Jn=_=Os(f.current,null),si=d,Ki=0,za=null,Gi=!1,no=U(f,d),Kl=!1,Ql=Tr=Gs=Ho=io=Si=0,ao=of=null,lf=!1,(d&8)!==0&&(d|=d&32);var E=f.entangledLanes;if(E!==0)for(f=f.entanglements,E&=d;0<E;){var D=31-Ar(E),G=1<<D;d|=f[D],E&=~G}return jo=d,De(),_}function lu(f,d){$n=null,Dn.H=Ei,d===Xi?(d=Lt(),Ki=3):d===nm?(d=Lt(),Ki=4):Ki=d===pg?8:d!==null&&typeof d=="object"&&typeof d.then=="function"?6:1,za=d,Jn===null&&(Si=1,xr(f,ie(d,f.current)))}function qf(){var f=to.current;return f===null?!0:(si&4194176)===si?So===null:(si&62914560)===si||(si&536870912)!==0?f===So:!1}function Vu(){var f=Dn.H;return Dn.H=Ei,f===null?Ei:f}function Xr(){var f=Dn.A;return Dn.A=Xd,f}function _r(){Si=4,Gi||(si&4194176)!==si&&to.current!==null||(no=!0),(io&134217727)===0&&(Ho&134217727)===0||ci===null||Lo(ci,si,Tr,!1)}function nl(f,d,_){var E=Tn;Tn|=2;var D=Vu(),G=Xr();(ci!==f||si!==d)&&(ko=null,Oo(f,d)),d=!1;var de=Si;e:do try{if(Ki!==0&&Jn!==null){var Ce=Jn,Xe=za;switch(Ki){case 8:br(),de=6;break e;case 3:case 2:case 6:to.current===null&&(d=!0);var Ct=Ki;if(Ki=0,za=null,Sc(f,Ce,Xe,Ct),_&&no){de=0;break e}break;default:Ct=Ki,Ki=0,za=null,Sc(f,Ce,Xe,Ct)}}il(),de=Si;break}catch(Jt){lu(f,Jt)}while(!0);return d&&f.shellSuspendCounter++,Ca=Ic=null,Tn=E,Dn.H=D,Dn.A=G,Jn===null&&(ci=null,si=0,De()),de}function il(){for(;Jn!==null;)p0(Jn)}function al(f,d){var _=Tn;Tn|=2;var E=Vu(),D=Xr();ci!==f||si!==d?(ko=null,_a=Es()+500,Oo(f,d)):no=U(f,d);e:do try{if(Ki!==0&&Jn!==null){d=Jn;var G=za;t:switch(Ki){case 1:Ki=0,za=null,Sc(f,d,G,1);break;case 2:if(Rt(G)){Ki=0,za=null,gd(d);break}d=function(){Ki===2&&ci===f&&(Ki=7),et(f)},G.then(d,d);break e;case 3:Ki=7;break e;case 4:Ki=5;break e;case 7:Rt(G)?(Ki=0,za=null,gd(d)):(Ki=0,za=null,Sc(f,d,G,7));break;case 5:var de=null;switch(Jn.tag){case 26:de=Jn.memoizedState;case 5:case 27:var Ce=Jn,Xe=Ce.type,Ct=Ce.pendingProps;if(de?K0(de):Vl(Xe,Ct)){Ki=0,za=null;var Jt=Ce.sibling;if(Jt!==null)Jn=Jt;else{var cn=Ce.return;cn!==null?(Jn=cn,Jf(cn)):Jn=null}break t}}Ki=0,za=null,Sc(f,d,G,5);break;case 6:Ki=0,za=null,Sc(f,d,G,6);break;case 8:br(),Si=6;break e;default:throw Error(i(462))}}zl();break}catch(pn){lu(f,pn)}while(!0);return Ca=Ic=null,Dn.H=E,Dn.A=D,Tn=_,Jn!==null?0:(ci=null,si=0,De(),Si)}function zl(){for(;Jn!==null&&!cg();)p0(Jn)}function p0(f){var d=dc(f.alternate,f,jo);f.memoizedProps=f.pendingProps,d===null?Jf(f):Jn=d}function gd(f){var d=f,_=d.alternate;switch(d.tag){case 15:case 0:d=Zo(_,d,d.pendingProps,d.type,void 0,si);break;case 11:d=Zo(_,d,d.pendingProps,d.type.render,d.ref,si);break;case 5:Dt(d);default:Se(_,d),d=Jn=Gl(d,jo),d=dc(_,d,jo)}f.memoizedProps=f.pendingProps,d===null?Jf(f):Jn=d}function Sc(f,d,_,E){Ca=Ic=null,Dt(d),fl=null,_o=0;var D=d.return;try{if(hc(f,D,d,_,si)){Si=1,xr(f,ie(_,f.current)),Jn=null;return}}catch(G){if(D!==null)throw Jn=D,G;Si=1,xr(f,ie(_,f.current)),Jn=null;return}d.flags&32768?(wi||E===1?f=!0:no||(si&536870912)!==0?f=!1:(Gi=f=!0,(E===2||E===3||E===6)&&(E=to.current,E!==null&&E.tag===13&&(E.flags|=16384))),fs(d,f)):Jf(d)}function Jf(f){var d=f;do{if((d.flags&32768)!==0){fs(d,Gi);return}f=d.return;var _=fd(d.alternate,d,jo);if(_!==null){Jn=_;return}if(d=d.sibling,d!==null){Jn=d;return}Jn=d=f}while(d!==null);Si===0&&(Si=5)}function fs(f,d){do{var _=ce(f.alternate,f);if(_!==null){_.flags&=32767,Jn=_;return}if(_=f.return,_!==null&&(_.flags|=32768,_.subtreeFlags=0,_.deletions=null),!d&&(f=f.sibling,f!==null)){Jn=f;return}Jn=f=_}while(f!==null);Si=6,Jn=null}function ia(f,d,_,E,D,G,de,Ce,Xe,Ct){var Jt=Dn.T,cn=$a();try{Is(2),Dn.T=null,gi(f,d,_,E,cn,D,G,de,Ce,Xe,Ct)}finally{Dn.T=Jt,Is(cn)}}function gi(f,d,_,E,D,G,de,Ce){do hs();while($l!==null);if((Tn&6)!==0)throw Error(i(327));var Xe=f.finishedWork;if(E=f.finishedLanes,Xe===null)return null;if(f.finishedWork=null,f.finishedLanes=0,Xe===f.current)throw Error(i(177));f.callbackNode=null,f.callbackPriority=0,f.cancelPendingCommit=null;var Ct=Xe.lanes|Xe.childLanes;if(Ct|=tf,Q(f,E,Ct,G,de,Ce),f===ci&&(Jn=ci=null,si=0),(Xe.subtreeFlags&10256)===0&&(Xe.flags&10256)===0||Mo||(Mo=!0,qd=Ct,Mu=_,Zf(zd,function(){return hs(),null})),_=(Xe.flags&15990)!==0,(Xe.subtreeFlags&15990)!==0||_?(_=Dn.T,Dn.T=null,G=$a(),Is(2),de=Tn,Tn|=4,_n(f,Xe),xc(Xe,f),w0(f.containerInfo),f.current=Xe,nn(f,Xe.alternate,Xe),ug(),Tn=de,Is(G),Dn.T=_):f.current=Xe,Mo?(Mo=!1,$l=f,Au=E):Fl(f,Ct),Ct=f.pendingLanes,Ct===0&&(so=null),j(Xe.stateNode),et(f),d!==null)for(D=f.onRecoverableError,Xe=0;Xe<d.length;Xe++)Ct=d[Xe],D(Ct.value,{componentStack:Ct.stack});return(Au&3)!==0&&hs(),Ct=f.pendingLanes,(E&4194218)!==0&&(Ct&42)!==0?f===ir?wu++:(wu=0,ir=f):wu=0,Ne(0),null}function Fl(f,d){(f.pooledCacheLanes&=d)===0&&(d=f.pooledCache,d!=null&&(f.pooledCache=null,Uo(d)))}function hs(){if($l!==null){var f=$l,d=qd;qd=0;var _=re(Au),E=32>_?32:_;_=Dn.T;var D=$a();try{if(Is(E),Dn.T=null,$l===null)var G=!1;else{E=Mu,Mu=null;var de=$l,Ce=Au;if($l=null,Au=0,(Tn&6)!==0)throw Error(i(331));var Xe=Tn;if(Tn|=4,Yf(de.current),dd(de,de.current,Ce,E),Tn=Xe,Ne(0,!1),Mr&&typeof Mr.onPostCommitFiberRoot=="function")try{Mr.onPostCommitFiberRoot($u,de)}catch{}G=!0}return G}finally{Is(D),Dn.T=_,Fl(f,d)}}return!1}function vd(f,d,_){d=ie(_,d),d=Zs(f.stateNode,d,2),f=We(f,d,2),f!==null&&(ee(f,2),et(f))}function pi(f,d,_){if(f.tag===3)vd(f,f,_);else for(;d!==null;){if(d.tag===3){vd(d,f,_);break}else if(d.tag===1){var E=d.stateNode;if(typeof d.type.getDerivedStateFromError=="function"||typeof E.componentDidCatch=="function"&&(so===null||!so.has(E))){f=ie(_,f),_=gr(2),E=We(d,_,2),E!==null&&(xa(_,E,d,f),ee(E,2),et(E));break}}d=d.return}}function yd(f,d,_){var E=f.pingCache;if(E===null){E=f.pingCache=new mi;var D=new Set;E.set(d,D)}else D=E.get(d),D===void 0&&(D=new Set,E.set(d,D));D.has(_)||(Kl=!0,D.add(_),f=Ix.bind(null,f,d,_),d.then(f,f))}function Ix(f,d,_){var E=f.pingCache;E!==null&&E.delete(d),f.pingedLanes|=f.suspendedLanes&_,f.warmLanes&=~_,ci===f&&(si&_)===_&&(Si===4||Si===3&&(si&62914560)===si&&300>Es()-pl?(Tn&2)===0&&Oo(f,0):Gs|=_,Ql===si&&(Ql=0)),et(f)}function cu(f,d){d===0&&(d=L()),f=Ze(f,d),f!==null&&(ee(f,d),et(f))}function uu(f){var d=f.memoizedState,_=0;d!==null&&(_=d.retryLane),cu(f,_)}function m0(f,d){var _=0;switch(f.tag){case 13:var E=f.stateNode,D=f.memoizedState;D!==null&&(_=D.retryLane);break;case 19:E=f.stateNode;break;case 22:E=f.stateNode._retryCache;break;default:throw Error(i(314))}E!==null&&E.delete(d),cu(f,_)}function Zf(f,d){return Qu(f,d)}function x0(f,d,_,E){this.tag=f,this.key=_,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=d,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=E,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pl(f){return f=f.prototype,!(!f||!f.isReactComponent)}function Os(f,d){var _=f.alternate;return _===null?(_=t(f.tag,d,f.key,f.mode),_.elementType=f.elementType,_.type=f.type,_.stateNode=f.stateNode,_.alternate=f,f.alternate=_):(_.pendingProps=d,_.type=f.type,_.flags=0,_.subtreeFlags=0,_.deletions=null),_.flags=f.flags&31457280,_.childLanes=f.childLanes,_.lanes=f.lanes,_.child=f.child,_.memoizedProps=f.memoizedProps,_.memoizedState=f.memoizedState,_.updateQueue=f.updateQueue,d=f.dependencies,_.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext},_.sibling=f.sibling,_.index=f.index,_.ref=f.ref,_.refCleanup=f.refCleanup,_}function Gl(f,d){f.flags&=31457282;var _=f.alternate;return _===null?(f.childLanes=0,f.lanes=d,f.child=null,f.subtreeFlags=0,f.memoizedProps=null,f.memoizedState=null,f.updateQueue=null,f.dependencies=null,f.stateNode=null):(f.childLanes=_.childLanes,f.lanes=_.lanes,f.child=_.child,f.subtreeFlags=0,f.deletions=null,f.memoizedProps=_.memoizedProps,f.memoizedState=_.memoizedState,f.updateQueue=_.updateQueue,f.type=_.type,d=_.dependencies,f.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext}),f}function go(f,d,_,E,D,G){var de=0;if(E=f,typeof f=="function")Pl(f)&&(de=1);else if(typeof f=="string")de=qr&&ws?V0(f,_,ps.current)?26:Zu(f)?27:5:qr?V0(f,_,ps.current)?26:5:ws&&Zu(f)?27:5;else e:switch(f){case Yu:return jl(_.children,D,G,d);case _0:de=8,D|=24;break;case S0:return f=t(12,_,d,D|2),f.elementType=S0,f.lanes=G,f;case _d:return f=t(13,_,d,D),f.elementType=_d,f.lanes=G,f;case wc:return f=t(19,_,d,D),f.elementType=wc,f.lanes=G,f;case $f:return bd(_,D,G,d);default:if(typeof f=="object"&&f!==null)switch(f.$$typeof){case Px:case sl:de=10;break e;case Mc:de=9;break e;case Wu:de=11;break e;case Qf:de=14;break e;case zo:de=16,E=null;break e}de=29,_=Error(i(130,f===null?"null":typeof f,"")),E=null}return d=t(de,_,d,D),d.elementType=f,d.type=E,d.lanes=G,d}function jl(f,d,_,E){return f=t(7,f,E,d),f.lanes=_,f}function bd(f,d,_,E){f=t(22,f,E,d),f.elementType=$f,f.lanes=_;var D={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var G=D._current;if(G===null)throw Error(i(456));if((D._pendingVisibility&2)===0){var de=Ze(G,2);de!==null&&(D._pendingVisibility|=2,Ls(de,G,2))}},attach:function(){var G=D._current;if(G===null)throw Error(i(456));if((D._pendingVisibility&2)!==0){var de=Ze(G,2);de!==null&&(D._pendingVisibility&=-3,Ls(de,G,2))}}};return f.stateNode=D,f}function Ac(f,d,_){return f=t(6,f,null,d),f.lanes=_,f}function Xu(f,d,_){return d=t(4,f.children!==null?f.children:[],f.key,d),d.lanes=_,d.stateNode={containerInfo:f.containerInfo,pendingChildren:null,implementation:f.implementation},d}function fu(f,d,_,E,D,G,de,Ce){this.tag=1,this.containerInfo=f,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=mu,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=O(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=O(0),this.hiddenUpdates=O(null),this.identifierPrefix=E,this.onUncaughtError=D,this.onCaughtError=G,this.onRecoverableError=de,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Ce,this.incompleteTransitions=new Map}function ds(f,d,_,E,D,G,de,Ce,Xe,Ct,Jt,cn){return f=new fu(f,d,_,de,Ce,Xe,Ct,cn),d=1,G===!0&&(d|=24),G=t(3,null,null,d),f.current=G,G.stateNode=f,d=Ul(),d.refCount++,f.pooledCache=d,d.refCount++,G.memoizedState={element:E,isDehydrated:_,cache:d},It(G),f}function Kf(f){return f?(f=gu,f):gu}function g0(f){var d=f._reactInternals;if(d===void 0)throw typeof f.render=="function"?Error(i(188)):(f=Object.keys(f).join(","),Error(i(268,f)));return f=b(d),f=f!==null?S(f):null,f===null?null:qu(f.stateNode)}function zx(f,d,_,E,D,G){D=Kf(D),E.context===null?E.context=D:E.pendingContext=D,E=qe(d),E.payload={element:_},G=G===void 0?null:G,G!==null&&(E.callback=G),_=We(f,E,d),_!==null&&(Ls(_,f,d),ft(_,f,d))}function Fx(f,d){if(f=f.memoizedState,f!==null&&f.dehydrated!==null){var _=f.retryLane;f.retryLane=_!==0&&_<d?_:d}}function v0(f,d){Fx(f,d),(f=f.alternate)&&Fx(f,d)}var Cn={},y0=t0(),As=mT(),hu=Object.assign,b0=Symbol.for("react.element"),Hl=Symbol.for("react.transitional.element"),Io=Symbol.for("react.portal"),Yu=Symbol.for("react.fragment"),_0=Symbol.for("react.strict_mode"),S0=Symbol.for("react.profiler"),Px=Symbol.for("react.provider"),Mc=Symbol.for("react.consumer"),sl=Symbol.for("react.context"),Wu=Symbol.for("react.forward_ref"),_d=Symbol.for("react.suspense"),wc=Symbol.for("react.suspense_list"),Qf=Symbol.for("react.memo"),zo=Symbol.for("react.lazy"),$f=Symbol.for("react.offscreen"),Gx=Symbol.for("react.memo_cache_sentinel"),A0=Symbol.iterator,du=Symbol.for("react.client.reference"),Dn=y0.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Sd,M0,Ec=!1,Cc=Array.isArray,Ad=e.rendererVersion,eh=e.rendererPackageName,th=e.extraDevToolsConfig,qu=e.getPublicInstance,pu=e.getRootHostContext,jx=e.getChildHostContext,Tc=e.prepareForCommit,w0=e.resetAfterCommit,E0=e.createInstance,rl=e.appendInitialChild,kl=e.finalizeInitialChildren,Rc=e.shouldSetTextContent,Md=e.createTextInstance,C0=e.scheduleTimeout,nh=e.cancelTimeout,mu=e.noTimeout,ol=e.isPrimaryRenderer;e.warnsIfNotActing;var Ms=e.supportsMutation,Yr=e.supportsPersistence,er=e.supportsHydration,T0=e.getInstanceFromNode;e.beforeActiveInstanceBlur,e.afterActiveInstanceBlur;var R0=e.preparePortalMount;e.prepareScopeUpdate,e.getInstanceFromScope;var Is=e.setCurrentUpdatePriority,$a=e.getCurrentUpdatePriority,vo=e.resolveUpdatePriority;e.resolveEventType,e.resolveEventTimeStamp;var Nc=e.shouldAttemptEagerTransition,N0=e.detachDeletedInstance;e.requestPostPaintCallback;var Hx=e.maySuspendCommit,Vl=e.preloadInstance,Wr=e.startSuspendingCommit,Aa=e.suspendInstance,wd=e.waitForCommitToBeReady,Sr=e.NotPendingTransition,In=e.HostTransitionContext,Zi=e.resetFormInstance;e.bindToConsole;var Ya=e.supportsMicrotasks,Ed=e.scheduleMicrotask,ll=e.supportsTestSelectors,xu=e.findFiberRoot,Cd=e.getBoundingRect,ih=e.getTextContent,cl=e.isHiddenSubtree,Xy=e.matchAccessibilityRole,Ma=e.setFocusIfFocusable,B0=e.setupIntersectionObserver,D0=e.appendChild,kx=e.appendChildToContainer,Vx=e.commitTextUpdate,Yy=e.commitMount,U0=e.commitUpdate,L0=e.insertBefore,O0=e.insertInContainerBefore,tr=e.removeChild,Ua=e.removeChildFromContainer,ah=e.resetTextContent,sh=e.hideInstance,Td=e.hideTextInstance,I0=e.unhideInstance,Xl=e.unhideTextInstance,Rd=e.clearContainer,z0=e.cloneInstance,Nd=e.createContainerChildSet,F0=e.appendChildToContainerChildSet,Xx=e.finalizeContainerChildren,P0=e.replaceContainerChildren,G0=e.cloneHiddenInstance,j0=e.cloneHiddenTextInstance,Bd=e.isSuspenseInstancePending,rh=e.isSuspenseInstanceFallback,Yx=e.getSuspenseInstanceFallbackErrorDetails,Wy=e.registerSuspenseInstanceRetry,Wx=e.canHydrateFormStateMarker,qx=e.isFormStateMarkerMatching,H0=e.getNextHydratableSibling,Dd=e.getFirstHydratableChild,Jx=e.getFirstHydratableChildWithinContainer,Zx=e.getFirstHydratableChildWithinSuspenseInstance,Kx=e.canHydrateInstance,Qx=e.canHydrateTextInstance,$x=e.canHydrateSuspenseInstance,qy=e.hydrateInstance,eg=e.hydrateTextInstance,Ju=e.hydrateSuspenseInstance,tg=e.getNextHydratableInstanceAfterSuspenseInstance,Ud=e.commitHydratedContainer,Ld=e.commitHydratedSuspenseInstance,ng=e.clearSuspenseBoundary,k0=e.clearSuspenseBoundaryFromContainer,ig=e.shouldDeleteUnhydratedTailInstances;e.diffHydratedPropsForDevWarnings,e.diffHydratedTextForDevWarnings,e.describeHydratableInstanceForDevWarnings;var ag=e.validateHydratableInstance,sg=e.validateHydratableTextInstance,qr=e.supportsResources,V0=e.isHostHoistableType,Od=e.getHoistableRoot,Id=e.getResource,X0=e.acquireResource,Y0=e.releaseResource,W0=e.hydrateHoistable,q0=e.mountHoistable,J0=e.unmountHoistable,Jy=e.createHoistableInstance,Z0=e.prepareToCommitHoistables,rg=e.mayResourceSuspendCommit,K0=e.preloadResource,Q0=e.suspendResource,ws=e.supportsSingletons,$0=e.resolveSingletonInstance,Zy=e.clearSingleton,Ky=e.acquireSingletonInstance,og=e.releaseSingletonInstance,Zu=e.isHostSingletonType,oh=[],Yl=-1,gu={},Ar=Math.clz32?Math.clz32:N,lh=Math.log,lg=Math.LN2,Ku=128,ch=4194304,Qu=As.unstable_scheduleCallback,uh=As.unstable_cancelCallback,cg=As.unstable_shouldYield,ug=As.unstable_requestPaint,Es=As.unstable_now,em=As.unstable_ImmediatePriority,fg=As.unstable_UserBlockingPriority,zd=As.unstable_NormalPriority,Fd=As.unstable_IdlePriority,hg=As.log,tm=As.unstable_setDisableYieldValue,$u=null,Mr=null,Jr=typeof Object.is=="function"?Object.is:J,Pd=new WeakMap,fa=[],wa=0,fh=null,hh=0,Zr=[],Kr=0,Fo=null,ul=1,yo="",ps=M(null),dh=M(null),Po=M(null),ef=M(null),zs=null,Cs=null,wi=!1,Qr=null,bo=!1,ph=Error(i(519)),$r=[],Bc=0,tf=0,nf=null,vu=null,mh=!1,xh=!1,Go=!1,Dc=0,gh=null,Gd=0,wr=0,Uc=null,Wl=!1,af=!1,vh=Object.prototype.hasOwnProperty,Xi=Error(i(460)),nm=Error(i(474)),jd={then:function(){}},yu=null,fl=null,_o=0,Lc=En(!0),im=En(!1),hl=M(null),eo=M(0),to=M(null),So=null,Wa=M(0),dl=0,$n=null,Li=null,La=null,Ao=!1,ha=!1,ql=!1,yh=0,Ea=0,sf=null,dg=0,Hd=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}},Ei={readContext:va,use:xe,useCallback:bn,useContext:bn,useEffect:bn,useImperativeHandle:bn,useLayoutEffect:bn,useInsertionEffect:bn,useMemo:bn,useReducer:bn,useRef:bn,useState:bn,useDebugValue:bn,useDeferredValue:bn,useTransition:bn,useSyncExternalStore:bn,useId:bn};Ei.useCacheRefresh=bn,Ei.useMemoCache=bn,Ei.useHostTransitionStatus=bn,Ei.useFormState=bn,Ei.useActionState=bn,Ei.useOptimistic=bn;var qa={readContext:va,use:xe,useCallback:function(f,d){return Nt().memoizedState=[f,d===void 0?null:d],f},useContext:va,useEffect:To,useImperativeHandle:function(f,d,_){_=_!=null?_.concat([f]):null,Ka(4194308,4,ys.bind(null,d,f),_)},useLayoutEffect:function(f,d){return Ka(4194308,4,f,d)},useInsertionEffect:function(f,d){Ka(4,2,f,d)},useMemo:function(f,d){var _=Nt();d=d===void 0?null:d;var E=f();if(ql){ae(!0);try{f()}finally{ae(!1)}}return _.memoizedState=[E,d],E},useReducer:function(f,d,_){var E=Nt();if(_!==void 0){var D=_(d);if(ql){ae(!0);try{_(d)}finally{ae(!1)}}}else D=d;return E.memoizedState=E.baseState=D,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:f,lastRenderedState:D},E.queue=f,f=f.dispatch=_s.bind(null,$n,f),[E.memoizedState,f]},useRef:function(f){var d=Nt();return f={current:f},d.memoizedState=f},useState:function(f){f=ln(f);var d=f.queue,_=Ro.bind(null,$n,d);return d.dispatch=_,[f.memoizedState,_]},useDebugValue:qs,useDeferredValue:function(f,d){var _=Nt();return ja(_,f,d)},useTransition:function(){var f=ln(!1);return f=Ir.bind(null,$n,f.queue,!0,!1),Nt().memoizedState=f,[!1,f]},useSyncExternalStore:function(f,d,_){var E=$n,D=Nt();if(wi){if(_===void 0)throw Error(i(407));_=_()}else{if(_=d(),ci===null)throw Error(i(349));(si&60)!==0||mt(E,d,_)}D.memoizedState=_;var G={value:_,getSnapshot:d};return D.queue=G,To(en.bind(null,E,G,f),[f]),E.flags|=2048,Di(9,Pt.bind(null,E,G,_,d),{destroy:void 0},null),_},useId:function(){var f=Nt(),d=ci.identifierPrefix;if(wi){var _=yo,E=ul;_=(E&~(1<<32-Ar(E)-1)).toString(32)+_,d=":"+d+"R"+_,_=yh++,0<_&&(d+="H"+_.toString(32)),d+=":"}else _=dg++,d=":"+d+"r"+_.toString(32)+":";return f.memoizedState=d},useCacheRefresh:function(){return Nt().memoizedState=zr.bind(null,$n)}};qa.useMemoCache=Oe,qa.useHostTransitionStatus=Ha,qa.useFormState=Ni,qa.useActionState=Ni,qa.useOptimistic=function(f){var d=Nt();d.memoizedState=d.baseState=f;var _={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return d.queue=_,d=No.bind(null,$n,!0,_),_.dispatch=d,[f,d]};var Fs={readContext:va,use:xe,useCallback:ho,useContext:va,useEffect:vs,useImperativeHandle:da,useInsertionEffect:Nl,useLayoutEffect:dr,useMemo:bs,useReducer:$e,useRef:Ga,useState:function(){return $e(Me)},useDebugValue:qs,useDeferredValue:function(f,d){var _=K();return Or(_,Li.memoizedState,f,d)},useTransition:function(){var f=$e(Me)[0],d=K().memoizedState;return[typeof f=="boolean"?f:be(f),d]},useSyncExternalStore:Ft,useId:pa};Fs.useCacheRefresh=gn,Fs.useMemoCache=Oe,Fs.useHostTransitionStatus=Ha,Fs.useFormState=Yn,Fs.useActionState=Yn,Fs.useOptimistic=function(f,d){var _=K();return xn(_,Li,f,d)};var Oc={readContext:va,use:xe,useCallback:ho,useContext:va,useEffect:vs,useImperativeHandle:da,useInsertionEffect:Nl,useLayoutEffect:dr,useMemo:bs,useReducer:Mt,useRef:Ga,useState:function(){return Mt(Me)},useDebugValue:qs,useDeferredValue:function(f,d){var _=K();return Li===null?ja(_,f,d):Or(_,Li.memoizedState,f,d)},useTransition:function(){var f=Mt(Me)[0],d=K().memoizedState;return[typeof f=="boolean"?f:be(f),d]},useSyncExternalStore:Ft,useId:pa};Oc.useCacheRefresh=gn,Oc.useMemoCache=Oe,Oc.useHostTransitionStatus=Ha,Oc.useFormState=ki,Oc.useActionState=ki,Oc.useOptimistic=function(f,d){var _=K();return Li!==null?xn(_,Li,f,d):(_.baseState=f,[f,_.queue.dispatch])};var kd={isMounted:function(f){return(f=f._reactInternals)?x(f)===f:!1},enqueueSetState:function(f,d,_){f=f._reactInternals;var E=$s(),D=qe(E);D.payload=d,_!=null&&(D.callback=_),d=We(f,D,E),d!==null&&(Ls(d,f,E),ft(d,f,E))},enqueueReplaceState:function(f,d,_){f=f._reactInternals;var E=$s(),D=qe(E);D.tag=1,D.payload=d,_!=null&&(D.callback=_),d=We(f,D,E),d!==null&&(Ls(d,f,E),ft(d,f,E))},enqueueForceUpdate:function(f,d){f=f._reactInternals;var _=$s(),E=qe(_);E.tag=2,d!=null&&(E.callback=d),d=We(f,E,_),d!==null&&(Ls(d,f,_),ft(d,f,_))}},am=typeof reportError=="function"?reportError:function(f){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var d=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof f=="object"&&f!==null&&typeof f.message=="string"?String(f.message):String(f),error:f});if(!window.dispatchEvent(d))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",f);return}console.error(f)},pg=Error(i(461)),Oa=!1,Ps={dehydrated:null,treeContext:null,retryLane:0},Er=M(null),Ic=null,Ca=null,mg=typeof AbortController<"u"?AbortController:function(){var f=[],d=this.signal={aborted:!1,addEventListener:function(_,E){f.push(E)}};this.abort=function(){d.aborted=!0,f.forEach(function(_){return _()})}},Jl=As.unstable_scheduleCallback,bu=As.unstable_NormalPriority,Fi={$$typeof:sl,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0},Vd=Dn.S;Dn.S=function(f,d){typeof d=="object"&&d!==null&&typeof d.then=="function"&&Be(f,d),Vd!==null&&Vd(f,d)};var Zl=M(null),es=!1,ba=!1,zc=!1,rf=typeof WeakSet=="function"?WeakSet:Set,Ta=null,_u=!1,Ia=null,Cr=!1,nr=null,Su=8192,Xd={getCacheForType:function(f){var d=va(Fi),_=d.data.get(f);return _===void 0&&(_=f(),d.data.set(f,_)),_}},bh=0,Yd=1,Wd=2,_i=3,Pi=4;if(typeof Symbol=="function"&&Symbol.for){var ei=Symbol.for;bh=ei("selector.component"),Yd=ei("selector.has_pseudo_class"),Wd=ei("selector.role"),_i=ei("selector.test_id"),Pi=ei("selector.text")}var mi=typeof WeakMap=="function"?WeakMap:Map,Tn=0,ci=null,Jn=null,si=0,Ki=0,za=null,Gi=!1,no=!1,Kl=!1,jo=0,Si=0,io=0,Ho=0,Gs=0,Tr=0,Ql=0,of=null,ao=null,lf=!1,pl=0,_a=1/0,ko=null,so=null,Mo=!1,$l=null,Au=0,qd=0,Mu=null,wu=0,ir=null;return Cn.attemptContinuousHydration=function(f){if(f.tag===13){var d=Ze(f,67108864);d!==null&&Ls(d,f,67108864),v0(f,67108864)}},Cn.attemptHydrationAtCurrentPriority=function(f){if(f.tag===13){var d=$s(),_=Ze(f,d);_!==null&&Ls(_,f,d),v0(f,d)}},Cn.attemptSynchronousHydration=function(f){switch(f.tag){case 3:if(f=f.stateNode,f.current.memoizedState.isDehydrated){var d=B(f.pendingLanes);if(d!==0){for(f.pendingLanes|=2,f.entangledLanes|=2;d;){var _=1<<31-Ar(d);f.entanglements[1]|=_,d&=~_}et(f),(Tn&6)===0&&(_a=Es()+500,Ne(0))}}break;case 13:d=Ze(f,2),d!==null&&Ls(d,f,2),d0(),v0(f,2)}},Cn.batchedUpdates=function(f,d){return f(d)},Cn.createComponentSelector=function(f){return{$$typeof:bh,value:f}},Cn.createContainer=function(f,d,_,E,D,G,de,Ce,Xe,Ct){return ds(f,d,!1,null,_,E,G,de,Ce,Xe,Ct,null)},Cn.createHasPseudoClassSelector=function(f){return{$$typeof:Yd,value:f}},Cn.createHydrationContainer=function(f,d,_,E,D,G,de,Ce,Xe,Ct,Jt,cn,pn){return f=ds(_,E,!0,f,D,G,Ce,Xe,Ct,Jt,cn,pn),f.context=Kf(null),_=f.current,E=$s(),D=qe(E),D.callback=d??null,We(_,D,E),f.current.lanes=E,ee(f,E),et(f),f},Cn.createPortal=function(f,d,_){var E=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Io,key:E==null?null:""+E,children:f,containerInfo:d,implementation:_}},Cn.createRoleSelector=function(f){return{$$typeof:Wd,value:f}},Cn.createTestNameSelector=function(f){return{$$typeof:_i,value:f}},Cn.createTextSelector=function(f){return{$$typeof:Pi,value:f}},Cn.defaultOnCaughtError=function(f){console.error(f)},Cn.defaultOnRecoverableError=function(f){am(f)},Cn.defaultOnUncaughtError=function(f){am(f)},Cn.deferredUpdates=function(f){var d=Dn.T,_=$a();try{return Is(32),Dn.T=null,f()}finally{Is(_),Dn.T=d}},Cn.discreteUpdates=function(f,d,_,E,D){var G=Dn.T,de=$a();try{return Is(2),Dn.T=null,f(d,_,E,D)}finally{Is(de),Dn.T=G,Tn===0&&(_a=Es()+500)}},Cn.findAllNodes=Qs,Cn.findBoundingRects=function(f,d){if(!ll)throw Error(i(363));d=Qs(f,d),f=[];for(var _=0;_<d.length;_++)f.push(Cd(d[_]));for(d=f.length-1;0<d;d--){_=f[d];for(var E=_.x,D=E+_.width,G=_.y,de=G+_.height,Ce=d-1;0<=Ce;Ce--)if(d!==Ce){var Xe=f[Ce],Ct=Xe.x,Jt=Ct+Xe.width,cn=Xe.y,pn=cn+Xe.height;if(E>=Ct&&G>=cn&&D<=Jt&&de<=pn){f.splice(d,1);break}else if(E!==Ct||_.width!==Xe.width||pn<G||cn>de){if(!(G!==cn||_.height!==Xe.height||Jt<E||Ct>D)){Ct>E&&(Xe.width+=Ct-E,Xe.x=E),Jt<D&&(Xe.width=D-Ct),f.splice(d,1);break}}else{cn>G&&(Xe.height+=cn-G,Xe.y=G),pn<de&&(Xe.height=de-cn),f.splice(d,1);break}}}return f},Cn.findHostInstance=g0,Cn.findHostInstanceWithNoPortals=function(f){return f=b(f),f=f!==null?C(f):null,f===null?null:qu(f.stateNode)},Cn.findHostInstanceWithWarning=function(f){return g0(f)},Cn.flushPassiveEffects=hs,Cn.flushSyncFromReconciler=function(f){var d=Tn;Tn|=1;var _=Dn.T,E=$a();try{if(Is(2),Dn.T=null,f)return f()}finally{Is(E),Dn.T=_,Tn=d,(Tn&6)===0&&Ne(0)}},Cn.flushSyncWork=d0,Cn.focusWithin=function(f,d){if(!ll)throw Error(i(363));for(f=md(f),d=Lx(f,d),d=Array.from(d),f=0;f<d.length;){var _=d[f++],E=_.tag;if(!cl(_)){if((E===5||E===26||E===27)&&Ma(_.stateNode))return!0;for(_=_.child;_!==null;)d.push(_),_=_.sibling}}return!1},Cn.getFindAllNodesFailureDescription=function(f,d){if(!ll)throw Error(i(363));var _=0,E=[];f=[md(f),0];for(var D=0;D<f.length;){var G=f[D++],de=G.tag,Ce=f[D++],Xe=d[Ce];if((de!==5&&de!==26&&de!==27||!cl(G))&&(ku(G,Xe)&&(E.push(_c(Xe)),Ce++,Ce>_&&(_=Ce)),Ce<d.length))for(G=G.child;G!==null;)f.push(G,Ce),G=G.sibling}if(_<d.length){for(f=[];_<d.length;_++)f.push(_c(d[_]));return`findAllNodes was able to match part of the selector:
  `+(E.join(" > ")+`

No matching component was found for:
  `)+f.join(" > ")}return null},Cn.getPublicRootInstance=function(f){if(f=f.current,!f.child)return null;switch(f.child.tag){case 27:case 5:return qu(f.child.stateNode);default:return f.child.stateNode}},Cn.injectIntoDevTools=function(){var f={bundleType:0,version:Ad,rendererPackageName:eh,currentDispatcherRef:Dn,findFiberByHostInstance:T0,reconcilerVersion:"19.0.0"};if(th!==null&&(f.rendererConfig=th),typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")f=!1;else{var d=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(d.isDisabled||!d.supportsFiber)f=!0;else{try{$u=d.inject(f),Mr=d}catch{}f=!!d.checkDCE}}return f},Cn.isAlreadyRendering=function(){return!1},Cn.observeVisibleRects=function(f,d,_,E){if(!ll)throw Error(i(363));f=Qs(f,d);var D=B0(f,_,E).disconnect;return{disconnect:function(){D()}}},Cn.shouldError=function(){return null},Cn.shouldSuspend=function(){return!1},Cn.startHostTransition=function(f,d,_,E){if(f.tag!==5)throw Error(i(476));var D=pr(f).queue;Ir(f,D,d,Sr,_===null?n:function(){var G=pr(f).next.queue;return Ns(f,G,{},$s()),_(E)})},Cn.updateContainer=function(f,d,_,E){var D=d.current,G=$s();return zx(D,G,f,d,_,E),G},Cn.updateContainerSync=function(f,d,_,E){return d.tag===0&&hs(),zx(d.current,2,f,d,_,E),2},Cn},s.exports.default=s.exports,Object.defineProperty(s.exports,"__esModule",{value:!0})})(W2)),W2.exports}var bE;function RF(){return bE||(bE=1,Y2.exports=TF()),Y2.exports}var NF=RF();const BF=ny(NF);var _E=mT();function WS(s,e,t){if(!s)return;if(t(s)===!0)return s;let n=e?s.return:s.child;for(;n;){const i=WS(n,e,t);if(i)return i;n=e?null:n.sibling}}function xT(s){try{return Object.defineProperties(s,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return s}}const qS=xT(Y.createContext(null));class gT extends Y.Component{render(){return Y.createElement(qS.Provider,{value:this._reactInternals},this.props.children)}}function vT(){const s=Y.useContext(qS);if(s===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=Y.useId();return Y.useMemo(()=>{for(const t of[s,s==null?void 0:s.alternate]){if(!t)continue;const n=WS(t,!1,i=>{let a=i.memoizedState;for(;a;){if(a.memoizedState===e)return!0;a=a.next}});if(n)return n}},[s,e])}const DF=Symbol.for("react.context"),UF=s=>s!==null&&typeof s=="object"&&"$$typeof"in s&&s.$$typeof===DF;function LF(){const s=vT(),[e]=Y.useState(()=>new Map);e.clear();let t=s;for(;t;){const n=t.type;UF(n)&&n!==qS&&!e.has(n)&&e.set(n,Y.use(xT(n))),t=t.return}return e}function OF(){const s=LF();return Y.useMemo(()=>Array.from(s.keys()).reduce((e,t)=>n=>Y.createElement(e,null,Y.createElement(t.Provider,{...n,value:s.get(t)})),e=>Y.createElement(gT,{...e})),[s])}function yT(s){let e=s.root;for(;e.getState().previousRoot;)e=e.getState().previousRoot;return e}const bT=s=>s&&s.isOrthographicCamera,IF=s=>s&&s.hasOwnProperty("current"),zF=s=>s!=null&&(typeof s=="string"||typeof s=="number"||s.isColor),Nx=((s,e)=>typeof window<"u"&&(((s=window.document)==null?void 0:s.createElement)||((e=window.navigator)==null?void 0:e.product)==="ReactNative"))()?Y.useLayoutEffect:Y.useEffect;function JS(s){const e=Y.useRef(s);return Nx(()=>void(e.current=s),[s]),e}function FF(){const s=vT(),e=OF();return Y.useMemo(()=>({children:t})=>{const i=!!WS(s,!0,a=>a.type===Y.StrictMode)?Y.StrictMode:Y.Fragment;return y.jsx(i,{children:y.jsx(e,{children:t})})},[s,e])}function PF({set:s}){return Nx(()=>(s(new Promise(()=>null)),()=>s(!1)),[s]),null}const GF=(s=>(s=class extends Y.Component{constructor(...t){super(...t),this.state={error:!1}}componentDidCatch(t){this.props.set(t)}render(){return this.state.error?null:this.props.children}},s.getDerivedStateFromError=()=>({error:!0}),s))();function _T(s){var e;const t=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(s)?Math.min(Math.max(s[0],t),s[1]):s}function wp(s){var e;return(e=s.__r3f)==null?void 0:e.root.getState()}const Na={obj:s=>s===Object(s)&&!Na.arr(s)&&typeof s!="function",fun:s=>typeof s=="function",str:s=>typeof s=="string",num:s=>typeof s=="number",boo:s=>typeof s=="boolean",und:s=>s===void 0,nul:s=>s===null,arr:s=>Array.isArray(s),equ(s,e,{arrays:t="shallow",objects:n="reference",strict:i=!0}={}){if(typeof s!=typeof e||!!s!=!!e)return!1;if(Na.str(s)||Na.num(s)||Na.boo(s))return s===e;const a=Na.obj(s);if(a&&n==="reference")return s===e;const o=Na.arr(s);if(o&&t==="reference")return s===e;if((o||a)&&s===e)return!0;let c;for(c in s)if(!(c in e))return!1;if(a&&t==="shallow"&&n==="shallow"){for(c in i?e:s)if(!Na.equ(s[c],e[c],{strict:i,objects:"reference"}))return!1}else for(c in i?e:s)if(s[c]!==e[c])return!1;if(Na.und(c)){if(o&&s.length===0&&e.length===0||a&&Object.keys(s).length===0&&Object.keys(e).length===0)return!0;if(s!==e)return!1}return!0}};function jF(s){const e={nodes:{},materials:{},meshes:{}};return s&&s.traverse(t=>{t.name&&(e.nodes[t.name]=t),t.material&&!e.materials[t.material.name]&&(e.materials[t.material.name]=t.material),t.isMesh&&!e.meshes[t.name]&&(e.meshes[t.name]=t)}),e}function HF(s){s.type!=="Scene"&&(s.dispose==null||s.dispose());for(const e in s){const t=s[e];(t==null?void 0:t.type)!=="Scene"&&(t==null||t.dispose==null||t.dispose())}}const ST=["children","key","ref"];function kF(s){const e={};for(const t in s)ST.includes(t)||(e[t]=s[t]);return e}function Y1(s,e,t,n){const i=s;let a=i==null?void 0:i.__r3f;return a||(a={root:e,type:t,parent:null,children:[],props:kF(n),object:i,eventCount:0,handlers:{},isHidden:!1},i&&(i.__r3f=a)),a}function mx(s,e){if(!e.includes("-"))return{root:s,key:e,target:s[e]};if(e in s)return{root:s,key:e,target:s[e]};let t=s;const n=e.split("-");for(const i of n){if(typeof t!="object"||t===null){if(t!==void 0){const a=n.slice(n.indexOf(i)).join("-");return{root:t,key:a,target:void 0}}return{root:s,key:e,target:void 0}}e=i,s=t,t=t[e]}return{root:s,key:e,target:t}}const SE=/-\d+$/;function W1(s,e){if(Na.str(e.props.attach)){if(SE.test(e.props.attach)){const i=e.props.attach.replace(SE,""),{root:a,key:o}=mx(s.object,i);Array.isArray(a[o])||(a[o]=[])}const{root:t,key:n}=mx(s.object,e.props.attach);e.previousAttach=t[n],t[n]=e.object}else Na.fun(e.props.attach)&&(e.previousAttach=e.props.attach(s.object,e.object))}function q1(s,e){if(Na.str(e.props.attach)){const{root:t,key:n}=mx(s.object,e.props.attach),i=e.previousAttach;i===void 0?delete t[n]:t[n]=i}else e.previousAttach==null||e.previousAttach(s.object,e.object);delete e.previousAttach}const H_=[...ST,"args","dispose","attach","object","onUpdate","dispose"],AE=new Map;function VF(s){let e=AE.get(s.constructor);try{e||(e=new s.constructor,AE.set(s.constructor,e))}catch{}return e}function XF(s,e){const t={};for(const n in e)if(!H_.includes(n)&&!Na.equ(e[n],s.props[n])){t[n]=e[n];for(const i in e)i.startsWith(`${n}-`)&&(t[i]=e[i])}for(const n in s.props){if(H_.includes(n)||e.hasOwnProperty(n))continue;const{root:i,key:a}=mx(s.object,n);if(i.constructor&&i.constructor.length===0){const o=VF(i);Na.und(o)||(t[a]=o[a])}else t[a]=0}return t}const YF=["map","emissiveMap","sheenColorMap","specularColorMap","envMap"],WF=/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/;function Vc(s,e){var t;const n=s.__r3f,i=n&&yT(n).getState(),a=n==null?void 0:n.eventCount;for(const c in e){let u=e[c];if(H_.includes(c))continue;if(n&&WF.test(c)){typeof u=="function"?n.handlers[c]=u:delete n.handlers[c],n.eventCount=Object.keys(n.handlers).length;continue}if(u===void 0)continue;let{root:h,key:m,target:x}=mx(s,c);if(x===void 0&&(typeof h!="object"||h===null))throw Error(`R3F: Cannot set "${c}". Ensure it is an object before setting "${m}".`);if(x instanceof qp&&u instanceof qp)x.mask=u.mask;else if(x instanceof qt&&zF(u))x.set(u);else if(x!==null&&typeof x=="object"&&typeof x.set=="function"&&typeof x.copy=="function"&&u!=null&&u.constructor&&x.constructor===u.constructor)x.copy(u);else if(x!==null&&typeof x=="object"&&typeof x.set=="function"&&Array.isArray(u))typeof x.fromArray=="function"?x.fromArray(u):x.set(...u);else if(x!==null&&typeof x=="object"&&typeof x.set=="function"&&typeof u=="number")typeof x.setScalar=="function"?x.setScalar(u):x.set(u);else{var o;h[m]=u,i&&!i.linear&&YF.includes(m)&&(o=h[m])!=null&&o.isTexture&&h[m].format===ss&&h[m].type===uo&&(h[m].colorSpace=Hs)}}if(n!=null&&n.parent&&i!=null&&i.internal&&(t=n.object)!=null&&t.isObject3D&&a!==n.eventCount){const c=n.object,u=i.internal.interaction.indexOf(c);u>-1&&i.internal.interaction.splice(u,1),n.eventCount&&c.raycast!==null&&i.internal.interaction.push(c)}return n&&n.props.attach===void 0&&(n.object.isBufferGeometry?n.props.attach="geometry":n.object.isMaterial&&(n.props.attach="material")),n&&c0(n),s}function c0(s){var e;if(!s.parent)return;s.props.onUpdate==null||s.props.onUpdate(s.object);const t=(e=s.root)==null||e.getState==null?void 0:e.getState();t&&t.internal.frames===0&&t.invalidate()}function AT(s,e){s.manual||(bT(s)?(s.left=e.width/-2,s.right=e.width/2,s.top=e.height/2,s.bottom=e.height/-2):s.aspect=e.width/e.height,s.updateProjectionMatrix())}const lo=s=>s==null?void 0:s.isObject3D;function Dv(s){return(s.eventObject||s.object).uuid+"/"+s.index+s.instanceId}function MT(s,e,t,n){const i=t.get(e);i&&(t.delete(e),t.size===0&&(s.delete(n),i.target.releasePointerCapture(n)))}function qF(s,e){const{internal:t}=s.getState();t.interaction=t.interaction.filter(n=>n!==e),t.initialHits=t.initialHits.filter(n=>n!==e),t.hovered.forEach((n,i)=>{(n.eventObject===e||n.object===e)&&t.hovered.delete(i)}),t.capturedMap.forEach((n,i)=>{MT(t.capturedMap,e,n,i)})}function JF(s){function e(u){const{internal:h}=s.getState(),m=u.offsetX-h.initialClick[0],x=u.offsetY-h.initialClick[1];return Math.round(Math.sqrt(m*m+x*x))}function t(u){return u.filter(h=>["Move","Over","Enter","Out","Leave"].some(m=>{var x;return(x=h.__r3f)==null?void 0:x.handlers["onPointer"+m]}))}function n(u,h){const m=s.getState(),x=new Set,g=[],b=h?h(m.internal.interaction):m.internal.interaction;for(let A=0;A<b.length;A++){const R=wp(b[A]);R&&(R.raycaster.camera=void 0)}m.previousRoot||m.events.compute==null||m.events.compute(u,m);function S(A){const R=wp(A);if(!R||!R.events.enabled||R.raycaster.camera===null)return[];if(R.raycaster.camera===void 0){var N;R.events.compute==null||R.events.compute(u,R,(N=R.previousRoot)==null?void 0:N.getState()),R.raycaster.camera===void 0&&(R.raycaster.camera=null)}return R.raycaster.camera?R.raycaster.intersectObject(A,!0):[]}let C=b.flatMap(S).sort((A,R)=>{const N=wp(A.object),B=wp(R.object);return!N||!B?A.distance-R.distance:B.events.priority-N.events.priority||A.distance-R.distance}).filter(A=>{const R=Dv(A);return x.has(R)?!1:(x.add(R),!0)});m.events.filter&&(C=m.events.filter(C,m));for(const A of C){let R=A.object;for(;R;){var M;(M=R.__r3f)!=null&&M.eventCount&&g.push({...A,eventObject:R}),R=R.parent}}if("pointerId"in u&&m.internal.capturedMap.has(u.pointerId))for(let A of m.internal.capturedMap.get(u.pointerId).values())x.has(Dv(A.intersection))||g.push(A.intersection);return g}function i(u,h,m,x){if(u.length){const g={stopped:!1};for(const b of u){let S=wp(b.object);if(S||b.object.traverseAncestors(C=>{const M=wp(C);if(M)return S=M,!1}),S){const{raycaster:C,pointer:M,camera:A,internal:R}=S,N=new k(M.x,M.y,0).unproject(A),B=L=>{var O,ee;return(O=(ee=R.capturedMap.get(L))==null?void 0:ee.has(b.eventObject))!=null?O:!1},F=L=>{const O={intersection:b,target:h.target};R.capturedMap.has(L)?R.capturedMap.get(L).set(b.eventObject,O):R.capturedMap.set(L,new Map([[b.eventObject,O]])),h.target.setPointerCapture(L)},U=L=>{const O=R.capturedMap.get(L);O&&MT(R.capturedMap,b.eventObject,O,L)};let z={};for(let L in h){let O=h[L];typeof O!="function"&&(z[L]=O)}let P={...b,...z,pointer:M,intersections:u,stopped:g.stopped,delta:m,unprojectedPoint:N,ray:C.ray,camera:A,stopPropagation(){const L="pointerId"in h&&R.capturedMap.get(h.pointerId);if((!L||L.has(b.eventObject))&&(P.stopped=g.stopped=!0,R.hovered.size&&Array.from(R.hovered.values()).find(O=>O.eventObject===b.eventObject))){const O=u.slice(0,u.indexOf(b));a([...O,b])}},target:{hasPointerCapture:B,setPointerCapture:F,releasePointerCapture:U},currentTarget:{hasPointerCapture:B,setPointerCapture:F,releasePointerCapture:U},nativeEvent:h};if(x(P),g.stopped===!0)break}}}return u}function a(u){const{internal:h}=s.getState();for(const m of h.hovered.values())if(!u.length||!u.find(x=>x.object===m.object&&x.index===m.index&&x.instanceId===m.instanceId)){const g=m.eventObject.__r3f;if(h.hovered.delete(Dv(m)),g!=null&&g.eventCount){const b=g.handlers,S={...m,intersections:u};b.onPointerOut==null||b.onPointerOut(S),b.onPointerLeave==null||b.onPointerLeave(S)}}}function o(u,h){for(let m=0;m<h.length;m++){const x=h[m].__r3f;x==null||x.handlers.onPointerMissed==null||x.handlers.onPointerMissed(u)}}function c(u){switch(u){case"onPointerLeave":case"onPointerCancel":return()=>a([]);case"onLostPointerCapture":return h=>{const{internal:m}=s.getState();"pointerId"in h&&m.capturedMap.has(h.pointerId)&&requestAnimationFrame(()=>{m.capturedMap.has(h.pointerId)&&(m.capturedMap.delete(h.pointerId),a([]))})}}return function(m){const{onPointerMissed:x,internal:g}=s.getState();g.lastEvent.current=m;const b=u==="onPointerMove",S=u==="onClick"||u==="onContextMenu"||u==="onDoubleClick",M=n(m,b?t:void 0),A=S?e(m):0;u==="onPointerDown"&&(g.initialClick=[m.offsetX,m.offsetY],g.initialHits=M.map(N=>N.eventObject)),S&&!M.length&&A<=2&&(o(m,g.interaction),x&&x(m)),b&&a(M);function R(N){const B=N.eventObject,F=B.__r3f;if(!(F!=null&&F.eventCount))return;const U=F.handlers;if(b){if(U.onPointerOver||U.onPointerEnter||U.onPointerOut||U.onPointerLeave){const z=Dv(N),P=g.hovered.get(z);P?P.stopped&&N.stopPropagation():(g.hovered.set(z,N),U.onPointerOver==null||U.onPointerOver(N),U.onPointerEnter==null||U.onPointerEnter(N))}U.onPointerMove==null||U.onPointerMove(N)}else{const z=U[u];z?(!S||g.initialHits.includes(B))&&(o(m,g.interaction.filter(P=>!g.initialHits.includes(P))),z(N)):S&&g.initialHits.includes(B)&&o(m,g.interaction.filter(P=>!g.initialHits.includes(P)))}}i(M,m,A,R)}}return{handlePointer:c}}const ME=s=>!!(s!=null&&s.render),ZS=Y.createContext(null),ZF=(s,e)=>{const t=fT((c,u)=>{const h=new k,m=new k,x=new k;function g(A=u().camera,R=m,N=u().size){const{width:B,height:F,top:U,left:z}=N,P=B/F;R.isVector3?x.copy(R):x.set(...R);const L=A.getWorldPosition(h).distanceTo(x);if(bT(A))return{width:B/A.zoom,height:F/A.zoom,top:U,left:z,factor:1,distance:L,aspect:P};{const O=A.fov*Math.PI/180,ee=2*Math.tan(O/2)*L,Q=ee*(B/F);return{width:Q,height:ee,top:U,left:z,factor:B/Q,distance:L,aspect:P}}}let b;const S=A=>c(R=>({performance:{...R.performance,current:A}})),C=new gt;return{set:c,get:u,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},scene:null,xr:null,invalidate:(A=1)=>s(u(),A),advance:(A,R)=>e(A,R,u()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new jS,pointer:C,mouse:C,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const A=u();b&&clearTimeout(b),A.performance.current!==A.performance.min&&S(A.performance.min),b=setTimeout(()=>S(u().performance.max),A.performance.debounce)}},size:{width:0,height:0,top:0,left:0},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:g},setEvents:A=>c(R=>({...R,events:{...R.events,...A}})),setSize:(A,R,N=0,B=0)=>{const F=u().camera,U={width:A,height:R,top:N,left:B};c(z=>({size:U,viewport:{...z.viewport,...g(F,m,U)}}))},setDpr:A=>c(R=>{const N=_T(A);return{viewport:{...R.viewport,dpr:N,initialDpr:R.viewport.initialDpr||N}}}),setFrameloop:(A="always")=>{const R=u().clock;R.stop(),R.elapsedTime=0,A!=="never"&&(R.start(),R.elapsedTime=0),c(()=>({frameloop:A}))},previousRoot:void 0,internal:{interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,lastEvent:Y.createRef(),active:!1,frames:0,priority:0,subscribe:(A,R,N)=>{const B=u().internal;return B.priority=B.priority+(R>0?1:0),B.subscribers.push({ref:A,priority:R,store:N}),B.subscribers=B.subscribers.sort((F,U)=>F.priority-U.priority),()=>{const F=u().internal;F!=null&&F.subscribers&&(F.priority=F.priority-(R>0?1:0),F.subscribers=F.subscribers.filter(U=>U.ref!==A))}}}}}),n=t.getState();let i=n.size,a=n.viewport.dpr,o=n.camera;return t.subscribe(()=>{const{camera:c,size:u,viewport:h,gl:m,set:x}=t.getState();if(u.width!==i.width||u.height!==i.height||h.dpr!==a){i=u,a=h.dpr,AT(c,u),h.dpr>0&&m.setPixelRatio(h.dpr);const g=typeof HTMLCanvasElement<"u"&&m.domElement instanceof HTMLCanvasElement;m.setSize(u.width,u.height,g)}c!==o&&(o=c,x(g=>({viewport:{...g.viewport,...g.viewport.getCurrentViewport(c)}})))}),t.subscribe(c=>s(c)),t};function KS(){const s=Y.useContext(ZS);if(!s)throw new Error("R3F: Hooks can only be used within the Canvas component!");return s}function ti(s=t=>t,e){return KS()(s,e)}function Rl(s,e=0){const t=KS(),n=t.getState().internal.subscribe,i=JS(s);return Nx(()=>n(i,e,t),[e,n,t]),null}const wE=new WeakMap,KF=s=>{var e;return typeof s=="function"&&(s==null||(e=s.prototype)==null?void 0:e.constructor)===s};function wT(s,e){return function(t,...n){let i;return KF(t)?(i=wE.get(t),i||(i=new t,wE.set(t,i))):i=t,s&&s(i),Promise.all(n.map(a=>new Promise((o,c)=>i.load(a,u=>{lo(u==null?void 0:u.scene)&&Object.assign(u,jF(u.scene)),o(u)},e,u=>c(new Error(`Could not load ${a}: ${u==null?void 0:u.message}`))))))}}function $c(s,e,t,n){const i=Array.isArray(e)?e:[e],a=pT(wT(t,n),[s,...i],{equal:Na.equ});return Array.isArray(e)?a:a[0]}$c.preload=function(s,e,t){const n=Array.isArray(e)?e:[e];return wF(wT(t),[s,...n])};$c.clear=function(s,e){const t=Array.isArray(e)?e:[e];return EF([s,...t])};var QF={version:"9.4.2"};function $F(s){const e=BF(s);return e.injectIntoDevTools(),e}const ET=0,e0={},e8=/^three(?=[A-Z])/,Gy=s=>`${s[0].toUpperCase()}${s.slice(1)}`;let t8=0;const n8=s=>typeof s=="function";function QS(s){if(n8(s)){const e=`${t8++}`;return e0[e]=s,e}else Object.assign(e0,s)}function CT(s,e){const t=Gy(s),n=e0[t];if(s!=="primitive"&&!n)throw new Error(`R3F: ${t} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(s==="primitive"&&!e.object)throw new Error("R3F: Primitives without 'object' are invalid!");if(e.args!==void 0&&!Array.isArray(e.args))throw new Error("R3F: The args prop must be an array!")}function i8(s,e,t){var n;return s=Gy(s)in e0?s:s.replace(e8,""),CT(s,e),s==="primitive"&&(n=e.object)!=null&&n.__r3f&&delete e.object.__r3f,Y1(e.object,t,s,e)}function a8(s){if(!s.isHidden){var e;s.props.attach&&(e=s.parent)!=null&&e.object?q1(s.parent,s):lo(s.object)&&(s.object.visible=!1),s.isHidden=!0,c0(s)}}function TT(s){if(s.isHidden){var e;s.props.attach&&(e=s.parent)!=null&&e.object?W1(s.parent,s):lo(s.object)&&s.props.visible!==!1&&(s.object.visible=!0),s.isHidden=!1,c0(s)}}function $S(s,e,t){const n=e.root.getState();if(!(!s.parent&&s.object!==n.scene)){if(!e.object){var i,a;const o=e0[Gy(e.type)];e.object=(i=e.props.object)!=null?i:new o(...(a=e.props.args)!=null?a:[]),e.object.__r3f=e}if(Vc(e.object,e.props),e.props.attach)W1(s,e);else if(lo(e.object)&&lo(s.object)){const o=s.object.children.indexOf(t==null?void 0:t.object);if(t&&o!==-1){const c=s.object.children.indexOf(e.object);if(c!==-1){s.object.children.splice(c,1);const u=c<o?o-1:o;s.object.children.splice(u,0,e.object)}else e.object.parent=s.object,s.object.children.splice(o,0,e.object),e.object.dispatchEvent({type:"added"}),s.object.dispatchEvent({type:"childadded",child:e.object})}else s.object.add(e.object)}for(const o of e.children)$S(e,o);c0(e)}}function Z2(s,e){e&&(e.parent=s,s.children.push(e),$S(s,e))}function EE(s,e,t){if(!e||!t)return;e.parent=s;const n=s.children.indexOf(t);n!==-1?s.children.splice(n,0,e):s.children.push(e),$S(s,e,t)}function RT(s){if(typeof s.dispose=="function"){const e=()=>{try{s.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT<"u"?e():_E.unstable_scheduleCallback(_E.unstable_IdlePriority,e)}}function k_(s,e,t){if(!e)return;e.parent=null;const n=s.children.indexOf(e);n!==-1&&s.children.splice(n,1),e.props.attach?q1(s,e):lo(e.object)&&lo(s.object)&&(s.object.remove(e.object),qF(yT(e),e.object));const i=e.props.dispose!==null&&t!==!1;for(let a=e.children.length-1;a>=0;a--){const o=e.children[a];k_(e,o,i)}e.children.length=0,delete e.object.__r3f,i&&e.type!=="primitive"&&e.object.type!=="Scene"&&RT(e.object),t===void 0&&c0(e)}function s8(s,e){for(const t of[s,s.alternate])if(t!==null)if(typeof t.ref=="function"){t.refCleanup==null||t.refCleanup();const n=t.ref(e);typeof n=="function"&&(t.refCleanup=n)}else t.ref&&(t.ref.current=e)}const Qv=[];function r8(){for(const[t]of Qv){const n=t.parent;if(n){t.props.attach?q1(n,t):lo(t.object)&&lo(n.object)&&n.object.remove(t.object);for(const i of t.children)i.props.attach?q1(t,i):lo(i.object)&&lo(t.object)&&t.object.remove(i.object)}t.isHidden&&TT(t),t.object.__r3f&&delete t.object.__r3f,t.type!=="primitive"&&RT(t.object)}for(const[t,n,i]of Qv){t.props=n;const a=t.parent;if(a){var s,e;const o=e0[Gy(t.type)];t.object=(s=t.props.object)!=null?s:new o(...(e=t.props.args)!=null?e:[]),t.object.__r3f=t,s8(i,t.object),Vc(t.object,t.props),t.props.attach?W1(a,t):lo(t.object)&&lo(a.object)&&a.object.add(t.object);for(const c of t.children)c.props.attach?W1(t,c):lo(c.object)&&lo(t.object)&&t.object.add(c.object);c0(t)}}Qv.length=0}const K2=()=>{},CE={};let Uv=ET;const o8=0,l8=4,J1=$F({isPrimaryRenderer:!1,warnsIfNotActing:!1,supportsMutation:!0,supportsPersistence:!1,supportsHydration:!1,createInstance:i8,removeChild:k_,appendChild:Z2,appendInitialChild:Z2,insertBefore:EE,appendChildToContainer(s,e){const t=s.getState().scene.__r3f;!e||!t||Z2(t,e)},removeChildFromContainer(s,e){const t=s.getState().scene.__r3f;!e||!t||k_(t,e)},insertInContainerBefore(s,e,t){const n=s.getState().scene.__r3f;!e||!t||!n||EE(n,e,t)},getRootHostContext:()=>CE,getChildHostContext:()=>CE,commitUpdate(s,e,t,n,i){var a,o,c;CT(e,n);let u=!1;if((s.type==="primitive"&&t.object!==n.object||((a=n.args)==null?void 0:a.length)!==((o=t.args)==null?void 0:o.length)||(c=n.args)!=null&&c.some((m,x)=>{var g;return m!==((g=t.args)==null?void 0:g[x])}))&&(u=!0),u)Qv.push([s,{...n},i]);else{const m=XF(s,n);Object.keys(m).length&&(Object.assign(s.props,m),Vc(s.object,m))}(i.sibling===null||(i.flags&l8)===o8)&&r8()},finalizeInitialChildren:()=>!1,commitMount(){},getPublicInstance:s=>s==null?void 0:s.object,prepareForCommit:()=>null,preparePortalMount:s=>Y1(s.getState().scene,s,"",{}),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance:a8,unhideInstance:TT,createTextInstance:K2,hideTextInstance:K2,unhideTextInstance:K2,scheduleTimeout:typeof setTimeout=="function"?setTimeout:void 0,cancelTimeout:typeof clearTimeout=="function"?clearTimeout:void 0,noTimeout:-1,getInstanceFromNode:()=>null,beforeActiveInstanceBlur(){},afterActiveInstanceBlur(){},detachDeletedInstance(){},prepareScopeUpdate(){},getInstanceFromScope:()=>null,shouldAttemptEagerTransition:()=>!1,trackSchedulerEvent:()=>{},resolveEventType:()=>null,resolveEventTimeStamp:()=>-1.1,requestPostPaintCallback(){},maySuspendCommit:()=>!1,preloadInstance:()=>!0,startSuspendingCommit(){},suspendInstance(){},waitForCommitToBeReady:()=>null,NotPendingTransition:null,HostTransitionContext:Y.createContext(null),setCurrentUpdatePriority(s){Uv=s},getCurrentUpdatePriority(){return Uv},resolveUpdatePriority(){var s;if(Uv!==ET)return Uv;switch(typeof window<"u"&&((s=window.event)==null?void 0:s.type)){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return Kv.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return Kv.ContinuousEventPriority;default:return Kv.DefaultEventPriority}},resetFormInstance(){},rendererPackageName:"@react-three/fiber",rendererVersion:QF.version}),od=new Map,Ep={objects:"shallow",strict:!1};function c8(s,e){if(!e&&typeof HTMLCanvasElement<"u"&&s instanceof HTMLCanvasElement&&s.parentElement){const{width:t,height:n,top:i,left:a}=s.parentElement.getBoundingClientRect();return{width:t,height:n,top:i,left:a}}else if(!e&&typeof OffscreenCanvas<"u"&&s instanceof OffscreenCanvas)return{width:s.width,height:s.height,top:0,left:0};return{width:0,height:0,top:0,left:0,...e}}function u8(s){const e=od.get(s),t=e==null?void 0:e.fiber,n=e==null?void 0:e.store;e&&console.warn("R3F.createRoot should only be called once!");const i=typeof reportError=="function"?reportError:console.error,a=n||ZF(Y_,RE),o=t||J1.createContainer(a,Kv.ConcurrentRoot,null,!1,null,"",i,i,i,null);e||od.set(s,{fiber:o,store:a});let c,u,h=!1,m=null;return{async configure(x={}){let g;m=new Promise(I=>g=I);let{gl:b,size:S,scene:C,events:M,onCreated:A,shadows:R=!1,linear:N=!1,flat:B=!1,legacy:F=!1,orthographic:U=!1,frameloop:z="always",dpr:P=[1,2],performance:L,raycaster:O,camera:ee,onPointerMissed:Q}=x,te=a.getState(),ne=te.gl;if(!te.gl){const I={canvas:s,powerPreference:"high-performance",antialias:!0,alpha:!0},W=typeof b=="function"?await b(I):b;ME(W)?ne=W:ne=new YS({...I,...b}),te.set({gl:ne})}let re=te.raycaster;re||te.set({raycaster:re=new zy});const{params:j,...ae}=O||{};if(Na.equ(ae,re,Ep)||Vc(re,{...ae}),Na.equ(j,re.params,Ep)||Vc(re,{params:{...re.params,...j}}),!te.camera||te.camera===u&&!Na.equ(u,ee,Ep)){u=ee;const I=ee==null?void 0:ee.isCamera,W=I?ee:U?new El(0,0,0,0,.1,1e3):new Ba(75,0,.1,1e3);I||(W.position.z=5,ee&&(Vc(W,ee),W.manual||("aspect"in ee||"left"in ee||"right"in ee||"bottom"in ee||"top"in ee)&&(W.manual=!0,W.updateProjectionMatrix())),!te.camera&&!(ee!=null&&ee.rotation)&&W.lookAt(0,0,0)),te.set({camera:W}),re.camera=W}if(!te.scene){let I;C!=null&&C.isScene?(I=C,Y1(I,a,"",{})):(I=new a0,Y1(I,a,"",{}),C&&Vc(I,C)),te.set({scene:I})}M&&!te.events.handlers&&te.set({events:M(a)});const J=c8(s,S);if(Na.equ(J,te.size,Ep)||te.setSize(J.width,J.height,J.top,J.left),P&&te.viewport.dpr!==_T(P)&&te.setDpr(P),te.frameloop!==z&&te.setFrameloop(z),te.onPointerMissed||te.set({onPointerMissed:Q}),L&&!Na.equ(L,te.performance,Ep)&&te.set(I=>({performance:{...I.performance,...L}})),!te.xr){var ie;const I=(Z,me)=>{const $=a.getState();$.frameloop!=="never"&&RE(Z,!0,$,me)},W=()=>{const Z=a.getState();Z.gl.xr.enabled=Z.gl.xr.isPresenting,Z.gl.xr.setAnimationLoop(Z.gl.xr.isPresenting?I:null),Z.gl.xr.isPresenting||Y_(Z)},fe={connect(){const Z=a.getState().gl;Z.xr.addEventListener("sessionstart",W),Z.xr.addEventListener("sessionend",W)},disconnect(){const Z=a.getState().gl;Z.xr.removeEventListener("sessionstart",W),Z.xr.removeEventListener("sessionend",W)}};typeof((ie=ne.xr)==null?void 0:ie.addEventListener)=="function"&&fe.connect(),te.set({xr:fe})}if(ne.shadowMap){const I=ne.shadowMap.enabled,W=ne.shadowMap.type;if(ne.shadowMap.enabled=!!R,Na.boo(R))ne.shadowMap.type=Ym;else if(Na.str(R)){var se;const fe={basic:S3,percentage:iy,soft:Ym,variance:sc};ne.shadowMap.type=(se=fe[R])!=null?se:Ym}else Na.obj(R)&&Object.assign(ne.shadowMap,R);(I!==ne.shadowMap.enabled||W!==ne.shadowMap.type)&&(ne.shadowMap.needsUpdate=!0)}return Ri.enabled=!F,h||(ne.outputColorSpace=N?uc:Hs,ne.toneMapping=B?qc:sS),te.legacy!==F&&te.set(()=>({legacy:F})),te.linear!==N&&te.set(()=>({linear:N})),te.flat!==B&&te.set(()=>({flat:B})),b&&!Na.fun(b)&&!ME(b)&&!Na.equ(b,ne,Ep)&&Vc(ne,b),c=A,h=!0,g(),this},render(x){return!h&&!m&&this.configure(),m.then(()=>{J1.updateContainer(y.jsx(f8,{store:a,children:x,onCreated:c,rootElement:s}),o,null,()=>{})}),a},unmount(){NT(s)}}}function f8({store:s,children:e,onCreated:t,rootElement:n}){return Nx(()=>{const i=s.getState();i.set(a=>({internal:{...a.internal,active:!0}})),t&&t(i),s.getState().events.connected||i.events.connect==null||i.events.connect(n)},[]),y.jsx(ZS.Provider,{value:s,children:e})}function NT(s,e){const t=od.get(s),n=t==null?void 0:t.fiber;if(n){const i=t==null?void 0:t.store.getState();i&&(i.internal.active=!1),J1.updateContainer(null,n,null,()=>{i&&setTimeout(()=>{try{var a,o,c,u;i.events.disconnect==null||i.events.disconnect(),(a=i.gl)==null||(o=a.renderLists)==null||o.dispose==null||o.dispose(),(c=i.gl)==null||c.forceContextLoss==null||c.forceContextLoss(),(u=i.gl)!=null&&u.xr&&i.xr.disconnect(),HF(i.scene),od.delete(s)}catch{}},500)})}}function BT(s,e,t){return y.jsx(h8,{children:s,container:e,state:t})}function h8({state:s={},children:e,container:t}){const{events:n,size:i,...a}=s,o=KS(),[c]=Y.useState(()=>new zy),[u]=Y.useState(()=>new gt),h=JS((x,g)=>{let b;if(g.camera&&i){const S=g.camera;b=x.viewport.getCurrentViewport(S,new k,i),S!==x.camera&&AT(S,i)}return{...x,...g,scene:t,raycaster:c,pointer:u,mouse:u,previousRoot:o,events:{...x.events,...g.events,...n},size:{...x.size,...i},viewport:{...x.viewport,...b},setEvents:S=>g.set(C=>({...C,events:{...C.events,...S}}))}}),m=Y.useMemo(()=>{const x=fT((b,S)=>({...a,set:b,get:S})),g=b=>x.setState(S=>h.current(b,S));return g(o.getState()),o.subscribe(g),x},[o,t]);return y.jsx(y.Fragment,{children:J1.createPortal(y.jsx(ZS.Provider,{value:m,children:e}),m,null)})}const d8=new Set,p8=new Set,m8=new Set;function Q2(s,e){if(s.size)for(const{callback:t}of s.values())t(e)}function ex(s,e){switch(s){case"before":return Q2(d8,e);case"after":return Q2(p8,e);case"tail":return Q2(m8,e)}}let $2,e_;function V_(s,e,t){let n=e.clock.getDelta();e.frameloop==="never"&&typeof s=="number"&&(n=s-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=s),$2=e.internal.subscribers;for(let i=0;i<$2.length;i++)e_=$2[i],e_.ref.current(e_.store.getState(),n,t);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}let Z1=!1,X_=!1,t_,TE,Cp;function DT(s){TE=requestAnimationFrame(DT),Z1=!0,t_=0,ex("before",s),X_=!0;for(const t of od.values()){var e;Cp=t.store.getState(),Cp.internal.active&&(Cp.frameloop==="always"||Cp.internal.frames>0)&&!((e=Cp.gl.xr)!=null&&e.isPresenting)&&(t_+=V_(s,Cp))}if(X_=!1,ex("after",s),t_===0)return ex("tail",s),Z1=!1,cancelAnimationFrame(TE)}function Y_(s,e=1){var t;if(!s)return od.forEach(n=>Y_(n.store.getState(),e));(t=s.gl.xr)!=null&&t.isPresenting||!s.internal.active||s.frameloop==="never"||(e>1?s.internal.frames=Math.min(60,s.internal.frames+e):X_?s.internal.frames=2:s.internal.frames=1,Z1||(Z1=!0,requestAnimationFrame(DT)))}function RE(s,e=!0,t,n){if(e&&ex("before",s),t)V_(s,t,n);else for(const i of od.values())V_(s,i.store.getState());e&&ex("after",s)}const n_={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function x8(s){const{handlePointer:e}=JF(s);return{priority:1,enabled:!0,compute(t,n,i){n.pointer.set(t.offsetX/n.size.width*2-1,-(t.offsetY/n.size.height)*2+1),n.raycaster.setFromCamera(n.pointer,n.camera)},connected:void 0,handlers:Object.keys(n_).reduce((t,n)=>({...t,[n]:e(n)}),{}),update:()=>{var t;const{events:n,internal:i}=s.getState();(t=i.lastEvent)!=null&&t.current&&n.handlers&&n.handlers.onPointerMove(i.lastEvent.current)},connect:t=>{const{set:n,events:i}=s.getState();if(i.disconnect==null||i.disconnect(),n(a=>({events:{...a.events,connected:t}})),i.handlers)for(const a in i.handlers){const o=i.handlers[a],[c,u]=n_[a];t.addEventListener(c,o,{passive:u})}},disconnect:()=>{const{set:t,events:n}=s.getState();if(n.connected){if(n.handlers)for(const i in n.handlers){const a=n.handlers[i],[o]=n_[i];n.connected.removeEventListener(o,a)}t(i=>({events:{...i.events,connected:void 0}}))}}}}function NE(s,e){let t;return(...n)=>{window.clearTimeout(t),t=window.setTimeout(()=>s(...n),e)}}function g8({debounce:s,scroll:e,polyfill:t,offsetSize:n}={debounce:0,scroll:!1,offsetSize:!1}){const i=t||(typeof window>"u"?class{}:window.ResizeObserver);if(!i)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[a,o]=Y.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),c=Y.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:a,orientationHandler:null}),u=s?typeof s=="number"?s:s.scroll:null,h=s?typeof s=="number"?s:s.resize:null,m=Y.useRef(!1);Y.useEffect(()=>(m.current=!0,()=>void(m.current=!1)));const[x,g,b]=Y.useMemo(()=>{const A=()=>{if(!c.current.element)return;const{left:R,top:N,width:B,height:F,bottom:U,right:z,x:P,y:L}=c.current.element.getBoundingClientRect(),O={left:R,top:N,width:B,height:F,bottom:U,right:z,x:P,y:L};c.current.element instanceof HTMLElement&&n&&(O.height=c.current.element.offsetHeight,O.width=c.current.element.offsetWidth),Object.freeze(O),m.current&&!_8(c.current.lastBounds,O)&&o(c.current.lastBounds=O)};return[A,h?NE(A,h):A,u?NE(A,u):A]},[o,n,u,h]);function S(){c.current.scrollContainers&&(c.current.scrollContainers.forEach(A=>A.removeEventListener("scroll",b,!0)),c.current.scrollContainers=null),c.current.resizeObserver&&(c.current.resizeObserver.disconnect(),c.current.resizeObserver=null),c.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",c.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",c.current.orientationHandler))}function C(){c.current.element&&(c.current.resizeObserver=new i(b),c.current.resizeObserver.observe(c.current.element),e&&c.current.scrollContainers&&c.current.scrollContainers.forEach(A=>A.addEventListener("scroll",b,{capture:!0,passive:!0})),c.current.orientationHandler=()=>{b()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",c.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",c.current.orientationHandler))}const M=A=>{!A||A===c.current.element||(S(),c.current.element=A,c.current.scrollContainers=UT(A),C())};return y8(b,!!e),v8(g),Y.useEffect(()=>{S(),C()},[e,b,g]),Y.useEffect(()=>S,[]),[M,a,x]}function v8(s){Y.useEffect(()=>{const e=s;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[s])}function y8(s,e){Y.useEffect(()=>{if(e){const t=s;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",t,!0)}},[s,e])}function UT(s){const e=[];if(!s||s===document.body)return e;const{overflow:t,overflowX:n,overflowY:i}=window.getComputedStyle(s);return[t,n,i].some(a=>a==="auto"||a==="scroll")&&e.push(s),[...e,...UT(s.parentElement)]}const b8=["x","y","top","bottom","left","right","width","height"],_8=(s,e)=>b8.every(t=>s[t]===e[t]);function S8({ref:s,children:e,fallback:t,resize:n,style:i,gl:a,events:o=x8,eventSource:c,eventPrefix:u,shadows:h,linear:m,flat:x,legacy:g,orthographic:b,frameloop:S,dpr:C,performance:M,raycaster:A,camera:R,scene:N,onPointerMissed:B,onCreated:F,...U}){Y.useMemo(()=>QS(lT),[]);const z=FF(),[P,L]=g8({scroll:!0,debounce:{scroll:50,resize:0},...n}),O=Y.useRef(null),ee=Y.useRef(null);Y.useImperativeHandle(s,()=>O.current);const Q=JS(B),[te,ne]=Y.useState(!1),[re,j]=Y.useState(!1);if(te)throw te;if(re)throw re;const ae=Y.useRef(null);Nx(()=>{const ie=O.current;if(L.width>0&&L.height>0&&ie){ae.current||(ae.current=u8(ie));async function se(){await ae.current.configure({gl:a,scene:N,events:o,shadows:h,linear:m,flat:x,legacy:g,orthographic:b,frameloop:S,dpr:C,performance:M,raycaster:A,camera:R,size:L,onPointerMissed:(...I)=>Q.current==null?void 0:Q.current(...I),onCreated:I=>{I.events.connect==null||I.events.connect(c?IF(c)?c.current:c:ee.current),u&&I.setEvents({compute:(W,fe)=>{const Z=W[u+"X"],me=W[u+"Y"];fe.pointer.set(Z/fe.size.width*2-1,-(me/fe.size.height)*2+1),fe.raycaster.setFromCamera(fe.pointer,fe.camera)}}),F==null||F(I)}}),ae.current.render(y.jsx(z,{children:y.jsx(GF,{set:j,children:y.jsx(Y.Suspense,{fallback:y.jsx(PF,{set:ne}),children:e??null})})}))}se()}}),Y.useEffect(()=>{const ie=O.current;if(ie)return()=>NT(ie)},[]);const J=c?"none":"auto";return y.jsx("div",{ref:ee,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:J,...i},...U,children:y.jsx("div",{ref:P,style:{width:"100%",height:"100%"},children:y.jsx("canvas",{ref:O,style:{display:"block"},children:t})})})}function A8(s){return y.jsx(gT,{children:y.jsx(S8,{...s})})}function fo(){return fo=Object.assign?Object.assign.bind():function(s){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(s[n]=t[n])}return s},fo.apply(null,arguments)}const Bx=new k,eA=new k,M8=new k,BE=new gt;function w8(s,e,t){const n=Bx.setFromMatrixPosition(s.matrixWorld);n.project(e);const i=t.width/2,a=t.height/2;return[n.x*i+i,-(n.y*a)+a]}function E8(s,e){const t=Bx.setFromMatrixPosition(s.matrixWorld),n=eA.setFromMatrixPosition(e.matrixWorld),i=t.sub(n),a=e.getWorldDirection(M8);return i.angleTo(a)>Math.PI/2}function C8(s,e,t,n){const i=Bx.setFromMatrixPosition(s.matrixWorld),a=i.clone();a.project(e),BE.set(a.x,a.y),t.setFromCamera(BE,e);const o=t.intersectObjects(n,!0);if(o.length){const c=o[0].distance;return i.distanceTo(t.ray.origin)<c}return!0}function T8(s,e){if(e instanceof El)return e.zoom;if(e instanceof Ba){const t=Bx.setFromMatrixPosition(s.matrixWorld),n=eA.setFromMatrixPosition(e.matrixWorld),i=e.fov*Math.PI/180,a=t.distanceTo(n);return 1/(2*Math.tan(i/2)*a)}else return 1}function R8(s,e,t){if(e instanceof Ba||e instanceof El){const n=Bx.setFromMatrixPosition(s.matrixWorld),i=eA.setFromMatrixPosition(e.matrixWorld),a=n.distanceTo(i),o=(t[1]-t[0])/(e.far-e.near),c=t[1]-o*e.far;return Math.round(o*a+c)}}const W_=s=>Math.abs(s)<1e-10?0:s;function LT(s,e,t=""){let n="matrix3d(";for(let i=0;i!==16;i++)n+=W_(e[i]*s.elements[i])+(i!==15?",":")");return t+n}const N8=(s=>e=>LT(e,s))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),B8=(s=>(e,t)=>LT(e,s(t),"translate(-50%,-50%)"))(s=>[1/s,1/s,1/s,1,-1/s,-1/s,-1/s,-1,1/s,1/s,1/s,1,1,1,1,1]);function D8(s){return s&&typeof s=="object"&&"current"in s}const tA=Y.forwardRef(({children:s,eps:e=.001,style:t,className:n,prepend:i,center:a,fullscreen:o,portal:c,distanceFactor:u,sprite:h=!1,transform:m=!1,occlude:x,onOcclude:g,castShadow:b,receiveShadow:S,material:C,geometry:M,zIndexRange:A=[16777271,0],calculatePosition:R=w8,as:N="div",wrapperClass:B,pointerEvents:F="auto",...U},z)=>{const{gl:P,camera:L,scene:O,size:ee,raycaster:Q,events:te,viewport:ne}=ti(),[re]=Y.useState(()=>document.createElement(N)),j=Y.useRef(null),ae=Y.useRef(null),J=Y.useRef(0),ie=Y.useRef([0,0]),se=Y.useRef(null),I=Y.useRef(null),W=(c==null?void 0:c.current)||te.connected||P.domElement.parentNode,fe=Y.useRef(null),Z=Y.useRef(!1),me=Y.useMemo(()=>x&&x!=="blending"||Array.isArray(x)&&x.length&&D8(x[0]),[x]);Y.useLayoutEffect(()=>{const Ge=P.domElement;x&&x==="blending"?(Ge.style.zIndex=`${Math.floor(A[0]/2)}`,Ge.style.position="absolute",Ge.style.pointerEvents="none"):(Ge.style.zIndex=null,Ge.style.position=null,Ge.style.pointerEvents=null)},[x]),Y.useLayoutEffect(()=>{if(ae.current){const Ge=j.current=y3.createRoot(re);if(O.updateMatrixWorld(),m)re.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const Fe=R(ae.current,L,ee);re.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${Fe[0]}px,${Fe[1]}px,0);transform-origin:0 0;`}return W&&(i?W.prepend(re):W.appendChild(re)),()=>{W&&W.removeChild(re),Ge.unmount()}}},[W,m]),Y.useLayoutEffect(()=>{B&&(re.className=B)},[B]);const $=Y.useMemo(()=>m?{position:"absolute",top:0,left:0,width:ee.width,height:ee.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:a?"translate3d(-50%,-50%,0)":"none",...o&&{top:-ee.height/2,left:-ee.width/2,width:ee.width,height:ee.height},...t},[t,a,o,ee,m]),pe=Y.useMemo(()=>({position:"absolute",pointerEvents:F}),[F]);Y.useLayoutEffect(()=>{if(Z.current=!1,m){var Ge;(Ge=j.current)==null||Ge.render(Y.createElement("div",{ref:se,style:$},Y.createElement("div",{ref:I,style:pe},Y.createElement("div",{ref:z,className:n,style:t,children:s}))))}else{var Fe;(Fe=j.current)==null||Fe.render(Y.createElement("div",{ref:z,style:$,className:n,children:s}))}});const ve=Y.useRef(!0);Rl(Ge=>{if(ae.current){L.updateMatrixWorld(),ae.current.updateWorldMatrix(!0,!1);const Fe=m?ie.current:R(ae.current,L,ee);if(m||Math.abs(J.current-L.zoom)>e||Math.abs(ie.current[0]-Fe[0])>e||Math.abs(ie.current[1]-Fe[1])>e){const Qe=E8(ae.current,L);let lt=!1;me&&(Array.isArray(x)?lt=x.map(Ze=>Ze.current):x!=="blending"&&(lt=[O]));const De=ve.current;if(lt){const Ze=C8(ae.current,L,Q,lt);ve.current=Ze&&!Qe}else ve.current=!Qe;De!==ve.current&&(g?g(!ve.current):re.style.display=ve.current?"block":"none");const le=Math.floor(A[0]/2),Ye=x?me?[A[0],le]:[le-1,0]:A;if(re.style.zIndex=`${R8(ae.current,L,Ye)}`,m){const[Ze,je]=[ee.width/2,ee.height/2],He=L.projectionMatrix.elements[5]*je,{isOrthographicCamera:et,top:Ne,left:st,bottom:oe,right:X}=L,Ae=N8(L.matrixWorldInverse),Pe=et?`scale(${He})translate(${W_(-(X+st)/2)}px,${W_((Ne+oe)/2)}px)`:`translateZ(${He}px)`;let Ue=ae.current.matrixWorld;h&&(Ue=L.matrixWorldInverse.clone().transpose().copyPosition(Ue).scale(ae.current.scale),Ue.elements[3]=Ue.elements[7]=Ue.elements[11]=0,Ue.elements[15]=1),re.style.width=ee.width+"px",re.style.height=ee.height+"px",re.style.perspective=et?"":`${He}px`,se.current&&I.current&&(se.current.style.transform=`${Pe}${Ae}translate(${Ze}px,${je}px)`,I.current.style.transform=B8(Ue,1/((u||10)/400)))}else{const Ze=u===void 0?1:T8(ae.current,L)*u;re.style.transform=`translate3d(${Fe[0]}px,${Fe[1]}px,0) scale(${Ze})`}ie.current=Fe,J.current=L.zoom}}if(!me&&fe.current&&!Z.current)if(m){if(se.current){const Fe=se.current.children[0];if(Fe!=null&&Fe.clientWidth&&Fe!=null&&Fe.clientHeight){const{isOrthographicCamera:Qe}=L;if(Qe||M)U.scale&&(Array.isArray(U.scale)?U.scale instanceof k?fe.current.scale.copy(U.scale.clone().divideScalar(1)):fe.current.scale.set(1/U.scale[0],1/U.scale[1],1/U.scale[2]):fe.current.scale.setScalar(1/U.scale));else{const lt=(u||10)/400,De=Fe.clientWidth*lt,le=Fe.clientHeight*lt;fe.current.scale.set(De,le,1)}Z.current=!0}}}else{const Fe=re.children[0];if(Fe!=null&&Fe.clientWidth&&Fe!=null&&Fe.clientHeight){const Qe=1/ne.factor,lt=Fe.clientWidth*Qe,De=Fe.clientHeight*Qe;fe.current.scale.set(lt,De,1),Z.current=!0}fe.current.lookAt(Ge.camera.position)}});const ze=Y.useMemo(()=>({vertexShader:m?void 0:`
          /*
            This shader is from the THREE's SpriteMaterial.
            We need to turn the backing plane into a Sprite
            (make it always face the camera) if "transfrom"
            is false.
          */
          #include <common>

          void main() {
            vec2 center = vec2(0., 1.);
            float rotation = 0.0;

            // This is somewhat arbitrary, but it seems to work well
            // Need to figure out how to derive this dynamically if it even matters
            float size = 0.03;

            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
            vec2 scale;
            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

            bool isPerspective = isPerspectiveMatrix( projectionMatrix );
            if ( isPerspective ) scale *= - mvPosition.z;

            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
            vec2 rotatedPosition;
            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
            mvPosition.xy += rotatedPosition;

            gl_Position = projectionMatrix * mvPosition;
          }
      `,fragmentShader:`
        void main() {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `}),[m]);return Y.createElement("group",fo({},U,{ref:ae}),x&&!me&&Y.createElement("mesh",{castShadow:b,receiveShadow:S,ref:fe},M||Y.createElement("planeGeometry",null),C||Y.createElement("shaderMaterial",{side:Oi,vertexShader:ze.vertexShader,fragmentShader:ze.fragmentShader})))});function U8(s,e="pointer",t="auto",n=document.body){Y.useEffect(()=>{if(s)return n.style.cursor=e,()=>void(n.style.cursor=t)},[s])}const Dx=parseInt(n0.replace(/\D+/g,"")),OT=Dx>=125?"uv1":"uv2";function DE(s,e){if(e===Q3)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),s;if(e===P1||e===fS){let t=s.getIndex();if(t===null){const o=[],c=s.getAttribute("position");if(c!==void 0){for(let u=0;u<c.count;u++)o.push(u);s.setIndex(o),t=s.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),s}const n=t.count-2,i=[];if(t)if(e===P1)for(let o=1;o<=n;o++)i.push(t.getX(0)),i.push(t.getX(o)),i.push(t.getX(o+1));else for(let o=0;o<n;o++)o%2===0?(i.push(t.getX(o)),i.push(t.getX(o+1)),i.push(t.getX(o+2))):(i.push(t.getX(o+2)),i.push(t.getX(o+1)),i.push(t.getX(o)));i.length/3!==n&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const a=s.clone();return a.setIndex(i),a.clearGroups(),a}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),s}var Sl=Uint8Array,Bf=Uint16Array,q_=Uint32Array,IT=new Sl([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),zT=new Sl([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),L8=new Sl([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),FT=function(s,e){for(var t=new Bf(31),n=0;n<31;++n)t[n]=e+=1<<s[n-1];for(var i=new q_(t[30]),n=1;n<30;++n)for(var a=t[n];a<t[n+1];++a)i[a]=a-t[n]<<5|n;return[t,i]},PT=FT(IT,2),GT=PT[0],O8=PT[1];GT[28]=258,O8[258]=28;var I8=FT(zT,0),z8=I8[0],J_=new Bf(32768);for(var Sa=0;Sa<32768;++Sa){var Af=(Sa&43690)>>>1|(Sa&21845)<<1;Af=(Af&52428)>>>2|(Af&13107)<<2,Af=(Af&61680)>>>4|(Af&3855)<<4,J_[Sa]=((Af&65280)>>>8|(Af&255)<<8)>>>1}var tx=(function(s,e,t){for(var n=s.length,i=0,a=new Bf(e);i<n;++i)++a[s[i]-1];var o=new Bf(e);for(i=0;i<e;++i)o[i]=o[i-1]+a[i-1]<<1;var c;if(t){c=new Bf(1<<e);var u=15-e;for(i=0;i<n;++i)if(s[i])for(var h=i<<4|s[i],m=e-s[i],x=o[s[i]-1]++<<m,g=x|(1<<m)-1;x<=g;++x)c[J_[x]>>>u]=h}else for(c=new Bf(n),i=0;i<n;++i)s[i]&&(c[i]=J_[o[s[i]-1]++]>>>15-s[i]);return c}),Ux=new Sl(288);for(var Sa=0;Sa<144;++Sa)Ux[Sa]=8;for(var Sa=144;Sa<256;++Sa)Ux[Sa]=9;for(var Sa=256;Sa<280;++Sa)Ux[Sa]=7;for(var Sa=280;Sa<288;++Sa)Ux[Sa]=8;var jT=new Sl(32);for(var Sa=0;Sa<32;++Sa)jT[Sa]=5;var F8=tx(Ux,9,1),P8=tx(jT,5,1),i_=function(s){for(var e=s[0],t=1;t<s.length;++t)s[t]>e&&(e=s[t]);return e},ac=function(s,e,t){var n=e/8|0;return(s[n]|s[n+1]<<8)>>(e&7)&t},a_=function(s,e){var t=e/8|0;return(s[t]|s[t+1]<<8|s[t+2]<<16)>>(e&7)},G8=function(s){return(s/8|0)+(s&7&&1)},j8=function(s,e,t){(t==null||t>s.length)&&(t=s.length);var n=new(s instanceof Bf?Bf:s instanceof q_?q_:Sl)(t-e);return n.set(s.subarray(e,t)),n},H8=function(s,e,t){var n=s.length;if(!n||t&&!t.l&&n<5)return e||new Sl(0);var i=!e||t,a=!t||t.i;t||(t={}),e||(e=new Sl(n*3));var o=function($){var pe=e.length;if($>pe){var ve=new Sl(Math.max(pe*2,$));ve.set(e),e=ve}},c=t.f||0,u=t.p||0,h=t.b||0,m=t.l,x=t.d,g=t.m,b=t.n,S=n*8;do{if(!m){t.f=c=ac(s,u,1);var C=ac(s,u+1,3);if(u+=3,C)if(C==1)m=F8,x=P8,g=9,b=5;else if(C==2){var N=ac(s,u,31)+257,B=ac(s,u+10,15)+4,F=N+ac(s,u+5,31)+1;u+=14;for(var U=new Sl(F),z=new Sl(19),P=0;P<B;++P)z[L8[P]]=ac(s,u+P*3,7);u+=B*3;for(var L=i_(z),O=(1<<L)-1,ee=tx(z,L,1),P=0;P<F;){var Q=ee[ac(s,u,O)];u+=Q&15;var M=Q>>>4;if(M<16)U[P++]=M;else{var te=0,ne=0;for(M==16?(ne=3+ac(s,u,3),u+=2,te=U[P-1]):M==17?(ne=3+ac(s,u,7),u+=3):M==18&&(ne=11+ac(s,u,127),u+=7);ne--;)U[P++]=te}}var re=U.subarray(0,N),j=U.subarray(N);g=i_(re),b=i_(j),m=tx(re,g,1),x=tx(j,b,1)}else throw"invalid block type";else{var M=G8(u)+4,A=s[M-4]|s[M-3]<<8,R=M+A;if(R>n){if(a)throw"unexpected EOF";break}i&&o(h+A),e.set(s.subarray(M,R),h),t.b=h+=A,t.p=u=R*8;continue}if(u>S){if(a)throw"unexpected EOF";break}}i&&o(h+131072);for(var ae=(1<<g)-1,J=(1<<b)-1,ie=u;;ie=u){var te=m[a_(s,u)&ae],se=te>>>4;if(u+=te&15,u>S){if(a)throw"unexpected EOF";break}if(!te)throw"invalid length/literal";if(se<256)e[h++]=se;else if(se==256){ie=u,m=null;break}else{var I=se-254;if(se>264){var P=se-257,W=IT[P];I=ac(s,u,(1<<W)-1)+GT[P],u+=W}var fe=x[a_(s,u)&J],Z=fe>>>4;if(!fe)throw"invalid distance";u+=fe&15;var j=z8[Z];if(Z>3){var W=zT[Z];j+=a_(s,u)&(1<<W)-1,u+=W}if(u>S){if(a)throw"unexpected EOF";break}i&&o(h+131072);for(var me=h+I;h<me;h+=4)e[h]=e[h-j],e[h+1]=e[h+1-j],e[h+2]=e[h+2-j],e[h+3]=e[h+3-j];h=me}}t.l=m,t.p=ie,t.b=h,m&&(c=1,t.m=g,t.d=x,t.n=b)}while(!c);return h==e.length?e:j8(e,0,h)},k8=new Sl(0),V8=function(s){if((s[0]&15)!=8||s[0]>>>4>7||(s[0]<<8|s[1])%31)throw"invalid zlib data";if(s[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function Lv(s,e){return H8((V8(s),s.subarray(2,-4)),e)}var X8=typeof TextDecoder<"u"&&new TextDecoder,Y8=0;try{X8.decode(k8,{stream:!0}),Y8=1}catch{}const W8=s=>s&&s.isCubeTexture;class q8 extends sn{constructor(e,t){var n,i;const a=W8(e),c=((i=a?(n=e.image[0])==null?void 0:n.width:e.image.width)!=null?i:1024)/4,u=Math.floor(Math.log2(c)),h=Math.pow(2,u),m=3*Math.max(h,112),x=4*h,g=[a?"#define ENVMAP_TYPE_CUBE":"",`#define CUBEUV_TEXEL_WIDTH ${1/m}`,`#define CUBEUV_TEXEL_HEIGHT ${1/x}`,`#define CUBEUV_MAX_MIP ${u}.0`],b=`
        varying vec3 vWorldPosition;
        void main() 
        {
            vec4 worldPosition = ( modelMatrix * vec4( position, 1.0 ) );
            vWorldPosition = worldPosition.xyz;
            
            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }
        `,S=g.join(`
`)+`
        #define ENVMAP_TYPE_CUBE_UV
        varying vec3 vWorldPosition;
        uniform float radius;
        uniform float height;
        uniform float angle;
        #ifdef ENVMAP_TYPE_CUBE
            uniform samplerCube map;
        #else
            uniform sampler2D map;
        #endif
        // From: https://www.shadertoy.com/view/4tsBD7
        float diskIntersectWithBackFaceCulling( vec3 ro, vec3 rd, vec3 c, vec3 n, float r ) 
        {
            float d = dot ( rd, n );
            
            if( d > 0.0 ) { return 1e6; }
            
            vec3  o = ro - c;
            float t = - dot( n, o ) / d;
            vec3  q = o + rd * t;
            
            return ( dot( q, q ) < r * r ) ? t : 1e6;
        }
        // From: https://www.iquilezles.org/www/articles/intersectors/intersectors.htm
        float sphereIntersect( vec3 ro, vec3 rd, vec3 ce, float ra ) 
        {
            vec3 oc = ro - ce;
            float b = dot( oc, rd );
            float c = dot( oc, oc ) - ra * ra;
            float h = b * b - c;
            
            if( h < 0.0 ) { return -1.0; }
            
            h = sqrt( h );
            
            return - b + h;
        }
        vec3 project() 
        {
            vec3 p = normalize( vWorldPosition );
            vec3 camPos = cameraPosition;
            camPos.y -= height;
            float intersection = sphereIntersect( camPos, p, vec3( 0.0 ), radius );
            if( intersection > 0.0 ) {
                
                vec3 h = vec3( 0.0, - height, 0.0 );
                float intersection2 = diskIntersectWithBackFaceCulling( camPos, p, h, vec3( 0.0, 1.0, 0.0 ), radius );
                p = ( camPos + min( intersection, intersection2 ) * p ) / radius;
            } else {
                p = vec3( 0.0, 1.0, 0.0 );
            }
            return p;
        }
        #include <common>
        #include <cube_uv_reflection_fragment>
        void main() 
        {
            vec3 projectedWorldPosition = project();
            
            #ifdef ENVMAP_TYPE_CUBE
                vec3 outcolor = textureCube( map, projectedWorldPosition ).rgb;
            #else
                vec3 direction = normalize( projectedWorldPosition );
                vec2 uv = equirectUv( direction );
                vec3 outcolor = texture2D( map, uv ).rgb;
            #endif
            gl_FragColor = vec4( outcolor, 1.0 );
            #include <tonemapping_fragment>
            #include <${Dx>=154?"colorspace_fragment":"encodings_fragment"}>
        }
        `,C={map:{value:e},height:{value:(t==null?void 0:t.height)||15},radius:{value:(t==null?void 0:t.radius)||100}},M=new Tx(1,16),A=new Ys({uniforms:C,fragmentShader:S,vertexShader:b,side:Oi});super(M,A)}set radius(e){this.material.uniforms.radius.value=e}get radius(){return this.material.uniforms.radius.value}set height(e){this.material.uniforms.height.value=e}get height(){return this.material.uniforms.height.value}}var J8=Object.defineProperty,Z8=(s,e,t)=>e in s?J8(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,K8=(s,e,t)=>(Z8(s,e+"",t),t);class Q8{constructor(){K8(this,"_listeners")}addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const n=this._listeners;return n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const i=this._listeners[e];if(i!==void 0){const a=i.indexOf(t);a!==-1&&i.splice(a,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const n=this._listeners[e.type];if(n!==void 0){e.target=this;const i=n.slice(0);for(let a=0,o=i.length;a<o;a++)i[a].call(this,e);e.target=null}}}var $8=Object.defineProperty,eP=(s,e,t)=>e in s?$8(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,_t=(s,e,t)=>(eP(s,typeof e!="symbol"?e+"":e,t),t);let tP=class extends ai{constructor(e,t){super(),_t(this,"isTransformControls",!0),_t(this,"visible",!1),_t(this,"domElement"),_t(this,"raycaster",new zy),_t(this,"gizmo"),_t(this,"plane"),_t(this,"tempVector",new k),_t(this,"tempVector2",new k),_t(this,"tempQuaternion",new Fn),_t(this,"unit",{X:new k(1,0,0),Y:new k(0,1,0),Z:new k(0,0,1)}),_t(this,"pointStart",new k),_t(this,"pointEnd",new k),_t(this,"offset",new k),_t(this,"rotationAxis",new k),_t(this,"startNorm",new k),_t(this,"endNorm",new k),_t(this,"rotationAngle",0),_t(this,"cameraPosition",new k),_t(this,"cameraQuaternion",new Fn),_t(this,"cameraScale",new k),_t(this,"parentPosition",new k),_t(this,"parentQuaternion",new Fn),_t(this,"parentQuaternionInv",new Fn),_t(this,"parentScale",new k),_t(this,"worldPositionStart",new k),_t(this,"worldQuaternionStart",new Fn),_t(this,"worldScaleStart",new k),_t(this,"worldPosition",new k),_t(this,"worldQuaternion",new Fn),_t(this,"worldQuaternionInv",new Fn),_t(this,"worldScale",new k),_t(this,"eye",new k),_t(this,"positionStart",new k),_t(this,"quaternionStart",new Fn),_t(this,"scaleStart",new k),_t(this,"camera"),_t(this,"object"),_t(this,"enabled",!0),_t(this,"axis",null),_t(this,"mode","translate"),_t(this,"translationSnap",null),_t(this,"rotationSnap",null),_t(this,"scaleSnap",null),_t(this,"space","world"),_t(this,"size",1),_t(this,"dragging",!1),_t(this,"showX",!0),_t(this,"showY",!0),_t(this,"showZ",!0),_t(this,"changeEvent",{type:"change"}),_t(this,"mouseDownEvent",{type:"mouseDown",mode:this.mode}),_t(this,"mouseUpEvent",{type:"mouseUp",mode:this.mode}),_t(this,"objectChangeEvent",{type:"objectChange"}),_t(this,"intersectObjectWithRay",(i,a,o)=>{const c=a.intersectObject(i,!0);for(let u=0;u<c.length;u++)if(c[u].object.visible||o)return c[u];return!1}),_t(this,"attach",i=>(this.object=i,this.visible=!0,this)),_t(this,"detach",()=>(this.object=void 0,this.visible=!1,this.axis=null,this)),_t(this,"reset",()=>this.enabled?(this.dragging&&this.object!==void 0&&(this.object.position.copy(this.positionStart),this.object.quaternion.copy(this.quaternionStart),this.object.scale.copy(this.scaleStart),this.dispatchEvent(this.changeEvent),this.dispatchEvent(this.objectChangeEvent),this.pointStart.copy(this.pointEnd)),this):this),_t(this,"updateMatrixWorld",()=>{this.object!==void 0&&(this.object.updateMatrixWorld(),this.object.parent===null?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):this.object.parent.matrixWorld.decompose(this.parentPosition,this.parentQuaternion,this.parentScale),this.object.matrixWorld.decompose(this.worldPosition,this.worldQuaternion,this.worldScale),this.parentQuaternionInv.copy(this.parentQuaternion).invert(),this.worldQuaternionInv.copy(this.worldQuaternion).invert()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(this.cameraPosition,this.cameraQuaternion,this.cameraScale),this.eye.copy(this.cameraPosition).sub(this.worldPosition).normalize(),super.updateMatrixWorld()}),_t(this,"pointerHover",i=>{if(this.object===void 0||this.dragging===!0)return;this.raycaster.setFromCamera(i,this.camera);const a=this.intersectObjectWithRay(this.gizmo.picker[this.mode],this.raycaster);a?this.axis=a.object.name:this.axis=null}),_t(this,"pointerDown",i=>{if(!(this.object===void 0||this.dragging===!0||i.button!==0)&&this.axis!==null){this.raycaster.setFromCamera(i,this.camera);const a=this.intersectObjectWithRay(this.plane,this.raycaster,!0);if(a){let o=this.space;if(this.mode==="scale"?o="local":(this.axis==="E"||this.axis==="XYZE"||this.axis==="XYZ")&&(o="world"),o==="local"&&this.mode==="rotate"){const c=this.rotationSnap;this.axis==="X"&&c&&(this.object.rotation.x=Math.round(this.object.rotation.x/c)*c),this.axis==="Y"&&c&&(this.object.rotation.y=Math.round(this.object.rotation.y/c)*c),this.axis==="Z"&&c&&(this.object.rotation.z=Math.round(this.object.rotation.z/c)*c)}this.object.updateMatrixWorld(),this.object.parent&&this.object.parent.updateMatrixWorld(),this.positionStart.copy(this.object.position),this.quaternionStart.copy(this.object.quaternion),this.scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this.worldScaleStart),this.pointStart.copy(a.point).sub(this.worldPositionStart)}this.dragging=!0,this.mouseDownEvent.mode=this.mode,this.dispatchEvent(this.mouseDownEvent)}}),_t(this,"pointerMove",i=>{const a=this.axis,o=this.mode,c=this.object;let u=this.space;if(o==="scale"?u="local":(a==="E"||a==="XYZE"||a==="XYZ")&&(u="world"),c===void 0||a===null||this.dragging===!1||i.button!==-1)return;this.raycaster.setFromCamera(i,this.camera);const h=this.intersectObjectWithRay(this.plane,this.raycaster,!0);if(h){if(this.pointEnd.copy(h.point).sub(this.worldPositionStart),o==="translate")this.offset.copy(this.pointEnd).sub(this.pointStart),u==="local"&&a!=="XYZ"&&this.offset.applyQuaternion(this.worldQuaternionInv),a.indexOf("X")===-1&&(this.offset.x=0),a.indexOf("Y")===-1&&(this.offset.y=0),a.indexOf("Z")===-1&&(this.offset.z=0),u==="local"&&a!=="XYZ"?this.offset.applyQuaternion(this.quaternionStart).divide(this.parentScale):this.offset.applyQuaternion(this.parentQuaternionInv).divide(this.parentScale),c.position.copy(this.offset).add(this.positionStart),this.translationSnap&&(u==="local"&&(c.position.applyQuaternion(this.tempQuaternion.copy(this.quaternionStart).invert()),a.search("X")!==-1&&(c.position.x=Math.round(c.position.x/this.translationSnap)*this.translationSnap),a.search("Y")!==-1&&(c.position.y=Math.round(c.position.y/this.translationSnap)*this.translationSnap),a.search("Z")!==-1&&(c.position.z=Math.round(c.position.z/this.translationSnap)*this.translationSnap),c.position.applyQuaternion(this.quaternionStart)),u==="world"&&(c.parent&&c.position.add(this.tempVector.setFromMatrixPosition(c.parent.matrixWorld)),a.search("X")!==-1&&(c.position.x=Math.round(c.position.x/this.translationSnap)*this.translationSnap),a.search("Y")!==-1&&(c.position.y=Math.round(c.position.y/this.translationSnap)*this.translationSnap),a.search("Z")!==-1&&(c.position.z=Math.round(c.position.z/this.translationSnap)*this.translationSnap),c.parent&&c.position.sub(this.tempVector.setFromMatrixPosition(c.parent.matrixWorld))));else if(o==="scale"){if(a.search("XYZ")!==-1){let m=this.pointEnd.length()/this.pointStart.length();this.pointEnd.dot(this.pointStart)<0&&(m*=-1),this.tempVector2.set(m,m,m)}else this.tempVector.copy(this.pointStart),this.tempVector2.copy(this.pointEnd),this.tempVector.applyQuaternion(this.worldQuaternionInv),this.tempVector2.applyQuaternion(this.worldQuaternionInv),this.tempVector2.divide(this.tempVector),a.search("X")===-1&&(this.tempVector2.x=1),a.search("Y")===-1&&(this.tempVector2.y=1),a.search("Z")===-1&&(this.tempVector2.z=1);c.scale.copy(this.scaleStart).multiply(this.tempVector2),this.scaleSnap&&this.object&&(a.search("X")!==-1&&(this.object.scale.x=Math.round(c.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),a.search("Y")!==-1&&(c.scale.y=Math.round(c.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),a.search("Z")!==-1&&(c.scale.z=Math.round(c.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if(o==="rotate"){this.offset.copy(this.pointEnd).sub(this.pointStart);const m=20/this.worldPosition.distanceTo(this.tempVector.setFromMatrixPosition(this.camera.matrixWorld));a==="E"?(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this.startNorm.copy(this.pointStart).normalize(),this.endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=this.endNorm.cross(this.startNorm).dot(this.eye)<0?1:-1):a==="XYZE"?(this.rotationAxis.copy(this.offset).cross(this.eye).normalize(),this.rotationAngle=this.offset.dot(this.tempVector.copy(this.rotationAxis).cross(this.eye))*m):(a==="X"||a==="Y"||a==="Z")&&(this.rotationAxis.copy(this.unit[a]),this.tempVector.copy(this.unit[a]),u==="local"&&this.tempVector.applyQuaternion(this.worldQuaternion),this.rotationAngle=this.offset.dot(this.tempVector.cross(this.eye).normalize())*m),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),u==="local"&&a!=="E"&&a!=="XYZE"?(c.quaternion.copy(this.quaternionStart),c.quaternion.multiply(this.tempQuaternion.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this.parentQuaternionInv),c.quaternion.copy(this.tempQuaternion.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),c.quaternion.multiply(this.quaternionStart).normalize())}this.dispatchEvent(this.changeEvent),this.dispatchEvent(this.objectChangeEvent)}}),_t(this,"pointerUp",i=>{i.button===0&&(this.dragging&&this.axis!==null&&(this.mouseUpEvent.mode=this.mode,this.dispatchEvent(this.mouseUpEvent)),this.dragging=!1,this.axis=null)}),_t(this,"getPointer",i=>{var a;if(this.domElement&&((a=this.domElement.ownerDocument)!=null&&a.pointerLockElement))return{x:0,y:0,button:i.button};{const o=i.changedTouches?i.changedTouches[0]:i,c=this.domElement.getBoundingClientRect();return{x:(o.clientX-c.left)/c.width*2-1,y:-(o.clientY-c.top)/c.height*2+1,button:i.button}}}),_t(this,"onPointerHover",i=>{if(this.enabled)switch(i.pointerType){case"mouse":case"pen":this.pointerHover(this.getPointer(i));break}}),_t(this,"onPointerDown",i=>{!this.enabled||!this.domElement||(this.domElement.style.touchAction="none",this.domElement.ownerDocument.addEventListener("pointermove",this.onPointerMove),this.pointerHover(this.getPointer(i)),this.pointerDown(this.getPointer(i)))}),_t(this,"onPointerMove",i=>{this.enabled&&this.pointerMove(this.getPointer(i))}),_t(this,"onPointerUp",i=>{!this.enabled||!this.domElement||(this.domElement.style.touchAction="",this.domElement.ownerDocument.removeEventListener("pointermove",this.onPointerMove),this.pointerUp(this.getPointer(i)))}),_t(this,"getMode",()=>this.mode),_t(this,"setMode",i=>{this.mode=i}),_t(this,"setTranslationSnap",i=>{this.translationSnap=i}),_t(this,"setRotationSnap",i=>{this.rotationSnap=i}),_t(this,"setScaleSnap",i=>{this.scaleSnap=i}),_t(this,"setSize",i=>{this.size=i}),_t(this,"setSpace",i=>{this.space=i}),_t(this,"update",()=>{console.warn("THREE.TransformControls: update function has no more functionality and therefore has been deprecated.")}),_t(this,"connect",i=>{i===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.domElement=i,this.domElement.addEventListener("pointerdown",this.onPointerDown),this.domElement.addEventListener("pointermove",this.onPointerHover),this.domElement.ownerDocument.addEventListener("pointerup",this.onPointerUp)}),_t(this,"dispose",()=>{var i,a,o,c,u,h;(i=this.domElement)==null||i.removeEventListener("pointerdown",this.onPointerDown),(a=this.domElement)==null||a.removeEventListener("pointermove",this.onPointerHover),(c=(o=this.domElement)==null?void 0:o.ownerDocument)==null||c.removeEventListener("pointermove",this.onPointerMove),(h=(u=this.domElement)==null?void 0:u.ownerDocument)==null||h.removeEventListener("pointerup",this.onPointerUp),this.traverse(m=>{const x=m;x.geometry&&x.geometry.dispose(),x.material&&x.material.dispose()})}),this.domElement=t,this.camera=e,this.gizmo=new nP,this.add(this.gizmo),this.plane=new iP,this.add(this.plane);const n=(i,a)=>{let o=a;Object.defineProperty(this,i,{get:function(){return o!==void 0?o:a},set:function(c){o!==c&&(o=c,this.plane[i]=c,this.gizmo[i]=c,this.dispatchEvent({type:i+"-changed",value:c}),this.dispatchEvent(this.changeEvent))}}),this[i]=a,this.plane[i]=a,this.gizmo[i]=a};n("camera",this.camera),n("object",this.object),n("enabled",this.enabled),n("axis",this.axis),n("mode",this.mode),n("translationSnap",this.translationSnap),n("rotationSnap",this.rotationSnap),n("scaleSnap",this.scaleSnap),n("space",this.space),n("size",this.size),n("dragging",this.dragging),n("showX",this.showX),n("showY",this.showY),n("showZ",this.showZ),n("worldPosition",this.worldPosition),n("worldPositionStart",this.worldPositionStart),n("worldQuaternion",this.worldQuaternion),n("worldQuaternionStart",this.worldQuaternionStart),n("cameraPosition",this.cameraPosition),n("cameraQuaternion",this.cameraQuaternion),n("pointStart",this.pointStart),n("pointEnd",this.pointEnd),n("rotationAxis",this.rotationAxis),n("rotationAngle",this.rotationAngle),n("eye",this.eye),t!==void 0&&this.connect(t)}};class nP extends ai{constructor(){super(),_t(this,"isTransformControlsGizmo",!0),_t(this,"type","TransformControlsGizmo"),_t(this,"tempVector",new k(0,0,0)),_t(this,"tempEuler",new hi),_t(this,"alignVector",new k(0,1,0)),_t(this,"zeroVector",new k(0,0,0)),_t(this,"lookAtMatrix",new wn),_t(this,"tempQuaternion",new Fn),_t(this,"tempQuaternion2",new Fn),_t(this,"identityQuaternion",new Fn),_t(this,"unitX",new k(1,0,0)),_t(this,"unitY",new k(0,1,0)),_t(this,"unitZ",new k(0,0,1)),_t(this,"gizmo"),_t(this,"picker"),_t(this,"helper"),_t(this,"rotationAxis",new k),_t(this,"cameraPosition",new k),_t(this,"worldPositionStart",new k),_t(this,"worldQuaternionStart",new Fn),_t(this,"worldPosition",new k),_t(this,"worldQuaternion",new Fn),_t(this,"eye",new k),_t(this,"camera",null),_t(this,"enabled",!0),_t(this,"axis",null),_t(this,"mode","translate"),_t(this,"space","world"),_t(this,"size",1),_t(this,"dragging",!1),_t(this,"showX",!0),_t(this,"showY",!0),_t(this,"showZ",!0),_t(this,"updateMatrixWorld",()=>{let se=this.space;this.mode==="scale"&&(se="local");const I=se==="local"?this.worldQuaternion:this.identityQuaternion;this.gizmo.translate.visible=this.mode==="translate",this.gizmo.rotate.visible=this.mode==="rotate",this.gizmo.scale.visible=this.mode==="scale",this.helper.translate.visible=this.mode==="translate",this.helper.rotate.visible=this.mode==="rotate",this.helper.scale.visible=this.mode==="scale";let W=[];W=W.concat(this.picker[this.mode].children),W=W.concat(this.gizmo[this.mode].children),W=W.concat(this.helper[this.mode].children);for(let fe=0;fe<W.length;fe++){const Z=W[fe];Z.visible=!0,Z.rotation.set(0,0,0),Z.position.copy(this.worldPosition);let me;if(this.camera.isOrthographicCamera?me=(this.camera.top-this.camera.bottom)/this.camera.zoom:me=this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),Z.scale.set(1,1,1).multiplyScalar(me*this.size/7),Z.tag==="helper"){Z.visible=!1,Z.name==="AXIS"?(Z.position.copy(this.worldPositionStart),Z.visible=!!this.axis,this.axis==="X"&&(this.tempQuaternion.setFromEuler(this.tempEuler.set(0,0,0)),Z.quaternion.copy(I).multiply(this.tempQuaternion),Math.abs(this.alignVector.copy(this.unitX).applyQuaternion(I).dot(this.eye))>.9&&(Z.visible=!1)),this.axis==="Y"&&(this.tempQuaternion.setFromEuler(this.tempEuler.set(0,0,Math.PI/2)),Z.quaternion.copy(I).multiply(this.tempQuaternion),Math.abs(this.alignVector.copy(this.unitY).applyQuaternion(I).dot(this.eye))>.9&&(Z.visible=!1)),this.axis==="Z"&&(this.tempQuaternion.setFromEuler(this.tempEuler.set(0,Math.PI/2,0)),Z.quaternion.copy(I).multiply(this.tempQuaternion),Math.abs(this.alignVector.copy(this.unitZ).applyQuaternion(I).dot(this.eye))>.9&&(Z.visible=!1)),this.axis==="XYZE"&&(this.tempQuaternion.setFromEuler(this.tempEuler.set(0,Math.PI/2,0)),this.alignVector.copy(this.rotationAxis),Z.quaternion.setFromRotationMatrix(this.lookAtMatrix.lookAt(this.zeroVector,this.alignVector,this.unitY)),Z.quaternion.multiply(this.tempQuaternion),Z.visible=this.dragging),this.axis==="E"&&(Z.visible=!1)):Z.name==="START"?(Z.position.copy(this.worldPositionStart),Z.visible=this.dragging):Z.name==="END"?(Z.position.copy(this.worldPosition),Z.visible=this.dragging):Z.name==="DELTA"?(Z.position.copy(this.worldPositionStart),Z.quaternion.copy(this.worldQuaternionStart),this.tempVector.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),this.tempVector.applyQuaternion(this.worldQuaternionStart.clone().invert()),Z.scale.copy(this.tempVector),Z.visible=this.dragging):(Z.quaternion.copy(I),this.dragging?Z.position.copy(this.worldPositionStart):Z.position.copy(this.worldPosition),this.axis&&(Z.visible=this.axis.search(Z.name)!==-1));continue}Z.quaternion.copy(I),this.mode==="translate"||this.mode==="scale"?((Z.name==="X"||Z.name==="XYZX")&&Math.abs(this.alignVector.copy(this.unitX).applyQuaternion(I).dot(this.eye))>.99&&(Z.scale.set(1e-10,1e-10,1e-10),Z.visible=!1),(Z.name==="Y"||Z.name==="XYZY")&&Math.abs(this.alignVector.copy(this.unitY).applyQuaternion(I).dot(this.eye))>.99&&(Z.scale.set(1e-10,1e-10,1e-10),Z.visible=!1),(Z.name==="Z"||Z.name==="XYZZ")&&Math.abs(this.alignVector.copy(this.unitZ).applyQuaternion(I).dot(this.eye))>.99&&(Z.scale.set(1e-10,1e-10,1e-10),Z.visible=!1),Z.name==="XY"&&Math.abs(this.alignVector.copy(this.unitZ).applyQuaternion(I).dot(this.eye))<.2&&(Z.scale.set(1e-10,1e-10,1e-10),Z.visible=!1),Z.name==="YZ"&&Math.abs(this.alignVector.copy(this.unitX).applyQuaternion(I).dot(this.eye))<.2&&(Z.scale.set(1e-10,1e-10,1e-10),Z.visible=!1),Z.name==="XZ"&&Math.abs(this.alignVector.copy(this.unitY).applyQuaternion(I).dot(this.eye))<.2&&(Z.scale.set(1e-10,1e-10,1e-10),Z.visible=!1),Z.name.search("X")!==-1&&(this.alignVector.copy(this.unitX).applyQuaternion(I).dot(this.eye)<0?Z.tag==="fwd"?Z.visible=!1:Z.scale.x*=-1:Z.tag==="bwd"&&(Z.visible=!1)),Z.name.search("Y")!==-1&&(this.alignVector.copy(this.unitY).applyQuaternion(I).dot(this.eye)<0?Z.tag==="fwd"?Z.visible=!1:Z.scale.y*=-1:Z.tag==="bwd"&&(Z.visible=!1)),Z.name.search("Z")!==-1&&(this.alignVector.copy(this.unitZ).applyQuaternion(I).dot(this.eye)<0?Z.tag==="fwd"?Z.visible=!1:Z.scale.z*=-1:Z.tag==="bwd"&&(Z.visible=!1))):this.mode==="rotate"&&(this.tempQuaternion2.copy(I),this.alignVector.copy(this.eye).applyQuaternion(this.tempQuaternion.copy(I).invert()),Z.name.search("E")!==-1&&Z.quaternion.setFromRotationMatrix(this.lookAtMatrix.lookAt(this.eye,this.zeroVector,this.unitY)),Z.name==="X"&&(this.tempQuaternion.setFromAxisAngle(this.unitX,Math.atan2(-this.alignVector.y,this.alignVector.z)),this.tempQuaternion.multiplyQuaternions(this.tempQuaternion2,this.tempQuaternion),Z.quaternion.copy(this.tempQuaternion)),Z.name==="Y"&&(this.tempQuaternion.setFromAxisAngle(this.unitY,Math.atan2(this.alignVector.x,this.alignVector.z)),this.tempQuaternion.multiplyQuaternions(this.tempQuaternion2,this.tempQuaternion),Z.quaternion.copy(this.tempQuaternion)),Z.name==="Z"&&(this.tempQuaternion.setFromAxisAngle(this.unitZ,Math.atan2(this.alignVector.y,this.alignVector.x)),this.tempQuaternion.multiplyQuaternions(this.tempQuaternion2,this.tempQuaternion),Z.quaternion.copy(this.tempQuaternion))),Z.visible=Z.visible&&(Z.name.indexOf("X")===-1||this.showX),Z.visible=Z.visible&&(Z.name.indexOf("Y")===-1||this.showY),Z.visible=Z.visible&&(Z.name.indexOf("Z")===-1||this.showZ),Z.visible=Z.visible&&(Z.name.indexOf("E")===-1||this.showX&&this.showY&&this.showZ),Z.material.tempOpacity=Z.material.tempOpacity||Z.material.opacity,Z.material.tempColor=Z.material.tempColor||Z.material.color.clone(),Z.material.color.copy(Z.material.tempColor),Z.material.opacity=Z.material.tempOpacity,this.enabled?this.axis&&(Z.name===this.axis?(Z.material.opacity=1,Z.material.color.lerp(new qt(1,1,1),.5)):this.axis.split("").some(function($){return Z.name===$})?(Z.material.opacity=1,Z.material.color.lerp(new qt(1,1,1),.5)):(Z.material.opacity*=.25,Z.material.color.lerp(new qt(1,1,1),.5))):(Z.material.opacity*=.5,Z.material.color.lerp(new qt(1,1,1),.5))}super.updateMatrixWorld()});const e=new ur({depthTest:!1,depthWrite:!1,transparent:!0,side:Oi,fog:!1,toneMapped:!1}),t=new gs({depthTest:!1,depthWrite:!1,transparent:!0,linewidth:1,fog:!1,toneMapped:!1}),n=e.clone();n.opacity=.15;const i=e.clone();i.opacity=.33;const a=e.clone();a.color.set(16711680);const o=e.clone();o.color.set(65280);const c=e.clone();c.color.set(255);const u=e.clone();u.opacity=.25;const h=u.clone();h.color.set(16776960);const m=u.clone();m.color.set(65535);const x=u.clone();x.color.set(16711935),e.clone().color.set(16776960);const b=t.clone();b.color.set(16711680);const S=t.clone();S.color.set(65280);const C=t.clone();C.color.set(255);const M=t.clone();M.color.set(65535);const A=t.clone();A.color.set(16711935);const R=t.clone();R.color.set(16776960);const N=t.clone();N.color.set(7895160);const B=R.clone();B.opacity=.25;const F=new Lr(0,.05,.2,12,1,!1),U=new ks(.125,.125,.125),z=new Rn;z.setAttribute("position",new $t([0,0,0,1,0,0],3));const P=(se,I)=>{const W=new Rn,fe=[];for(let Z=0;Z<=64*I;++Z)fe.push(0,Math.cos(Z/32*Math.PI)*se,Math.sin(Z/32*Math.PI)*se);return W.setAttribute("position",new $t(fe,3)),W},L=()=>{const se=new Rn;return se.setAttribute("position",new $t([0,0,0,1,1,1],3)),se},O={X:[[new sn(F,a),[1,0,0],[0,0,-Math.PI/2],null,"fwd"],[new sn(F,a),[1,0,0],[0,0,Math.PI/2],null,"bwd"],[new ui(z,b)]],Y:[[new sn(F,o),[0,1,0],null,null,"fwd"],[new sn(F,o),[0,1,0],[Math.PI,0,0],null,"bwd"],[new ui(z,S),null,[0,0,Math.PI/2]]],Z:[[new sn(F,c),[0,0,1],[Math.PI/2,0,0],null,"fwd"],[new sn(F,c),[0,0,1],[-Math.PI/2,0,0],null,"bwd"],[new ui(z,C),null,[0,-Math.PI/2,0]]],XYZ:[[new sn(new bl(.1,0),u.clone()),[0,0,0],[0,0,0]]],XY:[[new sn(new is(.295,.295),h.clone()),[.15,.15,0]],[new ui(z,R),[.18,.3,0],null,[.125,1,1]],[new ui(z,R),[.3,.18,0],[0,0,Math.PI/2],[.125,1,1]]],YZ:[[new sn(new is(.295,.295),m.clone()),[0,.15,.15],[0,Math.PI/2,0]],[new ui(z,M),[0,.18,.3],[0,0,Math.PI/2],[.125,1,1]],[new ui(z,M),[0,.3,.18],[0,-Math.PI/2,0],[.125,1,1]]],XZ:[[new sn(new is(.295,.295),x.clone()),[.15,0,.15],[-Math.PI/2,0,0]],[new ui(z,A),[.18,0,.3],null,[.125,1,1]],[new ui(z,A),[.3,0,.18],[0,-Math.PI/2,0],[.125,1,1]]]},ee={X:[[new sn(new Lr(.2,0,1,4,1,!1),n),[.6,0,0],[0,0,-Math.PI/2]]],Y:[[new sn(new Lr(.2,0,1,4,1,!1),n),[0,.6,0]]],Z:[[new sn(new Lr(.2,0,1,4,1,!1),n),[0,0,.6],[Math.PI/2,0,0]]],XYZ:[[new sn(new bl(.2,0),n)]],XY:[[new sn(new is(.4,.4),n),[.2,.2,0]]],YZ:[[new sn(new is(.4,.4),n),[0,.2,.2],[0,Math.PI/2,0]]],XZ:[[new sn(new is(.4,.4),n),[.2,0,.2],[-Math.PI/2,0,0]]]},Q={START:[[new sn(new bl(.01,2),i),null,null,null,"helper"]],END:[[new sn(new bl(.01,2),i),null,null,null,"helper"]],DELTA:[[new ui(L(),i),null,null,null,"helper"]],X:[[new ui(z,i.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new ui(z,i.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new ui(z,i.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},te={X:[[new ui(P(1,.5),b)],[new sn(new bl(.04,0),a),[0,0,.99],null,[1,3,1]]],Y:[[new ui(P(1,.5),S),null,[0,0,-Math.PI/2]],[new sn(new bl(.04,0),o),[0,0,.99],null,[3,1,1]]],Z:[[new ui(P(1,.5),C),null,[0,Math.PI/2,0]],[new sn(new bl(.04,0),c),[.99,0,0],null,[1,3,1]]],E:[[new ui(P(1.25,1),B),null,[0,Math.PI/2,0]],[new sn(new Lr(.03,0,.15,4,1,!1),B),[1.17,0,0],[0,0,-Math.PI/2],[1,1,.001]],[new sn(new Lr(.03,0,.15,4,1,!1),B),[-1.17,0,0],[0,0,Math.PI/2],[1,1,.001]],[new sn(new Lr(.03,0,.15,4,1,!1),B),[0,-1.17,0],[Math.PI,0,0],[1,1,.001]],[new sn(new Lr(.03,0,.15,4,1,!1),B),[0,1.17,0],[0,0,0],[1,1,.001]]],XYZE:[[new ui(P(1,1),N),null,[0,Math.PI/2,0]]]},ne={AXIS:[[new ui(z,i.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},re={X:[[new sn(new Rf(1,.1,4,24),n),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new sn(new Rf(1,.1,4,24),n),[0,0,0],[Math.PI/2,0,0]]],Z:[[new sn(new Rf(1,.1,4,24),n),[0,0,0],[0,0,-Math.PI/2]]],E:[[new sn(new Rf(1.25,.1,2,24),n)]],XYZE:[[new sn(new r0(.7,10,8),n)]]},j={X:[[new sn(U,a),[.8,0,0],[0,0,-Math.PI/2]],[new ui(z,b),null,null,[.8,1,1]]],Y:[[new sn(U,o),[0,.8,0]],[new ui(z,S),null,[0,0,Math.PI/2],[.8,1,1]]],Z:[[new sn(U,c),[0,0,.8],[Math.PI/2,0,0]],[new ui(z,C),null,[0,-Math.PI/2,0],[.8,1,1]]],XY:[[new sn(U,h),[.85,.85,0],null,[2,2,.2]],[new ui(z,R),[.855,.98,0],null,[.125,1,1]],[new ui(z,R),[.98,.855,0],[0,0,Math.PI/2],[.125,1,1]]],YZ:[[new sn(U,m),[0,.85,.85],null,[.2,2,2]],[new ui(z,M),[0,.855,.98],[0,0,Math.PI/2],[.125,1,1]],[new ui(z,M),[0,.98,.855],[0,-Math.PI/2,0],[.125,1,1]]],XZ:[[new sn(U,x),[.85,0,.85],null,[2,.2,2]],[new ui(z,A),[.855,0,.98],null,[.125,1,1]],[new ui(z,A),[.98,0,.855],[0,-Math.PI/2,0],[.125,1,1]]],XYZX:[[new sn(new ks(.125,.125,.125),u.clone()),[1.1,0,0]]],XYZY:[[new sn(new ks(.125,.125,.125),u.clone()),[0,1.1,0]]],XYZZ:[[new sn(new ks(.125,.125,.125),u.clone()),[0,0,1.1]]]},ae={X:[[new sn(new Lr(.2,0,.8,4,1,!1),n),[.5,0,0],[0,0,-Math.PI/2]]],Y:[[new sn(new Lr(.2,0,.8,4,1,!1),n),[0,.5,0]]],Z:[[new sn(new Lr(.2,0,.8,4,1,!1),n),[0,0,.5],[Math.PI/2,0,0]]],XY:[[new sn(U,n),[.85,.85,0],null,[3,3,.2]]],YZ:[[new sn(U,n),[0,.85,.85],null,[.2,3,3]]],XZ:[[new sn(U,n),[.85,0,.85],null,[3,.2,3]]],XYZX:[[new sn(new ks(.2,.2,.2),n),[1.1,0,0]]],XYZY:[[new sn(new ks(.2,.2,.2),n),[0,1.1,0]]],XYZZ:[[new sn(new ks(.2,.2,.2),n),[0,0,1.1]]]},J={X:[[new ui(z,i.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new ui(z,i.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new ui(z,i.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},ie=se=>{const I=new ai;for(let W in se)for(let fe=se[W].length;fe--;){const Z=se[W][fe][0].clone(),me=se[W][fe][1],$=se[W][fe][2],pe=se[W][fe][3],ve=se[W][fe][4];Z.name=W,Z.tag=ve,me&&Z.position.set(me[0],me[1],me[2]),$&&Z.rotation.set($[0],$[1],$[2]),pe&&Z.scale.set(pe[0],pe[1],pe[2]),Z.updateMatrix();const ze=Z.geometry.clone();ze.applyMatrix4(Z.matrix),Z.geometry=ze,Z.renderOrder=1/0,Z.position.set(0,0,0),Z.rotation.set(0,0,0),Z.scale.set(1,1,1),I.add(Z)}return I};this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=ie(O)),this.add(this.gizmo.rotate=ie(te)),this.add(this.gizmo.scale=ie(j)),this.add(this.picker.translate=ie(ee)),this.add(this.picker.rotate=ie(re)),this.add(this.picker.scale=ie(ae)),this.add(this.helper.translate=ie(Q)),this.add(this.helper.rotate=ie(ne)),this.add(this.helper.scale=ie(J)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1}}class iP extends sn{constructor(){super(new is(1e5,1e5,2,2),new ur({visible:!1,wireframe:!0,side:Oi,transparent:!0,opacity:.1,toneMapped:!1})),_t(this,"isTransformControlsPlane",!0),_t(this,"type","TransformControlsPlane"),_t(this,"unitX",new k(1,0,0)),_t(this,"unitY",new k(0,1,0)),_t(this,"unitZ",new k(0,0,1)),_t(this,"tempVector",new k),_t(this,"dirVector",new k),_t(this,"alignVector",new k),_t(this,"tempMatrix",new wn),_t(this,"identityQuaternion",new Fn),_t(this,"cameraQuaternion",new Fn),_t(this,"worldPosition",new k),_t(this,"worldQuaternion",new Fn),_t(this,"eye",new k),_t(this,"axis",null),_t(this,"mode","translate"),_t(this,"space","world"),_t(this,"updateMatrixWorld",()=>{let e=this.space;switch(this.position.copy(this.worldPosition),this.mode==="scale"&&(e="local"),this.unitX.set(1,0,0).applyQuaternion(e==="local"?this.worldQuaternion:this.identityQuaternion),this.unitY.set(0,1,0).applyQuaternion(e==="local"?this.worldQuaternion:this.identityQuaternion),this.unitZ.set(0,0,1).applyQuaternion(e==="local"?this.worldQuaternion:this.identityQuaternion),this.alignVector.copy(this.unitY),this.mode){case"translate":case"scale":switch(this.axis){case"X":this.alignVector.copy(this.eye).cross(this.unitX),this.dirVector.copy(this.unitX).cross(this.alignVector);break;case"Y":this.alignVector.copy(this.eye).cross(this.unitY),this.dirVector.copy(this.unitY).cross(this.alignVector);break;case"Z":this.alignVector.copy(this.eye).cross(this.unitZ),this.dirVector.copy(this.unitZ).cross(this.alignVector);break;case"XY":this.dirVector.copy(this.unitZ);break;case"YZ":this.dirVector.copy(this.unitX);break;case"XZ":this.alignVector.copy(this.unitZ),this.dirVector.copy(this.unitY);break;case"XYZ":case"E":this.dirVector.set(0,0,0);break}break;case"rotate":default:this.dirVector.set(0,0,0)}this.dirVector.length()===0?this.quaternion.copy(this.cameraQuaternion):(this.tempMatrix.lookAt(this.tempVector.set(0,0,0),this.dirVector,this.alignVector),this.quaternion.setFromRotationMatrix(this.tempMatrix)),super.updateMatrixWorld()})}}var aP=Object.defineProperty,sP=(s,e,t)=>e in s?aP(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,Ln=(s,e,t)=>(sP(s,typeof e!="symbol"?e+"":e,t),t);const Ov=new ld,UE=new rc,rP=Math.cos(70*(Math.PI/180)),LE=(s,e)=>(s%e+e)%e;let oP=class extends Q8{constructor(e,t){super(),Ln(this,"object"),Ln(this,"domElement"),Ln(this,"enabled",!0),Ln(this,"target",new k),Ln(this,"minDistance",0),Ln(this,"maxDistance",1/0),Ln(this,"minZoom",0),Ln(this,"maxZoom",1/0),Ln(this,"minPolarAngle",0),Ln(this,"maxPolarAngle",Math.PI),Ln(this,"minAzimuthAngle",-1/0),Ln(this,"maxAzimuthAngle",1/0),Ln(this,"enableDamping",!1),Ln(this,"dampingFactor",.05),Ln(this,"enableZoom",!0),Ln(this,"zoomSpeed",1),Ln(this,"enableRotate",!0),Ln(this,"rotateSpeed",1),Ln(this,"enablePan",!0),Ln(this,"panSpeed",1),Ln(this,"screenSpacePanning",!0),Ln(this,"keyPanSpeed",7),Ln(this,"zoomToCursor",!1),Ln(this,"autoRotate",!1),Ln(this,"autoRotateSpeed",2),Ln(this,"reverseOrbit",!1),Ln(this,"reverseHorizontalOrbit",!1),Ln(this,"reverseVerticalOrbit",!1),Ln(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),Ln(this,"mouseButtons",{LEFT:Gh.ROTATE,MIDDLE:Gh.DOLLY,RIGHT:Gh.PAN}),Ln(this,"touches",{ONE:jh.ROTATE,TWO:jh.DOLLY_PAN}),Ln(this,"target0"),Ln(this,"position0"),Ln(this,"zoom0"),Ln(this,"_domElementKeyEvents",null),Ln(this,"getPolarAngle"),Ln(this,"getAzimuthalAngle"),Ln(this,"setPolarAngle"),Ln(this,"setAzimuthalAngle"),Ln(this,"getDistance"),Ln(this,"getZoomScale"),Ln(this,"listenToKeyEvents"),Ln(this,"stopListenToKeyEvents"),Ln(this,"saveState"),Ln(this,"reset"),Ln(this,"update"),Ln(this,"connect"),Ln(this,"dispose"),Ln(this,"dollyIn"),Ln(this,"dollyOut"),Ln(this,"getScale"),Ln(this,"setScale"),this.object=e,this.domElement=t,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>m.phi,this.getAzimuthalAngle=()=>m.theta,this.setPolarAngle=ge=>{let Ie=LE(ge,2*Math.PI),ht=m.phi;ht<0&&(ht+=2*Math.PI),Ie<0&&(Ie+=2*Math.PI);let ye=Math.abs(Ie-ht);2*Math.PI-ye<ye&&(Ie<ht?Ie+=2*Math.PI:ht+=2*Math.PI),x.phi=Ie-ht,n.update()},this.setAzimuthalAngle=ge=>{let Ie=LE(ge,2*Math.PI),ht=m.theta;ht<0&&(ht+=2*Math.PI),Ie<0&&(Ie+=2*Math.PI);let ye=Math.abs(Ie-ht);2*Math.PI-ye<ye&&(Ie<ht?Ie+=2*Math.PI:ht+=2*Math.PI),x.theta=Ie-ht,n.update()},this.getDistance=()=>n.object.position.distanceTo(n.target),this.listenToKeyEvents=ge=>{ge.addEventListener("keydown",Be),this._domElementKeyEvents=ge},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",Be),this._domElementKeyEvents=null},this.saveState=()=>{n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=()=>{n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(i),n.update(),u=c.NONE},this.update=(()=>{const ge=new k,Ie=new k(0,1,0),ht=new Fn().setFromUnitVectors(e.up,Ie),ye=ht.clone().invert(),Re=new k,pt=new Fn,Rt=2*Math.PI;return function(){const Ke=n.object.position;ht.setFromUnitVectors(e.up,Ie),ye.copy(ht).invert(),ge.copy(Ke).sub(n.target),ge.applyQuaternion(ht),m.setFromVector3(ge),n.autoRotate&&u===c.NONE&&ne(Q()),n.enableDamping?(m.theta+=x.theta*n.dampingFactor,m.phi+=x.phi*n.dampingFactor):(m.theta+=x.theta,m.phi+=x.phi);let Lt=n.minAzimuthAngle,Vt=n.maxAzimuthAngle;isFinite(Lt)&&isFinite(Vt)&&(Lt<-Math.PI?Lt+=Rt:Lt>Math.PI&&(Lt-=Rt),Vt<-Math.PI?Vt+=Rt:Vt>Math.PI&&(Vt-=Rt),Lt<=Vt?m.theta=Math.max(Lt,Math.min(Vt,m.theta)):m.theta=m.theta>(Lt+Vt)/2?Math.max(Lt,m.theta):Math.min(Vt,m.theta)),m.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,m.phi)),m.makeSafe(),n.enableDamping===!0?n.target.addScaledVector(b,n.dampingFactor):n.target.add(b),n.zoomToCursor&&L||n.object.isOrthographicCamera?m.radius=fe(m.radius):m.radius=fe(m.radius*g),ge.setFromSpherical(m),ge.applyQuaternion(ye),Ke.copy(n.target).add(ge),n.object.matrixAutoUpdate||n.object.updateMatrix(),n.object.lookAt(n.target),n.enableDamping===!0?(x.theta*=1-n.dampingFactor,x.phi*=1-n.dampingFactor,b.multiplyScalar(1-n.dampingFactor)):(x.set(0,0,0),b.set(0,0,0));let Kt=!1;if(n.zoomToCursor&&L){let on=null;if(n.object instanceof Ba&&n.object.isPerspectiveCamera){const Gn=ge.length();on=fe(Gn*g);const En=Gn-on;n.object.position.addScaledVector(z,En),n.object.updateMatrixWorld()}else if(n.object.isOrthographicCamera){const Gn=new k(P.x,P.y,0);Gn.unproject(n.object),n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/g)),n.object.updateProjectionMatrix(),Kt=!0;const En=new k(P.x,P.y,0);En.unproject(n.object),n.object.position.sub(En).add(Gn),n.object.updateMatrixWorld(),on=ge.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),n.zoomToCursor=!1;on!==null&&(n.screenSpacePanning?n.target.set(0,0,-1).transformDirection(n.object.matrix).multiplyScalar(on).add(n.object.position):(Ov.origin.copy(n.object.position),Ov.direction.set(0,0,-1).transformDirection(n.object.matrix),Math.abs(n.object.up.dot(Ov.direction))<rP?e.lookAt(n.target):(UE.setFromNormalAndCoplanarPoint(n.object.up,n.target),Ov.intersectPlane(UE,n.target))))}else n.object instanceof El&&n.object.isOrthographicCamera&&(Kt=g!==1,Kt&&(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/g)),n.object.updateProjectionMatrix()));return g=1,L=!1,Kt||Re.distanceToSquared(n.object.position)>h||8*(1-pt.dot(n.object.quaternion))>h?(n.dispatchEvent(i),Re.copy(n.object.position),pt.copy(n.object.quaternion),Kt=!1,!0):!1}})(),this.connect=ge=>{n.domElement=ge,n.domElement.style.touchAction="none",n.domElement.addEventListener("contextmenu",It),n.domElement.addEventListener("pointerdown",st),n.domElement.addEventListener("pointercancel",X),n.domElement.addEventListener("wheel",Ue)},this.dispose=()=>{var ge,Ie,ht,ye,Re,pt;n.domElement&&(n.domElement.style.touchAction="auto"),(ge=n.domElement)==null||ge.removeEventListener("contextmenu",It),(Ie=n.domElement)==null||Ie.removeEventListener("pointerdown",st),(ht=n.domElement)==null||ht.removeEventListener("pointercancel",X),(ye=n.domElement)==null||ye.removeEventListener("wheel",Ue),(Re=n.domElement)==null||Re.ownerDocument.removeEventListener("pointermove",oe),(pt=n.domElement)==null||pt.ownerDocument.removeEventListener("pointerup",X),n._domElementKeyEvents!==null&&n._domElementKeyEvents.removeEventListener("keydown",Be)};const n=this,i={type:"change"},a={type:"start"},o={type:"end"},c={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let u=c.NONE;const h=1e-6,m=new X1,x=new X1;let g=1;const b=new k,S=new gt,C=new gt,M=new gt,A=new gt,R=new gt,N=new gt,B=new gt,F=new gt,U=new gt,z=new k,P=new gt;let L=!1;const O=[],ee={};function Q(){return 2*Math.PI/60/60*n.autoRotateSpeed}function te(){return Math.pow(.95,n.zoomSpeed)}function ne(ge){n.reverseOrbit||n.reverseHorizontalOrbit?x.theta+=ge:x.theta-=ge}function re(ge){n.reverseOrbit||n.reverseVerticalOrbit?x.phi+=ge:x.phi-=ge}const j=(()=>{const ge=new k;return function(ht,ye){ge.setFromMatrixColumn(ye,0),ge.multiplyScalar(-ht),b.add(ge)}})(),ae=(()=>{const ge=new k;return function(ht,ye){n.screenSpacePanning===!0?ge.setFromMatrixColumn(ye,1):(ge.setFromMatrixColumn(ye,0),ge.crossVectors(n.object.up,ge)),ge.multiplyScalar(ht),b.add(ge)}})(),J=(()=>{const ge=new k;return function(ht,ye){const Re=n.domElement;if(Re&&n.object instanceof Ba&&n.object.isPerspectiveCamera){const pt=n.object.position;ge.copy(pt).sub(n.target);let Rt=ge.length();Rt*=Math.tan(n.object.fov/2*Math.PI/180),j(2*ht*Rt/Re.clientHeight,n.object.matrix),ae(2*ye*Rt/Re.clientHeight,n.object.matrix)}else Re&&n.object instanceof El&&n.object.isOrthographicCamera?(j(ht*(n.object.right-n.object.left)/n.object.zoom/Re.clientWidth,n.object.matrix),ae(ye*(n.object.top-n.object.bottom)/n.object.zoom/Re.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}})();function ie(ge){n.object instanceof Ba&&n.object.isPerspectiveCamera||n.object instanceof El&&n.object.isOrthographicCamera?g=ge:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function se(ge){ie(g/ge)}function I(ge){ie(g*ge)}function W(ge){if(!n.zoomToCursor||!n.domElement)return;L=!0;const Ie=n.domElement.getBoundingClientRect(),ht=ge.clientX-Ie.left,ye=ge.clientY-Ie.top,Re=Ie.width,pt=Ie.height;P.x=ht/Re*2-1,P.y=-(ye/pt)*2+1,z.set(P.x,P.y,1).unproject(n.object).sub(n.object.position).normalize()}function fe(ge){return Math.max(n.minDistance,Math.min(n.maxDistance,ge))}function Z(ge){S.set(ge.clientX,ge.clientY)}function me(ge){W(ge),B.set(ge.clientX,ge.clientY)}function $(ge){A.set(ge.clientX,ge.clientY)}function pe(ge){C.set(ge.clientX,ge.clientY),M.subVectors(C,S).multiplyScalar(n.rotateSpeed);const Ie=n.domElement;Ie&&(ne(2*Math.PI*M.x/Ie.clientHeight),re(2*Math.PI*M.y/Ie.clientHeight)),S.copy(C),n.update()}function ve(ge){F.set(ge.clientX,ge.clientY),U.subVectors(F,B),U.y>0?se(te()):U.y<0&&I(te()),B.copy(F),n.update()}function ze(ge){R.set(ge.clientX,ge.clientY),N.subVectors(R,A).multiplyScalar(n.panSpeed),J(N.x,N.y),A.copy(R),n.update()}function Ge(ge){W(ge),ge.deltaY<0?I(te()):ge.deltaY>0&&se(te()),n.update()}function Fe(ge){let Ie=!1;switch(ge.code){case n.keys.UP:J(0,n.keyPanSpeed),Ie=!0;break;case n.keys.BOTTOM:J(0,-n.keyPanSpeed),Ie=!0;break;case n.keys.LEFT:J(n.keyPanSpeed,0),Ie=!0;break;case n.keys.RIGHT:J(-n.keyPanSpeed,0),Ie=!0;break}Ie&&(ge.preventDefault(),n.update())}function Qe(){if(O.length==1)S.set(O[0].pageX,O[0].pageY);else{const ge=.5*(O[0].pageX+O[1].pageX),Ie=.5*(O[0].pageY+O[1].pageY);S.set(ge,Ie)}}function lt(){if(O.length==1)A.set(O[0].pageX,O[0].pageY);else{const ge=.5*(O[0].pageX+O[1].pageX),Ie=.5*(O[0].pageY+O[1].pageY);A.set(ge,Ie)}}function De(){const ge=O[0].pageX-O[1].pageX,Ie=O[0].pageY-O[1].pageY,ht=Math.sqrt(ge*ge+Ie*Ie);B.set(0,ht)}function le(){n.enableZoom&&De(),n.enablePan&&lt()}function Ye(){n.enableZoom&&De(),n.enableRotate&&Qe()}function Ze(ge){if(O.length==1)C.set(ge.pageX,ge.pageY);else{const ht=ft(ge),ye=.5*(ge.pageX+ht.x),Re=.5*(ge.pageY+ht.y);C.set(ye,Re)}M.subVectors(C,S).multiplyScalar(n.rotateSpeed);const Ie=n.domElement;Ie&&(ne(2*Math.PI*M.x/Ie.clientHeight),re(2*Math.PI*M.y/Ie.clientHeight)),S.copy(C)}function je(ge){if(O.length==1)R.set(ge.pageX,ge.pageY);else{const Ie=ft(ge),ht=.5*(ge.pageX+Ie.x),ye=.5*(ge.pageY+Ie.y);R.set(ht,ye)}N.subVectors(R,A).multiplyScalar(n.panSpeed),J(N.x,N.y),A.copy(R)}function He(ge){const Ie=ft(ge),ht=ge.pageX-Ie.x,ye=ge.pageY-Ie.y,Re=Math.sqrt(ht*ht+ye*ye);F.set(0,Re),U.set(0,Math.pow(F.y/B.y,n.zoomSpeed)),se(U.y),B.copy(F)}function et(ge){n.enableZoom&&He(ge),n.enablePan&&je(ge)}function Ne(ge){n.enableZoom&&He(ge),n.enableRotate&&Ze(ge)}function st(ge){var Ie,ht;n.enabled!==!1&&(O.length===0&&((Ie=n.domElement)==null||Ie.ownerDocument.addEventListener("pointermove",oe),(ht=n.domElement)==null||ht.ownerDocument.addEventListener("pointerup",X)),zt(ge),ge.pointerType==="touch"?bt(ge):Ae(ge))}function oe(ge){n.enabled!==!1&&(ge.pointerType==="touch"?vt(ge):Pe(ge))}function X(ge){var Ie,ht,ye;qe(ge),O.length===0&&((Ie=n.domElement)==null||Ie.releasePointerCapture(ge.pointerId),(ht=n.domElement)==null||ht.ownerDocument.removeEventListener("pointermove",oe),(ye=n.domElement)==null||ye.ownerDocument.removeEventListener("pointerup",X)),n.dispatchEvent(o),u=c.NONE}function Ae(ge){let Ie;switch(ge.button){case 0:Ie=n.mouseButtons.LEFT;break;case 1:Ie=n.mouseButtons.MIDDLE;break;case 2:Ie=n.mouseButtons.RIGHT;break;default:Ie=-1}switch(Ie){case Gh.DOLLY:if(n.enableZoom===!1)return;me(ge),u=c.DOLLY;break;case Gh.ROTATE:if(ge.ctrlKey||ge.metaKey||ge.shiftKey){if(n.enablePan===!1)return;$(ge),u=c.PAN}else{if(n.enableRotate===!1)return;Z(ge),u=c.ROTATE}break;case Gh.PAN:if(ge.ctrlKey||ge.metaKey||ge.shiftKey){if(n.enableRotate===!1)return;Z(ge),u=c.ROTATE}else{if(n.enablePan===!1)return;$(ge),u=c.PAN}break;default:u=c.NONE}u!==c.NONE&&n.dispatchEvent(a)}function Pe(ge){if(n.enabled!==!1)switch(u){case c.ROTATE:if(n.enableRotate===!1)return;pe(ge);break;case c.DOLLY:if(n.enableZoom===!1)return;ve(ge);break;case c.PAN:if(n.enablePan===!1)return;ze(ge);break}}function Ue(ge){n.enabled===!1||n.enableZoom===!1||u!==c.NONE&&u!==c.ROTATE||(ge.preventDefault(),n.dispatchEvent(a),Ge(ge),n.dispatchEvent(o))}function Be(ge){n.enabled===!1||n.enablePan===!1||Fe(ge)}function bt(ge){switch(We(ge),O.length){case 1:switch(n.touches.ONE){case jh.ROTATE:if(n.enableRotate===!1)return;Qe(),u=c.TOUCH_ROTATE;break;case jh.PAN:if(n.enablePan===!1)return;lt(),u=c.TOUCH_PAN;break;default:u=c.NONE}break;case 2:switch(n.touches.TWO){case jh.DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;le(),u=c.TOUCH_DOLLY_PAN;break;case jh.DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;Ye(),u=c.TOUCH_DOLLY_ROTATE;break;default:u=c.NONE}break;default:u=c.NONE}u!==c.NONE&&n.dispatchEvent(a)}function vt(ge){switch(We(ge),u){case c.TOUCH_ROTATE:if(n.enableRotate===!1)return;Ze(ge),n.update();break;case c.TOUCH_PAN:if(n.enablePan===!1)return;je(ge),n.update();break;case c.TOUCH_DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;et(ge),n.update();break;case c.TOUCH_DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;Ne(ge),n.update();break;default:u=c.NONE}}function It(ge){n.enabled!==!1&&ge.preventDefault()}function zt(ge){O.push(ge)}function qe(ge){delete ee[ge.pointerId];for(let Ie=0;Ie<O.length;Ie++)if(O[Ie].pointerId==ge.pointerId){O.splice(Ie,1);return}}function We(ge){let Ie=ee[ge.pointerId];Ie===void 0&&(Ie=new gt,ee[ge.pointerId]=Ie),Ie.set(ge.pageX,ge.pageY)}function ft(ge){const Ie=ge.pointerId===O[0].pointerId?O[1]:O[0];return ee[Ie.pointerId]}this.dollyIn=(ge=te())=>{I(ge),n.update()},this.dollyOut=(ge=te())=>{se(ge),n.update()},this.getScale=()=>g,this.setScale=ge=>{ie(ge),n.update()},this.getZoomScale=()=>te(),t!==void 0&&this.connect(t),this.update()}};function K1(s){if(typeof TextDecoder<"u")return new TextDecoder().decode(s);let e="";for(let t=0,n=s.length;t<n;t++)e+=String.fromCharCode(s[t]);try{return decodeURIComponent(escape(e))}catch{return e}}const Zh="srgb",Gu="srgb-linear",OE=3001,lP=3e3;class nA extends Ws{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new dP(t)}),this.register(function(t){return new pP(t)}),this.register(function(t){return new AP(t)}),this.register(function(t){return new MP(t)}),this.register(function(t){return new wP(t)}),this.register(function(t){return new xP(t)}),this.register(function(t){return new gP(t)}),this.register(function(t){return new vP(t)}),this.register(function(t){return new yP(t)}),this.register(function(t){return new hP(t)}),this.register(function(t){return new bP(t)}),this.register(function(t){return new mP(t)}),this.register(function(t){return new SP(t)}),this.register(function(t){return new _P(t)}),this.register(function(t){return new uP(t)}),this.register(function(t){return new EP(t)}),this.register(function(t){return new CP(t)})}load(e,t,n,i){const a=this;let o;if(this.resourcePath!=="")o=this.resourcePath;else if(this.path!==""){const h=Df.extractUrlBase(e);o=Df.resolveURL(h,this.path)}else o=Df.extractUrlBase(e);this.manager.itemStart(e);const c=function(h){i?i(h):console.error(h),a.manager.itemError(e),a.manager.itemEnd(e)},u=new Xs(this.manager);u.setPath(this.path),u.setResponseType("arraybuffer"),u.setRequestHeader(this.requestHeader),u.setWithCredentials(this.withCredentials),u.load(e,function(h){try{a.parse(h,o,function(m){t(m),a.manager.itemEnd(e)},c)}catch(m){c(m)}},n,c)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,n,i){let a;const o={},c={};if(typeof e=="string")a=JSON.parse(e);else if(e instanceof ArrayBuffer)if(K1(new Uint8Array(e.slice(0,4)))===HT){try{o[yi.KHR_BINARY_GLTF]=new TP(e)}catch(m){i&&i(m);return}a=JSON.parse(o[yi.KHR_BINARY_GLTF].content)}else a=JSON.parse(K1(new Uint8Array(e)));else a=e;if(a.asset===void 0||a.asset.version[0]<2){i&&i(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const u=new jP(a,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});u.fileLoader.setRequestHeader(this.requestHeader);for(let h=0;h<this.pluginCallbacks.length;h++){const m=this.pluginCallbacks[h](u);m.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),c[m.name]=m,o[m.name]=!0}if(a.extensionsUsed)for(let h=0;h<a.extensionsUsed.length;++h){const m=a.extensionsUsed[h],x=a.extensionsRequired||[];switch(m){case yi.KHR_MATERIALS_UNLIT:o[m]=new fP;break;case yi.KHR_DRACO_MESH_COMPRESSION:o[m]=new RP(a,this.dracoLoader);break;case yi.KHR_TEXTURE_TRANSFORM:o[m]=new NP;break;case yi.KHR_MESH_QUANTIZATION:o[m]=new BP;break;default:x.indexOf(m)>=0&&c[m]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+m+'".')}}u.setExtensions(o),u.setPlugins(c),u.parse(n,i)}parseAsync(e,t){const n=this;return new Promise(function(i,a){n.parse(e,t,i,a)})}}function cP(){let s={};return{get:function(e){return s[e]},add:function(e,t){s[e]=t},remove:function(e){delete s[e]},removeAll:function(){s={}}}}const yi={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class uP{constructor(e){this.parser=e,this.name=yi.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let n=0,i=t.length;n<i;n++){const a=t[n];a.extensions&&a.extensions[this.name]&&a.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,a.extensions[this.name].light)}}_loadLight(e){const t=this.parser,n="light:"+e;let i=t.cache.get(n);if(i)return i;const a=t.json,u=((a.extensions&&a.extensions[this.name]||{}).lights||[])[e];let h;const m=new qt(16777215);u.color!==void 0&&m.setRGB(u.color[0],u.color[1],u.color[2],Gu);const x=u.range!==void 0?u.range:0;switch(u.type){case"directional":h=new PS(m),h.target.position.set(0,0,-1),h.add(h.target);break;case"point":h=new FS(m),h.distance=x;break;case"spot":h=new zS(m),h.distance=x,u.spot=u.spot||{},u.spot.innerConeAngle=u.spot.innerConeAngle!==void 0?u.spot.innerConeAngle:0,u.spot.outerConeAngle=u.spot.outerConeAngle!==void 0?u.spot.outerConeAngle:Math.PI/4,h.angle=u.spot.outerConeAngle,h.penumbra=1-u.spot.innerConeAngle/u.spot.outerConeAngle,h.target.position.set(0,0,-1),h.add(h.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+u.type)}return h.position.set(0,0,0),h.decay=2,Iu(h,u),u.intensity!==void 0&&(h.intensity=u.intensity),h.name=t.createUniqueName(u.name||"light_"+e),i=Promise.resolve(h),t.cache.add(n,i),i}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){const t=this,n=this.parser,a=n.json.nodes[e],c=(a.extensions&&a.extensions[this.name]||{}).light;return c===void 0?null:this._loadLight(c).then(function(u){return n._getNodeRef(t.cache,c,u)})}}class fP{constructor(){this.name=yi.KHR_MATERIALS_UNLIT}getMaterialType(){return ur}extendParams(e,t,n){const i=[];e.color=new qt(1,1,1),e.opacity=1;const a=t.pbrMetallicRoughness;if(a){if(Array.isArray(a.baseColorFactor)){const o=a.baseColorFactor;e.color.setRGB(o[0],o[1],o[2],Gu),e.opacity=o[3]}a.baseColorTexture!==void 0&&i.push(n.assignTexture(e,"map",a.baseColorTexture,Zh))}return Promise.all(i)}}class hP{constructor(e){this.parser=e,this.name=yi.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const a=i.extensions[this.name].emissiveStrength;return a!==void 0&&(t.emissiveIntensity=a),Promise.resolve()}}class dP{constructor(e){this.parser=e,this.name=yi.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Cl}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const a=[],o=i.extensions[this.name];if(o.clearcoatFactor!==void 0&&(t.clearcoat=o.clearcoatFactor),o.clearcoatTexture!==void 0&&a.push(n.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),o.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),o.clearcoatRoughnessTexture!==void 0&&a.push(n.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),o.clearcoatNormalTexture!==void 0&&(a.push(n.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),o.clearcoatNormalTexture.scale!==void 0)){const c=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new gt(c,c)}return Promise.all(a)}}class pP{constructor(e){this.parser=e,this.name=yi.KHR_MATERIALS_DISPERSION}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Cl}extendMaterialParams(e,t){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const a=i.extensions[this.name];return t.dispersion=a.dispersion!==void 0?a.dispersion:0,Promise.resolve()}}class mP{constructor(e){this.parser=e,this.name=yi.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Cl}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const a=[],o=i.extensions[this.name];return o.iridescenceFactor!==void 0&&(t.iridescence=o.iridescenceFactor),o.iridescenceTexture!==void 0&&a.push(n.assignTexture(t,"iridescenceMap",o.iridescenceTexture)),o.iridescenceIor!==void 0&&(t.iridescenceIOR=o.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),o.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),o.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),o.iridescenceThicknessTexture!==void 0&&a.push(n.assignTexture(t,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(a)}}class xP{constructor(e){this.parser=e,this.name=yi.KHR_MATERIALS_SHEEN}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Cl}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const a=[];t.sheenColor=new qt(0,0,0),t.sheenRoughness=0,t.sheen=1;const o=i.extensions[this.name];if(o.sheenColorFactor!==void 0){const c=o.sheenColorFactor;t.sheenColor.setRGB(c[0],c[1],c[2],Gu)}return o.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=o.sheenRoughnessFactor),o.sheenColorTexture!==void 0&&a.push(n.assignTexture(t,"sheenColorMap",o.sheenColorTexture,Zh)),o.sheenRoughnessTexture!==void 0&&a.push(n.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(a)}}class gP{constructor(e){this.parser=e,this.name=yi.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Cl}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const a=[],o=i.extensions[this.name];return o.transmissionFactor!==void 0&&(t.transmission=o.transmissionFactor),o.transmissionTexture!==void 0&&a.push(n.assignTexture(t,"transmissionMap",o.transmissionTexture)),Promise.all(a)}}class vP{constructor(e){this.parser=e,this.name=yi.KHR_MATERIALS_VOLUME}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Cl}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const a=[],o=i.extensions[this.name];t.thickness=o.thicknessFactor!==void 0?o.thicknessFactor:0,o.thicknessTexture!==void 0&&a.push(n.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||1/0;const c=o.attenuationColor||[1,1,1];return t.attenuationColor=new qt().setRGB(c[0],c[1],c[2],Gu),Promise.all(a)}}class yP{constructor(e){this.parser=e,this.name=yi.KHR_MATERIALS_IOR}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Cl}extendMaterialParams(e,t){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const a=i.extensions[this.name];return t.ior=a.ior!==void 0?a.ior:1.5,Promise.resolve()}}class bP{constructor(e){this.parser=e,this.name=yi.KHR_MATERIALS_SPECULAR}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Cl}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const a=[],o=i.extensions[this.name];t.specularIntensity=o.specularFactor!==void 0?o.specularFactor:1,o.specularTexture!==void 0&&a.push(n.assignTexture(t,"specularIntensityMap",o.specularTexture));const c=o.specularColorFactor||[1,1,1];return t.specularColor=new qt().setRGB(c[0],c[1],c[2],Gu),o.specularColorTexture!==void 0&&a.push(n.assignTexture(t,"specularColorMap",o.specularColorTexture,Zh)),Promise.all(a)}}class _P{constructor(e){this.parser=e,this.name=yi.EXT_MATERIALS_BUMP}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Cl}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const a=[],o=i.extensions[this.name];return t.bumpScale=o.bumpFactor!==void 0?o.bumpFactor:1,o.bumpTexture!==void 0&&a.push(n.assignTexture(t,"bumpMap",o.bumpTexture)),Promise.all(a)}}class SP{constructor(e){this.parser=e,this.name=yi.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const n=this.parser.json.materials[e];return!n.extensions||!n.extensions[this.name]?null:Cl}extendMaterialParams(e,t){const n=this.parser,i=n.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const a=[],o=i.extensions[this.name];return o.anisotropyStrength!==void 0&&(t.anisotropy=o.anisotropyStrength),o.anisotropyRotation!==void 0&&(t.anisotropyRotation=o.anisotropyRotation),o.anisotropyTexture!==void 0&&a.push(n.assignTexture(t,"anisotropyMap",o.anisotropyTexture)),Promise.all(a)}}class AP{constructor(e){this.parser=e,this.name=yi.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,n=t.json,i=n.textures[e];if(!i.extensions||!i.extensions[this.name])return null;const a=i.extensions[this.name],o=t.options.ktx2Loader;if(!o){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,a.source,o)}}class MP{constructor(e){this.parser=e,this.name=yi.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,i=n.json,a=i.textures[e];if(!a.extensions||!a.extensions[t])return null;const o=a.extensions[t],c=i.images[o.source];let u=n.textureLoader;if(c.uri){const h=n.options.manager.getHandler(c.uri);h!==null&&(u=h)}return this.detectSupport().then(function(h){if(h)return n.loadTextureImage(e,o.source,u);if(i.extensionsRequired&&i.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class wP{constructor(e){this.parser=e,this.name=yi.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,i=n.json,a=i.textures[e];if(!a.extensions||!a.extensions[t])return null;const o=a.extensions[t],c=i.images[o.source];let u=n.textureLoader;if(c.uri){const h=n.options.manager.getHandler(c.uri);h!==null&&(u=h)}return this.detectSupport().then(function(h){if(h)return n.loadTextureImage(e,o.source,u);if(i.extensionsRequired&&i.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return n.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class EP{constructor(e){this.name=yi.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){const i=n.extensions[this.name],a=this.parser.getDependency("buffer",i.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return a.then(function(c){const u=i.byteOffset||0,h=i.byteLength||0,m=i.count,x=i.byteStride,g=new Uint8Array(c,u,h);return o.decodeGltfBufferAsync?o.decodeGltfBufferAsync(m,x,g,i.mode,i.filter).then(function(b){return b.buffer}):o.ready.then(function(){const b=new ArrayBuffer(m*x);return o.decodeGltfBuffer(new Uint8Array(b),m,x,g,i.mode,i.filter),b})})}else return null}}class CP{constructor(e){this.name=yi.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,n=t.nodes[e];if(!n.extensions||!n.extensions[this.name]||n.mesh===void 0)return null;const i=t.meshes[n.mesh];for(const h of i.primitives)if(h.mode!==yl.TRIANGLES&&h.mode!==yl.TRIANGLE_STRIP&&h.mode!==yl.TRIANGLE_FAN&&h.mode!==void 0)return null;const o=n.extensions[this.name].attributes,c=[],u={};for(const h in o)c.push(this.parser.getDependency("accessor",o[h]).then(m=>(u[h]=m,u[h])));return c.length<1?null:(c.push(this.parser.createNodeMesh(e)),Promise.all(c).then(h=>{const m=h.pop(),x=m.isGroup?m.children:[m],g=h[0].count,b=[];for(const S of x){const C=new wn,M=new k,A=new Fn,R=new k(1,1,1),N=new _S(S.geometry,S.material,g);for(let B=0;B<g;B++)u.TRANSLATION&&M.fromBufferAttribute(u.TRANSLATION,B),u.ROTATION&&A.fromBufferAttribute(u.ROTATION,B),u.SCALE&&R.fromBufferAttribute(u.SCALE,B),N.setMatrixAt(B,C.compose(M,A,R));for(const B in u)if(B==="_COLOR_0"){const F=u[B];N.instanceColor=new Ff(F.array,F.itemSize,F.normalized)}else B!=="TRANSLATION"&&B!=="ROTATION"&&B!=="SCALE"&&S.geometry.setAttribute(B,u[B]);ai.prototype.copy.call(N,S),this.parser.assignFinalMaterial(N),b.push(N)}return m.isGroup?(m.clear(),m.add(...b),m):b[0]}))}}const HT="glTF",Im=12,IE={JSON:1313821514,BIN:5130562};class TP{constructor(e){this.name=yi.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,Im);if(this.header={magic:K1(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==HT)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const n=this.header.length-Im,i=new DataView(e,Im);let a=0;for(;a<n;){const o=i.getUint32(a,!0);a+=4;const c=i.getUint32(a,!0);if(a+=4,c===IE.JSON){const u=new Uint8Array(e,Im+a,o);this.content=K1(u)}else if(c===IE.BIN){const u=Im+a;this.body=e.slice(u,u+o)}a+=o}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class RP{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=yi.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const n=this.json,i=this.dracoLoader,a=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,c={},u={},h={};for(const m in o){const x=Z_[m]||m.toLowerCase();c[x]=o[m]}for(const m in e.attributes){const x=Z_[m]||m.toLowerCase();if(o[m]!==void 0){const g=n.accessors[e.attributes[m]],b=Op[g.componentType];h[x]=b.name,u[x]=g.normalized===!0}}return t.getDependency("bufferView",a).then(function(m){return new Promise(function(x,g){i.decodeDracoFile(m,function(b){for(const S in b.attributes){const C=b.attributes[S],M=u[S];M!==void 0&&(C.normalized=M)}x(b)},c,h,Gu,g)})})}}class NP{constructor(){this.name=yi.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(t.texCoord===void 0||t.texCoord===e.channel)&&t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.texCoord!==void 0&&(e.channel=t.texCoord),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class BP{constructor(){this.name=yi.KHR_MESH_QUANTIZATION}}class kT extends o0{constructor(e,t,n,i){super(e,t,n,i)}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,i=this.valueSize,a=e*i*3+i;for(let o=0;o!==i;o++)t[o]=n[a+o];return t}interpolate_(e,t,n,i){const a=this.resultBuffer,o=this.sampleValues,c=this.valueSize,u=c*2,h=c*3,m=i-t,x=(n-t)/m,g=x*x,b=g*x,S=e*h,C=S-h,M=-2*b+3*g,A=b-g,R=1-M,N=A-g+x;for(let B=0;B!==c;B++){const F=o[C+B+c],U=o[C+B+u]*m,z=o[S+B+c],P=o[S+B]*m;a[B]=R*F+N*U+M*z+A*P}return a}}const DP=new Fn;class UP extends kT{interpolate_(e,t,n,i){const a=super.interpolate_(e,t,n,i);return DP.fromArray(a).normalize().toArray(a),a}}const yl={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},Op={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},zE={9728:Vs,9729:bi,9984:ay,9985:Dp,9986:Vh,9987:Al},FE={33071:Pa,33648:Fp,10497:Of},s_={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Z_={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",...Dx>=152?{TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3"}:{TEXCOORD_0:"uv",TEXCOORD_1:"uv2"},COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Mf={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},LP={CUBICSPLINE:void 0,LINEAR:Vp,STEP:kp},r_={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function OP(s){return s.DefaultMaterial===void 0&&(s.DefaultMaterial=new Rx({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Zc})),s.DefaultMaterial}function Fh(s,e,t){for(const n in t.extensions)s[n]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[n]=t.extensions[n])}function Iu(s,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(s.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function IP(s,e,t){let n=!1,i=!1,a=!1;for(let h=0,m=e.length;h<m;h++){const x=e[h];if(x.POSITION!==void 0&&(n=!0),x.NORMAL!==void 0&&(i=!0),x.COLOR_0!==void 0&&(a=!0),n&&i&&a)break}if(!n&&!i&&!a)return Promise.resolve(s);const o=[],c=[],u=[];for(let h=0,m=e.length;h<m;h++){const x=e[h];if(n){const g=x.POSITION!==void 0?t.getDependency("accessor",x.POSITION):s.attributes.position;o.push(g)}if(i){const g=x.NORMAL!==void 0?t.getDependency("accessor",x.NORMAL):s.attributes.normal;c.push(g)}if(a){const g=x.COLOR_0!==void 0?t.getDependency("accessor",x.COLOR_0):s.attributes.color;u.push(g)}}return Promise.all([Promise.all(o),Promise.all(c),Promise.all(u)]).then(function(h){const m=h[0],x=h[1],g=h[2];return n&&(s.morphAttributes.position=m),i&&(s.morphAttributes.normal=x),a&&(s.morphAttributes.color=g),s.morphTargetsRelative=!0,s})}function zP(s,e){if(s.updateMorphTargets(),e.weights!==void 0)for(let t=0,n=e.weights.length;t<n;t++)s.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(s.morphTargetInfluences.length===t.length){s.morphTargetDictionary={};for(let n=0,i=t.length;n<i;n++)s.morphTargetDictionary[t[n]]=n}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function FP(s){let e;const t=s.extensions&&s.extensions[yi.KHR_DRACO_MESH_COMPRESSION];if(t?e="draco:"+t.bufferView+":"+t.indices+":"+o_(t.attributes):e=s.indices+":"+o_(s.attributes)+":"+s.mode,s.targets!==void 0)for(let n=0,i=s.targets.length;n<i;n++)e+=":"+o_(s.targets[n]);return e}function o_(s){let e="";const t=Object.keys(s).sort();for(let n=0,i=t.length;n<i;n++)e+=t[n]+":"+s[t[n]]+";";return e}function K_(s){switch(s){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function PP(s){return s.search(/\.jpe?g($|\?)/i)>0||s.search(/^data\:image\/jpeg/)===0?"image/jpeg":s.search(/\.webp($|\?)/i)>0||s.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const GP=new wn;class jP{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new cP,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let n=!1,i=!1,a=-1;typeof navigator<"u"&&typeof navigator.userAgent<"u"&&(n=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,i=navigator.userAgent.indexOf("Firefox")>-1,a=i?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||n||i&&a<98?this.textureLoader=new kC(this.options.manager):this.textureLoader=new ZC(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Xs(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const n=this,i=this.json,a=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])}).then(function(o){const c={scene:o[0][i.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:i.asset,parser:n,userData:{}};return Fh(a,c,i),Iu(c,i),Promise.all(n._invokeAll(function(u){return u.afterRoot&&u.afterRoot(c)})).then(function(){for(const u of c.scenes)u.updateMatrixWorld();e(c)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[];for(let i=0,a=t.length;i<a;i++){const o=t[i].joints;for(let c=0,u=o.length;c<u;c++)e[o[c]].isBone=!0}for(let i=0,a=e.length;i<a;i++){const o=e[i];o.mesh!==void 0&&(this._addNodeRef(this.meshCache,o.mesh),o.skin!==void 0&&(n[o.mesh].isSkinnedMesh=!0)),o.camera!==void 0&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,n){if(e.refs[t]<=1)return n;const i=n.clone(),a=(o,c)=>{const u=this.associations.get(o);u!=null&&this.associations.set(c,u);for(const[h,m]of o.children.entries())a(m,c.children[h])};return a(n,i),i.name+="_instance_"+e.uses[t]++,i}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let n=0;n<t.length;n++){const i=e(t[n]);if(i)return i}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const n=[];for(let i=0;i<t.length;i++){const a=e(t[i]);a&&n.push(a)}return n}getDependency(e,t){const n=e+":"+t;let i=this.cache.get(n);if(!i){switch(e){case"scene":i=this.loadScene(t);break;case"node":i=this._invokeOne(function(a){return a.loadNode&&a.loadNode(t)});break;case"mesh":i=this._invokeOne(function(a){return a.loadMesh&&a.loadMesh(t)});break;case"accessor":i=this.loadAccessor(t);break;case"bufferView":i=this._invokeOne(function(a){return a.loadBufferView&&a.loadBufferView(t)});break;case"buffer":i=this.loadBuffer(t);break;case"material":i=this._invokeOne(function(a){return a.loadMaterial&&a.loadMaterial(t)});break;case"texture":i=this._invokeOne(function(a){return a.loadTexture&&a.loadTexture(t)});break;case"skin":i=this.loadSkin(t);break;case"animation":i=this._invokeOne(function(a){return a.loadAnimation&&a.loadAnimation(t)});break;case"camera":i=this.loadCamera(t);break;default:if(i=this._invokeOne(function(a){return a!=this&&a.getDependency&&a.getDependency(e,t)}),!i)throw new Error("Unknown type: "+e);break}this.cache.add(n,i)}return i}getDependencies(e){let t=this.cache.get(e);if(!t){const n=this,i=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(i.map(function(a,o){return n.getDependency(e,o)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],n=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[yi.KHR_BINARY_GLTF].body);const i=this.options;return new Promise(function(a,o){n.load(Df.resolveURL(t.uri,i.path),a,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(n){const i=t.byteLength||0,a=t.byteOffset||0;return n.slice(a,a+i)})}loadAccessor(e){const t=this,n=this.json,i=this.json.accessors[e];if(i.bufferView===void 0&&i.sparse===void 0){const o=s_[i.type],c=Op[i.componentType],u=i.normalized===!0,h=new c(i.count*o);return Promise.resolve(new Ii(h,o,u))}const a=[];return i.bufferView!==void 0?a.push(this.getDependency("bufferView",i.bufferView)):a.push(null),i.sparse!==void 0&&(a.push(this.getDependency("bufferView",i.sparse.indices.bufferView)),a.push(this.getDependency("bufferView",i.sparse.values.bufferView))),Promise.all(a).then(function(o){const c=o[0],u=s_[i.type],h=Op[i.componentType],m=h.BYTES_PER_ELEMENT,x=m*u,g=i.byteOffset||0,b=i.bufferView!==void 0?n.bufferViews[i.bufferView].byteStride:void 0,S=i.normalized===!0;let C,M;if(b&&b!==x){const A=Math.floor(g/b),R="InterleavedBuffer:"+i.bufferView+":"+i.componentType+":"+A+":"+i.count;let N=t.cache.get(R);N||(C=new h(c,A*b,i.count*b/m),N=new wx(C,b/m),t.cache.add(R,N)),M=new Co(N,u,g%b/m,S)}else c===null?C=new h(i.count*u):C=new h(c,g,i.count*u),M=new Ii(C,u,S);if(i.sparse!==void 0){const A=s_.SCALAR,R=Op[i.sparse.indices.componentType],N=i.sparse.indices.byteOffset||0,B=i.sparse.values.byteOffset||0,F=new R(o[1],N,i.sparse.count*A),U=new h(o[2],B,i.sparse.count*u);c!==null&&(M=new Ii(M.array.slice(),M.itemSize,M.normalized));for(let z=0,P=F.length;z<P;z++){const L=F[z];if(M.setX(L,U[z*u]),u>=2&&M.setY(L,U[z*u+1]),u>=3&&M.setZ(L,U[z*u+2]),u>=4&&M.setW(L,U[z*u+3]),u>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return M})}loadTexture(e){const t=this.json,n=this.options,a=t.textures[e].source,o=t.images[a];let c=this.textureLoader;if(o.uri){const u=n.manager.getHandler(o.uri);u!==null&&(c=u)}return this.loadTextureImage(e,a,c)}loadTextureImage(e,t,n){const i=this,a=this.json,o=a.textures[e],c=a.images[t],u=(c.uri||c.bufferView)+":"+o.sampler;if(this.textureCache[u])return this.textureCache[u];const h=this.loadImageSource(t,n).then(function(m){m.flipY=!1,m.name=o.name||c.name||"",m.name===""&&typeof c.uri=="string"&&c.uri.startsWith("data:image/")===!1&&(m.name=c.uri);const g=(a.samplers||{})[o.sampler]||{};return m.magFilter=zE[g.magFilter]||bi,m.minFilter=zE[g.minFilter]||Al,m.wrapS=FE[g.wrapS]||Of,m.wrapT=FE[g.wrapT]||Of,i.associations.set(m,{textures:e}),m}).catch(function(){return null});return this.textureCache[u]=h,h}loadImageSource(e,t){const n=this,i=this.json,a=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(x=>x.clone());const o=i.images[e],c=self.URL||self.webkitURL;let u=o.uri||"",h=!1;if(o.bufferView!==void 0)u=n.getDependency("bufferView",o.bufferView).then(function(x){h=!0;const g=new Blob([x],{type:o.mimeType});return u=c.createObjectURL(g),u});else if(o.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const m=Promise.resolve(u).then(function(x){return new Promise(function(g,b){let S=g;t.isImageBitmapLoader===!0&&(S=function(C){const M=new Wi(C);M.needsUpdate=!0,g(M)}),t.load(Df.resolveURL(x,a.path),S,void 0,b)})}).then(function(x){return h===!0&&c.revokeObjectURL(u),Iu(x,o),x.userData.mimeType=o.mimeType||PP(o.uri),x}).catch(function(x){throw console.error("THREE.GLTFLoader: Couldn't load texture",u),x});return this.sourceCache[e]=m,m}assignTexture(e,t,n,i){const a=this;return this.getDependency("texture",n.index).then(function(o){if(!o)return null;if(n.texCoord!==void 0&&n.texCoord>0&&(o=o.clone(),o.channel=n.texCoord),a.extensions[yi.KHR_TEXTURE_TRANSFORM]){const c=n.extensions!==void 0?n.extensions[yi.KHR_TEXTURE_TRANSFORM]:void 0;if(c){const u=a.associations.get(o);o=a.extensions[yi.KHR_TEXTURE_TRANSFORM].extendTexture(o,c),a.associations.set(o,u)}}return i!==void 0&&(typeof i=="number"&&(i=i===OE?Zh:Gu),"colorSpace"in o?o.colorSpace=i:o.encoding=i===Zh?OE:lP),e[t]=o,o})}assignFinalMaterial(e){const t=e.geometry;let n=e.material;const i=t.attributes.tangent===void 0,a=t.attributes.color!==void 0,o=t.attributes.normal===void 0;if(e.isPoints){const c="PointsMaterial:"+n.uuid;let u=this.cache.get(c);u||(u=new Tf,os.prototype.copy.call(u,n),u.color.copy(n.color),u.map=n.map,u.sizeAttenuation=!1,this.cache.add(c,u)),n=u}else if(e.isLine){const c="LineBasicMaterial:"+n.uuid;let u=this.cache.get(c);u||(u=new gs,os.prototype.copy.call(u,n),u.color.copy(n.color),u.map=n.map,this.cache.add(c,u)),n=u}if(i||a||o){let c="ClonedMaterial:"+n.uuid+":";i&&(c+="derivative-tangents:"),a&&(c+="vertex-colors:"),o&&(c+="flat-shading:");let u=this.cache.get(c);u||(u=n.clone(),a&&(u.vertexColors=!0),o&&(u.flatShading=!0),i&&(u.normalScale&&(u.normalScale.y*=-1),u.clearcoatNormalScale&&(u.clearcoatNormalScale.y*=-1)),this.cache.add(c,u),this.associations.set(u,this.associations.get(n))),n=u}e.material=n}getMaterialType(){return Rx}loadMaterial(e){const t=this,n=this.json,i=this.extensions,a=n.materials[e];let o;const c={},u=a.extensions||{},h=[];if(u[yi.KHR_MATERIALS_UNLIT]){const x=i[yi.KHR_MATERIALS_UNLIT];o=x.getMaterialType(),h.push(x.extendParams(c,a,t))}else{const x=a.pbrMetallicRoughness||{};if(c.color=new qt(1,1,1),c.opacity=1,Array.isArray(x.baseColorFactor)){const g=x.baseColorFactor;c.color.setRGB(g[0],g[1],g[2],Gu),c.opacity=g[3]}x.baseColorTexture!==void 0&&h.push(t.assignTexture(c,"map",x.baseColorTexture,Zh)),c.metalness=x.metallicFactor!==void 0?x.metallicFactor:1,c.roughness=x.roughnessFactor!==void 0?x.roughnessFactor:1,x.metallicRoughnessTexture!==void 0&&(h.push(t.assignTexture(c,"metalnessMap",x.metallicRoughnessTexture)),h.push(t.assignTexture(c,"roughnessMap",x.metallicRoughnessTexture))),o=this._invokeOne(function(g){return g.getMaterialType&&g.getMaterialType(e)}),h.push(Promise.all(this._invokeAll(function(g){return g.extendMaterialParams&&g.extendMaterialParams(e,c)})))}a.doubleSided===!0&&(c.side=Oi);const m=a.alphaMode||r_.OPAQUE;if(m===r_.BLEND?(c.transparent=!0,c.depthWrite=!1):(c.transparent=!1,m===r_.MASK&&(c.alphaTest=a.alphaCutoff!==void 0?a.alphaCutoff:.5)),a.normalTexture!==void 0&&o!==ur&&(h.push(t.assignTexture(c,"normalMap",a.normalTexture)),c.normalScale=new gt(1,1),a.normalTexture.scale!==void 0)){const x=a.normalTexture.scale;c.normalScale.set(x,x)}if(a.occlusionTexture!==void 0&&o!==ur&&(h.push(t.assignTexture(c,"aoMap",a.occlusionTexture)),a.occlusionTexture.strength!==void 0&&(c.aoMapIntensity=a.occlusionTexture.strength)),a.emissiveFactor!==void 0&&o!==ur){const x=a.emissiveFactor;c.emissive=new qt().setRGB(x[0],x[1],x[2],Gu)}return a.emissiveTexture!==void 0&&o!==ur&&h.push(t.assignTexture(c,"emissiveMap",a.emissiveTexture,Zh)),Promise.all(h).then(function(){const x=new o(c);return a.name&&(x.name=a.name),Iu(x,a),t.associations.set(x,{materials:e}),a.extensions&&Fh(i,x,a),x})}createUniqueName(e){const t=Bi.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,n=this.extensions,i=this.primitiveCache;function a(c){return n[yi.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(c,t).then(function(u){return PE(u,c,t)})}const o=[];for(let c=0,u=e.length;c<u;c++){const h=e[c],m=FP(h),x=i[m];if(x)o.push(x.promise);else{let g;h.extensions&&h.extensions[yi.KHR_DRACO_MESH_COMPRESSION]?g=a(h):g=PE(new Rn,h,t),i[m]={primitive:h,promise:g},o.push(g)}}return Promise.all(o)}loadMesh(e){const t=this,n=this.json,i=this.extensions,a=n.meshes[e],o=a.primitives,c=[];for(let u=0,h=o.length;u<h;u++){const m=o[u].material===void 0?OP(this.cache):this.getDependency("material",o[u].material);c.push(m)}return c.push(t.loadGeometries(o)),Promise.all(c).then(function(u){const h=u.slice(0,u.length-1),m=u[u.length-1],x=[];for(let b=0,S=m.length;b<S;b++){const C=m[b],M=o[b];let A;const R=h[b];if(M.mode===yl.TRIANGLES||M.mode===yl.TRIANGLE_STRIP||M.mode===yl.TRIANGLE_FAN||M.mode===void 0)A=a.isSkinnedMesh===!0?new bS(C,R):new sn(C,R),A.isSkinnedMesh===!0&&A.normalizeSkinWeights(),M.mode===yl.TRIANGLE_STRIP?A.geometry=DE(A.geometry,fS):M.mode===yl.TRIANGLE_FAN&&(A.geometry=DE(A.geometry,P1));else if(M.mode===yl.LINES)A=new Jo(C,R);else if(M.mode===yl.LINE_STRIP)A=new ui(C,R);else if(M.mode===yl.LINE_LOOP)A=new SS(C,R);else if(M.mode===yl.POINTS)A=new Lp(C,R);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+M.mode);Object.keys(A.geometry.morphAttributes).length>0&&zP(A,a),A.name=t.createUniqueName(a.name||"mesh_"+e),Iu(A,a),M.extensions&&Fh(i,A,M),t.assignFinalMaterial(A),x.push(A)}for(let b=0,S=x.length;b<S;b++)t.associations.set(x[b],{meshes:e,primitives:b});if(x.length===1)return a.extensions&&Fh(i,x[0],a),x[0];const g=new Yc;a.extensions&&Fh(i,g,a),t.associations.set(g,{meshes:e});for(let b=0,S=x.length;b<S;b++)g.add(x[b]);return g})}loadCamera(e){let t;const n=this.json.cameras[e],i=n[n.type];if(!i){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return n.type==="perspective"?t=new Ba(zf.radToDeg(i.yfov),i.aspectRatio||1,i.znear||1,i.zfar||2e6):n.type==="orthographic"&&(t=new El(-i.xmag,i.xmag,i.ymag,-i.ymag,i.znear,i.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),Iu(t,n),Promise.resolve(t)}loadSkin(e){const t=this.json.skins[e],n=[];for(let i=0,a=t.joints.length;i<a;i++)n.push(this._loadNodeShallow(t.joints[i]));return t.inverseBindMatrices!==void 0?n.push(this.getDependency("accessor",t.inverseBindMatrices)):n.push(null),Promise.all(n).then(function(i){const a=i.pop(),o=i,c=[],u=[];for(let h=0,m=o.length;h<m;h++){const x=o[h];if(x){c.push(x);const g=new wn;a!==null&&g.fromArray(a.array,h*16),u.push(g)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[h])}return new Ex(c,u)})}loadAnimation(e){const t=this.json,n=this,i=t.animations[e],a=i.name?i.name:"animation_"+e,o=[],c=[],u=[],h=[],m=[];for(let x=0,g=i.channels.length;x<g;x++){const b=i.channels[x],S=i.samplers[b.sampler],C=b.target,M=C.node,A=i.parameters!==void 0?i.parameters[S.input]:S.input,R=i.parameters!==void 0?i.parameters[S.output]:S.output;C.node!==void 0&&(o.push(this.getDependency("node",M)),c.push(this.getDependency("accessor",A)),u.push(this.getDependency("accessor",R)),h.push(S),m.push(C))}return Promise.all([Promise.all(o),Promise.all(c),Promise.all(u),Promise.all(h),Promise.all(m)]).then(function(x){const g=x[0],b=x[1],S=x[2],C=x[3],M=x[4],A=[];for(let R=0,N=g.length;R<N;R++){const B=g[R],F=b[R],U=S[R],z=C[R],P=M[R];if(B===void 0)continue;B.updateMatrix&&B.updateMatrix();const L=n._createAnimationTracks(B,F,U,z,P);if(L)for(let O=0;O<L.length;O++)A.push(L[O])}return new $p(a,void 0,A)})}createNodeMesh(e){const t=this.json,n=this,i=t.nodes[e];return i.mesh===void 0?null:n.getDependency("mesh",i.mesh).then(function(a){const o=n._getNodeRef(n.meshCache,i.mesh,a);return i.weights!==void 0&&o.traverse(function(c){if(c.isMesh)for(let u=0,h=i.weights.length;u<h;u++)c.morphTargetInfluences[u]=i.weights[u]}),o})}loadNode(e){const t=this.json,n=this,i=t.nodes[e],a=n._loadNodeShallow(e),o=[],c=i.children||[];for(let h=0,m=c.length;h<m;h++)o.push(n.getDependency("node",c[h]));const u=i.skin===void 0?Promise.resolve(null):n.getDependency("skin",i.skin);return Promise.all([a,Promise.all(o),u]).then(function(h){const m=h[0],x=h[1],g=h[2];g!==null&&m.traverse(function(b){b.isSkinnedMesh&&b.bind(g,GP)});for(let b=0,S=x.length;b<S;b++)m.add(x[b]);return m})}_loadNodeShallow(e){const t=this.json,n=this.extensions,i=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const a=t.nodes[e],o=a.name?i.createUniqueName(a.name):"",c=[],u=i._invokeOne(function(h){return h.createNodeMesh&&h.createNodeMesh(e)});return u&&c.push(u),a.camera!==void 0&&c.push(i.getDependency("camera",a.camera).then(function(h){return i._getNodeRef(i.cameraCache,a.camera,h)})),i._invokeAll(function(h){return h.createNodeAttachment&&h.createNodeAttachment(e)}).forEach(function(h){c.push(h)}),this.nodeCache[e]=Promise.all(c).then(function(h){let m;if(a.isBone===!0?m=new vy:h.length>1?m=new Yc:h.length===1?m=h[0]:m=new ai,m!==h[0])for(let x=0,g=h.length;x<g;x++)m.add(h[x]);if(a.name&&(m.userData.name=a.name,m.name=o),Iu(m,a),a.extensions&&Fh(n,m,a),a.matrix!==void 0){const x=new wn;x.fromArray(a.matrix),m.applyMatrix4(x)}else a.translation!==void 0&&m.position.fromArray(a.translation),a.rotation!==void 0&&m.quaternion.fromArray(a.rotation),a.scale!==void 0&&m.scale.fromArray(a.scale);return i.associations.has(m)||i.associations.set(m,{}),i.associations.get(m).nodes=e,m}),this.nodeCache[e]}loadScene(e){const t=this.extensions,n=this.json.scenes[e],i=this,a=new Yc;n.name&&(a.name=i.createUniqueName(n.name)),Iu(a,n),n.extensions&&Fh(t,a,n);const o=n.nodes||[],c=[];for(let u=0,h=o.length;u<h;u++)c.push(i.getDependency("node",o[u]));return Promise.all(c).then(function(u){for(let m=0,x=u.length;m<x;m++)a.add(u[m]);const h=m=>{const x=new Map;for(const[g,b]of i.associations)(g instanceof os||g instanceof Wi)&&x.set(g,b);return m.traverse(g=>{const b=i.associations.get(g);b!=null&&x.set(g,b)}),x};return i.associations=h(a),a})}_createAnimationTracks(e,t,n,i,a){const o=[],c=e.name?e.name:e.uuid,u=[];Mf[a.path]===Mf.weights?e.traverse(function(g){g.morphTargetInfluences&&u.push(g.name?g.name:g.uuid)}):u.push(c);let h;switch(Mf[a.path]){case Mf.weights:h=ad;break;case Mf.rotation:h=sd;break;case Mf.position:case Mf.scale:h=rd;break;default:switch(n.itemSize){case 1:h=ad;break;case 2:case 3:default:h=rd;break}break}const m=i.interpolation!==void 0?LP[i.interpolation]:Vp,x=this._getArrayFromAccessor(n);for(let g=0,b=u.length;g<b;g++){const S=new h(u[g]+"."+Mf[a.path],t.array,x,m);i.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(S),o.push(S)}return o}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const n=K_(t.constructor),i=new Float32Array(t.length);for(let a=0,o=t.length;a<o;a++)i[a]=t[a]*n;t=i}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(n){const i=this instanceof sd?UP:kT;return new i(this.times,this.values,this.getValueSize()/3,n)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function HP(s,e,t){const n=e.attributes,i=new Yi;if(n.POSITION!==void 0){const c=t.json.accessors[n.POSITION],u=c.min,h=c.max;if(u!==void 0&&h!==void 0){if(i.set(new k(u[0],u[1],u[2]),new k(h[0],h[1],h[2])),c.normalized){const m=K_(Op[c.componentType]);i.min.multiplyScalar(m),i.max.multiplyScalar(m)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const a=e.targets;if(a!==void 0){const c=new k,u=new k;for(let h=0,m=a.length;h<m;h++){const x=a[h];if(x.POSITION!==void 0){const g=t.json.accessors[x.POSITION],b=g.min,S=g.max;if(b!==void 0&&S!==void 0){if(u.setX(Math.max(Math.abs(b[0]),Math.abs(S[0]))),u.setY(Math.max(Math.abs(b[1]),Math.abs(S[1]))),u.setZ(Math.max(Math.abs(b[2]),Math.abs(S[2]))),g.normalized){const C=K_(Op[g.componentType]);u.multiplyScalar(C)}c.max(u)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}i.expandByVector(c)}s.boundingBox=i;const o=new rs;i.getCenter(o.center),o.radius=i.min.distanceTo(i.max)/2,s.boundingSphere=o}function PE(s,e,t){const n=e.attributes,i=[];function a(o,c){return t.getDependency("accessor",o).then(function(u){s.setAttribute(c,u)})}for(const o in n){const c=Z_[o]||o.toLowerCase();c in s.attributes||i.push(a(n[o],c))}if(e.indices!==void 0&&!s.index){const o=t.getDependency("accessor",e.indices).then(function(c){s.setIndex(c)});i.push(o)}return Iu(s,e),HP(s,e,t),Promise.all(i).then(function(){return e.targets!==void 0?IP(s,e.targets,t):s})}class kP extends OS{constructor(e){super(e),this.type=xs}parse(e){const o=function(P,L){switch(P){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(L||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(L||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(L||""));default:case 4:throw new Error("THREE.RGBELoader: Memory Error: "+(L||""))}},x=function(P,L,O){L=L||1024;let Q=P.pos,te=-1,ne=0,re="",j=String.fromCharCode.apply(null,new Uint16Array(P.subarray(Q,Q+128)));for(;0>(te=j.indexOf(`
`))&&ne<L&&Q<P.byteLength;)re+=j,ne+=j.length,Q+=128,j+=String.fromCharCode.apply(null,new Uint16Array(P.subarray(Q,Q+128)));return-1<te?(P.pos+=ne+te+1,re+j.slice(0,te)):!1},g=function(P){const L=/^#\?(\S+)/,O=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,ee=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,Q=/^\s*FORMAT=(\S+)\s*$/,te=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,ne={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let re,j;for((P.pos>=P.byteLength||!(re=x(P)))&&o(1,"no header found"),(j=re.match(L))||o(3,"bad initial token"),ne.valid|=1,ne.programtype=j[1],ne.string+=re+`
`;re=x(P),re!==!1;){if(ne.string+=re+`
`,re.charAt(0)==="#"){ne.comments+=re+`
`;continue}if((j=re.match(O))&&(ne.gamma=parseFloat(j[1])),(j=re.match(ee))&&(ne.exposure=parseFloat(j[1])),(j=re.match(Q))&&(ne.valid|=2,ne.format=j[1]),(j=re.match(te))&&(ne.valid|=4,ne.height=parseInt(j[1],10),ne.width=parseInt(j[2],10)),ne.valid&2&&ne.valid&4)break}return ne.valid&2||o(3,"missing format specifier"),ne.valid&4||o(3,"missing image size specifier"),ne},b=function(P,L,O){const ee=L;if(ee<8||ee>32767||P[0]!==2||P[1]!==2||P[2]&128)return new Uint8Array(P);ee!==(P[2]<<8|P[3])&&o(3,"wrong scanline width");const Q=new Uint8Array(4*L*O);Q.length||o(4,"unable to allocate buffer space");let te=0,ne=0;const re=4*ee,j=new Uint8Array(4),ae=new Uint8Array(re);let J=O;for(;J>0&&ne<P.byteLength;){ne+4>P.byteLength&&o(1),j[0]=P[ne++],j[1]=P[ne++],j[2]=P[ne++],j[3]=P[ne++],(j[0]!=2||j[1]!=2||(j[2]<<8|j[3])!=ee)&&o(3,"bad rgbe scanline format");let ie=0,se;for(;ie<re&&ne<P.byteLength;){se=P[ne++];const W=se>128;if(W&&(se-=128),(se===0||ie+se>re)&&o(3,"bad scanline data"),W){const fe=P[ne++];for(let Z=0;Z<se;Z++)ae[ie++]=fe}else ae.set(P.subarray(ne,ne+se),ie),ie+=se,ne+=se}const I=ee;for(let W=0;W<I;W++){let fe=0;Q[te]=ae[W+fe],fe+=ee,Q[te+1]=ae[W+fe],fe+=ee,Q[te+2]=ae[W+fe],fe+=ee,Q[te+3]=ae[W+fe],te+=4}J--}return Q},S=function(P,L,O,ee){const Q=P[L+3],te=Math.pow(2,Q-128)/255;O[ee+0]=P[L+0]*te,O[ee+1]=P[L+1]*te,O[ee+2]=P[L+2]*te,O[ee+3]=1},C=function(P,L,O,ee){const Q=P[L+3],te=Math.pow(2,Q-128)/255;O[ee+0]=Wh.toHalfFloat(Math.min(P[L+0]*te,65504)),O[ee+1]=Wh.toHalfFloat(Math.min(P[L+1]*te,65504)),O[ee+2]=Wh.toHalfFloat(Math.min(P[L+2]*te,65504)),O[ee+3]=Wh.toHalfFloat(1)},M=new Uint8Array(e);M.pos=0;const A=g(M),R=A.width,N=A.height,B=b(M.subarray(M.pos),R,N);let F,U,z;switch(this.type){case Da:z=B.length/4;const P=new Float32Array(z*4);for(let O=0;O<z;O++)S(B,O*4,P,O*4);F=P,U=Da;break;case xs:z=B.length/4;const L=new Uint16Array(z*4);for(let O=0;O<z;O++)C(B,O*4,L,O*4);F=L,U=xs;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:R,height:N,data:F,header:A.string,gamma:A.gamma,exposure:A.exposure,type:U}}setDataType(e){return this.type=e,this}load(e,t,n,i){function a(o,c){switch(o.type){case Da:case xs:"colorSpace"in o?o.colorSpace="srgb-linear":o.encoding=3e3,o.minFilter=bi,o.magFilter=bi,o.generateMipmaps=!1,o.flipY=!0;break}t&&t(o,c)}return super.load(e,a,n,i)}}const zm=Dx>=152;class VP extends OS{constructor(e){super(e),this.type=xs}parse(e){const L=Math.pow(2.7182818,2.2);function O(q,he){for(var we=0,Je=0;Je<65536;++Je)(Je==0||q[Je>>3]&1<<(Je&7))&&(he[we++]=Je);for(var ot=we-1;we<65536;)he[we++]=0;return ot}function ee(q){for(var he=0;he<16384;he++)q[he]={},q[he].len=0,q[he].lit=0,q[he].p=null}const Q={l:0,c:0,lc:0};function te(q,he,we,Je,ot){for(;we<q;)he=he<<8|ft(Je,ot),we+=8;we-=q,Q.l=he>>we&(1<<q)-1,Q.c=he,Q.lc=we}const ne=new Array(59);function re(q){for(var he=0;he<=58;++he)ne[he]=0;for(var he=0;he<65537;++he)ne[q[he]]+=1;for(var we=0,he=58;he>0;--he){var Je=we+ne[he]>>1;ne[he]=we,we=Je}for(var he=0;he<65537;++he){var ot=q[he];ot>0&&(q[he]=ot|ne[ot]++<<6)}}function j(q,he,we,Je,ot,ct,Ot){for(var Dt=we,Nt=0,K=0;ot<=ct;ot++){if(Dt.value-we.value>Je)return!1;te(6,Nt,K,q,Dt);var be=Q.l;if(Nt=Q.c,K=Q.lc,Ot[ot]=be,be==63){if(Dt.value-we.value>Je)throw"Something wrong with hufUnpackEncTable";te(8,Nt,K,q,Dt);var xe=Q.l+6;if(Nt=Q.c,K=Q.lc,ot+xe>ct+1)throw"Something wrong with hufUnpackEncTable";for(;xe--;)Ot[ot++]=0;ot--}else if(be>=59){var xe=be-59+2;if(ot+xe>ct+1)throw"Something wrong with hufUnpackEncTable";for(;xe--;)Ot[ot++]=0;ot--}}re(Ot)}function ae(q){return q&63}function J(q){return q>>6}function ie(q,he,we,Je){for(;he<=we;he++){var ot=J(q[he]),ct=ae(q[he]);if(ot>>ct)throw"Invalid table entry";if(ct>14){var Ot=Je[ot>>ct-14];if(Ot.len)throw"Invalid table entry";if(Ot.lit++,Ot.p){var Dt=Ot.p;Ot.p=new Array(Ot.lit);for(var Nt=0;Nt<Ot.lit-1;++Nt)Ot.p[Nt]=Dt[Nt]}else Ot.p=new Array(1);Ot.p[Ot.lit-1]=he}else if(ct)for(var K=0,Nt=1<<14-ct;Nt>0;Nt--){var Ot=Je[(ot<<14-ct)+K];if(Ot.len||Ot.p)throw"Invalid table entry";Ot.len=ct,Ot.lit=he,K++}}return!0}const se={c:0,lc:0};function I(q,he,we,Je){q=q<<8|ft(we,Je),he+=8,se.c=q,se.lc=he}const W={c:0,lc:0};function fe(q,he,we,Je,ot,ct,Ot,Dt,Nt,K){if(q==he){Je<8&&(I(we,Je,ot,Ot),we=se.c,Je=se.lc),Je-=8;var be=we>>Je,be=new Uint8Array([be])[0];if(Nt.value+be>K)return!1;for(var xe=Dt[Nt.value-1];be-- >0;)Dt[Nt.value++]=xe}else if(Nt.value<K)Dt[Nt.value++]=q;else return!1;W.c=we,W.lc=Je}function Z(q){return q&65535}function me(q){var he=Z(q);return he>32767?he-65536:he}const $={a:0,b:0};function pe(q,he){var we=me(q),Je=me(he),ot=Je,ct=we+(ot&1)+(ot>>1),Ot=ct,Dt=ct-ot;$.a=Ot,$.b=Dt}function ve(q,he){var we=Z(q),Je=Z(he),ot=we-(Je>>1)&65535,ct=Je+ot-32768&65535;$.a=ct,$.b=ot}function ze(q,he,we,Je,ot,ct,Ot){for(var Dt=Ot<16384,Nt=we>ot?ot:we,K=1,be;K<=Nt;)K<<=1;for(K>>=1,be=K,K>>=1;K>=1;){for(var xe=0,Oe=xe+ct*(ot-be),Me=ct*K,$e=ct*be,yt=Je*K,Mt=Je*be,Ft,mt,Pt,en;xe<=Oe;xe+=$e){for(var Qt=xe,yn=xe+Je*(we-be);Qt<=yn;Qt+=Mt){var ln=Qt+yt,xn=Qt+Me,Un=xn+yt;Dt?(pe(q[Qt+he],q[xn+he]),Ft=$.a,Pt=$.b,pe(q[ln+he],q[Un+he]),mt=$.a,en=$.b,pe(Ft,mt),q[Qt+he]=$.a,q[ln+he]=$.b,pe(Pt,en),q[xn+he]=$.a,q[Un+he]=$.b):(ve(q[Qt+he],q[xn+he]),Ft=$.a,Pt=$.b,ve(q[ln+he],q[Un+he]),mt=$.a,en=$.b,ve(Ft,mt),q[Qt+he]=$.a,q[ln+he]=$.b,ve(Pt,en),q[xn+he]=$.a,q[Un+he]=$.b)}if(we&K){var xn=Qt+Me;Dt?pe(q[Qt+he],q[xn+he]):ve(q[Qt+he],q[xn+he]),Ft=$.a,q[xn+he]=$.b,q[Qt+he]=Ft}}if(ot&K)for(var Qt=xe,yn=xe+Je*(we-be);Qt<=yn;Qt+=Mt){var ln=Qt+yt;Dt?pe(q[Qt+he],q[ln+he]):ve(q[Qt+he],q[ln+he]),Ft=$.a,q[ln+he]=$.b,q[Qt+he]=Ft}be=K,K>>=1}return xe}function Ge(q,he,we,Je,ot,ct,Ot,Dt,Nt,K){for(var be=0,xe=0,Oe=Dt,Me=Math.trunc(ot.value+(ct+7)/8);ot.value<Me;)for(I(be,xe,we,ot),be=se.c,xe=se.lc;xe>=14;){var $e=be>>xe-14&16383,yt=he[$e];if(yt.len)xe-=yt.len,fe(yt.lit,Ot,be,xe,we,Je,ot,Nt,K,Oe),be=W.c,xe=W.lc;else{if(!yt.p)throw"hufDecode issues";var Mt;for(Mt=0;Mt<yt.lit;Mt++){for(var Ft=ae(q[yt.p[Mt]]);xe<Ft&&ot.value<Me;)I(be,xe,we,ot),be=se.c,xe=se.lc;if(xe>=Ft&&J(q[yt.p[Mt]])==(be>>xe-Ft&(1<<Ft)-1)){xe-=Ft,fe(yt.p[Mt],Ot,be,xe,we,Je,ot,Nt,K,Oe),be=W.c,xe=W.lc;break}}if(Mt==yt.lit)throw"hufDecode issues"}}var mt=8-ct&7;for(be>>=mt,xe-=mt;xe>0;){var yt=he[be<<14-xe&16383];if(yt.len)xe-=yt.len,fe(yt.lit,Ot,be,xe,we,Je,ot,Nt,K,Oe),be=W.c,xe=W.lc;else throw"hufDecode issues"}return!0}function Fe(q,he,we,Je,ot,ct){var Ot={value:0},Dt=we.value,Nt=We(he,we),K=We(he,we);we.value+=4;var be=We(he,we);if(we.value+=4,Nt<0||Nt>=65537||K<0||K>=65537)throw"Something wrong with HUF_ENCSIZE";var xe=new Array(65537),Oe=new Array(16384);ee(Oe);var Me=Je-(we.value-Dt);if(j(q,he,we,Me,Nt,K,xe),be>8*(Je-(we.value-Dt)))throw"Something wrong with hufUncompress";ie(xe,Nt,K,Oe),Ge(xe,Oe,q,he,we,be,K,ct,ot,Ot)}function Qe(q,he,we){for(var Je=0;Je<we;++Je)he[Je]=q[he[Je]]}function lt(q){for(var he=1;he<q.length;he++){var we=q[he-1]+q[he]-128;q[he]=we}}function De(q,he){for(var we=0,Je=Math.floor((q.length+1)/2),ot=0,ct=q.length-1;!(ot>ct||(he[ot++]=q[we++],ot>ct));)he[ot++]=q[Je++]}function le(q){for(var he=q.byteLength,we=new Array,Je=0,ot=new DataView(q);he>0;){var ct=ot.getInt8(Je++);if(ct<0){var Ot=-ct;he-=Ot+1;for(var Dt=0;Dt<Ot;Dt++)we.push(ot.getUint8(Je++))}else{var Ot=ct;he-=2;for(var Nt=ot.getUint8(Je++),Dt=0;Dt<Ot+1;Dt++)we.push(Nt)}}return we}function Ye(q,he,we,Je,ot,ct){var ln=new DataView(ct.buffer),Ot=we[q.idx[0]].width,Dt=we[q.idx[0]].height,Nt=3,K=Math.floor(Ot/8),be=Math.ceil(Ot/8),xe=Math.ceil(Dt/8),Oe=Ot-(be-1)*8,Me=Dt-(xe-1)*8,$e={value:0},yt=new Array(Nt),Mt=new Array(Nt),Ft=new Array(Nt),mt=new Array(Nt),Pt=new Array(Nt);for(let tn=0;tn<Nt;++tn)Pt[tn]=he[q.idx[tn]],yt[tn]=tn<1?0:yt[tn-1]+be*xe,Mt[tn]=new Float32Array(64),Ft[tn]=new Uint16Array(64),mt[tn]=new Uint16Array(be*64);for(let tn=0;tn<xe;++tn){var en=8;tn==xe-1&&(en=Me);var Qt=8;for(let kn=0;kn<be;++kn){kn==be-1&&(Qt=Oe);for(let hn=0;hn<Nt;++hn)Ft[hn].fill(0),Ft[hn][0]=ot[yt[hn]++],Ze($e,Je,Ft[hn]),je(Ft[hn],Mt[hn]),He(Mt[hn]);et(Mt);for(let hn=0;hn<Nt;++hn)Ne(Mt[hn],mt[hn],kn*64)}let Hn=0;for(let kn=0;kn<Nt;++kn){const hn=we[q.idx[kn]].type;for(let Ni=8*tn;Ni<8*tn+en;++Ni){Hn=Pt[kn][Ni];for(let Yn=0;Yn<K;++Yn){const Wn=Yn*64+(Ni&7)*8;ln.setUint16(Hn+0*hn,mt[kn][Wn+0],!0),ln.setUint16(Hn+2*hn,mt[kn][Wn+1],!0),ln.setUint16(Hn+4*hn,mt[kn][Wn+2],!0),ln.setUint16(Hn+6*hn,mt[kn][Wn+3],!0),ln.setUint16(Hn+8*hn,mt[kn][Wn+4],!0),ln.setUint16(Hn+10*hn,mt[kn][Wn+5],!0),ln.setUint16(Hn+12*hn,mt[kn][Wn+6],!0),ln.setUint16(Hn+14*hn,mt[kn][Wn+7],!0),Hn+=16*hn}}if(K!=be)for(let Ni=8*tn;Ni<8*tn+en;++Ni){const Yn=Pt[kn][Ni]+8*K*2*hn,Wn=K*64+(Ni&7)*8;for(let xi=0;xi<Qt;++xi)ln.setUint16(Yn+xi*2*hn,mt[kn][Wn+xi],!0)}}}for(var yn=new Uint16Array(Ot),ln=new DataView(ct.buffer),xn=0;xn<Nt;++xn){we[q.idx[xn]].decoded=!0;var Un=we[q.idx[xn]].type;if(we[xn].type==2)for(var an=0;an<Dt;++an){const tn=Pt[xn][an];for(var Bn=0;Bn<Ot;++Bn)yn[Bn]=ln.getUint16(tn+Bn*2*Un,!0);for(var Bn=0;Bn<Ot;++Bn)ln.setFloat32(tn+Bn*2*Un,Re(yn[Bn]),!0)}}}function Ze(q,he,we){for(var Je,ot=1;ot<64;)Je=he[q.value],Je==65280?ot=64:Je>>8==255?ot+=Je&255:(we[ot]=Je,ot++),q.value++}function je(q,he){he[0]=Re(q[0]),he[1]=Re(q[1]),he[2]=Re(q[5]),he[3]=Re(q[6]),he[4]=Re(q[14]),he[5]=Re(q[15]),he[6]=Re(q[27]),he[7]=Re(q[28]),he[8]=Re(q[2]),he[9]=Re(q[4]),he[10]=Re(q[7]),he[11]=Re(q[13]),he[12]=Re(q[16]),he[13]=Re(q[26]),he[14]=Re(q[29]),he[15]=Re(q[42]),he[16]=Re(q[3]),he[17]=Re(q[8]),he[18]=Re(q[12]),he[19]=Re(q[17]),he[20]=Re(q[25]),he[21]=Re(q[30]),he[22]=Re(q[41]),he[23]=Re(q[43]),he[24]=Re(q[9]),he[25]=Re(q[11]),he[26]=Re(q[18]),he[27]=Re(q[24]),he[28]=Re(q[31]),he[29]=Re(q[40]),he[30]=Re(q[44]),he[31]=Re(q[53]),he[32]=Re(q[10]),he[33]=Re(q[19]),he[34]=Re(q[23]),he[35]=Re(q[32]),he[36]=Re(q[39]),he[37]=Re(q[45]),he[38]=Re(q[52]),he[39]=Re(q[54]),he[40]=Re(q[20]),he[41]=Re(q[22]),he[42]=Re(q[33]),he[43]=Re(q[38]),he[44]=Re(q[46]),he[45]=Re(q[51]),he[46]=Re(q[55]),he[47]=Re(q[60]),he[48]=Re(q[21]),he[49]=Re(q[34]),he[50]=Re(q[37]),he[51]=Re(q[47]),he[52]=Re(q[50]),he[53]=Re(q[56]),he[54]=Re(q[59]),he[55]=Re(q[61]),he[56]=Re(q[35]),he[57]=Re(q[36]),he[58]=Re(q[48]),he[59]=Re(q[49]),he[60]=Re(q[57]),he[61]=Re(q[58]),he[62]=Re(q[62]),he[63]=Re(q[63])}function He(q){const he=.5*Math.cos(.7853975),we=.5*Math.cos(3.14159/16),Je=.5*Math.cos(3.14159/8),ot=.5*Math.cos(3*3.14159/16),ct=.5*Math.cos(5*3.14159/16),Ot=.5*Math.cos(3*3.14159/8),Dt=.5*Math.cos(7*3.14159/16);for(var Nt=new Array(4),K=new Array(4),be=new Array(4),xe=new Array(4),Oe=0;Oe<8;++Oe){var Me=Oe*8;Nt[0]=Je*q[Me+2],Nt[1]=Ot*q[Me+2],Nt[2]=Je*q[Me+6],Nt[3]=Ot*q[Me+6],K[0]=we*q[Me+1]+ot*q[Me+3]+ct*q[Me+5]+Dt*q[Me+7],K[1]=ot*q[Me+1]-Dt*q[Me+3]-we*q[Me+5]-ct*q[Me+7],K[2]=ct*q[Me+1]-we*q[Me+3]+Dt*q[Me+5]+ot*q[Me+7],K[3]=Dt*q[Me+1]-ct*q[Me+3]+ot*q[Me+5]-we*q[Me+7],be[0]=he*(q[Me+0]+q[Me+4]),be[3]=he*(q[Me+0]-q[Me+4]),be[1]=Nt[0]+Nt[3],be[2]=Nt[1]-Nt[2],xe[0]=be[0]+be[1],xe[1]=be[3]+be[2],xe[2]=be[3]-be[2],xe[3]=be[0]-be[1],q[Me+0]=xe[0]+K[0],q[Me+1]=xe[1]+K[1],q[Me+2]=xe[2]+K[2],q[Me+3]=xe[3]+K[3],q[Me+4]=xe[3]-K[3],q[Me+5]=xe[2]-K[2],q[Me+6]=xe[1]-K[1],q[Me+7]=xe[0]-K[0]}for(var $e=0;$e<8;++$e)Nt[0]=Je*q[16+$e],Nt[1]=Ot*q[16+$e],Nt[2]=Je*q[48+$e],Nt[3]=Ot*q[48+$e],K[0]=we*q[8+$e]+ot*q[24+$e]+ct*q[40+$e]+Dt*q[56+$e],K[1]=ot*q[8+$e]-Dt*q[24+$e]-we*q[40+$e]-ct*q[56+$e],K[2]=ct*q[8+$e]-we*q[24+$e]+Dt*q[40+$e]+ot*q[56+$e],K[3]=Dt*q[8+$e]-ct*q[24+$e]+ot*q[40+$e]-we*q[56+$e],be[0]=he*(q[$e]+q[32+$e]),be[3]=he*(q[$e]-q[32+$e]),be[1]=Nt[0]+Nt[3],be[2]=Nt[1]-Nt[2],xe[0]=be[0]+be[1],xe[1]=be[3]+be[2],xe[2]=be[3]-be[2],xe[3]=be[0]-be[1],q[0+$e]=xe[0]+K[0],q[8+$e]=xe[1]+K[1],q[16+$e]=xe[2]+K[2],q[24+$e]=xe[3]+K[3],q[32+$e]=xe[3]-K[3],q[40+$e]=xe[2]-K[2],q[48+$e]=xe[1]-K[1],q[56+$e]=xe[0]-K[0]}function et(q){for(var he=0;he<64;++he){var we=q[0][he],Je=q[1][he],ot=q[2][he];q[0][he]=we+1.5747*ot,q[1][he]=we-.1873*Je-.4682*ot,q[2][he]=we+1.8556*Je}}function Ne(q,he,we){for(var Je=0;Je<64;++Je)he[we+Je]=Wh.toHalfFloat(st(q[Je]))}function st(q){return q<=1?Math.sign(q)*Math.pow(Math.abs(q),2.2):Math.sign(q)*Math.pow(L,Math.abs(q)-1)}function oe(q){return new DataView(q.array.buffer,q.offset.value,q.size)}function X(q){var he=q.viewer.buffer.slice(q.offset.value,q.offset.value+q.size),we=new Uint8Array(le(he)),Je=new Uint8Array(we.length);return lt(we),De(we,Je),new DataView(Je.buffer)}function Ae(q){var he=q.array.slice(q.offset.value,q.offset.value+q.size),we=Lv(he),Je=new Uint8Array(we.length);return lt(we),De(we,Je),new DataView(Je.buffer)}function Pe(q){for(var he=q.viewer,we={value:q.offset.value},Je=new Uint16Array(q.width*q.scanlineBlockSize*(q.channels*q.type)),ot=new Uint8Array(8192),ct=0,Ot=new Array(q.channels),Dt=0;Dt<q.channels;Dt++)Ot[Dt]={},Ot[Dt].start=ct,Ot[Dt].end=Ot[Dt].start,Ot[Dt].nx=q.width,Ot[Dt].ny=q.lines,Ot[Dt].size=q.type,ct+=Ot[Dt].nx*Ot[Dt].ny*Ot[Dt].size;var Nt=pt(he,we),K=pt(he,we);if(K>=8192)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(Nt<=K)for(var Dt=0;Dt<K-Nt+1;Dt++)ot[Dt+Nt]=ge(he,we);var be=new Uint16Array(65536),xe=O(ot,be),Oe=We(he,we);Fe(q.array,he,we,Oe,Je,ct);for(var Dt=0;Dt<q.channels;++Dt)for(var Me=Ot[Dt],$e=0;$e<Ot[Dt].size;++$e)ze(Je,Me.start+$e,Me.nx,Me.size,Me.ny,Me.nx*Me.size,xe);Qe(be,Je,ct);for(var yt=0,Mt=new Uint8Array(Je.buffer.byteLength),Ft=0;Ft<q.lines;Ft++)for(var mt=0;mt<q.channels;mt++){var Me=Ot[mt],Pt=Me.nx*Me.size,en=new Uint8Array(Je.buffer,Me.end*2,Pt*2);Mt.set(en,yt),yt+=Pt*2,Me.end+=Pt}return new DataView(Mt.buffer)}function Ue(q){var he=q.array.slice(q.offset.value,q.offset.value+q.size),we=Lv(he);const Je=q.lines*q.channels*q.width,ot=q.type==1?new Uint16Array(Je):new Uint32Array(Je);let ct=0,Ot=0;const Dt=new Array(4);for(let Nt=0;Nt<q.lines;Nt++)for(let K=0;K<q.channels;K++){let be=0;switch(q.type){case 1:Dt[0]=ct,Dt[1]=Dt[0]+q.width,ct=Dt[1]+q.width;for(let xe=0;xe<q.width;++xe){const Oe=we[Dt[0]++]<<8|we[Dt[1]++];be+=Oe,ot[Ot]=be,Ot++}break;case 2:Dt[0]=ct,Dt[1]=Dt[0]+q.width,Dt[2]=Dt[1]+q.width,ct=Dt[2]+q.width;for(let xe=0;xe<q.width;++xe){const Oe=we[Dt[0]++]<<24|we[Dt[1]++]<<16|we[Dt[2]++]<<8;be+=Oe,ot[Ot]=be,Ot++}break}}return new DataView(ot.buffer)}function Be(q){var he=q.viewer,we={value:q.offset.value},Je=new Uint8Array(q.width*q.lines*(q.channels*q.type*2)),ot={version:Ie(he,we),unknownUncompressedSize:Ie(he,we),unknownCompressedSize:Ie(he,we),acCompressedSize:Ie(he,we),dcCompressedSize:Ie(he,we),rleCompressedSize:Ie(he,we),rleUncompressedSize:Ie(he,we),rleRawSize:Ie(he,we),totalAcUncompressedCount:Ie(he,we),totalDcUncompressedCount:Ie(he,we),acCompression:Ie(he,we)};if(ot.version<2)throw"EXRLoader.parse: "+Mi.compression+" version "+ot.version+" is unsupported";for(var ct=new Array,Ot=pt(he,we)-2;Ot>0;){var Dt=bt(he.buffer,we),Nt=ge(he,we),K=Nt>>2&3,be=(Nt>>4)-1,xe=new Int8Array([be])[0],Oe=ge(he,we);ct.push({name:Dt,index:xe,type:Oe,compression:K}),Ot-=Dt.length+3}for(var Me=Mi.channels,$e=new Array(q.channels),yt=0;yt<q.channels;++yt){var Mt=$e[yt]={},Ft=Me[yt];Mt.name=Ft.name,Mt.compression=0,Mt.decoded=!1,Mt.type=Ft.pixelType,Mt.pLinear=Ft.pLinear,Mt.width=q.width,Mt.height=q.lines}for(var mt={idx:new Array(3)},Pt=0;Pt<q.channels;++Pt)for(var Mt=$e[Pt],yt=0;yt<ct.length;++yt){var en=ct[yt];Mt.name==en.name&&(Mt.compression=en.compression,en.index>=0&&(mt.idx[en.index]=Pt),Mt.offset=Pt)}if(ot.acCompressedSize>0)switch(ot.acCompression){case 0:var ln=new Uint16Array(ot.totalAcUncompressedCount);Fe(q.array,he,we,ot.acCompressedSize,ln,ot.totalAcUncompressedCount);break;case 1:var Qt=q.array.slice(we.value,we.value+ot.totalAcUncompressedCount),yn=Lv(Qt),ln=new Uint16Array(yn.buffer);we.value+=ot.totalAcUncompressedCount;break}if(ot.dcCompressedSize>0){var xn={array:q.array,offset:we,size:ot.dcCompressedSize},Un=new Uint16Array(Ae(xn).buffer);we.value+=ot.dcCompressedSize}if(ot.rleRawSize>0){var Qt=q.array.slice(we.value,we.value+ot.rleCompressedSize),yn=Lv(Qt),an=le(yn.buffer);we.value+=ot.rleCompressedSize}for(var Bn=0,tn=new Array($e.length),yt=0;yt<tn.length;++yt)tn[yt]=new Array;for(var Hn=0;Hn<q.lines;++Hn)for(var kn=0;kn<$e.length;++kn)tn[kn].push(Bn),Bn+=$e[kn].width*q.type*2;Ye(mt,tn,$e,ln,Un,Je);for(var yt=0;yt<$e.length;++yt){var Mt=$e[yt];if(!Mt.decoded)switch(Mt.compression){case 2:for(var hn=0,Ni=0,Hn=0;Hn<q.lines;++Hn){for(var Yn=tn[yt][hn],Wn=0;Wn<Mt.width;++Wn){for(var xi=0;xi<2*Mt.type;++xi)Je[Yn++]=an[Ni+xi*Mt.width*Mt.height];Ni++}hn++}break;case 1:default:throw"EXRLoader.parse: unsupported channel compression"}}return new DataView(Je.buffer)}function bt(q,he){for(var we=new Uint8Array(q),Je=0;we[he.value+Je]!=0;)Je+=1;var ot=new TextDecoder().decode(we.slice(he.value,he.value+Je));return he.value=he.value+Je+1,ot}function vt(q,he,we){var Je=new TextDecoder().decode(new Uint8Array(q).slice(he.value,he.value+we));return he.value=he.value+we,Je}function It(q,he){var we=qe(q,he),Je=We(q,he);return[we,Je]}function zt(q,he){var we=We(q,he),Je=We(q,he);return[we,Je]}function qe(q,he){var we=q.getInt32(he.value,!0);return he.value=he.value+4,we}function We(q,he){var we=q.getUint32(he.value,!0);return he.value=he.value+4,we}function ft(q,he){var we=q[he.value];return he.value=he.value+1,we}function ge(q,he){var we=q.getUint8(he.value);return he.value=he.value+1,we}const Ie=function(q,he){let we;return"getBigInt64"in DataView.prototype?we=Number(q.getBigInt64(he.value,!0)):we=q.getUint32(he.value+4,!0)+Number(q.getUint32(he.value,!0)<<32),he.value+=8,we};function ht(q,he){var we=q.getFloat32(he.value,!0);return he.value+=4,we}function ye(q,he){return Wh.toHalfFloat(ht(q,he))}function Re(q){var he=(q&31744)>>10,we=q&1023;return(q>>15?-1:1)*(he?he===31?we?NaN:1/0:Math.pow(2,he-15)*(1+we/1024):6103515625e-14*(we/1024))}function pt(q,he){var we=q.getUint16(he.value,!0);return he.value+=2,we}function Rt(q,he){return Re(pt(q,he))}function dt(q,he,we,Je){for(var ot=we.value,ct=[];we.value<ot+Je-1;){var Ot=bt(he,we),Dt=qe(q,we),Nt=ge(q,we);we.value+=3;var K=qe(q,we),be=qe(q,we);ct.push({name:Ot,pixelType:Dt,pLinear:Nt,xSampling:K,ySampling:be})}return we.value+=1,ct}function Ke(q,he){var we=ht(q,he),Je=ht(q,he),ot=ht(q,he),ct=ht(q,he),Ot=ht(q,he),Dt=ht(q,he),Nt=ht(q,he),K=ht(q,he);return{redX:we,redY:Je,greenX:ot,greenY:ct,blueX:Ot,blueY:Dt,whiteX:Nt,whiteY:K}}function Lt(q,he){var we=["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"],Je=ge(q,he);return we[Je]}function Vt(q,he){var we=We(q,he),Je=We(q,he),ot=We(q,he),ct=We(q,he);return{xMin:we,yMin:Je,xMax:ot,yMax:ct}}function Kt(q,he){var we=["INCREASING_Y"],Je=ge(q,he);return we[Je]}function on(q,he){var we=ht(q,he),Je=ht(q,he);return[we,Je]}function Gn(q,he){var we=ht(q,he),Je=ht(q,he),ot=ht(q,he);return[we,Je,ot]}function En(q,he,we,Je,ot){if(Je==="string"||Je==="stringvector"||Je==="iccProfile")return vt(he,we,ot);if(Je==="chlist")return dt(q,he,we,ot);if(Je==="chromaticities")return Ke(q,we);if(Je==="compression")return Lt(q,we);if(Je==="box2i")return Vt(q,we);if(Je==="lineOrder")return Kt(q,we);if(Je==="float")return ht(q,we);if(Je==="v2f")return on(q,we);if(Je==="v3f")return Gn(q,we);if(Je==="int")return qe(q,we);if(Je==="rational")return It(q,we);if(Je==="timecode")return zt(q,we);if(Je==="preview")return we.value+=ot,"skipped";we.value+=ot}function li(q,he,we){const Je={};if(q.getUint32(0,!0)!=20000630)throw"THREE.EXRLoader: provided file doesn't appear to be in OpenEXR format.";Je.version=q.getUint8(4);const ot=q.getUint8(5);Je.spec={singleTile:!!(ot&2),longName:!!(ot&4),deepFormat:!!(ot&8),multiPart:!!(ot&16)},we.value=8;for(var ct=!0;ct;){var Ot=bt(he,we);if(Ot==0)ct=!1;else{var Dt=bt(he,we),Nt=We(q,we),K=En(q,he,we,Dt,Nt);K===void 0?console.warn(`EXRLoader.parse: skipped unknown header attribute type '${Dt}'.`):Je[Ot]=K}}if((ot&-5)!=0)throw console.error("EXRHeader:",Je),"THREE.EXRLoader: provided file is currently unsupported.";return Je}function qi(q,he,we,Je,ot){const ct={size:0,viewer:he,array:we,offset:Je,width:q.dataWindow.xMax-q.dataWindow.xMin+1,height:q.dataWindow.yMax-q.dataWindow.yMin+1,channels:q.channels.length,bytesPerLine:null,lines:null,inputSize:null,type:q.channels[0].pixelType,uncompress:null,getter:null,format:null,[zm?"colorSpace":"encoding"]:null};switch(q.compression){case"NO_COMPRESSION":ct.lines=1,ct.uncompress=oe;break;case"RLE_COMPRESSION":ct.lines=1,ct.uncompress=X;break;case"ZIPS_COMPRESSION":ct.lines=1,ct.uncompress=Ae;break;case"ZIP_COMPRESSION":ct.lines=16,ct.uncompress=Ae;break;case"PIZ_COMPRESSION":ct.lines=32,ct.uncompress=Pe;break;case"PXR24_COMPRESSION":ct.lines=16,ct.uncompress=Ue;break;case"DWAA_COMPRESSION":ct.lines=32,ct.uncompress=Be;break;case"DWAB_COMPRESSION":ct.lines=256,ct.uncompress=Be;break;default:throw"EXRLoader.parse: "+q.compression+" is unsupported"}if(ct.scanlineBlockSize=ct.lines,ct.type==1)switch(ot){case Da:ct.getter=Rt,ct.inputSize=2;break;case xs:ct.getter=pt,ct.inputSize=2;break}else if(ct.type==2)switch(ot){case Da:ct.getter=ht,ct.inputSize=4;break;case xs:ct.getter=ye,ct.inputSize=4}else throw"EXRLoader.parse: unsupported pixelType "+ct.type+" for "+q.compression+".";ct.blockCount=(q.dataWindow.yMax+1)/ct.scanlineBlockSize;for(var Ot=0;Ot<ct.blockCount;Ot++)Ie(he,Je);ct.outputChannels=ct.channels==3?4:ct.channels;const Dt=ct.width*ct.height*ct.outputChannels;switch(ot){case Da:ct.byteArray=new Float32Array(Dt),ct.channels<ct.outputChannels&&ct.byteArray.fill(1,0,Dt);break;case xs:ct.byteArray=new Uint16Array(Dt),ct.channels<ct.outputChannels&&ct.byteArray.fill(15360,0,Dt);break;default:console.error("THREE.EXRLoader: unsupported type: ",ot);break}return ct.bytesPerLine=ct.width*ct.inputSize*ct.channels,ct.outputChannels==4?ct.format=ss:ct.format=Sx,zm?ct.colorSpace="srgb-linear":ct.encoding=3e3,ct}const la=new DataView(e),di=new Uint8Array(e),Qi={value:0},Mi=li(la,e,Qi),mn=qi(Mi,la,di,Qi,this.type),jn={value:0},bn={R:0,G:1,B:2,A:3,Y:0};for(let q=0;q<mn.height/mn.scanlineBlockSize;q++){const he=We(la,Qi);mn.size=We(la,Qi),mn.lines=he+mn.scanlineBlockSize>mn.height?mn.height-he:mn.scanlineBlockSize;const Je=mn.size<mn.lines*mn.bytesPerLine?mn.uncompress(mn):oe(mn);Qi.value+=mn.size;for(let ot=0;ot<mn.scanlineBlockSize;ot++){const ct=ot+q*mn.scanlineBlockSize;if(ct>=mn.height)break;for(let Ot=0;Ot<mn.channels;Ot++){const Dt=bn[Mi.channels[Ot].name];for(let Nt=0;Nt<mn.width;Nt++){jn.value=(ot*(mn.channels*mn.width)+Ot*mn.width+Nt)*mn.inputSize;const K=(mn.height-1-ct)*(mn.width*mn.outputChannels)+Nt*mn.outputChannels+Dt;mn.byteArray[K]=mn.getter(Je,jn)}}}}return{header:Mi,width:mn.width,height:mn.height,data:mn.byteArray,format:mn.format,[zm?"colorSpace":"encoding"]:mn[zm?"colorSpace":"encoding"],type:this.type}}setDataType(e){return this.type=e,this}load(e,t,n,i){function a(o,c){zm?o.colorSpace=c.colorSpace:o.encoding=c.encoding,o.minFilter=bi,o.magFilter=bi,o.generateMipmaps=!1,o.flipY=!1,t&&t(o,c)}return super.load(e,a,n,i)}}const l_=new WeakMap;class XP extends Ws{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,n,i){const a=new Xs(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,o=>{const c={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(o,c).then(t).catch(i)},n,i)}decodeDracoFile(e,t,n,i){const a={attributeIDs:n||this.defaultAttributeIDs,attributeTypes:i||this.defaultAttributeTypes,useUniqueIDs:!!n};this.decodeGeometry(e,a).then(t)}decodeGeometry(e,t){for(const u in t.attributeTypes){const h=t.attributeTypes[u];h.BYTES_PER_ELEMENT!==void 0&&(t.attributeTypes[u]=h.name)}const n=JSON.stringify(t);if(l_.has(e)){const u=l_.get(e);if(u.key===n)return u.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let i;const a=this.workerNextTaskID++,o=e.byteLength,c=this._getWorker(a,o).then(u=>(i=u,new Promise((h,m)=>{i._callbacks[a]={resolve:h,reject:m},i.postMessage({type:"decode",id:a,taskConfig:t,buffer:e},[e])}))).then(u=>this._createGeometry(u.geometry));return c.catch(()=>!0).then(()=>{i&&a&&this._releaseTask(i,a)}),l_.set(e,{key:n,promise:c}),c}_createGeometry(e){const t=new Rn;e.index&&t.setIndex(new Ii(e.index.array,1));for(let n=0;n<e.attributes.length;n++){const i=e.attributes[n],a=i.name,o=i.array,c=i.itemSize;t.setAttribute(a,new Ii(o,c))}return t}_loadLibrary(e,t){const n=new Xs(this.manager);return n.setPath(this.decoderPath),n.setResponseType(t),n.setWithCredentials(this.withCredentials),new Promise((i,a)=>{n.load(e,i,void 0,a)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(n=>{const i=n[0];e||(this.decoderConfig.wasmBinary=n[1]);const a=YP.toString(),o=["/* draco decoder */",i,"","/* worker */",a.substring(a.indexOf("{")+1,a.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([o]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const i=new Worker(this.workerSourceURL);i._callbacks={},i._taskCosts={},i._taskLoad=0,i.postMessage({type:"init",decoderConfig:this.decoderConfig}),i.onmessage=function(a){const o=a.data;switch(o.type){case"decode":i._callbacks[o.id].resolve(o);break;case"error":i._callbacks[o.id].reject(o);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+o.type+'"')}},this.workerPool.push(i)}else this.workerPool.sort(function(i,a){return i._taskLoad>a._taskLoad?-1:1});const n=this.workerPool[this.workerPool.length-1];return n._taskCosts[e]=t,n._taskLoad+=t,n})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}function YP(){let s,e;onmessage=function(o){const c=o.data;switch(c.type){case"init":s=c.decoderConfig,e=new Promise(function(m){s.onModuleLoaded=function(x){m({draco:x})},DracoDecoderModule(s)});break;case"decode":const u=c.buffer,h=c.taskConfig;e.then(m=>{const x=m.draco,g=new x.Decoder,b=new x.DecoderBuffer;b.Init(new Int8Array(u),u.byteLength);try{const S=t(x,g,b,h),C=S.attributes.map(M=>M.array.buffer);S.index&&C.push(S.index.array.buffer),self.postMessage({type:"decode",id:c.id,geometry:S},C)}catch(S){console.error(S),self.postMessage({type:"error",id:c.id,error:S.message})}finally{x.destroy(b),x.destroy(g)}});break}};function t(o,c,u,h){const m=h.attributeIDs,x=h.attributeTypes;let g,b;const S=c.GetEncodedGeometryType(u);if(S===o.TRIANGULAR_MESH)g=new o.Mesh,b=c.DecodeBufferToMesh(u,g);else if(S===o.POINT_CLOUD)g=new o.PointCloud,b=c.DecodeBufferToPointCloud(u,g);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!b.ok()||g.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+b.error_msg());const C={index:null,attributes:[]};for(const M in m){const A=self[x[M]];let R,N;if(h.useUniqueIDs)N=m[M],R=c.GetAttributeByUniqueId(g,N);else{if(N=c.GetAttributeId(g,o[m[M]]),N===-1)continue;R=c.GetAttribute(g,N)}C.attributes.push(i(o,c,g,M,A,R))}return S===o.TRIANGULAR_MESH&&(C.index=n(o,c,g)),o.destroy(g),C}function n(o,c,u){const m=u.num_faces()*3,x=m*4,g=o._malloc(x);c.GetTrianglesUInt32Array(u,x,g);const b=new Uint32Array(o.HEAPF32.buffer,g,m).slice();return o._free(g),{array:b,itemSize:1}}function i(o,c,u,h,m,x){const g=x.num_components(),S=u.num_points()*g,C=S*m.BYTES_PER_ELEMENT,M=a(o,m),A=o._malloc(C);c.GetAttributeDataArrayForAllPoints(u,x,M,C,A);const R=new m(o.HEAPF32.buffer,A,S).slice();return o._free(A),{name:h,array:R,itemSize:g}}function a(o,c){switch(c){case Float32Array:return o.DT_FLOAT32;case Int8Array:return o.DT_INT8;case Int16Array:return o.DT_INT16;case Int32Array:return o.DT_INT32;case Uint8Array:return o.DT_UINT8;case Uint16Array:return o.DT_UINT16;case Uint32Array:return o.DT_UINT32}}}const GE=new Yi,Iv=new k;class iA extends Oy{constructor(){super(),this.isLineSegmentsGeometry=!0,this.type="LineSegmentsGeometry";const e=[-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],t=[-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],n=[0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5];this.setIndex(n),this.setAttribute("position",new $t(e,3)),this.setAttribute("uv",new $t(t,2))}applyMatrix4(e){const t=this.attributes.instanceStart,n=this.attributes.instanceEnd;return t!==void 0&&(t.applyMatrix4(e),n.applyMatrix4(e),t.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}setPositions(e){let t;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));const n=new V1(t,6,1);return this.setAttribute("instanceStart",new Co(n,3,0)),this.setAttribute("instanceEnd",new Co(n,3,3)),this.computeBoundingBox(),this.computeBoundingSphere(),this}setColors(e,t=3){let n;e instanceof Float32Array?n=e:Array.isArray(e)&&(n=new Float32Array(e));const i=new V1(n,t*2,1);return this.setAttribute("instanceColorStart",new Co(i,t,0)),this.setAttribute("instanceColorEnd",new Co(i,t,t)),this}fromWireframeGeometry(e){return this.setPositions(e.attributes.position.array),this}fromEdgesGeometry(e){return this.setPositions(e.attributes.position.array),this}fromMesh(e){return this.fromWireframeGeometry(new NS(e.geometry)),this}fromLineSegments(e){const t=e.geometry;return this.setPositions(t.attributes.position.array),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Yi);const e=this.attributes.instanceStart,t=this.attributes.instanceEnd;e!==void 0&&t!==void 0&&(this.boundingBox.setFromBufferAttribute(e),GE.setFromBufferAttribute(t),this.boundingBox.union(GE))}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new rs),this.boundingBox===null&&this.computeBoundingBox();const e=this.attributes.instanceStart,t=this.attributes.instanceEnd;if(e!==void 0&&t!==void 0){const n=this.boundingSphere.center;this.boundingBox.getCenter(n);let i=0;for(let a=0,o=e.count;a<o;a++)Iv.fromBufferAttribute(e,a),i=Math.max(i,n.distanceToSquared(Iv)),Iv.fromBufferAttribute(t,a),i=Math.max(i,n.distanceToSquared(Iv));this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}toJSON(){}applyMatrix(e){return console.warn("THREE.LineSegmentsGeometry: applyMatrix() has been renamed to applyMatrix4()."),this.applyMatrix4(e)}}class VT extends iA{constructor(){super(),this.isLineGeometry=!0,this.type="LineGeometry"}setPositions(e){const t=e.length-3,n=new Float32Array(2*t);for(let i=0;i<t;i+=3)n[2*i]=e[i],n[2*i+1]=e[i+1],n[2*i+2]=e[i+2],n[2*i+3]=e[i+3],n[2*i+4]=e[i+4],n[2*i+5]=e[i+5];return super.setPositions(n),this}setColors(e,t=3){const n=e.length-t,i=new Float32Array(2*n);if(t===3)for(let a=0;a<n;a+=t)i[2*a]=e[a],i[2*a+1]=e[a+1],i[2*a+2]=e[a+2],i[2*a+3]=e[a+3],i[2*a+4]=e[a+4],i[2*a+5]=e[a+5];else for(let a=0;a<n;a+=t)i[2*a]=e[a],i[2*a+1]=e[a+1],i[2*a+2]=e[a+2],i[2*a+3]=e[a+3],i[2*a+4]=e[a+4],i[2*a+5]=e[a+5],i[2*a+6]=e[a+6],i[2*a+7]=e[a+7];return super.setColors(i,t),this}fromLine(e){const t=e.geometry;return this.setPositions(t.attributes.position.array),this}}class aA extends Ys{constructor(e){super({type:"LineMaterial",uniforms:Zp.clone(Zp.merge([rn.common,rn.fog,{worldUnits:{value:1},linewidth:{value:1},resolution:{value:new gt(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}}])),vertexShader:`
				#include <common>
				#include <fog_pars_vertex>
				#include <logdepthbuf_pars_vertex>
				#include <clipping_planes_pars_vertex>

				uniform float linewidth;
				uniform vec2 resolution;

				attribute vec3 instanceStart;
				attribute vec3 instanceEnd;

				#ifdef USE_COLOR
					#ifdef USE_LINE_COLOR_ALPHA
						varying vec4 vLineColor;
						attribute vec4 instanceColorStart;
						attribute vec4 instanceColorEnd;
					#else
						varying vec3 vLineColor;
						attribute vec3 instanceColorStart;
						attribute vec3 instanceColorEnd;
					#endif
				#endif

				#ifdef WORLD_UNITS

					varying vec4 worldPos;
					varying vec3 worldStart;
					varying vec3 worldEnd;

					#ifdef USE_DASH

						varying vec2 vUv;

					#endif

				#else

					varying vec2 vUv;

				#endif

				#ifdef USE_DASH

					uniform float dashScale;
					attribute float instanceDistanceStart;
					attribute float instanceDistanceEnd;
					varying float vLineDistance;

				#endif

				void trimSegment( const in vec4 start, inout vec4 end ) {

					// trim end segment so it terminates between the camera plane and the near plane

					// conservative estimate of the near plane
					float a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column
					float b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column
					float nearEstimate = - 0.5 * b / a;

					float alpha = ( nearEstimate - start.z ) / ( end.z - start.z );

					end.xyz = mix( start.xyz, end.xyz, alpha );

				}

				void main() {

					#ifdef USE_COLOR

						vLineColor = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;

					#endif

					#ifdef USE_DASH

						vLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;
						vUv = uv;

					#endif

					float aspect = resolution.x / resolution.y;

					// camera space
					vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );
					vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );

					#ifdef WORLD_UNITS

						worldStart = start.xyz;
						worldEnd = end.xyz;

					#else

						vUv = uv;

					#endif

					// special case for perspective projection, and segments that terminate either in, or behind, the camera plane
					// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space
					// but we need to perform ndc-space calculations in the shader, so we must address this issue directly
					// perhaps there is a more elegant solution -- WestLangley

					bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column

					if ( perspective ) {

						if ( start.z < 0.0 && end.z >= 0.0 ) {

							trimSegment( start, end );

						} else if ( end.z < 0.0 && start.z >= 0.0 ) {

							trimSegment( end, start );

						}

					}

					// clip space
					vec4 clipStart = projectionMatrix * start;
					vec4 clipEnd = projectionMatrix * end;

					// ndc space
					vec3 ndcStart = clipStart.xyz / clipStart.w;
					vec3 ndcEnd = clipEnd.xyz / clipEnd.w;

					// direction
					vec2 dir = ndcEnd.xy - ndcStart.xy;

					// account for clip-space aspect ratio
					dir.x *= aspect;
					dir = normalize( dir );

					#ifdef WORLD_UNITS

						// get the offset direction as perpendicular to the view vector
						vec3 worldDir = normalize( end.xyz - start.xyz );
						vec3 offset;
						if ( position.y < 0.5 ) {

							offset = normalize( cross( start.xyz, worldDir ) );

						} else {

							offset = normalize( cross( end.xyz, worldDir ) );

						}

						// sign flip
						if ( position.x < 0.0 ) offset *= - 1.0;

						float forwardOffset = dot( worldDir, vec3( 0.0, 0.0, 1.0 ) );

						// don't extend the line if we're rendering dashes because we
						// won't be rendering the endcaps
						#ifndef USE_DASH

							// extend the line bounds to encompass  endcaps
							start.xyz += - worldDir * linewidth * 0.5;
							end.xyz += worldDir * linewidth * 0.5;

							// shift the position of the quad so it hugs the forward edge of the line
							offset.xy -= dir * forwardOffset;
							offset.z += 0.5;

						#endif

						// endcaps
						if ( position.y > 1.0 || position.y < 0.0 ) {

							offset.xy += dir * 2.0 * forwardOffset;

						}

						// adjust for linewidth
						offset *= linewidth * 0.5;

						// set the world position
						worldPos = ( position.y < 0.5 ) ? start : end;
						worldPos.xyz += offset;

						// project the worldpos
						vec4 clip = projectionMatrix * worldPos;

						// shift the depth of the projected points so the line
						// segments overlap neatly
						vec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;
						clip.z = clipPose.z * clip.w;

					#else

						vec2 offset = vec2( dir.y, - dir.x );
						// undo aspect ratio adjustment
						dir.x /= aspect;
						offset.x /= aspect;

						// sign flip
						if ( position.x < 0.0 ) offset *= - 1.0;

						// endcaps
						if ( position.y < 0.0 ) {

							offset += - dir;

						} else if ( position.y > 1.0 ) {

							offset += dir;

						}

						// adjust for linewidth
						offset *= linewidth;

						// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...
						offset /= resolution.y;

						// select end
						vec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;

						// back to clip space
						offset *= clip.w;

						clip.xy += offset;

					#endif

					gl_Position = clip;

					vec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation

					#include <logdepthbuf_vertex>
					#include <clipping_planes_vertex>
					#include <fog_vertex>

				}
			`,fragmentShader:`
				uniform vec3 diffuse;
				uniform float opacity;
				uniform float linewidth;

				#ifdef USE_DASH

					uniform float dashOffset;
					uniform float dashSize;
					uniform float gapSize;

				#endif

				varying float vLineDistance;

				#ifdef WORLD_UNITS

					varying vec4 worldPos;
					varying vec3 worldStart;
					varying vec3 worldEnd;

					#ifdef USE_DASH

						varying vec2 vUv;

					#endif

				#else

					varying vec2 vUv;

				#endif

				#include <common>
				#include <fog_pars_fragment>
				#include <logdepthbuf_pars_fragment>
				#include <clipping_planes_pars_fragment>

				#ifdef USE_COLOR
					#ifdef USE_LINE_COLOR_ALPHA
						varying vec4 vLineColor;
					#else
						varying vec3 vLineColor;
					#endif
				#endif

				vec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {

					float mua;
					float mub;

					vec3 p13 = p1 - p3;
					vec3 p43 = p4 - p3;

					vec3 p21 = p2 - p1;

					float d1343 = dot( p13, p43 );
					float d4321 = dot( p43, p21 );
					float d1321 = dot( p13, p21 );
					float d4343 = dot( p43, p43 );
					float d2121 = dot( p21, p21 );

					float denom = d2121 * d4343 - d4321 * d4321;

					float numer = d1343 * d4321 - d1321 * d4343;

					mua = numer / denom;
					mua = clamp( mua, 0.0, 1.0 );
					mub = ( d1343 + d4321 * ( mua ) ) / d4343;
					mub = clamp( mub, 0.0, 1.0 );

					return vec2( mua, mub );

				}

				void main() {

					#include <clipping_planes_fragment>

					#ifdef USE_DASH

						if ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps

						if ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX

					#endif

					float alpha = opacity;

					#ifdef WORLD_UNITS

						// Find the closest points on the view ray and the line segment
						vec3 rayEnd = normalize( worldPos.xyz ) * 1e5;
						vec3 lineDir = worldEnd - worldStart;
						vec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );

						vec3 p1 = worldStart + lineDir * params.x;
						vec3 p2 = rayEnd * params.y;
						vec3 delta = p1 - p2;
						float len = length( delta );
						float norm = len / linewidth;

						#ifndef USE_DASH

							#ifdef USE_ALPHA_TO_COVERAGE

								float dnorm = fwidth( norm );
								alpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );

							#else

								if ( norm > 0.5 ) {

									discard;

								}

							#endif

						#endif

					#else

						#ifdef USE_ALPHA_TO_COVERAGE

							// artifacts appear on some hardware if a derivative is taken within a conditional
							float a = vUv.x;
							float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
							float len2 = a * a + b * b;
							float dlen = fwidth( len2 );

							if ( abs( vUv.y ) > 1.0 ) {

								alpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );

							}

						#else

							if ( abs( vUv.y ) > 1.0 ) {

								float a = vUv.x;
								float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
								float len2 = a * a + b * b;

								if ( len2 > 1.0 ) discard;

							}

						#endif

					#endif

					vec4 diffuseColor = vec4( diffuse, alpha );
					#ifdef USE_COLOR
						#ifdef USE_LINE_COLOR_ALPHA
							diffuseColor *= vLineColor;
						#else
							diffuseColor.rgb *= vLineColor;
						#endif
					#endif

					#include <logdepthbuf_fragment>

					gl_FragColor = diffuseColor;

					#include <tonemapping_fragment>
					#include <${Dx>=154?"colorspace_fragment":"encodings_fragment"}>
					#include <fog_fragment>
					#include <premultiplied_alpha_fragment>

				}
			`,clipping:!0}),this.isLineMaterial=!0,this.onBeforeCompile=function(){this.transparent?this.defines.USE_LINE_COLOR_ALPHA="1":delete this.defines.USE_LINE_COLOR_ALPHA},Object.defineProperties(this,{color:{enumerable:!0,get:function(){return this.uniforms.diffuse.value},set:function(t){this.uniforms.diffuse.value=t}},worldUnits:{enumerable:!0,get:function(){return"WORLD_UNITS"in this.defines},set:function(t){t===!0?this.defines.WORLD_UNITS="":delete this.defines.WORLD_UNITS}},linewidth:{enumerable:!0,get:function(){return this.uniforms.linewidth.value},set:function(t){this.uniforms.linewidth.value=t}},dashed:{enumerable:!0,get:function(){return"USE_DASH"in this.defines},set(t){!!t!="USE_DASH"in this.defines&&(this.needsUpdate=!0),t===!0?this.defines.USE_DASH="":delete this.defines.USE_DASH}},dashScale:{enumerable:!0,get:function(){return this.uniforms.dashScale.value},set:function(t){this.uniforms.dashScale.value=t}},dashSize:{enumerable:!0,get:function(){return this.uniforms.dashSize.value},set:function(t){this.uniforms.dashSize.value=t}},dashOffset:{enumerable:!0,get:function(){return this.uniforms.dashOffset.value},set:function(t){this.uniforms.dashOffset.value=t}},gapSize:{enumerable:!0,get:function(){return this.uniforms.gapSize.value},set:function(t){this.uniforms.gapSize.value=t}},opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(t){this.uniforms.opacity.value=t}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(t){this.uniforms.resolution.value.copy(t)}},alphaToCoverage:{enumerable:!0,get:function(){return"USE_ALPHA_TO_COVERAGE"in this.defines},set:function(t){!!t!="USE_ALPHA_TO_COVERAGE"in this.defines&&(this.needsUpdate=!0),t===!0?(this.defines.USE_ALPHA_TO_COVERAGE="",this.extensions.derivatives=!0):(delete this.defines.USE_ALPHA_TO_COVERAGE,this.extensions.derivatives=!1)}}}),this.setValues(e)}}const c_=new oi,jE=new k,HE=new k,sr=new oi,rr=new oi,jc=new oi,u_=new k,f_=new wn,cr=new XS,kE=new k,zv=new Yi,Fv=new rs,Hc=new oi;let Xc,$h;function VE(s,e,t){return Hc.set(0,0,-e,1).applyMatrix4(s.projectionMatrix),Hc.multiplyScalar(1/Hc.w),Hc.x=$h/t.width,Hc.y=$h/t.height,Hc.applyMatrix4(s.projectionMatrixInverse),Hc.multiplyScalar(1/Hc.w),Math.abs(Math.max(Hc.x,Hc.y))}function WP(s,e){const t=s.matrixWorld,n=s.geometry,i=n.attributes.instanceStart,a=n.attributes.instanceEnd,o=Math.min(n.instanceCount,i.count);for(let c=0,u=o;c<u;c++){cr.start.fromBufferAttribute(i,c),cr.end.fromBufferAttribute(a,c),cr.applyMatrix4(t);const h=new k,m=new k;Xc.distanceSqToSegment(cr.start,cr.end,m,h),m.distanceTo(h)<$h*.5&&e.push({point:m,pointOnLine:h,distance:Xc.origin.distanceTo(m),object:s,face:null,faceIndex:c,uv:null,[OT]:null})}}function qP(s,e,t){const n=e.projectionMatrix,a=s.material.resolution,o=s.matrixWorld,c=s.geometry,u=c.attributes.instanceStart,h=c.attributes.instanceEnd,m=Math.min(c.instanceCount,u.count),x=-e.near;Xc.at(1,jc),jc.w=1,jc.applyMatrix4(e.matrixWorldInverse),jc.applyMatrix4(n),jc.multiplyScalar(1/jc.w),jc.x*=a.x/2,jc.y*=a.y/2,jc.z=0,u_.copy(jc),f_.multiplyMatrices(e.matrixWorldInverse,o);for(let g=0,b=m;g<b;g++){if(sr.fromBufferAttribute(u,g),rr.fromBufferAttribute(h,g),sr.w=1,rr.w=1,sr.applyMatrix4(f_),rr.applyMatrix4(f_),sr.z>x&&rr.z>x)continue;if(sr.z>x){const N=sr.z-rr.z,B=(sr.z-x)/N;sr.lerp(rr,B)}else if(rr.z>x){const N=rr.z-sr.z,B=(rr.z-x)/N;rr.lerp(sr,B)}sr.applyMatrix4(n),rr.applyMatrix4(n),sr.multiplyScalar(1/sr.w),rr.multiplyScalar(1/rr.w),sr.x*=a.x/2,sr.y*=a.y/2,rr.x*=a.x/2,rr.y*=a.y/2,cr.start.copy(sr),cr.start.z=0,cr.end.copy(rr),cr.end.z=0;const C=cr.closestPointToPointParameter(u_,!0);cr.at(C,kE);const M=zf.lerp(sr.z,rr.z,C),A=M>=-1&&M<=1,R=u_.distanceTo(kE)<$h*.5;if(A&&R){cr.start.fromBufferAttribute(u,g),cr.end.fromBufferAttribute(h,g),cr.start.applyMatrix4(o),cr.end.applyMatrix4(o);const N=new k,B=new k;Xc.distanceSqToSegment(cr.start,cr.end,B,N),t.push({point:B,pointOnLine:N,distance:Xc.origin.distanceTo(B),object:s,face:null,faceIndex:g,uv:null,[OT]:null})}}}class XT extends sn{constructor(e=new iA,t=new aA({color:Math.random()*16777215})){super(e,t),this.isLineSegments2=!0,this.type="LineSegments2"}computeLineDistances(){const e=this.geometry,t=e.attributes.instanceStart,n=e.attributes.instanceEnd,i=new Float32Array(2*t.count);for(let o=0,c=0,u=t.count;o<u;o++,c+=2)jE.fromBufferAttribute(t,o),HE.fromBufferAttribute(n,o),i[c]=c===0?0:i[c-1],i[c+1]=i[c]+jE.distanceTo(HE);const a=new V1(i,2,1);return e.setAttribute("instanceDistanceStart",new Co(a,1,0)),e.setAttribute("instanceDistanceEnd",new Co(a,1,1)),this}raycast(e,t){const n=this.material.worldUnits,i=e.camera;i===null&&!n&&console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2 while worldUnits is set to false.');const a=e.params.Line2!==void 0&&e.params.Line2.threshold||0;Xc=e.ray;const o=this.matrixWorld,c=this.geometry,u=this.material;$h=u.linewidth+a,c.boundingSphere===null&&c.computeBoundingSphere(),Fv.copy(c.boundingSphere).applyMatrix4(o);let h;if(n)h=$h*.5;else{const x=Math.max(i.near,Fv.distanceToPoint(Xc.origin));h=VE(i,x,u.resolution)}if(Fv.radius+=h,Xc.intersectsSphere(Fv)===!1)return;c.boundingBox===null&&c.computeBoundingBox(),zv.copy(c.boundingBox).applyMatrix4(o);let m;if(n)m=$h*.5;else{const x=Math.max(i.near,zv.distanceToPoint(Xc.origin));m=VE(i,x,u.resolution)}zv.expandByScalar(m),Xc.intersectsBox(zv)!==!1&&(n?WP(this,t):qP(this,i,t))}onBeforeRender(e){const t=this.material.uniforms;t&&t.resolution&&(e.getViewport(c_),this.material.uniforms.resolution.value.set(c_.z,c_.w))}}class JP extends XT{constructor(e=new VT,t=new aA({color:Math.random()*16777215})){super(e,t),this.isLine2=!0,this.type="Line2"}}let Pv;const h_=()=>{if(Pv)return Pv;const s="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB",e="B9h9z9tFBBBFiI9gBB9gLaaaaaFa9gEaaaB9gFaFaEMcBBFBFFGGGEILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBOn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBNI9z9iqlBVc+N9IcIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMk8lLbaE97F9+FaL978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAeDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAeDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBReCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBH8ZCFD9tA8ZAPD9OD9hD9RH8ZDQBTFtGmEYIPLdKeOnHpAIAQJDBIBHyCFD9tAyAPD9OD9hD9RHyAIASJDBIBH8cCFD9tA8cAPD9OD9hD9RH8cDQBTFtGmEYIPLdKeOnH8dDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAeD9uHeDyBjGBAEAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeApA8dDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNiV8ZcpMyS8cQ8df8eb8fHdAyA8cDQNiV8ZcpMyS8cQ8df8eb8fH8ZDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/dLEK97FaF97GXGXAGCI9HQBAF9FQFCBRGEXABABDBBBHECiD+rFCiD+sFD/6FHIAECND+rFCiD+sFD/6FAID/gFAECTD+rFCiD+sFD/6FHLD/gFD/kFD/lFHKCBDtD+2FHOAICUUUU94DtHND9OD9RD/kFHI9DBB/+hDYAIAID/mFAKAKD/mFALAOALAND9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHLD/mF9DBBX9LDYHOD/kFCgFDtD9OAECUUU94DtD9OD9QAIALD/mFAOD/kFCND+rFCU/+EDtD9OD9QAKALD/mFAOD/kFCTD+rFCUU/8ODtD9OD9QDMBBABCTJRBAGCIJHGAF9JQBSGMMAF9FQBCBRGEXABCTJHVAVDBBBHECBDtHOCUU98D8cFCUU98D8cEHND9OABDBBBHKAEDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAKAEDQBFGENVcMTtmYi8ZpyHECTD+sFD/6FHID/gFAECTD+rFCTD+sFD/6FHLD/gFD/kFD/lFHE9DB/+g6DYALAEAOD+2FHOALCUUUU94DtHcD9OD9RD/kFHLALD/mFAEAED/mFAIAOAIAcD9OD9RD/kFHEAED/mFD/kFD/kFD/jFD/nFHID/mF9DBBX9LDYHOD/kFCTD+rFALAID/mFAOD/kFCggEDtD9OD9QHLAEAID/mFAOD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHEDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAKAND9OALAEDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM/hEIGaF97FaL978jUUUUBCTlREGXAF9FQBCBRIEXAEABDBBBHLABCTJHKDBBBHODQILKOSQfbPden8c8d8e8fHNCTD+sFHVCID+rFDMIBAB9DBBU8/DY9D/zI818/DYAVCEDtD9QD/6FD/nFHVALAODQBFGENVcMTtmYi8ZpyHLCTD+rFCTD+sFD/6FD/mFHOAOD/mFAVALCTD+sFD/6FD/mFHcAcD/mFAVANCTD+rFCTD+sFD/6FD/mFHNAND/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHVD/mF9DBBX9LDYHLD/kFCggEDtHMD9OAcAVD/mFALD/kFCTD+rFD9QHcANAVD/mFALD/kFCTD+rFAOAVD/mFALD/kFAMD9OD9QHVDQBFTtGEmYILPdKOenHLD8dBAEDBIBDyB+t+J83EBABCNJALD8dFAEDBIBDyF+t+J83EBAKAcAVDQNVi8ZcMpySQ8c8dfb8e8fHVD8dBAEDBIBDyG+t+J83EBABCiJAVD8dFAEDBIBDyE+t+J83EBABCAJRBAICIJHIAF9JQBMMM9jFF97GXAGCGrAF9sHG9FQBCBRFEXABABDBBBHECND+rFCND+sFD/6FAECiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBABCTJRBAFCIJHFAG9JQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",t=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),n=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]);if(typeof WebAssembly!="object")return{supported:!1};let i=s;WebAssembly.validate(t)&&(i=e);let a;const o=WebAssembly.instantiate(c(i),{}).then(x=>{a=x.instance,a.exports.__wasm_call_ctors()});function c(x){const g=new Uint8Array(x.length);for(let S=0;S<x.length;++S){const C=x.charCodeAt(S);g[S]=C>96?C-71:C>64?C-65:C>47?C+4:C>46?63:62}let b=0;for(let S=0;S<x.length;++S)g[b++]=g[S]<60?n[g[S]]:(g[S]-60)*64+g[++S];return g.buffer.slice(0,b)}function u(x,g,b,S,C,M){const A=a.exports.sbrk,R=b+3&-4,N=A(R*S),B=A(C.length),F=new Uint8Array(a.exports.memory.buffer);F.set(C,B);const U=x(N,b,S,B,C.length);if(U===0&&M&&M(N,R,S),g.set(F.subarray(N,N+b*S)),A(N-A(0)),U!==0)throw new Error(`Malformed buffer data: ${U}`)}const h={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},m={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return Pv={ready:o,supported:!0,decodeVertexBuffer(x,g,b,S,C){u(a.exports.meshopt_decodeVertexBuffer,x,g,b,S,a.exports[h[C]])},decodeIndexBuffer(x,g,b,S){u(a.exports.meshopt_decodeIndexBuffer,x,g,b,S)},decodeIndexSequence(x,g,b,S){u(a.exports.meshopt_decodeIndexSequence,x,g,b,S)},decodeGltfBuffer(x,g,b,S,C,M){u(a.exports[m[C]],x,g,b,S,a.exports[h[M]])}},Pv},nx=Y.forwardRef(function({points:e,color:t=16777215,vertexColors:n,linewidth:i,lineWidth:a,segments:o,dashed:c,...u},h){var m,x;const g=ti(A=>A.size),b=Y.useMemo(()=>o?new XT:new JP,[o]),[S]=Y.useState(()=>new aA),C=(n==null||(m=n[0])==null?void 0:m.length)===4?4:3,M=Y.useMemo(()=>{const A=o?new iA:new VT,R=e.map(N=>{const B=Array.isArray(N);return N instanceof k||N instanceof oi?[N.x,N.y,N.z]:N instanceof gt?[N.x,N.y,0]:B&&N.length===3?[N[0],N[1],N[2]]:B&&N.length===2?[N[0],N[1],0]:N});if(A.setPositions(R.flat()),n){t=16777215;const N=n.map(B=>B instanceof qt?B.toArray():B);A.setColors(N.flat(),C)}return A},[e,o,n,C]);return Y.useLayoutEffect(()=>{b.computeLineDistances()},[e,b]),Y.useLayoutEffect(()=>{c?S.defines.USE_DASH="":delete S.defines.USE_DASH,S.needsUpdate=!0},[c,S]),Y.useEffect(()=>()=>{M.dispose(),S.dispose()},[M]),Y.createElement("primitive",fo({object:b,ref:h},u),Y.createElement("primitive",{object:M,attach:"geometry"}),Y.createElement("primitive",fo({object:S,attach:"material",color:t,vertexColors:!!n,resolution:[g.width,g.height],linewidth:(x=i??a)!==null&&x!==void 0?x:1,dashed:c,transparent:C===4},u)))});function ZP(){var s=Object.create(null);function e(i,a){var o=i.id,c=i.name,u=i.dependencies;u===void 0&&(u=[]);var h=i.init;h===void 0&&(h=function(){});var m=i.getTransferables;if(m===void 0&&(m=null),!s[o])try{u=u.map(function(g){return g&&g.isWorkerModule&&(e(g,function(b){if(b instanceof Error)throw b}),g=s[g.id].value),g}),h=n("<"+c+">.init",h),m&&(m=n("<"+c+">.getTransferables",m));var x=null;typeof h=="function"?x=h.apply(void 0,u):console.error("worker module init function failed to rehydrate"),s[o]={id:o,value:x,getTransferables:m},a(x)}catch(g){g&&g.noLog||console.error(g),a(g)}}function t(i,a){var o,c=i.id,u=i.args;(!s[c]||typeof s[c].value!="function")&&a(new Error("Worker module "+c+": not found or its 'init' did not return a function"));try{var h=(o=s[c]).value.apply(o,u);h&&typeof h.then=="function"?h.then(m,function(x){return a(x instanceof Error?x:new Error(""+x))}):m(h)}catch(x){a(x)}function m(x){try{var g=s[c].getTransferables&&s[c].getTransferables(x);(!g||!Array.isArray(g)||!g.length)&&(g=void 0),a(x,g)}catch(b){console.error(b),a(b)}}}function n(i,a){var o=void 0;self.troikaDefine=function(u){return o=u};var c=URL.createObjectURL(new Blob(["/** "+i.replace(/\*/g,"")+` **/

troikaDefine(
`+a+`
)`],{type:"application/javascript"}));try{importScripts(c)}catch(u){console.error(u)}return URL.revokeObjectURL(c),delete self.troikaDefine,o}self.addEventListener("message",function(i){var a=i.data,o=a.messageId,c=a.action,u=a.data;try{c==="registerModule"&&e(u,function(h){h instanceof Error?postMessage({messageId:o,success:!1,error:h.message}):postMessage({messageId:o,success:!0,result:{isCallable:typeof h=="function"}})}),c==="callModule"&&t(u,function(h,m){h instanceof Error?postMessage({messageId:o,success:!1,error:h.message}):postMessage({messageId:o,success:!0,result:h},m||void 0)})}catch(h){postMessage({messageId:o,success:!1,error:h.stack})}})}function KP(s){var e=function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];return e._getInitResult().then(function(i){if(typeof i=="function")return i.apply(void 0,t);throw new Error("Worker module function was called but `init` did not return a callable function")})};return e._getInitResult=function(){var t=s.dependencies,n=s.init;t=Array.isArray(t)?t.map(function(a){return a&&(a=a.onMainThread||a,a._getInitResult&&(a=a._getInitResult())),a}):[];var i=Promise.all(t).then(function(a){return n.apply(null,a)});return e._getInitResult=function(){return i},i},e}var YT=function(){var s=!1;if(typeof window<"u"&&typeof window.document<"u")try{var e=new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"})));e.terminate(),s=!0}catch(t){console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+t.message+"]")}return YT=function(){return s},s},QP=0,$P=0,d_=!1,ix=Object.create(null),ax=Object.create(null),Q_=Object.create(null);function u0(s){if((!s||typeof s.init!="function")&&!d_)throw new Error("requires `options.init` function");var e=s.dependencies,t=s.init,n=s.getTransferables,i=s.workerId,a=KP(s);i==null&&(i="#default");var o="workerModule"+ ++QP,c=s.name||o,u=null;e=e&&e.map(function(m){return typeof m=="function"&&!m.workerModuleData&&(d_=!0,m=u0({workerId:i,name:"<"+c+"> function dependency: "+m.name,init:`function(){return (
`+$v(m)+`
)}`}),d_=!1),m&&m.workerModuleData&&(m=m.workerModuleData),m});function h(){for(var m=[],x=arguments.length;x--;)m[x]=arguments[x];if(!YT())return a.apply(void 0,m);if(!u){u=XE(i,"registerModule",h.workerModuleData);var g=function(){u=null,ax[i].delete(g)};(ax[i]||(ax[i]=new Set)).add(g)}return u.then(function(b){var S=b.isCallable;if(S)return XE(i,"callModule",{id:o,args:m});throw new Error("Worker module function was called but `init` did not return a callable function")})}return h.workerModuleData={isWorkerModule:!0,id:o,name:c,dependencies:e,init:$v(t),getTransferables:n&&$v(n)},h.onMainThread=a,h}function e9(s){ax[s]&&ax[s].forEach(function(e){e()}),ix[s]&&(ix[s].terminate(),delete ix[s])}function $v(s){var e=s.toString();return!/^function/.test(e)&&/^\w+\s*\(/.test(e)&&(e="function "+e),e}function t9(s){var e=ix[s];if(!e){var t=$v(ZP);e=ix[s]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+s.replace(/\*/g,"")+` **/

;(`+t+")()"],{type:"application/javascript"}))),e.onmessage=function(n){var i=n.data,a=i.messageId,o=Q_[a];if(!o)throw new Error("WorkerModule response with empty or unknown messageId");delete Q_[a],o(i)}}return e}function XE(s,e,t){return new Promise(function(n,i){var a=++$P;Q_[a]=function(o){o.success?n(o.result):i(new Error("Error in worker "+e+" call: "+o.error))},t9(s).postMessage({messageId:a,action:e,data:t})})}function WT(){var s=(function(e){function t(ie,se,I,W,fe,Z,me,$){var pe=1-me;$.x=pe*pe*ie+2*pe*me*I+me*me*fe,$.y=pe*pe*se+2*pe*me*W+me*me*Z}function n(ie,se,I,W,fe,Z,me,$,pe,ve){var ze=1-pe;ve.x=ze*ze*ze*ie+3*ze*ze*pe*I+3*ze*pe*pe*fe+pe*pe*pe*me,ve.y=ze*ze*ze*se+3*ze*ze*pe*W+3*ze*pe*pe*Z+pe*pe*pe*$}function i(ie,se){for(var I=/([MLQCZ])([^MLQCZ]*)/g,W,fe,Z,me,$;W=I.exec(ie);){var pe=W[2].replace(/^\s*|\s*$/g,"").split(/[,\s]+/).map(function(ve){return parseFloat(ve)});switch(W[1]){case"M":me=fe=pe[0],$=Z=pe[1];break;case"L":(pe[0]!==me||pe[1]!==$)&&se("L",me,$,me=pe[0],$=pe[1]);break;case"Q":{se("Q",me,$,me=pe[2],$=pe[3],pe[0],pe[1]);break}case"C":{se("C",me,$,me=pe[4],$=pe[5],pe[0],pe[1],pe[2],pe[3]);break}case"Z":(me!==fe||$!==Z)&&se("L",me,$,fe,Z);break}}}function a(ie,se,I){I===void 0&&(I=16);var W={x:0,y:0};i(ie,function(fe,Z,me,$,pe,ve,ze,Ge,Fe){switch(fe){case"L":se(Z,me,$,pe);break;case"Q":{for(var Qe=Z,lt=me,De=1;De<I;De++)t(Z,me,ve,ze,$,pe,De/(I-1),W),se(Qe,lt,W.x,W.y),Qe=W.x,lt=W.y;break}case"C":{for(var le=Z,Ye=me,Ze=1;Ze<I;Ze++)n(Z,me,ve,ze,Ge,Fe,$,pe,Ze/(I-1),W),se(le,Ye,W.x,W.y),le=W.x,Ye=W.y;break}}})}var o="precision highp float;attribute vec2 aUV;varying vec2 vUV;void main(){vUV=aUV;gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",c="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){gl_FragColor=texture2D(tex,vUV);}",u=new WeakMap,h={premultipliedAlpha:!1,preserveDrawingBuffer:!0,antialias:!1,depth:!1};function m(ie,se){var I=ie.getContext?ie.getContext("webgl",h):ie,W=u.get(I);if(!W){let le=function(Ne){var st=Z[Ne];if(!st&&(st=Z[Ne]=I.getExtension(Ne),!st))throw new Error(Ne+" not supported");return st},Ye=function(Ne,st){var oe=I.createShader(st);return I.shaderSource(oe,Ne),I.compileShader(oe),oe},Ze=function(Ne,st,oe,X){if(!me[Ne]){var Ae={},Pe={},Ue=I.createProgram();I.attachShader(Ue,Ye(st,I.VERTEX_SHADER)),I.attachShader(Ue,Ye(oe,I.FRAGMENT_SHADER)),I.linkProgram(Ue),me[Ne]={program:Ue,transaction:function(bt){I.useProgram(Ue),bt({setUniform:function(It,zt){for(var qe=[],We=arguments.length-2;We-- >0;)qe[We]=arguments[We+2];var ft=Pe[zt]||(Pe[zt]=I.getUniformLocation(Ue,zt));I["uniform"+It].apply(I,[ft].concat(qe))},setAttribute:function(It,zt,qe,We,ft){var ge=Ae[It];ge||(ge=Ae[It]={buf:I.createBuffer(),loc:I.getAttribLocation(Ue,It),data:null}),I.bindBuffer(I.ARRAY_BUFFER,ge.buf),I.vertexAttribPointer(ge.loc,zt,I.FLOAT,!1,0,0),I.enableVertexAttribArray(ge.loc),fe?I.vertexAttribDivisor(ge.loc,We):le("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(ge.loc,We),ft!==ge.data&&(I.bufferData(I.ARRAY_BUFFER,ft,qe),ge.data=ft)}})}}}me[Ne].transaction(X)},je=function(Ne,st){pe++;try{I.activeTexture(I.TEXTURE0+pe);var oe=$[Ne];oe||(oe=$[Ne]=I.createTexture(),I.bindTexture(I.TEXTURE_2D,oe),I.texParameteri(I.TEXTURE_2D,I.TEXTURE_MIN_FILTER,I.NEAREST),I.texParameteri(I.TEXTURE_2D,I.TEXTURE_MAG_FILTER,I.NEAREST)),I.bindTexture(I.TEXTURE_2D,oe),st(oe,pe)}finally{pe--}},He=function(Ne,st,oe){var X=I.createFramebuffer();ve.push(X),I.bindFramebuffer(I.FRAMEBUFFER,X),I.activeTexture(I.TEXTURE0+st),I.bindTexture(I.TEXTURE_2D,Ne),I.framebufferTexture2D(I.FRAMEBUFFER,I.COLOR_ATTACHMENT0,I.TEXTURE_2D,Ne,0);try{oe(X)}finally{I.deleteFramebuffer(X),I.bindFramebuffer(I.FRAMEBUFFER,ve[--ve.length-1]||null)}},et=function(){Z={},me={},$={},pe=-1,ve.length=0};var ze=le,Ge=Ye,Fe=Ze,Qe=je,lt=He,De=et,fe=typeof WebGL2RenderingContext<"u"&&I instanceof WebGL2RenderingContext,Z={},me={},$={},pe=-1,ve=[];I.canvas.addEventListener("webglcontextlost",function(Ne){et(),Ne.preventDefault()},!1),u.set(I,W={gl:I,isWebGL2:fe,getExtension:le,withProgram:Ze,withTexture:je,withTextureFramebuffer:He,handleContextLoss:et})}se(W)}function x(ie,se,I,W,fe,Z,me,$){me===void 0&&(me=15),$===void 0&&($=null),m(ie,function(pe){var ve=pe.gl,ze=pe.withProgram,Ge=pe.withTexture;Ge("copy",function(Fe,Qe){ve.texImage2D(ve.TEXTURE_2D,0,ve.RGBA,fe,Z,0,ve.RGBA,ve.UNSIGNED_BYTE,se),ze("copy",o,c,function(lt){var De=lt.setUniform,le=lt.setAttribute;le("aUV",2,ve.STATIC_DRAW,0,new Float32Array([0,0,2,0,0,2])),De("1i","image",Qe),ve.bindFramebuffer(ve.FRAMEBUFFER,$||null),ve.disable(ve.BLEND),ve.colorMask(me&8,me&4,me&2,me&1),ve.viewport(I,W,fe,Z),ve.scissor(I,W,fe,Z),ve.drawArrays(ve.TRIANGLES,0,3)})})})}function g(ie,se,I){var W=ie.width,fe=ie.height;m(ie,function(Z){var me=Z.gl,$=new Uint8Array(W*fe*4);me.readPixels(0,0,W,fe,me.RGBA,me.UNSIGNED_BYTE,$),ie.width=se,ie.height=I,x(me,$,0,0,W,fe)})}var b=Object.freeze({__proto__:null,withWebGLContext:m,renderImageData:x,resizeWebGLCanvasWithoutClearing:g});function S(ie,se,I,W,fe,Z){Z===void 0&&(Z=1);var me=new Uint8Array(ie*se),$=W[2]-W[0],pe=W[3]-W[1],ve=[];a(I,function(le,Ye,Ze,je){ve.push({x1:le,y1:Ye,x2:Ze,y2:je,minX:Math.min(le,Ze),minY:Math.min(Ye,je),maxX:Math.max(le,Ze),maxY:Math.max(Ye,je)})}),ve.sort(function(le,Ye){return le.maxX-Ye.maxX});for(var ze=0;ze<ie;ze++)for(var Ge=0;Ge<se;Ge++){var Fe=lt(W[0]+$*(ze+.5)/ie,W[1]+pe*(Ge+.5)/se),Qe=Math.pow(1-Math.abs(Fe)/fe,Z)/2;Fe<0&&(Qe=1-Qe),Qe=Math.max(0,Math.min(255,Math.round(Qe*255))),me[Ge*ie+ze]=Qe}return me;function lt(le,Ye){for(var Ze=1/0,je=1/0,He=ve.length;He--;){var et=ve[He];if(et.maxX+je<=le)break;if(le+je>et.minX&&Ye-je<et.maxY&&Ye+je>et.minY){var Ne=A(le,Ye,et.x1,et.y1,et.x2,et.y2);Ne<Ze&&(Ze=Ne,je=Math.sqrt(Ze))}}return De(le,Ye)&&(je=-je),je}function De(le,Ye){for(var Ze=0,je=ve.length;je--;){var He=ve[je];if(He.maxX<=le)break;var et=He.y1>Ye!=He.y2>Ye&&le<(He.x2-He.x1)*(Ye-He.y1)/(He.y2-He.y1)+He.x1;et&&(Ze+=He.y1<He.y2?1:-1)}return Ze!==0}}function C(ie,se,I,W,fe,Z,me,$,pe,ve){Z===void 0&&(Z=1),$===void 0&&($=0),pe===void 0&&(pe=0),ve===void 0&&(ve=0),M(ie,se,I,W,fe,Z,me,null,$,pe,ve)}function M(ie,se,I,W,fe,Z,me,$,pe,ve,ze){Z===void 0&&(Z=1),pe===void 0&&(pe=0),ve===void 0&&(ve=0),ze===void 0&&(ze=0);for(var Ge=S(ie,se,I,W,fe,Z),Fe=new Uint8Array(Ge.length*4),Qe=0;Qe<Ge.length;Qe++)Fe[Qe*4+ze]=Ge[Qe];x(me,Fe,pe,ve,ie,se,1<<3-ze,$)}function A(ie,se,I,W,fe,Z){var me=fe-I,$=Z-W,pe=me*me+$*$,ve=pe?Math.max(0,Math.min(1,((ie-I)*me+(se-W)*$)/pe)):0,ze=ie-(I+ve*me),Ge=se-(W+ve*$);return ze*ze+Ge*Ge}var R=Object.freeze({__proto__:null,generate:S,generateIntoCanvas:C,generateIntoFramebuffer:M}),N="precision highp float;uniform vec4 uGlyphBounds;attribute vec2 aUV;attribute vec4 aLineSegment;varying vec4 vLineSegment;varying vec2 vGlyphXY;void main(){vLineSegment=aLineSegment;vGlyphXY=mix(uGlyphBounds.xy,uGlyphBounds.zw,aUV);gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",B="precision highp float;uniform vec4 uGlyphBounds;uniform float uMaxDistance;uniform float uExponent;varying vec4 vLineSegment;varying vec2 vGlyphXY;float absDistToSegment(vec2 point,vec2 lineA,vec2 lineB){vec2 lineDir=lineB-lineA;float lenSq=dot(lineDir,lineDir);float t=lenSq==0.0 ? 0.0 : clamp(dot(point-lineA,lineDir)/lenSq,0.0,1.0);vec2 linePt=lineA+t*lineDir;return distance(point,linePt);}void main(){vec4 seg=vLineSegment;vec2 p=vGlyphXY;float dist=absDistToSegment(p,seg.xy,seg.zw);float val=pow(1.0-clamp(dist/uMaxDistance,0.0,1.0),uExponent)*0.5;bool crossing=(seg.y>p.y!=seg.w>p.y)&&(p.x<(seg.z-seg.x)*(p.y-seg.y)/(seg.w-seg.y)+seg.x);bool crossingUp=crossing&&vLineSegment.y<vLineSegment.w;gl_FragColor=vec4(crossingUp ? 1.0/255.0 : 0.0,crossing&&!crossingUp ? 1.0/255.0 : 0.0,0.0,val);}",F="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){vec4 color=texture2D(tex,vUV);bool inside=color.r!=color.g;float val=inside ? 1.0-color.a : color.a;gl_FragColor=vec4(val);}",U=new Float32Array([0,0,2,0,0,2]),z=null,P=!1,L={},O=new WeakMap;function ee(ie){if(!P&&!re(ie))throw new Error("WebGL generation not supported")}function Q(ie,se,I,W,fe,Z,me){if(Z===void 0&&(Z=1),me===void 0&&(me=null),!me&&(me=z,!me)){var $=typeof OffscreenCanvas=="function"?new OffscreenCanvas(1,1):typeof document<"u"?document.createElement("canvas"):null;if(!$)throw new Error("OffscreenCanvas or DOM canvas not supported");me=z=$.getContext("webgl",{depth:!1})}ee(me);var pe=new Uint8Array(ie*se*4);m(me,function(Fe){var Qe=Fe.gl,lt=Fe.withTexture,De=Fe.withTextureFramebuffer;lt("readable",function(le,Ye){Qe.texImage2D(Qe.TEXTURE_2D,0,Qe.RGBA,ie,se,0,Qe.RGBA,Qe.UNSIGNED_BYTE,null),De(le,Ye,function(Ze){ne(ie,se,I,W,fe,Z,Qe,Ze,0,0,0),Qe.readPixels(0,0,ie,se,Qe.RGBA,Qe.UNSIGNED_BYTE,pe)})})});for(var ve=new Uint8Array(ie*se),ze=0,Ge=0;ze<pe.length;ze+=4)ve[Ge++]=pe[ze];return ve}function te(ie,se,I,W,fe,Z,me,$,pe,ve){Z===void 0&&(Z=1),$===void 0&&($=0),pe===void 0&&(pe=0),ve===void 0&&(ve=0),ne(ie,se,I,W,fe,Z,me,null,$,pe,ve)}function ne(ie,se,I,W,fe,Z,me,$,pe,ve,ze){Z===void 0&&(Z=1),pe===void 0&&(pe=0),ve===void 0&&(ve=0),ze===void 0&&(ze=0),ee(me);var Ge=[];a(I,function(Fe,Qe,lt,De){Ge.push(Fe,Qe,lt,De)}),Ge=new Float32Array(Ge),m(me,function(Fe){var Qe=Fe.gl,lt=Fe.isWebGL2,De=Fe.getExtension,le=Fe.withProgram,Ye=Fe.withTexture,Ze=Fe.withTextureFramebuffer,je=Fe.handleContextLoss;if(Ye("rawDistances",function(He,et){(ie!==He._lastWidth||se!==He._lastHeight)&&Qe.texImage2D(Qe.TEXTURE_2D,0,Qe.RGBA,He._lastWidth=ie,He._lastHeight=se,0,Qe.RGBA,Qe.UNSIGNED_BYTE,null),le("main",N,B,function(Ne){var st=Ne.setAttribute,oe=Ne.setUniform,X=!lt&&De("ANGLE_instanced_arrays"),Ae=!lt&&De("EXT_blend_minmax");st("aUV",2,Qe.STATIC_DRAW,0,U),st("aLineSegment",4,Qe.DYNAMIC_DRAW,1,Ge),oe.apply(void 0,["4f","uGlyphBounds"].concat(W)),oe("1f","uMaxDistance",fe),oe("1f","uExponent",Z),Ze(He,et,function(Pe){Qe.enable(Qe.BLEND),Qe.colorMask(!0,!0,!0,!0),Qe.viewport(0,0,ie,se),Qe.scissor(0,0,ie,se),Qe.blendFunc(Qe.ONE,Qe.ONE),Qe.blendEquationSeparate(Qe.FUNC_ADD,lt?Qe.MAX:Ae.MAX_EXT),Qe.clear(Qe.COLOR_BUFFER_BIT),lt?Qe.drawArraysInstanced(Qe.TRIANGLES,0,3,Ge.length/4):X.drawArraysInstancedANGLE(Qe.TRIANGLES,0,3,Ge.length/4)})}),le("post",o,F,function(Ne){Ne.setAttribute("aUV",2,Qe.STATIC_DRAW,0,U),Ne.setUniform("1i","tex",et),Qe.bindFramebuffer(Qe.FRAMEBUFFER,$),Qe.disable(Qe.BLEND),Qe.colorMask(ze===0,ze===1,ze===2,ze===3),Qe.viewport(pe,ve,ie,se),Qe.scissor(pe,ve,ie,se),Qe.drawArrays(Qe.TRIANGLES,0,3)})}),Qe.isContextLost())throw je(),new Error("webgl context lost")})}function re(ie){var se=!ie||ie===z?L:ie.canvas||ie,I=O.get(se);if(I===void 0){P=!0;var W=null;try{var fe=[97,106,97,61,99,137,118,80,80,118,137,99,61,97,106,97],Z=Q(4,4,"M8,8L16,8L24,24L16,24Z",[0,0,32,32],24,1,ie);I=Z&&fe.length===Z.length&&Z.every(function(me,$){return me===fe[$]}),I||(W="bad trial run results",console.info(fe,Z))}catch(me){I=!1,W=me.message}W&&console.warn("WebGL SDF generation not supported:",W),P=!1,O.set(se,I)}return I}var j=Object.freeze({__proto__:null,generate:Q,generateIntoCanvas:te,generateIntoFramebuffer:ne,isSupported:re});function ae(ie,se,I,W,fe,Z){fe===void 0&&(fe=Math.max(W[2]-W[0],W[3]-W[1])/2),Z===void 0&&(Z=1);try{return Q.apply(j,arguments)}catch(me){return console.info("WebGL SDF generation failed, falling back to JS",me),S.apply(R,arguments)}}function J(ie,se,I,W,fe,Z,me,$,pe,ve){fe===void 0&&(fe=Math.max(W[2]-W[0],W[3]-W[1])/2),Z===void 0&&(Z=1),$===void 0&&($=0),pe===void 0&&(pe=0),ve===void 0&&(ve=0);try{return te.apply(j,arguments)}catch(ze){return console.info("WebGL SDF generation failed, falling back to JS",ze),C.apply(R,arguments)}}return e.forEachPathCommand=i,e.generate=ae,e.generateIntoCanvas=J,e.javascript=R,e.pathToLineSegments=a,e.webgl=j,e.webglUtils=b,Object.defineProperty(e,"__esModule",{value:!0}),e})({});return s}function n9(){var s=(function(e){var t={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"},n={},i={};n.L=1,i[1]="L",Object.keys(t).forEach(function(je,He){n[je]=1<<He+1,i[n[je]]=je}),Object.freeze(n);var a=n.LRI|n.RLI|n.FSI,o=n.L|n.R|n.AL,c=n.B|n.S|n.WS|n.ON|n.FSI|n.LRI|n.RLI|n.PDI,u=n.BN|n.RLE|n.LRE|n.RLO|n.LRO|n.PDF,h=n.S|n.WS|n.B|a|n.PDI|u,m=null;function x(){if(!m){m=new Map;var je=function(et){if(t.hasOwnProperty(et)){var Ne=0;t[et].split(",").forEach(function(st){var oe=st.split("+"),X=oe[0],Ae=oe[1];X=parseInt(X,36),Ae=Ae?parseInt(Ae,36):0,m.set(Ne+=X,n[et]);for(var Pe=0;Pe<Ae;Pe++)m.set(++Ne,n[et])})}};for(var He in t)je(He)}}function g(je){return x(),m.get(je.codePointAt(0))||n.L}function b(je){return i[g(je)]}var S={pairs:"14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",canonical:"6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye"};function C(je,He){var et=36,Ne=0,st=new Map,oe=He&&new Map,X;return je.split(",").forEach(function Ae(Pe){if(Pe.indexOf("+")!==-1)for(var Ue=+Pe;Ue--;)Ae(X);else{X=Pe;var Be=Pe.split(">"),bt=Be[0],vt=Be[1];bt=String.fromCodePoint(Ne+=parseInt(bt,et)),vt=String.fromCodePoint(Ne+=parseInt(vt,et)),st.set(bt,vt),He&&oe.set(vt,bt)}}),{map:st,reverseMap:oe}}var M,A,R;function N(){if(!M){var je=C(S.pairs,!0),He=je.map,et=je.reverseMap;M=He,A=et,R=C(S.canonical,!1).map}}function B(je){return N(),M.get(je)||null}function F(je){return N(),A.get(je)||null}function U(je){return N(),R.get(je)||null}var z=n.L,P=n.R,L=n.EN,O=n.ES,ee=n.ET,Q=n.AN,te=n.CS,ne=n.B,re=n.S,j=n.ON,ae=n.BN,J=n.NSM,ie=n.AL,se=n.LRO,I=n.RLO,W=n.LRE,fe=n.RLE,Z=n.PDF,me=n.LRI,$=n.RLI,pe=n.FSI,ve=n.PDI;function ze(je,He){for(var et=125,Ne=new Uint32Array(je.length),st=0;st<je.length;st++)Ne[st]=g(je[st]);var oe=new Map;function X(ga,Qa){var ca=Ne[ga];Ne[ga]=Qa,oe.set(ca,oe.get(ca)-1),ca&c&&oe.set(c,oe.get(c)-1),oe.set(Qa,(oe.get(Qa)||0)+1),Qa&c&&oe.set(c,(oe.get(c)||0)+1)}for(var Ae=new Uint8Array(je.length),Pe=new Map,Ue=[],Be=null,bt=0;bt<je.length;bt++)Be||Ue.push(Be={start:bt,end:je.length-1,level:He==="rtl"?1:He==="ltr"?0:Bl(bt,!1)}),Ne[bt]&ne&&(Be.end=bt,Be=null);for(var vt=fe|W|I|se|a|ve|Z|ne,It=function(ga){return ga+(ga&1?1:2)},zt=function(ga){return ga+(ga&1?2:1)},qe=0;qe<Ue.length;qe++){Be=Ue[qe];var We=[{_level:Be.level,_override:0,_isolate:0}],ft=void 0,ge=0,Ie=0,ht=0;oe.clear();for(var ye=Be.start;ye<=Be.end;ye++){var Re=Ne[ye];if(ft=We[We.length-1],oe.set(Re,(oe.get(Re)||0)+1),Re&c&&oe.set(c,(oe.get(c)||0)+1),Re&vt)if(Re&(fe|W)){Ae[ye]=ft._level;var pt=(Re===fe?zt:It)(ft._level);pt<=et&&!ge&&!Ie?We.push({_level:pt,_override:0,_isolate:0}):ge||Ie++}else if(Re&(I|se)){Ae[ye]=ft._level;var Rt=(Re===I?zt:It)(ft._level);Rt<=et&&!ge&&!Ie?We.push({_level:Rt,_override:Re&I?P:z,_isolate:0}):ge||Ie++}else if(Re&a){Re&pe&&(Re=Bl(ye+1,!0)===1?$:me),Ae[ye]=ft._level,ft._override&&X(ye,ft._override);var dt=(Re===$?zt:It)(ft._level);dt<=et&&ge===0&&Ie===0?(ht++,We.push({_level:dt,_override:0,_isolate:1,_isolInitIndex:ye})):ge++}else if(Re&ve){if(ge>0)ge--;else if(ht>0){for(Ie=0;!We[We.length-1]._isolate;)We.pop();var Ke=We[We.length-1]._isolInitIndex;Ke!=null&&(Pe.set(Ke,ye),Pe.set(ye,Ke)),We.pop(),ht--}ft=We[We.length-1],Ae[ye]=ft._level,ft._override&&X(ye,ft._override)}else Re&Z?(ge===0&&(Ie>0?Ie--:!ft._isolate&&We.length>1&&(We.pop(),ft=We[We.length-1])),Ae[ye]=ft._level):Re&ne&&(Ae[ye]=Be.level);else Ae[ye]=ft._level,ft._override&&Re!==ae&&X(ye,ft._override)}for(var Lt=[],Vt=null,Kt=Be.start;Kt<=Be.end;Kt++){var on=Ne[Kt];if(!(on&u)){var Gn=Ae[Kt],En=on&a,li=on===ve;Vt&&Gn===Vt._level?(Vt._end=Kt,Vt._endsWithIsolInit=En):Lt.push(Vt={_start:Kt,_end:Kt,_level:Gn,_startsWithPDI:li,_endsWithIsolInit:En})}}for(var qi=[],la=0;la<Lt.length;la++){var di=Lt[la];if(!di._startsWithPDI||di._startsWithPDI&&!Pe.has(di._start)){for(var Qi=[Vt=di],Mi=void 0;Vt&&Vt._endsWithIsolInit&&(Mi=Pe.get(Vt._end))!=null;)for(var mn=la+1;mn<Lt.length;mn++)if(Lt[mn]._start===Mi){Qi.push(Vt=Lt[mn]);break}for(var jn=[],bn=0;bn<Qi.length;bn++)for(var q=Qi[bn],he=q._start;he<=q._end;he++)jn.push(he);for(var we=Ae[jn[0]],Je=Be.level,ot=jn[0]-1;ot>=0;ot--)if(!(Ne[ot]&u)){Je=Ae[ot];break}var ct=jn[jn.length-1],Ot=Ae[ct],Dt=Be.level;if(!(Ne[ct]&a)){for(var Nt=ct+1;Nt<=Be.end;Nt++)if(!(Ne[Nt]&u)){Dt=Ae[Nt];break}}qi.push({_seqIndices:jn,_sosType:Math.max(Je,we)%2?P:z,_eosType:Math.max(Dt,Ot)%2?P:z})}}for(var K=0;K<qi.length;K++){var be=qi[K],xe=be._seqIndices,Oe=be._sosType,Me=be._eosType,$e=Ae[xe[0]]&1?P:z;if(oe.get(J))for(var yt=0;yt<xe.length;yt++){var Mt=xe[yt];if(Ne[Mt]&J){for(var Ft=Oe,mt=yt-1;mt>=0;mt--)if(!(Ne[xe[mt]]&u)){Ft=Ne[xe[mt]];break}X(Mt,Ft&(a|ve)?j:Ft)}}if(oe.get(L))for(var Pt=0;Pt<xe.length;Pt++){var en=xe[Pt];if(Ne[en]&L)for(var Qt=Pt-1;Qt>=-1;Qt--){var yn=Qt===-1?Oe:Ne[xe[Qt]];if(yn&o){yn===ie&&X(en,Q);break}}}if(oe.get(ie))for(var ln=0;ln<xe.length;ln++){var xn=xe[ln];Ne[xn]&ie&&X(xn,P)}if(oe.get(O)||oe.get(te))for(var Un=1;Un<xe.length-1;Un++){var an=xe[Un];if(Ne[an]&(O|te)){for(var Bn=0,tn=0,Hn=Un-1;Hn>=0&&(Bn=Ne[xe[Hn]],!!(Bn&u));Hn--);for(var kn=Un+1;kn<xe.length&&(tn=Ne[xe[kn]],!!(tn&u));kn++);Bn===tn&&(Ne[an]===O?Bn===L:Bn&(L|Q))&&X(an,Bn)}}if(oe.get(L))for(var hn=0;hn<xe.length;hn++){var Ni=xe[hn];if(Ne[Ni]&L){for(var Yn=hn-1;Yn>=0&&Ne[xe[Yn]]&(ee|u);Yn--)X(xe[Yn],L);for(hn++;hn<xe.length&&Ne[xe[hn]]&(ee|u|L);hn++)Ne[xe[hn]]!==L&&X(xe[hn],L)}}if(oe.get(ee)||oe.get(O)||oe.get(te))for(var Wn=0;Wn<xe.length;Wn++){var xi=xe[Wn];if(Ne[xi]&(ee|O|te)){X(xi,j);for(var ki=Wn-1;ki>=0&&Ne[xe[ki]]&u;ki--)X(xe[ki],j);for(var Di=Wn+1;Di<xe.length&&Ne[xe[Di]]&u;Di++)X(xe[Di],j)}}if(oe.get(L))for(var Ga=0,Ka=Oe;Ga<xe.length;Ga++){var hr=xe[Ga],To=Ne[hr];To&L?Ka===z&&X(hr,z):To&o&&(Ka=To)}if(oe.get(c)){var vs=P|L|Q,Nl=vs|z,dr=[];{for(var ys=[],da=0;da<xe.length;da++)if(Ne[xe[da]]&c){var qs=je[xe[da]],ho=void 0;if(B(qs)!==null)if(ys.length<63)ys.push({char:qs,seqIndex:da});else break;else if((ho=F(qs))!==null)for(var bs=ys.length-1;bs>=0;bs--){var ja=ys[bs].char;if(ja===ho||ja===F(U(qs))||B(U(ja))===qs){dr.push([ys[bs].seqIndex,da]),ys.length=bs;break}}}dr.sort(function(ga,Qa){return ga[0]-Qa[0]})}for(var Or=0;Or<dr.length;Or++){for(var Ir=dr[Or],pr=Ir[0],Ha=Ir[1],pa=!1,gn=0,zr=pr+1;zr<Ha;zr++){var _s=xe[zr];if(Ne[_s]&Nl){pa=!0;var Ro=Ne[_s]&vs?P:z;if(Ro===$e){gn=Ro;break}}}if(pa&&!gn){gn=Oe;for(var Ns=pr-1;Ns>=0;Ns--){var No=xe[Ns];if(Ne[No]&Nl){var mr=Ne[No]&vs?P:z;mr!==$e?gn=mr:gn=$e;break}}}if(gn){if(Ne[xe[pr]]=Ne[xe[Ha]]=gn,gn!==$e){for(var Js=pr+1;Js<xe.length;Js++)if(!(Ne[xe[Js]]&u)){g(je[xe[Js]])&J&&(Ne[xe[Js]]=gn);break}}if(gn!==$e){for(var Fr=Ha+1;Fr<xe.length;Fr++)if(!(Ne[xe[Fr]]&u)){g(je[xe[Fr]])&J&&(Ne[xe[Fr]]=gn);break}}}}for(var Vi=0;Vi<xe.length;Vi++)if(Ne[xe[Vi]]&c){for(var Bs=Vi,ma=Vi,ka=Oe,xr=Vi-1;xr>=0;xr--)if(Ne[xe[xr]]&u)Bs=xr;else{ka=Ne[xe[xr]]&vs?P:z;break}for(var Pr=Me,Zs=Vi+1;Zs<xe.length;Zs++)if(Ne[xe[Zs]]&(c|u))ma=Zs;else{Pr=Ne[xe[Zs]]&vs?P:z;break}for(var gr=Bs;gr<=ma;gr++)Ne[xe[gr]]=ka===Pr?ka:$e;Vi=ma}}}for(var xa=Be.start;xa<=Be.end;xa++){var hc=Ae[xa],na=Ne[xa];if(hc&1?na&(z|L|Q)&&Ae[xa]++:na&P?Ae[xa]++:na&(Q|L)&&(Ae[xa]+=2),na&u&&(Ae[xa]=xa===0?Be.level:Ae[xa-1]),xa===Be.end||g(je[xa])&(re|ne))for(var Gr=xa;Gr>=0&&g(je[Gr])&h;Gr--)Ae[Gr]=Be.level}}return{levels:Ae,paragraphs:Ue};function Bl(ga,Qa){for(var ca=ga;ca<je.length;ca++){var Ds=Ne[ca];if(Ds&(P|ie))return 1;if(Ds&(ne|z)||Qa&&Ds===ve)return 0;if(Ds&a){var Zo=jr(ca);ca=Zo===-1?je.length:Zo}}return 0}function jr(ga){for(var Qa=1,ca=ga+1;ca<je.length;ca++){var Ds=Ne[ca];if(Ds&ne)break;if(Ds&ve){if(--Qa===0)return ca}else Ds&a&&Qa++}return-1}}var Ge="14>1,j>2,t>2,u>2,1a>g,2v3>1,1>1,1ge>1,1wd>1,b>1,1j>1,f>1,ai>3,-2>3,+1,8>1k0,-1jq>1y7,-1y6>1hf,-1he>1h6,-1h5>1ha,-1h8>1qi,-1pu>1,6>3u,-3s>7,6>1,1>1,f>1,1>1,+2,3>1,1>1,+13,4>1,1>1,6>1eo,-1ee>1,3>1mg,-1me>1mk,-1mj>1mi,-1mg>1mi,-1md>1,1>1,+2,1>10k,-103>1,1>1,4>1,5>1,1>1,+10,3>1,1>8,-7>8,+1,-6>7,+1,a>1,1>1,u>1,u6>1,1>1,+5,26>1,1>1,2>1,2>2,8>1,7>1,4>1,1>1,+5,b8>1,1>1,+3,1>3,-2>1,2>1,1>1,+2,c>1,3>1,1>1,+2,h>1,3>1,a>1,1>1,2>1,3>1,1>1,d>1,f>1,3>1,1a>1,1>1,6>1,7>1,13>1,k>1,1>1,+19,4>1,1>1,+2,2>1,1>1,+18,m>1,a>1,1>1,lk>1,1>1,4>1,2>1,f>1,3>1,1>1,+3,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,6>1,4j>1,j>2,t>2,u>2,2>1,+1",Fe;function Qe(){if(!Fe){var je=C(Ge,!0),He=je.map,et=je.reverseMap;et.forEach(function(Ne,st){He.set(st,Ne)}),Fe=He}}function lt(je){return Qe(),Fe.get(je)||null}function De(je,He,et,Ne){var st=je.length;et=Math.max(0,et==null?0:+et),Ne=Math.min(st-1,Ne==null?st-1:+Ne);for(var oe=new Map,X=et;X<=Ne;X++)if(He[X]&1){var Ae=lt(je[X]);Ae!==null&&oe.set(X,Ae)}return oe}function le(je,He,et,Ne){var st=je.length;et=Math.max(0,et==null?0:+et),Ne=Math.min(st-1,Ne==null?st-1:+Ne);var oe=[];return He.paragraphs.forEach(function(X){var Ae=Math.max(et,X.start),Pe=Math.min(Ne,X.end);if(Ae<Pe){for(var Ue=He.levels.slice(Ae,Pe+1),Be=Pe;Be>=Ae&&g(je[Be])&h;Be--)Ue[Be]=X.level;for(var bt=X.level,vt=1/0,It=0;It<Ue.length;It++){var zt=Ue[It];zt>bt&&(bt=zt),zt<vt&&(vt=zt|1)}for(var qe=bt;qe>=vt;qe--)for(var We=0;We<Ue.length;We++)if(Ue[We]>=qe){for(var ft=We;We+1<Ue.length&&Ue[We+1]>=qe;)We++;We>ft&&oe.push([ft+Ae,We+Ae])}}}),oe}function Ye(je,He,et,Ne){var st=Ze(je,He,et,Ne),oe=[].concat(je);return st.forEach(function(X,Ae){oe[Ae]=(He.levels[X]&1?lt(je[X]):null)||je[X]}),oe.join("")}function Ze(je,He,et,Ne){for(var st=le(je,He,et,Ne),oe=[],X=0;X<je.length;X++)oe[X]=X;return st.forEach(function(Ae){for(var Pe=Ae[0],Ue=Ae[1],Be=oe.slice(Pe,Ue+1),bt=Be.length;bt--;)oe[Ue-bt]=Be[bt]}),oe}return e.closingToOpeningBracket=F,e.getBidiCharType=g,e.getBidiCharTypeName=b,e.getCanonicalBracket=U,e.getEmbeddingLevels=ze,e.getMirroredCharacter=lt,e.getMirroredCharactersMap=De,e.getReorderSegments=le,e.getReorderedIndices=Ze,e.getReorderedString=Ye,e.openingToClosingBracket=B,Object.defineProperty(e,"__esModule",{value:!0}),e})({});return s}const qT=/\bvoid\s+main\s*\(\s*\)\s*{/g;function $_(s){const e=/^[ \t]*#include +<([\w\d./]+)>/gm;function t(n,i){let a=ni[i];return a?$_(a):n}return s.replace(e,t)}const lr=[];for(let s=0;s<256;s++)lr[s]=(s<16?"0":"")+s.toString(16);function i9(){const s=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(lr[s&255]+lr[s>>8&255]+lr[s>>16&255]+lr[s>>24&255]+"-"+lr[e&255]+lr[e>>8&255]+"-"+lr[e>>16&15|64]+lr[e>>24&255]+"-"+lr[t&63|128]+lr[t>>8&255]+"-"+lr[t>>16&255]+lr[t>>24&255]+lr[n&255]+lr[n>>8&255]+lr[n>>16&255]+lr[n>>24&255]).toUpperCase()}const Ph=Object.assign||function(){let s=arguments[0];for(let e=1,t=arguments.length;e<t;e++){let n=arguments[e];if(n)for(let i in n)Object.prototype.hasOwnProperty.call(n,i)&&(s[i]=n[i])}return s},a9=Date.now(),YE=new WeakMap,WE=new Map;let s9=1e10;function eS(s,e){const t=c9(e);let n=YE.get(s);if(n||YE.set(s,n=Object.create(null)),n[t])return new n[t];const i=`_onBeforeCompile${t}`,a=function(h,m){s.onBeforeCompile.call(this,h,m);const x=this.customProgramCacheKey()+"|"+h.vertexShader+"|"+h.fragmentShader;let g=WE[x];if(!g){const b=r9(this,h,e,t);g=WE[x]=b}h.vertexShader=g.vertexShader,h.fragmentShader=g.fragmentShader,Ph(h.uniforms,this.uniforms),e.timeUniform&&(h.uniforms[e.timeUniform]={get value(){return Date.now()-a9}}),this[i]&&this[i](h)},o=function(){return c(e.chained?s:s.clone())},c=function(h){const m=Object.create(h,u);return Object.defineProperty(m,"baseMaterial",{value:s}),Object.defineProperty(m,"id",{value:s9++}),m.uuid=i9(),m.uniforms=Ph({},h.uniforms,e.uniforms),m.defines=Ph({},h.defines,e.defines),m.defines[`TROIKA_DERIVED_MATERIAL_${t}`]="",m.extensions=Ph({},h.extensions,e.extensions),m._listeners=void 0,m},u={constructor:{value:o},isDerivedMaterial:{value:!0},type:{get:()=>s.type,set:h=>{s.type=h}},isDerivedFrom:{writable:!0,configurable:!0,value:function(h){const m=this.baseMaterial;return h===m||m.isDerivedMaterial&&m.isDerivedFrom(h)||!1}},customProgramCacheKey:{writable:!0,configurable:!0,value:function(){return s.customProgramCacheKey()+"|"+t}},onBeforeCompile:{get(){return a},set(h){this[i]=h}},copy:{writable:!0,configurable:!0,value:function(h){return s.copy.call(this,h),!s.isShaderMaterial&&!s.isDerivedMaterial&&(Ph(this.extensions,h.extensions),Ph(this.defines,h.defines),Ph(this.uniforms,Zp.clone(h.uniforms))),this}},clone:{writable:!0,configurable:!0,value:function(){const h=new s.constructor;return c(h).copy(this)}},getDepthMaterial:{writable:!0,configurable:!0,value:function(){let h=this._depthMaterial;return h||(h=this._depthMaterial=eS(s.isDerivedMaterial?s.getDepthMaterial():new By({depthPacking:hS}),e),h.defines.IS_DEPTH_MATERIAL="",h.uniforms=this.uniforms),h}},getDistanceMaterial:{writable:!0,configurable:!0,value:function(){let h=this._distanceMaterial;return h||(h=this._distanceMaterial=eS(s.isDerivedMaterial?s.getDistanceMaterial():new Dy,e),h.defines.IS_DISTANCE_MATERIAL="",h.uniforms=this.uniforms),h}},dispose:{writable:!0,configurable:!0,value(){const{_depthMaterial:h,_distanceMaterial:m}=this;h&&h.dispose(),m&&m.dispose(),s.dispose.call(this)}}};return n[t]=o,new o}function r9(s,{vertexShader:e,fragmentShader:t},n,i){let{vertexDefs:a,vertexMainIntro:o,vertexMainOutro:c,vertexTransform:u,fragmentDefs:h,fragmentMainIntro:m,fragmentMainOutro:x,fragmentColorTransform:g,customRewriter:b,timeUniform:S}=n;if(a=a||"",o=o||"",c=c||"",h=h||"",m=m||"",x=x||"",(u||b)&&(e=$_(e)),(g||b)&&(t=t.replace(/^[ \t]*#include <((?:tonemapping|encodings|colorspace|fog|premultiplied_alpha|dithering)_fragment)>/gm,`
//!BEGIN_POST_CHUNK $1
$&
//!END_POST_CHUNK
`),t=$_(t)),b){let C=b({vertexShader:e,fragmentShader:t});e=C.vertexShader,t=C.fragmentShader}if(g){let C=[];t=t.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,M=>(C.push(M),"")),x=`${g}
${C.join(`
`)}
${x}`}if(S){const C=`
uniform float ${S};
`;a=C+a,h=C+h}return u&&(e=`vec3 troika_position_${i};
vec3 troika_normal_${i};
vec2 troika_uv_${i};
${e}
`,a=`${a}
void troikaVertexTransform${i}(inout vec3 position, inout vec3 normal, inout vec2 uv) {
  ${u}
}
`,o=`
troika_position_${i} = vec3(position);
troika_normal_${i} = vec3(normal);
troika_uv_${i} = vec2(uv);
troikaVertexTransform${i}(troika_position_${i}, troika_normal_${i}, troika_uv_${i});
${o}
`,e=e.replace(/\b(position|normal|uv)\b/g,(C,M,A,R)=>/\battribute\s+vec[23]\s+$/.test(R.substr(0,A))?M:`troika_${M}_${i}`),s.map&&s.map.channel>0||(e=e.replace(/\bMAP_UV\b/g,`troika_uv_${i}`))),e=qE(e,i,a,o,c),t=qE(t,i,h,m,x),{vertexShader:e,fragmentShader:t}}function qE(s,e,t,n,i){return(n||i||t)&&(s=s.replace(qT,`
${t}
void troikaOrigMain${e}() {`),s+=`
void main() {
  ${n}
  troikaOrigMain${e}();
  ${i}
}`),s}function o9(s,e){return s==="uniforms"?void 0:typeof e=="function"?e.toString():e}let l9=0;const JE=new Map;function c9(s){const e=JSON.stringify(s,o9);let t=JE.get(e);return t==null&&JE.set(e,t=++l9),t}/*!
Custom build of Typr.ts (https://github.com/fredli74/Typr.ts) for use in Troika text rendering.
Original MIT license applies: https://github.com/fredli74/Typr.ts/blob/master/LICENSE
*/function u9(){return typeof window>"u"&&(self.window=self),(function(s){var e={parse:function(i){var a=e._bin,o=new Uint8Array(i);if(a.readASCII(o,0,4)=="ttcf"){var c=4;a.readUshort(o,c),c+=2,a.readUshort(o,c),c+=2;var u=a.readUint(o,c);c+=4;for(var h=[],m=0;m<u;m++){var x=a.readUint(o,c);c+=4,h.push(e._readFont(o,x))}return h}return[e._readFont(o,0)]},_readFont:function(i,a){var o=e._bin,c=a;o.readFixed(i,a),a+=4;var u=o.readUshort(i,a);a+=2,o.readUshort(i,a),a+=2,o.readUshort(i,a),a+=2,o.readUshort(i,a),a+=2;for(var h=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GDEF","GPOS","GSUB","SVG "],m={_data:i,_offset:c},x={},g=0;g<u;g++){var b=o.readASCII(i,a,4);a+=4,o.readUint(i,a),a+=4;var S=o.readUint(i,a);a+=4;var C=o.readUint(i,a);a+=4,x[b]={offset:S,length:C}}for(g=0;g<h.length;g++){var M=h[g];x[M]&&(m[M.trim()]=e[M.trim()].parse(i,x[M].offset,x[M].length,m))}return m},_tabOffset:function(i,a,o){for(var c=e._bin,u=c.readUshort(i,o+4),h=o+12,m=0;m<u;m++){var x=c.readASCII(i,h,4);h+=4,c.readUint(i,h),h+=4;var g=c.readUint(i,h);if(h+=4,c.readUint(i,h),h+=4,x==a)return g}return 0}};e._bin={readFixed:function(i,a){return(i[a]<<8|i[a+1])+(i[a+2]<<8|i[a+3])/65540},readF2dot14:function(i,a){return e._bin.readShort(i,a)/16384},readInt:function(i,a){return e._bin._view(i).getInt32(a)},readInt8:function(i,a){return e._bin._view(i).getInt8(a)},readShort:function(i,a){return e._bin._view(i).getInt16(a)},readUshort:function(i,a){return e._bin._view(i).getUint16(a)},readUshorts:function(i,a,o){for(var c=[],u=0;u<o;u++)c.push(e._bin.readUshort(i,a+2*u));return c},readUint:function(i,a){return e._bin._view(i).getUint32(a)},readUint64:function(i,a){return 4294967296*e._bin.readUint(i,a)+e._bin.readUint(i,a+4)},readASCII:function(i,a,o){for(var c="",u=0;u<o;u++)c+=String.fromCharCode(i[a+u]);return c},readUnicode:function(i,a,o){for(var c="",u=0;u<o;u++){var h=i[a++]<<8|i[a++];c+=String.fromCharCode(h)}return c},_tdec:typeof window<"u"&&window.TextDecoder?new window.TextDecoder:null,readUTF8:function(i,a,o){var c=e._bin._tdec;return c&&a==0&&o==i.length?c.decode(i):e._bin.readASCII(i,a,o)},readBytes:function(i,a,o){for(var c=[],u=0;u<o;u++)c.push(i[a+u]);return c},readASCIIArray:function(i,a,o){for(var c=[],u=0;u<o;u++)c.push(String.fromCharCode(i[a+u]));return c},_view:function(i){return i._dataView||(i._dataView=i.buffer?new DataView(i.buffer,i.byteOffset,i.byteLength):new DataView(new Uint8Array(i).buffer))}},e._lctf={},e._lctf.parse=function(i,a,o,c,u){var h=e._bin,m={},x=a;h.readFixed(i,a),a+=4;var g=h.readUshort(i,a);a+=2;var b=h.readUshort(i,a);a+=2;var S=h.readUshort(i,a);return a+=2,m.scriptList=e._lctf.readScriptList(i,x+g),m.featureList=e._lctf.readFeatureList(i,x+b),m.lookupList=e._lctf.readLookupList(i,x+S,u),m},e._lctf.readLookupList=function(i,a,o){var c=e._bin,u=a,h=[],m=c.readUshort(i,a);a+=2;for(var x=0;x<m;x++){var g=c.readUshort(i,a);a+=2;var b=e._lctf.readLookupTable(i,u+g,o);h.push(b)}return h},e._lctf.readLookupTable=function(i,a,o){var c=e._bin,u=a,h={tabs:[]};h.ltype=c.readUshort(i,a),a+=2,h.flag=c.readUshort(i,a),a+=2;var m=c.readUshort(i,a);a+=2;for(var x=h.ltype,g=0;g<m;g++){var b=c.readUshort(i,a);a+=2;var S=o(i,x,u+b,h);h.tabs.push(S)}return h},e._lctf.numOfOnes=function(i){for(var a=0,o=0;o<32;o++)(i>>>o&1)!=0&&a++;return a},e._lctf.readClassDef=function(i,a){var o=e._bin,c=[],u=o.readUshort(i,a);if(a+=2,u==1){var h=o.readUshort(i,a);a+=2;var m=o.readUshort(i,a);a+=2;for(var x=0;x<m;x++)c.push(h+x),c.push(h+x),c.push(o.readUshort(i,a)),a+=2}if(u==2){var g=o.readUshort(i,a);for(a+=2,x=0;x<g;x++)c.push(o.readUshort(i,a)),a+=2,c.push(o.readUshort(i,a)),a+=2,c.push(o.readUshort(i,a)),a+=2}return c},e._lctf.getInterval=function(i,a){for(var o=0;o<i.length;o+=3){var c=i[o],u=i[o+1];if(i[o+2],c<=a&&a<=u)return o}return-1},e._lctf.readCoverage=function(i,a){var o=e._bin,c={};c.fmt=o.readUshort(i,a),a+=2;var u=o.readUshort(i,a);return a+=2,c.fmt==1&&(c.tab=o.readUshorts(i,a,u)),c.fmt==2&&(c.tab=o.readUshorts(i,a,3*u)),c},e._lctf.coverageIndex=function(i,a){var o=i.tab;if(i.fmt==1)return o.indexOf(a);if(i.fmt==2){var c=e._lctf.getInterval(o,a);if(c!=-1)return o[c+2]+(a-o[c])}return-1},e._lctf.readFeatureList=function(i,a){var o=e._bin,c=a,u=[],h=o.readUshort(i,a);a+=2;for(var m=0;m<h;m++){var x=o.readASCII(i,a,4);a+=4;var g=o.readUshort(i,a);a+=2;var b=e._lctf.readFeatureTable(i,c+g);b.tag=x.trim(),u.push(b)}return u},e._lctf.readFeatureTable=function(i,a){var o=e._bin,c=a,u={},h=o.readUshort(i,a);a+=2,h>0&&(u.featureParams=c+h);var m=o.readUshort(i,a);a+=2,u.tab=[];for(var x=0;x<m;x++)u.tab.push(o.readUshort(i,a+2*x));return u},e._lctf.readScriptList=function(i,a){var o=e._bin,c=a,u={},h=o.readUshort(i,a);a+=2;for(var m=0;m<h;m++){var x=o.readASCII(i,a,4);a+=4;var g=o.readUshort(i,a);a+=2,u[x.trim()]=e._lctf.readScriptTable(i,c+g)}return u},e._lctf.readScriptTable=function(i,a){var o=e._bin,c=a,u={},h=o.readUshort(i,a);a+=2,h>0&&(u.default=e._lctf.readLangSysTable(i,c+h));var m=o.readUshort(i,a);a+=2;for(var x=0;x<m;x++){var g=o.readASCII(i,a,4);a+=4;var b=o.readUshort(i,a);a+=2,u[g.trim()]=e._lctf.readLangSysTable(i,c+b)}return u},e._lctf.readLangSysTable=function(i,a){var o=e._bin,c={};o.readUshort(i,a),a+=2,c.reqFeature=o.readUshort(i,a),a+=2;var u=o.readUshort(i,a);return a+=2,c.features=o.readUshorts(i,a,u),c},e.CFF={},e.CFF.parse=function(i,a,o){var c=e._bin;(i=new Uint8Array(i.buffer,a,o))[a=0],i[++a],i[++a],i[++a],a++;var u=[];a=e.CFF.readIndex(i,a,u);for(var h=[],m=0;m<u.length-1;m++)h.push(c.readASCII(i,a+u[m],u[m+1]-u[m]));a+=u[u.length-1];var x=[];a=e.CFF.readIndex(i,a,x);var g=[];for(m=0;m<x.length-1;m++)g.push(e.CFF.readDict(i,a+x[m],a+x[m+1]));a+=x[x.length-1];var b=g[0],S=[];a=e.CFF.readIndex(i,a,S);var C=[];for(m=0;m<S.length-1;m++)C.push(c.readASCII(i,a+S[m],S[m+1]-S[m]));if(a+=S[S.length-1],e.CFF.readSubrs(i,a,b),b.CharStrings){a=b.CharStrings,S=[],a=e.CFF.readIndex(i,a,S);var M=[];for(m=0;m<S.length-1;m++)M.push(c.readBytes(i,a+S[m],S[m+1]-S[m]));b.CharStrings=M}if(b.ROS){a=b.FDArray;var A=[];for(a=e.CFF.readIndex(i,a,A),b.FDArray=[],m=0;m<A.length-1;m++){var R=e.CFF.readDict(i,a+A[m],a+A[m+1]);e.CFF._readFDict(i,R,C),b.FDArray.push(R)}a+=A[A.length-1],a=b.FDSelect,b.FDSelect=[];var N=i[a];if(a++,N!=3)throw N;var B=c.readUshort(i,a);for(a+=2,m=0;m<B+1;m++)b.FDSelect.push(c.readUshort(i,a),i[a+2]),a+=3}return b.Encoding&&(b.Encoding=e.CFF.readEncoding(i,b.Encoding,b.CharStrings.length)),b.charset&&(b.charset=e.CFF.readCharset(i,b.charset,b.CharStrings.length)),e.CFF._readFDict(i,b,C),b},e.CFF._readFDict=function(i,a,o){var c;for(var u in a.Private&&(c=a.Private[1],a.Private=e.CFF.readDict(i,c,c+a.Private[0]),a.Private.Subrs&&e.CFF.readSubrs(i,c+a.Private.Subrs,a.Private)),a)["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(u)!=-1&&(a[u]=o[a[u]-426+35])},e.CFF.readSubrs=function(i,a,o){var c=e._bin,u=[];a=e.CFF.readIndex(i,a,u);var h,m=u.length;h=m<1240?107:m<33900?1131:32768,o.Bias=h,o.Subrs=[];for(var x=0;x<u.length-1;x++)o.Subrs.push(c.readBytes(i,a+u[x],u[x+1]-u[x]))},e.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],e.CFF.glyphByUnicode=function(i,a){for(var o=0;o<i.charset.length;o++)if(i.charset[o]==a)return o;return-1},e.CFF.glyphBySE=function(i,a){return a<0||a>255?-1:e.CFF.glyphByUnicode(i,e.CFF.tableSE[a])},e.CFF.readEncoding=function(i,a,o){e._bin;var c=[".notdef"],u=i[a];if(a++,u!=0)throw"error: unknown encoding format: "+u;var h=i[a];a++;for(var m=0;m<h;m++)c.push(i[a+m]);return c},e.CFF.readCharset=function(i,a,o){var c=e._bin,u=[".notdef"],h=i[a];if(a++,h==0)for(var m=0;m<o;m++){var x=c.readUshort(i,a);a+=2,u.push(x)}else{if(h!=1&&h!=2)throw"error: format: "+h;for(;u.length<o;){x=c.readUshort(i,a),a+=2;var g=0;for(h==1?(g=i[a],a++):(g=c.readUshort(i,a),a+=2),m=0;m<=g;m++)u.push(x),x++}}return u},e.CFF.readIndex=function(i,a,o){var c=e._bin,u=c.readUshort(i,a)+1,h=i[a+=2];if(a++,h==1)for(var m=0;m<u;m++)o.push(i[a+m]);else if(h==2)for(m=0;m<u;m++)o.push(c.readUshort(i,a+2*m));else if(h==3)for(m=0;m<u;m++)o.push(16777215&c.readUint(i,a+3*m-1));else if(u!=1)throw"unsupported offset size: "+h+", count: "+u;return(a+=u*h)-1},e.CFF.getCharString=function(i,a,o){var c=e._bin,u=i[a],h=i[a+1];i[a+2],i[a+3],i[a+4];var m=1,x=null,g=null;u<=20&&(x=u,m=1),u==12&&(x=100*u+h,m=2),21<=u&&u<=27&&(x=u,m=1),u==28&&(g=c.readShort(i,a+1),m=3),29<=u&&u<=31&&(x=u,m=1),32<=u&&u<=246&&(g=u-139,m=1),247<=u&&u<=250&&(g=256*(u-247)+h+108,m=2),251<=u&&u<=254&&(g=256*-(u-251)-h-108,m=2),u==255&&(g=c.readInt(i,a+1)/65535,m=5),o.val=g??"o"+x,o.size=m},e.CFF.readCharString=function(i,a,o){for(var c=a+o,u=e._bin,h=[];a<c;){var m=i[a],x=i[a+1];i[a+2],i[a+3],i[a+4];var g=1,b=null,S=null;m<=20&&(b=m,g=1),m==12&&(b=100*m+x,g=2),m!=19&&m!=20||(b=m,g=2),21<=m&&m<=27&&(b=m,g=1),m==28&&(S=u.readShort(i,a+1),g=3),29<=m&&m<=31&&(b=m,g=1),32<=m&&m<=246&&(S=m-139,g=1),247<=m&&m<=250&&(S=256*(m-247)+x+108,g=2),251<=m&&m<=254&&(S=256*-(m-251)-x-108,g=2),m==255&&(S=u.readInt(i,a+1)/65535,g=5),h.push(S??"o"+b),a+=g}return h},e.CFF.readDict=function(i,a,o){for(var c=e._bin,u={},h=[];a<o;){var m=i[a],x=i[a+1];i[a+2],i[a+3],i[a+4];var g=1,b=null,S=null;if(m==28&&(S=c.readShort(i,a+1),g=3),m==29&&(S=c.readInt(i,a+1),g=5),32<=m&&m<=246&&(S=m-139,g=1),247<=m&&m<=250&&(S=256*(m-247)+x+108,g=2),251<=m&&m<=254&&(S=256*-(m-251)-x-108,g=2),m==255)throw S=c.readInt(i,a+1)/65535,g=5,"unknown number";if(m==30){var C=[];for(g=1;;){var M=i[a+g];g++;var A=M>>4,R=15&M;if(A!=15&&C.push(A),R!=15&&C.push(R),R==15)break}for(var N="",B=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],F=0;F<C.length;F++)N+=B[C[F]];S=parseFloat(N)}m<=21&&(b=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][m],g=1,m==12&&(b=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][x],g=2)),b!=null?(u[b]=h.length==1?h[0]:h,h=[]):h.push(S),a+=g}return u},e.cmap={},e.cmap.parse=function(i,a,o){i=new Uint8Array(i.buffer,a,o),a=0;var c=e._bin,u={};c.readUshort(i,a),a+=2;var h=c.readUshort(i,a);a+=2;var m=[];u.tables=[];for(var x=0;x<h;x++){var g=c.readUshort(i,a);a+=2;var b=c.readUshort(i,a);a+=2;var S=c.readUint(i,a);a+=4;var C="p"+g+"e"+b,M=m.indexOf(S);if(M==-1){var A;M=u.tables.length,m.push(S);var R=c.readUshort(i,S);R==0?A=e.cmap.parse0(i,S):R==4?A=e.cmap.parse4(i,S):R==6?A=e.cmap.parse6(i,S):R==12?A=e.cmap.parse12(i,S):console.debug("unknown format: "+R,g,b,S),u.tables.push(A)}if(u[C]!=null)throw"multiple tables for one platform+encoding";u[C]=M}return u},e.cmap.parse0=function(i,a){var o=e._bin,c={};c.format=o.readUshort(i,a),a+=2;var u=o.readUshort(i,a);a+=2,o.readUshort(i,a),a+=2,c.map=[];for(var h=0;h<u-6;h++)c.map.push(i[a+h]);return c},e.cmap.parse4=function(i,a){var o=e._bin,c=a,u={};u.format=o.readUshort(i,a),a+=2;var h=o.readUshort(i,a);a+=2,o.readUshort(i,a),a+=2;var m=o.readUshort(i,a);a+=2;var x=m/2;u.searchRange=o.readUshort(i,a),a+=2,u.entrySelector=o.readUshort(i,a),a+=2,u.rangeShift=o.readUshort(i,a),a+=2,u.endCount=o.readUshorts(i,a,x),a+=2*x,a+=2,u.startCount=o.readUshorts(i,a,x),a+=2*x,u.idDelta=[];for(var g=0;g<x;g++)u.idDelta.push(o.readShort(i,a)),a+=2;for(u.idRangeOffset=o.readUshorts(i,a,x),a+=2*x,u.glyphIdArray=[];a<c+h;)u.glyphIdArray.push(o.readUshort(i,a)),a+=2;return u},e.cmap.parse6=function(i,a){var o=e._bin,c={};c.format=o.readUshort(i,a),a+=2,o.readUshort(i,a),a+=2,o.readUshort(i,a),a+=2,c.firstCode=o.readUshort(i,a),a+=2;var u=o.readUshort(i,a);a+=2,c.glyphIdArray=[];for(var h=0;h<u;h++)c.glyphIdArray.push(o.readUshort(i,a)),a+=2;return c},e.cmap.parse12=function(i,a){var o=e._bin,c={};c.format=o.readUshort(i,a),a+=2,a+=2,o.readUint(i,a),a+=4,o.readUint(i,a),a+=4;var u=o.readUint(i,a);a+=4,c.groups=[];for(var h=0;h<u;h++){var m=a+12*h,x=o.readUint(i,m+0),g=o.readUint(i,m+4),b=o.readUint(i,m+8);c.groups.push([x,g,b])}return c},e.glyf={},e.glyf.parse=function(i,a,o,c){for(var u=[],h=0;h<c.maxp.numGlyphs;h++)u.push(null);return u},e.glyf._parseGlyf=function(i,a){var o=e._bin,c=i._data,u=e._tabOffset(c,"glyf",i._offset)+i.loca[a];if(i.loca[a]==i.loca[a+1])return null;var h={};if(h.noc=o.readShort(c,u),u+=2,h.xMin=o.readShort(c,u),u+=2,h.yMin=o.readShort(c,u),u+=2,h.xMax=o.readShort(c,u),u+=2,h.yMax=o.readShort(c,u),u+=2,h.xMin>=h.xMax||h.yMin>=h.yMax)return null;if(h.noc>0){h.endPts=[];for(var m=0;m<h.noc;m++)h.endPts.push(o.readUshort(c,u)),u+=2;var x=o.readUshort(c,u);if(u+=2,c.length-u<x)return null;h.instructions=o.readBytes(c,u,x),u+=x;var g=h.endPts[h.noc-1]+1;for(h.flags=[],m=0;m<g;m++){var b=c[u];if(u++,h.flags.push(b),(8&b)!=0){var S=c[u];u++;for(var C=0;C<S;C++)h.flags.push(b),m++}}for(h.xs=[],m=0;m<g;m++){var M=(2&h.flags[m])!=0,A=(16&h.flags[m])!=0;M?(h.xs.push(A?c[u]:-c[u]),u++):A?h.xs.push(0):(h.xs.push(o.readShort(c,u)),u+=2)}for(h.ys=[],m=0;m<g;m++)M=(4&h.flags[m])!=0,A=(32&h.flags[m])!=0,M?(h.ys.push(A?c[u]:-c[u]),u++):A?h.ys.push(0):(h.ys.push(o.readShort(c,u)),u+=2);var R=0,N=0;for(m=0;m<g;m++)R+=h.xs[m],N+=h.ys[m],h.xs[m]=R,h.ys[m]=N}else{var B;h.parts=[];do{B=o.readUshort(c,u),u+=2;var F={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(h.parts.push(F),F.glyphIndex=o.readUshort(c,u),u+=2,1&B){var U=o.readShort(c,u);u+=2;var z=o.readShort(c,u);u+=2}else U=o.readInt8(c,u),u++,z=o.readInt8(c,u),u++;2&B?(F.m.tx=U,F.m.ty=z):(F.p1=U,F.p2=z),8&B?(F.m.a=F.m.d=o.readF2dot14(c,u),u+=2):64&B?(F.m.a=o.readF2dot14(c,u),u+=2,F.m.d=o.readF2dot14(c,u),u+=2):128&B&&(F.m.a=o.readF2dot14(c,u),u+=2,F.m.b=o.readF2dot14(c,u),u+=2,F.m.c=o.readF2dot14(c,u),u+=2,F.m.d=o.readF2dot14(c,u),u+=2)}while(32&B);if(256&B){var P=o.readUshort(c,u);for(u+=2,h.instr=[],m=0;m<P;m++)h.instr.push(c[u]),u++}}return h},e.GDEF={},e.GDEF.parse=function(i,a,o,c){var u=a;a+=4;var h=e._bin.readUshort(i,a);return{glyphClassDef:h===0?null:e._lctf.readClassDef(i,u+h)}},e.GPOS={},e.GPOS.parse=function(i,a,o,c){return e._lctf.parse(i,a,o,c,e.GPOS.subt)},e.GPOS.subt=function(i,a,o,c){var u=e._bin,h=o,m={};if(m.fmt=u.readUshort(i,o),o+=2,a==1||a==2||a==3||a==7||a==8&&m.fmt<=2){var x=u.readUshort(i,o);o+=2,m.coverage=e._lctf.readCoverage(i,x+h)}if(a==1&&m.fmt==1){var g=u.readUshort(i,o);o+=2,g!=0&&(m.pos=e.GPOS.readValueRecord(i,o,g))}else if(a==2&&m.fmt>=1&&m.fmt<=2){g=u.readUshort(i,o),o+=2;var b=u.readUshort(i,o);o+=2;var S=e._lctf.numOfOnes(g),C=e._lctf.numOfOnes(b);if(m.fmt==1){m.pairsets=[];var M=u.readUshort(i,o);o+=2;for(var A=0;A<M;A++){var R=h+u.readUshort(i,o);o+=2;var N=u.readUshort(i,R);R+=2;for(var B=[],F=0;F<N;F++){var U=u.readUshort(i,R);R+=2,g!=0&&(Q=e.GPOS.readValueRecord(i,R,g),R+=2*S),b!=0&&(te=e.GPOS.readValueRecord(i,R,b),R+=2*C),B.push({gid2:U,val1:Q,val2:te})}m.pairsets.push(B)}}if(m.fmt==2){var z=u.readUshort(i,o);o+=2;var P=u.readUshort(i,o);o+=2;var L=u.readUshort(i,o);o+=2;var O=u.readUshort(i,o);for(o+=2,m.classDef1=e._lctf.readClassDef(i,h+z),m.classDef2=e._lctf.readClassDef(i,h+P),m.matrix=[],A=0;A<L;A++){var ee=[];for(F=0;F<O;F++){var Q=null,te=null;g!=0&&(Q=e.GPOS.readValueRecord(i,o,g),o+=2*S),b!=0&&(te=e.GPOS.readValueRecord(i,o,b),o+=2*C),ee.push({val1:Q,val2:te})}m.matrix.push(ee)}}}else if(a==4&&m.fmt==1)m.markCoverage=e._lctf.readCoverage(i,u.readUshort(i,o)+h),m.baseCoverage=e._lctf.readCoverage(i,u.readUshort(i,o+2)+h),m.markClassCount=u.readUshort(i,o+4),m.markArray=e.GPOS.readMarkArray(i,u.readUshort(i,o+6)+h),m.baseArray=e.GPOS.readBaseArray(i,u.readUshort(i,o+8)+h,m.markClassCount);else if(a==6&&m.fmt==1)m.mark1Coverage=e._lctf.readCoverage(i,u.readUshort(i,o)+h),m.mark2Coverage=e._lctf.readCoverage(i,u.readUshort(i,o+2)+h),m.markClassCount=u.readUshort(i,o+4),m.mark1Array=e.GPOS.readMarkArray(i,u.readUshort(i,o+6)+h),m.mark2Array=e.GPOS.readBaseArray(i,u.readUshort(i,o+8)+h,m.markClassCount);else{if(a==9&&m.fmt==1){var ne=u.readUshort(i,o);o+=2;var re=u.readUint(i,o);if(o+=4,c.ltype==9)c.ltype=ne;else if(c.ltype!=ne)throw"invalid extension substitution";return e.GPOS.subt(i,c.ltype,h+re)}console.debug("unsupported GPOS table LookupType",a,"format",m.fmt)}return m},e.GPOS.readValueRecord=function(i,a,o){var c=e._bin,u=[];return u.push(1&o?c.readShort(i,a):0),a+=1&o?2:0,u.push(2&o?c.readShort(i,a):0),a+=2&o?2:0,u.push(4&o?c.readShort(i,a):0),a+=4&o?2:0,u.push(8&o?c.readShort(i,a):0),a+=8&o?2:0,u},e.GPOS.readBaseArray=function(i,a,o){var c=e._bin,u=[],h=a,m=c.readUshort(i,a);a+=2;for(var x=0;x<m;x++){for(var g=[],b=0;b<o;b++)g.push(e.GPOS.readAnchorRecord(i,h+c.readUshort(i,a))),a+=2;u.push(g)}return u},e.GPOS.readMarkArray=function(i,a){var o=e._bin,c=[],u=a,h=o.readUshort(i,a);a+=2;for(var m=0;m<h;m++){var x=e.GPOS.readAnchorRecord(i,o.readUshort(i,a+2)+u);x.markClass=o.readUshort(i,a),c.push(x),a+=4}return c},e.GPOS.readAnchorRecord=function(i,a){var o=e._bin,c={};return c.fmt=o.readUshort(i,a),c.x=o.readShort(i,a+2),c.y=o.readShort(i,a+4),c},e.GSUB={},e.GSUB.parse=function(i,a,o,c){return e._lctf.parse(i,a,o,c,e.GSUB.subt)},e.GSUB.subt=function(i,a,o,c){var u=e._bin,h=o,m={};if(m.fmt=u.readUshort(i,o),o+=2,a!=1&&a!=2&&a!=4&&a!=5&&a!=6)return null;if(a==1||a==2||a==4||a==5&&m.fmt<=2||a==6&&m.fmt<=2){var x=u.readUshort(i,o);o+=2,m.coverage=e._lctf.readCoverage(i,h+x)}if(a==1&&m.fmt>=1&&m.fmt<=2){if(m.fmt==1)m.delta=u.readShort(i,o),o+=2;else if(m.fmt==2){var g=u.readUshort(i,o);o+=2,m.newg=u.readUshorts(i,o,g),o+=2*m.newg.length}}else if(a==2&&m.fmt==1){g=u.readUshort(i,o),o+=2,m.seqs=[];for(var b=0;b<g;b++){var S=u.readUshort(i,o)+h;o+=2;var C=u.readUshort(i,S);m.seqs.push(u.readUshorts(i,S+2,C))}}else if(a==4)for(m.vals=[],g=u.readUshort(i,o),o+=2,b=0;b<g;b++){var M=u.readUshort(i,o);o+=2,m.vals.push(e.GSUB.readLigatureSet(i,h+M))}else if(a==5&&m.fmt==2){if(m.fmt==2){var A=u.readUshort(i,o);o+=2,m.cDef=e._lctf.readClassDef(i,h+A),m.scset=[];var R=u.readUshort(i,o);for(o+=2,b=0;b<R;b++){var N=u.readUshort(i,o);o+=2,m.scset.push(N==0?null:e.GSUB.readSubClassSet(i,h+N))}}}else if(a==6&&m.fmt==3){if(m.fmt==3){for(b=0;b<3;b++){g=u.readUshort(i,o),o+=2;for(var B=[],F=0;F<g;F++)B.push(e._lctf.readCoverage(i,h+u.readUshort(i,o+2*F)));o+=2*g,b==0&&(m.backCvg=B),b==1&&(m.inptCvg=B),b==2&&(m.ahedCvg=B)}g=u.readUshort(i,o),o+=2,m.lookupRec=e.GSUB.readSubstLookupRecords(i,o,g)}}else{if(a==7&&m.fmt==1){var U=u.readUshort(i,o);o+=2;var z=u.readUint(i,o);if(o+=4,c.ltype==9)c.ltype=U;else if(c.ltype!=U)throw"invalid extension substitution";return e.GSUB.subt(i,c.ltype,h+z)}console.debug("unsupported GSUB table LookupType",a,"format",m.fmt)}return m},e.GSUB.readSubClassSet=function(i,a){var o=e._bin.readUshort,c=a,u=[],h=o(i,a);a+=2;for(var m=0;m<h;m++){var x=o(i,a);a+=2,u.push(e.GSUB.readSubClassRule(i,c+x))}return u},e.GSUB.readSubClassRule=function(i,a){var o=e._bin.readUshort,c={},u=o(i,a),h=o(i,a+=2);a+=2,c.input=[];for(var m=0;m<u-1;m++)c.input.push(o(i,a)),a+=2;return c.substLookupRecords=e.GSUB.readSubstLookupRecords(i,a,h),c},e.GSUB.readSubstLookupRecords=function(i,a,o){for(var c=e._bin.readUshort,u=[],h=0;h<o;h++)u.push(c(i,a),c(i,a+2)),a+=4;return u},e.GSUB.readChainSubClassSet=function(i,a){var o=e._bin,c=a,u=[],h=o.readUshort(i,a);a+=2;for(var m=0;m<h;m++){var x=o.readUshort(i,a);a+=2,u.push(e.GSUB.readChainSubClassRule(i,c+x))}return u},e.GSUB.readChainSubClassRule=function(i,a){for(var o=e._bin,c={},u=["backtrack","input","lookahead"],h=0;h<u.length;h++){var m=o.readUshort(i,a);a+=2,h==1&&m--,c[u[h]]=o.readUshorts(i,a,m),a+=2*c[u[h]].length}return m=o.readUshort(i,a),a+=2,c.subst=o.readUshorts(i,a,2*m),a+=2*c.subst.length,c},e.GSUB.readLigatureSet=function(i,a){var o=e._bin,c=a,u=[],h=o.readUshort(i,a);a+=2;for(var m=0;m<h;m++){var x=o.readUshort(i,a);a+=2,u.push(e.GSUB.readLigature(i,c+x))}return u},e.GSUB.readLigature=function(i,a){var o=e._bin,c={chain:[]};c.nglyph=o.readUshort(i,a),a+=2;var u=o.readUshort(i,a);a+=2;for(var h=0;h<u-1;h++)c.chain.push(o.readUshort(i,a)),a+=2;return c},e.head={},e.head.parse=function(i,a,o){var c=e._bin,u={};return c.readFixed(i,a),a+=4,u.fontRevision=c.readFixed(i,a),a+=4,c.readUint(i,a),a+=4,c.readUint(i,a),a+=4,u.flags=c.readUshort(i,a),a+=2,u.unitsPerEm=c.readUshort(i,a),a+=2,u.created=c.readUint64(i,a),a+=8,u.modified=c.readUint64(i,a),a+=8,u.xMin=c.readShort(i,a),a+=2,u.yMin=c.readShort(i,a),a+=2,u.xMax=c.readShort(i,a),a+=2,u.yMax=c.readShort(i,a),a+=2,u.macStyle=c.readUshort(i,a),a+=2,u.lowestRecPPEM=c.readUshort(i,a),a+=2,u.fontDirectionHint=c.readShort(i,a),a+=2,u.indexToLocFormat=c.readShort(i,a),a+=2,u.glyphDataFormat=c.readShort(i,a),a+=2,u},e.hhea={},e.hhea.parse=function(i,a,o){var c=e._bin,u={};return c.readFixed(i,a),a+=4,u.ascender=c.readShort(i,a),a+=2,u.descender=c.readShort(i,a),a+=2,u.lineGap=c.readShort(i,a),a+=2,u.advanceWidthMax=c.readUshort(i,a),a+=2,u.minLeftSideBearing=c.readShort(i,a),a+=2,u.minRightSideBearing=c.readShort(i,a),a+=2,u.xMaxExtent=c.readShort(i,a),a+=2,u.caretSlopeRise=c.readShort(i,a),a+=2,u.caretSlopeRun=c.readShort(i,a),a+=2,u.caretOffset=c.readShort(i,a),a+=2,a+=8,u.metricDataFormat=c.readShort(i,a),a+=2,u.numberOfHMetrics=c.readUshort(i,a),a+=2,u},e.hmtx={},e.hmtx.parse=function(i,a,o,c){for(var u=e._bin,h={aWidth:[],lsBearing:[]},m=0,x=0,g=0;g<c.maxp.numGlyphs;g++)g<c.hhea.numberOfHMetrics&&(m=u.readUshort(i,a),a+=2,x=u.readShort(i,a),a+=2),h.aWidth.push(m),h.lsBearing.push(x);return h},e.kern={},e.kern.parse=function(i,a,o,c){var u=e._bin,h=u.readUshort(i,a);if(a+=2,h==1)return e.kern.parseV1(i,a-2,o,c);var m=u.readUshort(i,a);a+=2;for(var x={glyph1:[],rval:[]},g=0;g<m;g++){a+=2,o=u.readUshort(i,a),a+=2;var b=u.readUshort(i,a);a+=2;var S=b>>>8;if((S&=15)!=0)throw"unknown kern table format: "+S;a=e.kern.readFormat0(i,a,x)}return x},e.kern.parseV1=function(i,a,o,c){var u=e._bin;u.readFixed(i,a),a+=4;var h=u.readUint(i,a);a+=4;for(var m={glyph1:[],rval:[]},x=0;x<h;x++){u.readUint(i,a),a+=4;var g=u.readUshort(i,a);a+=2,u.readUshort(i,a),a+=2;var b=g>>>8;if((b&=15)!=0)throw"unknown kern table format: "+b;a=e.kern.readFormat0(i,a,m)}return m},e.kern.readFormat0=function(i,a,o){var c=e._bin,u=-1,h=c.readUshort(i,a);a+=2,c.readUshort(i,a),a+=2,c.readUshort(i,a),a+=2,c.readUshort(i,a),a+=2;for(var m=0;m<h;m++){var x=c.readUshort(i,a);a+=2;var g=c.readUshort(i,a);a+=2;var b=c.readShort(i,a);a+=2,x!=u&&(o.glyph1.push(x),o.rval.push({glyph2:[],vals:[]}));var S=o.rval[o.rval.length-1];S.glyph2.push(g),S.vals.push(b),u=x}return a},e.loca={},e.loca.parse=function(i,a,o,c){var u=e._bin,h=[],m=c.head.indexToLocFormat,x=c.maxp.numGlyphs+1;if(m==0)for(var g=0;g<x;g++)h.push(u.readUshort(i,a+(g<<1))<<1);if(m==1)for(g=0;g<x;g++)h.push(u.readUint(i,a+(g<<2)));return h},e.maxp={},e.maxp.parse=function(i,a,o){var c=e._bin,u={},h=c.readUint(i,a);return a+=4,u.numGlyphs=c.readUshort(i,a),a+=2,h==65536&&(u.maxPoints=c.readUshort(i,a),a+=2,u.maxContours=c.readUshort(i,a),a+=2,u.maxCompositePoints=c.readUshort(i,a),a+=2,u.maxCompositeContours=c.readUshort(i,a),a+=2,u.maxZones=c.readUshort(i,a),a+=2,u.maxTwilightPoints=c.readUshort(i,a),a+=2,u.maxStorage=c.readUshort(i,a),a+=2,u.maxFunctionDefs=c.readUshort(i,a),a+=2,u.maxInstructionDefs=c.readUshort(i,a),a+=2,u.maxStackElements=c.readUshort(i,a),a+=2,u.maxSizeOfInstructions=c.readUshort(i,a),a+=2,u.maxComponentElements=c.readUshort(i,a),a+=2,u.maxComponentDepth=c.readUshort(i,a),a+=2),u},e.name={},e.name.parse=function(i,a,o){var c=e._bin,u={};c.readUshort(i,a),a+=2;var h=c.readUshort(i,a);a+=2,c.readUshort(i,a);for(var m,x=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],g=a+=2,b=0;b<h;b++){var S=c.readUshort(i,a);a+=2;var C=c.readUshort(i,a);a+=2;var M=c.readUshort(i,a);a+=2;var A=c.readUshort(i,a);a+=2;var R=c.readUshort(i,a);a+=2;var N=c.readUshort(i,a);a+=2;var B,F=x[A],U=g+12*h+N;if(S==0)B=c.readUnicode(i,U,R/2);else if(S==3&&C==0)B=c.readUnicode(i,U,R/2);else if(C==0)B=c.readASCII(i,U,R);else if(C==1)B=c.readUnicode(i,U,R/2);else if(C==3)B=c.readUnicode(i,U,R/2);else{if(S!=1)throw"unknown encoding "+C+", platformID: "+S;B=c.readASCII(i,U,R),console.debug("reading unknown MAC encoding "+C+" as ASCII")}var z="p"+S+","+M.toString(16);u[z]==null&&(u[z]={}),u[z][F!==void 0?F:A]=B,u[z]._lang=M}for(var P in u)if(u[P].postScriptName!=null&&u[P]._lang==1033)return u[P];for(var P in u)if(u[P].postScriptName!=null&&u[P]._lang==0)return u[P];for(var P in u)if(u[P].postScriptName!=null&&u[P]._lang==3084)return u[P];for(var P in u)if(u[P].postScriptName!=null)return u[P];for(var P in u){m=P;break}return console.debug("returning name table with languageID "+u[m]._lang),u[m]},e["OS/2"]={},e["OS/2"].parse=function(i,a,o){var c=e._bin.readUshort(i,a);a+=2;var u={};if(c==0)e["OS/2"].version0(i,a,u);else if(c==1)e["OS/2"].version1(i,a,u);else if(c==2||c==3||c==4)e["OS/2"].version2(i,a,u);else{if(c!=5)throw"unknown OS/2 table version: "+c;e["OS/2"].version5(i,a,u)}return u},e["OS/2"].version0=function(i,a,o){var c=e._bin;return o.xAvgCharWidth=c.readShort(i,a),a+=2,o.usWeightClass=c.readUshort(i,a),a+=2,o.usWidthClass=c.readUshort(i,a),a+=2,o.fsType=c.readUshort(i,a),a+=2,o.ySubscriptXSize=c.readShort(i,a),a+=2,o.ySubscriptYSize=c.readShort(i,a),a+=2,o.ySubscriptXOffset=c.readShort(i,a),a+=2,o.ySubscriptYOffset=c.readShort(i,a),a+=2,o.ySuperscriptXSize=c.readShort(i,a),a+=2,o.ySuperscriptYSize=c.readShort(i,a),a+=2,o.ySuperscriptXOffset=c.readShort(i,a),a+=2,o.ySuperscriptYOffset=c.readShort(i,a),a+=2,o.yStrikeoutSize=c.readShort(i,a),a+=2,o.yStrikeoutPosition=c.readShort(i,a),a+=2,o.sFamilyClass=c.readShort(i,a),a+=2,o.panose=c.readBytes(i,a,10),a+=10,o.ulUnicodeRange1=c.readUint(i,a),a+=4,o.ulUnicodeRange2=c.readUint(i,a),a+=4,o.ulUnicodeRange3=c.readUint(i,a),a+=4,o.ulUnicodeRange4=c.readUint(i,a),a+=4,o.achVendID=[c.readInt8(i,a),c.readInt8(i,a+1),c.readInt8(i,a+2),c.readInt8(i,a+3)],a+=4,o.fsSelection=c.readUshort(i,a),a+=2,o.usFirstCharIndex=c.readUshort(i,a),a+=2,o.usLastCharIndex=c.readUshort(i,a),a+=2,o.sTypoAscender=c.readShort(i,a),a+=2,o.sTypoDescender=c.readShort(i,a),a+=2,o.sTypoLineGap=c.readShort(i,a),a+=2,o.usWinAscent=c.readUshort(i,a),a+=2,o.usWinDescent=c.readUshort(i,a),a+=2},e["OS/2"].version1=function(i,a,o){var c=e._bin;return a=e["OS/2"].version0(i,a,o),o.ulCodePageRange1=c.readUint(i,a),a+=4,o.ulCodePageRange2=c.readUint(i,a),a+=4},e["OS/2"].version2=function(i,a,o){var c=e._bin;return a=e["OS/2"].version1(i,a,o),o.sxHeight=c.readShort(i,a),a+=2,o.sCapHeight=c.readShort(i,a),a+=2,o.usDefault=c.readUshort(i,a),a+=2,o.usBreak=c.readUshort(i,a),a+=2,o.usMaxContext=c.readUshort(i,a),a+=2},e["OS/2"].version5=function(i,a,o){var c=e._bin;return a=e["OS/2"].version2(i,a,o),o.usLowerOpticalPointSize=c.readUshort(i,a),a+=2,o.usUpperOpticalPointSize=c.readUshort(i,a),a+=2},e.post={},e.post.parse=function(i,a,o){var c=e._bin,u={};return u.version=c.readFixed(i,a),a+=4,u.italicAngle=c.readFixed(i,a),a+=4,u.underlinePosition=c.readShort(i,a),a+=2,u.underlineThickness=c.readShort(i,a),a+=2,u},e==null&&(e={}),e.U==null&&(e.U={}),e.U.codeToGlyph=function(i,a){var o=i.cmap,c=-1;if(o.p0e4!=null?c=o.p0e4:o.p3e1!=null?c=o.p3e1:o.p1e0!=null?c=o.p1e0:o.p0e3!=null&&(c=o.p0e3),c==-1)throw"no familiar platform and encoding!";var u=o.tables[c];if(u.format==0)return a>=u.map.length?0:u.map[a];if(u.format==4){for(var h=-1,m=0;m<u.endCount.length;m++)if(a<=u.endCount[m]){h=m;break}return h==-1||u.startCount[h]>a?0:65535&(u.idRangeOffset[h]!=0?u.glyphIdArray[a-u.startCount[h]+(u.idRangeOffset[h]>>1)-(u.idRangeOffset.length-h)]:a+u.idDelta[h])}if(u.format==12){if(a>u.groups[u.groups.length-1][1])return 0;for(m=0;m<u.groups.length;m++){var x=u.groups[m];if(x[0]<=a&&a<=x[1])return x[2]+(a-x[0])}return 0}throw"unknown cmap table format "+u.format},e.U.glyphToPath=function(i,a){var o={cmds:[],crds:[]};if(i.SVG&&i.SVG.entries[a]){var c=i.SVG.entries[a];return c==null?o:(typeof c=="string"&&(c=e.SVG.toPath(c),i.SVG.entries[a]=c),c)}if(i.CFF){var u={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:i.CFF.Private?i.CFF.Private.defaultWidthX:0,open:!1},h=i.CFF,m=i.CFF.Private;if(h.ROS){for(var x=0;h.FDSelect[x+2]<=a;)x+=2;m=h.FDArray[h.FDSelect[x+1]].Private}e.U._drawCFF(i.CFF.CharStrings[a],u,h,m,o)}else i.glyf&&e.U._drawGlyf(a,i,o);return o},e.U._drawGlyf=function(i,a,o){var c=a.glyf[i];c==null&&(c=a.glyf[i]=e.glyf._parseGlyf(a,i)),c!=null&&(c.noc>-1?e.U._simpleGlyph(c,o):e.U._compoGlyph(c,a,o))},e.U._simpleGlyph=function(i,a){for(var o=0;o<i.noc;o++){for(var c=o==0?0:i.endPts[o-1]+1,u=i.endPts[o],h=c;h<=u;h++){var m=h==c?u:h-1,x=h==u?c:h+1,g=1&i.flags[h],b=1&i.flags[m],S=1&i.flags[x],C=i.xs[h],M=i.ys[h];if(h==c)if(g){if(!b){e.U.P.moveTo(a,C,M);continue}e.U.P.moveTo(a,i.xs[m],i.ys[m])}else b?e.U.P.moveTo(a,i.xs[m],i.ys[m]):e.U.P.moveTo(a,(i.xs[m]+C)/2,(i.ys[m]+M)/2);g?b&&e.U.P.lineTo(a,C,M):S?e.U.P.qcurveTo(a,C,M,i.xs[x],i.ys[x]):e.U.P.qcurveTo(a,C,M,(C+i.xs[x])/2,(M+i.ys[x])/2)}e.U.P.closePath(a)}},e.U._compoGlyph=function(i,a,o){for(var c=0;c<i.parts.length;c++){var u={cmds:[],crds:[]},h=i.parts[c];e.U._drawGlyf(h.glyphIndex,a,u);for(var m=h.m,x=0;x<u.crds.length;x+=2){var g=u.crds[x],b=u.crds[x+1];o.crds.push(g*m.a+b*m.b+m.tx),o.crds.push(g*m.c+b*m.d+m.ty)}for(x=0;x<u.cmds.length;x++)o.cmds.push(u.cmds[x])}},e.U._getGlyphClass=function(i,a){var o=e._lctf.getInterval(a,i);return o==-1?0:a[o+2]},e.U._applySubs=function(i,a,o,c){for(var u=i.length-a-1,h=0;h<o.tabs.length;h++)if(o.tabs[h]!=null){var m,x=o.tabs[h];if(!x.coverage||(m=e._lctf.coverageIndex(x.coverage,i[a]))!=-1){if(o.ltype==1)i[a],x.fmt==1?i[a]=i[a]+x.delta:i[a]=x.newg[m];else if(o.ltype==4)for(var g=x.vals[m],b=0;b<g.length;b++){var S=g[b],C=S.chain.length;if(!(C>u)){for(var M=!0,A=0,R=0;R<C;R++){for(;i[a+A+(1+R)]==-1;)A++;S.chain[R]!=i[a+A+(1+R)]&&(M=!1)}if(M){for(i[a]=S.nglyph,R=0;R<C+A;R++)i[a+R+1]=-1;break}}}else if(o.ltype==5&&x.fmt==2)for(var N=e._lctf.getInterval(x.cDef,i[a]),B=x.cDef[N+2],F=x.scset[B],U=0;U<F.length;U++){var z=F[U],P=z.input;if(!(P.length>u)){for(M=!0,R=0;R<P.length;R++){var L=e._lctf.getInterval(x.cDef,i[a+1+R]);if(N==-1&&x.cDef[L+2]!=P[R]){M=!1;break}}if(M){var O=z.substLookupRecords;for(b=0;b<O.length;b+=2)O[b],O[b+1]}}}else if(o.ltype==6&&x.fmt==3){if(!e.U._glsCovered(i,x.backCvg,a-x.backCvg.length)||!e.U._glsCovered(i,x.inptCvg,a)||!e.U._glsCovered(i,x.ahedCvg,a+x.inptCvg.length))continue;var ee=x.lookupRec;for(U=0;U<ee.length;U+=2){N=ee[U];var Q=c[ee[U+1]];e.U._applySubs(i,a+N,Q,c)}}}}},e.U._glsCovered=function(i,a,o){for(var c=0;c<a.length;c++)if(e._lctf.coverageIndex(a[c],i[o+c])==-1)return!1;return!0},e.U.glyphsToPath=function(i,a,o){for(var c={cmds:[],crds:[]},u=0,h=0;h<a.length;h++){var m=a[h];if(m!=-1){for(var x=h<a.length-1&&a[h+1]!=-1?a[h+1]:0,g=e.U.glyphToPath(i,m),b=0;b<g.crds.length;b+=2)c.crds.push(g.crds[b]+u),c.crds.push(g.crds[b+1]);for(o&&c.cmds.push(o),b=0;b<g.cmds.length;b++)c.cmds.push(g.cmds[b]);o&&c.cmds.push("X"),u+=i.hmtx.aWidth[m],h<a.length-1&&(u+=e.U.getPairAdjustment(i,m,x))}}return c},e.U.P={},e.U.P.moveTo=function(i,a,o){i.cmds.push("M"),i.crds.push(a,o)},e.U.P.lineTo=function(i,a,o){i.cmds.push("L"),i.crds.push(a,o)},e.U.P.curveTo=function(i,a,o,c,u,h,m){i.cmds.push("C"),i.crds.push(a,o,c,u,h,m)},e.U.P.qcurveTo=function(i,a,o,c,u){i.cmds.push("Q"),i.crds.push(a,o,c,u)},e.U.P.closePath=function(i){i.cmds.push("Z")},e.U._drawCFF=function(i,a,o,c,u){for(var h=a.stack,m=a.nStems,x=a.haveWidth,g=a.width,b=a.open,S=0,C=a.x,M=a.y,A=0,R=0,N=0,B=0,F=0,U=0,z=0,P=0,L=0,O=0,ee={val:0,size:0};S<i.length;){e.CFF.getCharString(i,S,ee);var Q=ee.val;if(S+=ee.size,Q=="o1"||Q=="o18")h.length%2!=0&&!x&&(g=h.shift()+c.nominalWidthX),m+=h.length>>1,h.length=0,x=!0;else if(Q=="o3"||Q=="o23")h.length%2!=0&&!x&&(g=h.shift()+c.nominalWidthX),m+=h.length>>1,h.length=0,x=!0;else if(Q=="o4")h.length>1&&!x&&(g=h.shift()+c.nominalWidthX,x=!0),b&&e.U.P.closePath(u),M+=h.pop(),e.U.P.moveTo(u,C,M),b=!0;else if(Q=="o5")for(;h.length>0;)C+=h.shift(),M+=h.shift(),e.U.P.lineTo(u,C,M);else if(Q=="o6"||Q=="o7")for(var te=h.length,ne=Q=="o6",re=0;re<te;re++){var j=h.shift();ne?C+=j:M+=j,ne=!ne,e.U.P.lineTo(u,C,M)}else if(Q=="o8"||Q=="o24"){te=h.length;for(var ae=0;ae+6<=te;)A=C+h.shift(),R=M+h.shift(),N=A+h.shift(),B=R+h.shift(),C=N+h.shift(),M=B+h.shift(),e.U.P.curveTo(u,A,R,N,B,C,M),ae+=6;Q=="o24"&&(C+=h.shift(),M+=h.shift(),e.U.P.lineTo(u,C,M))}else{if(Q=="o11")break;if(Q=="o1234"||Q=="o1235"||Q=="o1236"||Q=="o1237")Q=="o1234"&&(R=M,N=(A=C+h.shift())+h.shift(),O=B=R+h.shift(),U=B,P=M,C=(z=(F=(L=N+h.shift())+h.shift())+h.shift())+h.shift(),e.U.P.curveTo(u,A,R,N,B,L,O),e.U.P.curveTo(u,F,U,z,P,C,M)),Q=="o1235"&&(A=C+h.shift(),R=M+h.shift(),N=A+h.shift(),B=R+h.shift(),L=N+h.shift(),O=B+h.shift(),F=L+h.shift(),U=O+h.shift(),z=F+h.shift(),P=U+h.shift(),C=z+h.shift(),M=P+h.shift(),h.shift(),e.U.P.curveTo(u,A,R,N,B,L,O),e.U.P.curveTo(u,F,U,z,P,C,M)),Q=="o1236"&&(A=C+h.shift(),R=M+h.shift(),N=A+h.shift(),O=B=R+h.shift(),U=B,z=(F=(L=N+h.shift())+h.shift())+h.shift(),P=U+h.shift(),C=z+h.shift(),e.U.P.curveTo(u,A,R,N,B,L,O),e.U.P.curveTo(u,F,U,z,P,C,M)),Q=="o1237"&&(A=C+h.shift(),R=M+h.shift(),N=A+h.shift(),B=R+h.shift(),L=N+h.shift(),O=B+h.shift(),F=L+h.shift(),U=O+h.shift(),z=F+h.shift(),P=U+h.shift(),Math.abs(z-C)>Math.abs(P-M)?C=z+h.shift():M=P+h.shift(),e.U.P.curveTo(u,A,R,N,B,L,O),e.U.P.curveTo(u,F,U,z,P,C,M));else if(Q=="o14"){if(h.length>0&&!x&&(g=h.shift()+o.nominalWidthX,x=!0),h.length==4){var J=h.shift(),ie=h.shift(),se=h.shift(),I=h.shift(),W=e.CFF.glyphBySE(o,se),fe=e.CFF.glyphBySE(o,I);e.U._drawCFF(o.CharStrings[W],a,o,c,u),a.x=J,a.y=ie,e.U._drawCFF(o.CharStrings[fe],a,o,c,u)}b&&(e.U.P.closePath(u),b=!1)}else if(Q=="o19"||Q=="o20")h.length%2!=0&&!x&&(g=h.shift()+c.nominalWidthX),m+=h.length>>1,h.length=0,x=!0,S+=m+7>>3;else if(Q=="o21")h.length>2&&!x&&(g=h.shift()+c.nominalWidthX,x=!0),M+=h.pop(),C+=h.pop(),b&&e.U.P.closePath(u),e.U.P.moveTo(u,C,M),b=!0;else if(Q=="o22")h.length>1&&!x&&(g=h.shift()+c.nominalWidthX,x=!0),C+=h.pop(),b&&e.U.P.closePath(u),e.U.P.moveTo(u,C,M),b=!0;else if(Q=="o25"){for(;h.length>6;)C+=h.shift(),M+=h.shift(),e.U.P.lineTo(u,C,M);A=C+h.shift(),R=M+h.shift(),N=A+h.shift(),B=R+h.shift(),C=N+h.shift(),M=B+h.shift(),e.U.P.curveTo(u,A,R,N,B,C,M)}else if(Q=="o26")for(h.length%2&&(C+=h.shift());h.length>0;)A=C,R=M+h.shift(),C=N=A+h.shift(),M=(B=R+h.shift())+h.shift(),e.U.P.curveTo(u,A,R,N,B,C,M);else if(Q=="o27")for(h.length%2&&(M+=h.shift());h.length>0;)R=M,N=(A=C+h.shift())+h.shift(),B=R+h.shift(),C=N+h.shift(),M=B,e.U.P.curveTo(u,A,R,N,B,C,M);else if(Q=="o10"||Q=="o29"){var Z=Q=="o10"?c:o;if(h.length==0)console.debug("error: empty stack");else{var me=h.pop(),$=Z.Subrs[me+Z.Bias];a.x=C,a.y=M,a.nStems=m,a.haveWidth=x,a.width=g,a.open=b,e.U._drawCFF($,a,o,c,u),C=a.x,M=a.y,m=a.nStems,x=a.haveWidth,g=a.width,b=a.open}}else if(Q=="o30"||Q=="o31"){var pe=h.length,ve=(ae=0,Q=="o31");for(ae+=pe-(te=-3&pe);ae<te;)ve?(R=M,N=(A=C+h.shift())+h.shift(),M=(B=R+h.shift())+h.shift(),te-ae==5?(C=N+h.shift(),ae++):C=N,ve=!1):(A=C,R=M+h.shift(),N=A+h.shift(),B=R+h.shift(),C=N+h.shift(),te-ae==5?(M=B+h.shift(),ae++):M=B,ve=!0),e.U.P.curveTo(u,A,R,N,B,C,M),ae+=4}else{if((Q+"").charAt(0)=="o")throw console.debug("Unknown operation: "+Q,i),Q;h.push(Q)}}}a.x=C,a.y=M,a.nStems=m,a.haveWidth=x,a.width=g,a.open=b};var t=e,n={Typr:t};return s.Typr=t,s.default=n,Object.defineProperty(s,"__esModule",{value:!0}),s})({}).Typr}/*!
Custom bundle of woff2otf (https://github.com/arty-name/woff2otf) with fflate
(https://github.com/101arrowz/fflate) for use in Troika text rendering. 
Original licenses apply: 
- fflate: https://github.com/101arrowz/fflate/blob/master/LICENSE (MIT)
- woff2otf.js: https://github.com/arty-name/woff2otf/blob/master/woff2otf.js (Apache2)
*/function f9(){return(function(s){var e=Uint8Array,t=Uint16Array,n=Uint32Array,i=new e([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),a=new e([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),o=new e([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),c=function(Q,te){for(var ne=new t(31),re=0;re<31;++re)ne[re]=te+=1<<Q[re-1];var j=new n(ne[30]);for(re=1;re<30;++re)for(var ae=ne[re];ae<ne[re+1];++ae)j[ae]=ae-ne[re]<<5|re;return[ne,j]},u=c(i,2),h=u[0],m=u[1];h[28]=258,m[258]=28;for(var x=c(a,0)[0],g=new t(32768),b=0;b<32768;++b){var S=(43690&b)>>>1|(21845&b)<<1;S=(61680&(S=(52428&S)>>>2|(13107&S)<<2))>>>4|(3855&S)<<4,g[b]=((65280&S)>>>8|(255&S)<<8)>>>1}var C=function(Q,te,ne){for(var re=Q.length,j=0,ae=new t(te);j<re;++j)++ae[Q[j]-1];var J,ie=new t(te);for(j=0;j<te;++j)ie[j]=ie[j-1]+ae[j-1]<<1;{J=new t(1<<te);var se=15-te;for(j=0;j<re;++j)if(Q[j])for(var I=j<<4|Q[j],W=te-Q[j],fe=ie[Q[j]-1]++<<W,Z=fe|(1<<W)-1;fe<=Z;++fe)J[g[fe]>>>se]=I}return J},M=new e(288);for(b=0;b<144;++b)M[b]=8;for(b=144;b<256;++b)M[b]=9;for(b=256;b<280;++b)M[b]=7;for(b=280;b<288;++b)M[b]=8;var A=new e(32);for(b=0;b<32;++b)A[b]=5;var R=C(M,9),N=C(A,5),B=function(Q){for(var te=Q[0],ne=1;ne<Q.length;++ne)Q[ne]>te&&(te=Q[ne]);return te},F=function(Q,te,ne){var re=te/8|0;return(Q[re]|Q[re+1]<<8)>>(7&te)&ne},U=function(Q,te){var ne=te/8|0;return(Q[ne]|Q[ne+1]<<8|Q[ne+2]<<16)>>(7&te)},z=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],P=function(Q,te,ne){var re=new Error(te||z[Q]);if(re.code=Q,Error.captureStackTrace&&Error.captureStackTrace(re,P),!ne)throw re;return re},L=function(Q,te,ne){var re=Q.length;if(!re||ne&&!ne.l&&re<5)return te||new e(0);var j=!te||ne,ae=!ne||ne.i;ne||(ne={}),te||(te=new e(3*re));var J,ie=function(ft){var ge=te.length;if(ft>ge){var Ie=new e(Math.max(2*ge,ft));Ie.set(te),te=Ie}},se=ne.f||0,I=ne.p||0,W=ne.b||0,fe=ne.l,Z=ne.d,me=ne.m,$=ne.n,pe=8*re;do{if(!fe){ne.f=se=F(Q,I,1);var ve=F(Q,I+1,3);if(I+=3,!ve){var ze=Q[(et=((J=I)/8|0)+(7&J&&1)+4)-4]|Q[et-3]<<8,Ge=et+ze;if(Ge>re){ae&&P(0);break}j&&ie(W+ze),te.set(Q.subarray(et,Ge),W),ne.b=W+=ze,ne.p=I=8*Ge;continue}if(ve==1)fe=R,Z=N,me=9,$=5;else if(ve==2){var Fe=F(Q,I,31)+257,Qe=F(Q,I+10,15)+4,lt=Fe+F(Q,I+5,31)+1;I+=14;for(var De=new e(lt),le=new e(19),Ye=0;Ye<Qe;++Ye)le[o[Ye]]=F(Q,I+3*Ye,7);I+=3*Qe;var Ze=B(le),je=(1<<Ze)-1,He=C(le,Ze);for(Ye=0;Ye<lt;){var et,Ne=He[F(Q,I,je)];if(I+=15&Ne,(et=Ne>>>4)<16)De[Ye++]=et;else{var st=0,oe=0;for(et==16?(oe=3+F(Q,I,3),I+=2,st=De[Ye-1]):et==17?(oe=3+F(Q,I,7),I+=3):et==18&&(oe=11+F(Q,I,127),I+=7);oe--;)De[Ye++]=st}}var X=De.subarray(0,Fe),Ae=De.subarray(Fe);me=B(X),$=B(Ae),fe=C(X,me),Z=C(Ae,$)}else P(1);if(I>pe){ae&&P(0);break}}j&&ie(W+131072);for(var Pe=(1<<me)-1,Ue=(1<<$)-1,Be=I;;Be=I){var bt=(st=fe[U(Q,I)&Pe])>>>4;if((I+=15&st)>pe){ae&&P(0);break}if(st||P(2),bt<256)te[W++]=bt;else{if(bt==256){Be=I,fe=null;break}var vt=bt-254;if(bt>264){var It=i[Ye=bt-257];vt=F(Q,I,(1<<It)-1)+h[Ye],I+=It}var zt=Z[U(Q,I)&Ue],qe=zt>>>4;if(zt||P(3),I+=15&zt,Ae=x[qe],qe>3&&(It=a[qe],Ae+=U(Q,I)&(1<<It)-1,I+=It),I>pe){ae&&P(0);break}j&&ie(W+131072);for(var We=W+vt;W<We;W+=4)te[W]=te[W-Ae],te[W+1]=te[W+1-Ae],te[W+2]=te[W+2-Ae],te[W+3]=te[W+3-Ae];W=We}}ne.l=fe,ne.p=Be,ne.b=W,fe&&(se=1,ne.m=me,ne.d=Z,ne.n=$)}while(!se);return W==te.length?te:(function(ft,ge,Ie){(Ie==null||Ie>ft.length)&&(Ie=ft.length);var ht=new(ft instanceof t?t:ft instanceof n?n:e)(Ie-ge);return ht.set(ft.subarray(ge,Ie)),ht})(te,0,W)},O=new e(0),ee=typeof TextDecoder<"u"&&new TextDecoder;try{ee.decode(O,{stream:!0})}catch{}return s.convert_streams=function(Q){var te=new DataView(Q),ne=0;function re(){var Fe=te.getUint16(ne);return ne+=2,Fe}function j(){var Fe=te.getUint32(ne);return ne+=4,Fe}function ae(Fe){ze.setUint16(Ge,Fe),Ge+=2}function J(Fe){ze.setUint32(Ge,Fe),Ge+=4}for(var ie={signature:j(),flavor:j(),length:j(),numTables:re(),reserved:re(),totalSfntSize:j(),majorVersion:re(),minorVersion:re(),metaOffset:j(),metaLength:j(),metaOrigLength:j(),privOffset:j(),privLength:j()},se=0;Math.pow(2,se)<=ie.numTables;)se++;se--;for(var I=16*Math.pow(2,se),W=16*ie.numTables-I,fe=12,Z=[],me=0;me<ie.numTables;me++)Z.push({tag:j(),offset:j(),compLength:j(),origLength:j(),origChecksum:j()}),fe+=16;var $,pe=new Uint8Array(12+16*Z.length+Z.reduce((function(Fe,Qe){return Fe+Qe.origLength+4}),0)),ve=pe.buffer,ze=new DataView(ve),Ge=0;return J(ie.flavor),ae(ie.numTables),ae(I),ae(se),ae(W),Z.forEach((function(Fe){J(Fe.tag),J(Fe.origChecksum),J(fe),J(Fe.origLength),Fe.outOffset=fe,(fe+=Fe.origLength)%4!=0&&(fe+=4-fe%4)})),Z.forEach((function(Fe){var Qe,lt=Q.slice(Fe.offset,Fe.offset+Fe.compLength);if(Fe.compLength!=Fe.origLength){var De=new Uint8Array(Fe.origLength);Qe=new Uint8Array(lt,2),L(Qe,De)}else De=new Uint8Array(lt);pe.set(De,Fe.outOffset);var le=0;(fe=Fe.outOffset+Fe.origLength)%4!=0&&(le=4-fe%4),pe.set(new Uint8Array(le).buffer,Fe.outOffset+Fe.origLength),$=fe+le})),ve.slice(0,$)},Object.defineProperty(s,"__esModule",{value:!0}),s})({}).convert_streams}function h9(s,e){const t={M:2,L:2,Q:4,C:6,Z:0},n={C:"18g,ca,368,1kz",D:"17k,6,2,2+4,5+c,2+6,2+1,10+1,9+f,j+11,2+1,a,2,2+1,15+2,3,j+2,6+3,2+8,2,2,2+1,w+a,4+e,3+3,2,3+2,3+5,23+w,2f+4,3,2+9,2,b,2+3,3,1k+9,6+1,3+1,2+2,2+d,30g,p+y,1,1+1g,f+x,2,sd2+1d,jf3+4,f+3,2+4,2+2,b+3,42,2,4+2,2+1,2,3,t+1,9f+w,2,el+2,2+g,d+2,2l,2+1,5,3+1,2+1,2,3,6,16wm+1v",R:"17m+3,2,2,6+3,m,15+2,2+2,h+h,13,3+8,2,2,3+1,2,p+1,x,5+4,5,a,2,2,3,u,c+2,g+1,5,2+1,4+1,5j,6+1,2,b,2+2,f,2+1,1s+2,2,3+1,7,1ez0,2,2+1,4+4,b,4,3,b,42,2+2,4,3,2+1,2,o+3,ae,ep,x,2o+2,3+1,3,5+1,6",L:"x9u,jff,a,fd,jv",T:"4t,gj+33,7o+4,1+1,7c+18,2,2+1,2+1,2,21+a,2,1b+k,h,2u+6,3+5,3+1,2+3,y,2,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,3,7,6+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+d,1,1+1,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,ek,3+1,r+4,1e+4,6+5,2p+c,1+3,1,1+2,1+b,2db+2,3y,2p+v,ff+3,30+1,n9x,1+2,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,5s,6y+2,ea,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+9,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2,2b+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,470+8,at4+4,1o+6,t5,1s+3,2a,f5l+1,2+3,43o+2,a+7,1+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,1,gzau,v+2n,3l+6n"},i=1,a=2,o=4,c=8,u=16,h=32;let m;function x(z){if(!m){const P={R:a,L:i,D:o,C:u,U:h,T:c};m=new Map;for(let L in n){let O=0;n[L].split(",").forEach(ee=>{let[Q,te]=ee.split("+");Q=parseInt(Q,36),te=te?parseInt(te,36):0,m.set(O+=Q,P[L]);for(let ne=te;ne--;)m.set(++O,P[L])})}}return m.get(z)||h}const g=1,b=2,S=3,C=4,M=[null,"isol","init","fina","medi"];function A(z){const P=new Uint8Array(z.length);let L=h,O=g,ee=-1;for(let Q=0;Q<z.length;Q++){const te=z.codePointAt(Q);let ne=x(te)|0,re=g;ne&c||(L&(i|o|u)?ne&(a|o|u)?(re=S,(O===g||O===S)&&P[ee]++):ne&(i|h)&&(O===b||O===C)&&P[ee]--:L&(a|h)&&(O===b||O===C)&&P[ee]--,O=P[Q]=re,L=ne,ee=Q,te>65535&&Q++)}return P}function R(z,P){const L=[];for(let ee=0;ee<P.length;ee++){const Q=P.codePointAt(ee);Q>65535&&ee++,L.push(s.U.codeToGlyph(z,Q))}const O=z.GSUB;if(O){const{lookupList:ee,featureList:Q}=O;let te;const ne=/^(rlig|liga|mset|isol|init|fina|medi|half|pres|blws|ccmp)$/,re=[];Q.forEach(j=>{if(ne.test(j.tag))for(let ae=0;ae<j.tab.length;ae++){if(re[j.tab[ae]])continue;re[j.tab[ae]]=!0;const J=ee[j.tab[ae]],ie=/^(isol|init|fina|medi)$/.test(j.tag);ie&&!te&&(te=A(P));for(let se=0;se<L.length;se++)(!te||!ie||M[te[se]]===j.tag)&&s.U._applySubs(L,se,J,ee)}})}return L}function N(z,P){const L=new Int16Array(P.length*3);let O=0;for(;O<P.length;O++){const ne=P[O];if(ne===-1)continue;L[O*3+2]=z.hmtx.aWidth[ne];const re=z.GPOS;if(re){const j=re.lookupList;for(let ae=0;ae<j.length;ae++){const J=j[ae];for(let ie=0;ie<J.tabs.length;ie++){const se=J.tabs[ie];if(J.ltype===1){if(s._lctf.coverageIndex(se.coverage,ne)!==-1&&se.pos){te(se.pos,O);break}}else if(J.ltype===2){let I=null,W=ee();if(W!==-1){const fe=s._lctf.coverageIndex(se.coverage,P[W]);if(fe!==-1){if(se.fmt===1){const Z=se.pairsets[fe];for(let me=0;me<Z.length;me++)Z[me].gid2===ne&&(I=Z[me])}else if(se.fmt===2){const Z=s.U._getGlyphClass(P[W],se.classDef1),me=s.U._getGlyphClass(ne,se.classDef2);I=se.matrix[Z][me]}if(I){I.val1&&te(I.val1,W),I.val2&&te(I.val2,O);break}}}}else if(J.ltype===4){const I=s._lctf.coverageIndex(se.markCoverage,ne);if(I!==-1){const W=ee(Q),fe=W===-1?-1:s._lctf.coverageIndex(se.baseCoverage,P[W]);if(fe!==-1){const Z=se.markArray[I],me=se.baseArray[fe][Z.markClass];L[O*3]=me.x-Z.x+L[W*3]-L[W*3+2],L[O*3+1]=me.y-Z.y+L[W*3+1];break}}}else if(J.ltype===6){const I=s._lctf.coverageIndex(se.mark1Coverage,ne);if(I!==-1){const W=ee();if(W!==-1){const fe=P[W];if(B(z,fe)===3){const Z=s._lctf.coverageIndex(se.mark2Coverage,fe);if(Z!==-1){const me=se.mark1Array[I],$=se.mark2Array[Z][me.markClass];L[O*3]=$.x-me.x+L[W*3]-L[W*3+2],L[O*3+1]=$.y-me.y+L[W*3+1];break}}}}}}}}else if(z.kern&&!z.cff){const j=ee();if(j!==-1){const ae=z.kern.glyph1.indexOf(P[j]);if(ae!==-1){const J=z.kern.rval[ae].glyph2.indexOf(ne);J!==-1&&(L[j*3+2]+=z.kern.rval[ae].vals[J])}}}}return L;function ee(ne){for(let re=O-1;re>=0;re--)if(P[re]!==-1&&(!ne||ne(P[re])))return re;return-1}function Q(ne){return B(z,ne)===1}function te(ne,re){for(let j=0;j<3;j++)L[re*3+j]+=ne[j]||0}}function B(z,P){const L=z.GDEF&&z.GDEF.glyphClassDef;return L?s.U._getGlyphClass(P,L):0}function F(...z){for(let P=0;P<z.length;P++)if(typeof z[P]=="number")return z[P]}function U(z){const P=Object.create(null),L=z["OS/2"],O=z.hhea,ee=z.head.unitsPerEm,Q=F(L&&L.sTypoAscender,O&&O.ascender,ee),te={unitsPerEm:ee,ascender:Q,descender:F(L&&L.sTypoDescender,O&&O.descender,0),capHeight:F(L&&L.sCapHeight,Q),xHeight:F(L&&L.sxHeight,Q),lineGap:F(L&&L.sTypoLineGap,O&&O.lineGap),supportsCodePoint(ne){return s.U.codeToGlyph(z,ne)>0},forEachGlyph(ne,re,j,ae){let J=0;const ie=1/te.unitsPerEm*re,se=R(z,ne);let I=0;const W=N(z,se);return se.forEach((fe,Z)=>{if(fe!==-1){let me=P[fe];if(!me){const{cmds:$,crds:pe}=s.U.glyphToPath(z,fe);let ve="",ze=0;for(let De=0,le=$.length;De<le;De++){const Ye=t[$[De]];ve+=$[De];for(let Ze=1;Ze<=Ye;Ze++)ve+=(Ze>1?",":"")+pe[ze++]}let Ge,Fe,Qe,lt;if(pe.length){Ge=Fe=1/0,Qe=lt=-1/0;for(let De=0,le=pe.length;De<le;De+=2){let Ye=pe[De],Ze=pe[De+1];Ye<Ge&&(Ge=Ye),Ze<Fe&&(Fe=Ze),Ye>Qe&&(Qe=Ye),Ze>lt&&(lt=Ze)}}else Ge=Qe=Fe=lt=0;me=P[fe]={index:fe,advanceWidth:z.hmtx.aWidth[fe],xMin:Ge,yMin:Fe,xMax:Qe,yMax:lt,path:ve}}ae.call(null,me,J+W[Z*3]*ie,W[Z*3+1]*ie,I),J+=W[Z*3+2]*ie,j&&(J+=j*re)}I+=ne.codePointAt(I)>65535?2:1}),J}};return te}return function(P){const L=new Uint8Array(P,0,4),O=s._bin.readASCII(L,0,4);if(O==="wOFF")P=e(P);else if(O==="wOF2")throw new Error("woff2 fonts not supported");return U(s.parse(P)[0])}}const d9=u0({name:"Typr Font Parser",dependencies:[u9,f9,h9],init(s,e,t){const n=s(),i=e();return t(n,i)}});/*!
Custom bundle of @unicode-font-resolver/client v1.0.2 (https://github.com/lojjic/unicode-font-resolver)
for use in Troika text rendering. 
Original MIT license applies
*/function p9(){return(function(s){var e=function(){this.buckets=new Map};e.prototype.add=function(N){var B=N>>5;this.buckets.set(B,(this.buckets.get(B)||0)|1<<(31&N))},e.prototype.has=function(N){var B=this.buckets.get(N>>5);return B!==void 0&&(B&1<<(31&N))!=0},e.prototype.serialize=function(){var N=[];return this.buckets.forEach((function(B,F){N.push((+F).toString(36)+":"+B.toString(36))})),N.join(",")},e.prototype.deserialize=function(N){var B=this;this.buckets.clear(),N.split(",").forEach((function(F){var U=F.split(":");B.buckets.set(parseInt(U[0],36),parseInt(U[1],36))}))};var t=Math.pow(2,8),n=t-1,i=~n;function a(N){var B=(function(U){return U&i})(N).toString(16),F=(function(U){return(U&i)+t-1})(N).toString(16);return"codepoint-index/plane"+(N>>16)+"/"+B+"-"+F+".json"}function o(N,B){var F=N&n,U=B.codePointAt(F/6|0);return((U=(U||48)-48)&1<<F%6)!=0}function c(N,B){var F;(F=N,F.replace(/U\+/gi,"").replace(/^,+|,+$/g,"").split(/,+/).map((function(U){return U.split("-").map((function(z){return parseInt(z.trim(),16)}))}))).forEach((function(U){var z=U[0],P=U[1];P===void 0&&(P=z),B(z,P)}))}function u(N,B){c(N,(function(F,U){for(var z=F;z<=U;z++)B(z)}))}var h={},m={},x=new WeakMap,g="https://cdn.jsdelivr.net/gh/lojjic/unicode-font-resolver@v1.0.1/packages/data";function b(N){var B=x.get(N);return B||(B=new e,u(N.ranges,(function(F){return B.add(F)})),x.set(N,B)),B}var S,C=new Map;function M(N,B,F){return N[B]?B:N[F]?F:(function(U){for(var z in U)return z})(N)}function A(N,B){var F=B;if(!N.includes(F)){F=1/0;for(var U=0;U<N.length;U++)Math.abs(N[U]-B)<Math.abs(F-B)&&(F=N[U])}return F}function R(N){return S||(S=new Set,u("9-D,20,85,A0,1680,2000-200A,2028-202F,205F,3000",(function(B){S.add(B)}))),S.has(N)}return s.CodePointSet=e,s.clearCache=function(){h={},m={}},s.getFontsForString=function(N,B){B===void 0&&(B={});var F,U=B.lang;U===void 0&&(U=new RegExp("\\p{Script=Hangul}","u").test(F=N)?"ko":new RegExp("\\p{Script=Hiragana}|\\p{Script=Katakana}","u").test(F)?"ja":"en");var z=B.category;z===void 0&&(z="sans-serif");var P=B.style;P===void 0&&(P="normal");var L=B.weight;L===void 0&&(L=400);var O=(B.dataUrl||g).replace(/\/$/g,""),ee=new Map,Q=new Uint8Array(N.length),te={},ne={},re=new Array(N.length),j=new Map,ae=!1;function J(I){var W=C.get(I);return W||(W=fetch(O+"/"+I).then((function(fe){if(!fe.ok)throw new Error(fe.statusText);return fe.json().then((function(Z){if(!Array.isArray(Z)||Z[0]!==1)throw new Error("Incorrect schema version; need 1, got "+Z[0]);return Z[1]}))})).catch((function(fe){if(O!==g)return ae||(console.error('unicode-font-resolver: Failed loading from dataUrl "'+O+'", trying default CDN. '+fe.message),ae=!0),O=g,C.delete(I),J(I);throw fe})),C.set(I,W)),W}for(var ie=function(I){var W=N.codePointAt(I),fe=a(W);re[I]=fe,h[fe]||j.has(fe)||j.set(fe,J(fe).then((function(Z){h[fe]=Z}))),W>65535&&(I++,se=I)},se=0;se<N.length;se++)ie(se);return Promise.all(j.values()).then((function(){j.clear();for(var I=function(fe){var Z=N.codePointAt(fe),me=null,$=h[re[fe]],pe=void 0;for(var ve in $){var ze=ne[ve];if(ze===void 0&&(ze=ne[ve]=new RegExp(ve).test(U||"en")),ze){for(var Ge in pe=ve,$[ve])if(o(Z,$[ve][Ge])){me=Ge;break}break}}if(!me){e:for(var Fe in $)if(Fe!==pe){for(var Qe in $[Fe])if(o(Z,$[Fe][Qe])){me=Qe;break e}}}me||(console.debug("No font coverage for U+"+Z.toString(16)),me="latin"),re[fe]=me,m[me]||j.has(me)||j.set(me,J("font-meta/"+me+".json").then((function(lt){m[me]=lt}))),Z>65535&&(fe++,W=fe)},W=0;W<N.length;W++)I(W);return Promise.all(j.values())})).then((function(){for(var I,W=null,fe=0;fe<N.length;fe++){var Z=N.codePointAt(fe);if(W&&(R(Z)||b(W).has(Z)))Q[fe]=Q[fe-1];else{W=m[re[fe]];var me=te[W.id];if(!me){var $=W.typeforms,pe=M($,z,"sans-serif"),ve=M($[pe],P,"normal"),ze=A((I=$[pe])===null||I===void 0?void 0:I[ve],L);me=te[W.id]=O+"/font-files/"+W.id+"/"+pe+"."+ve+"."+ze+".woff"}var Ge=ee.get(me);Ge==null&&(Ge=ee.size,ee.set(me,Ge)),Q[fe]=Ge}Z>65535&&(fe++,Q[fe]=Q[fe-1])}return{fontUrls:Array.from(ee.keys()),chars:Q}}))},Object.defineProperty(s,"__esModule",{value:!0}),s})({})}function m9(s,e){const t=Object.create(null),n=Object.create(null);function i(o,c){const u=h=>{console.error(`Failure loading font ${o}`,h)};try{const h=new XMLHttpRequest;h.open("get",o,!0),h.responseType="arraybuffer",h.onload=function(){if(h.status>=400)u(new Error(h.statusText));else if(h.status>0)try{const m=s(h.response);m.src=o,c(m)}catch(m){u(m)}},h.onerror=u,h.send()}catch(h){u(h)}}function a(o,c){let u=t[o];u?c(u):n[o]?n[o].push(c):(n[o]=[c],i(o,h=>{h.src=o,t[o]=h,n[o].forEach(m=>m(h)),delete n[o]}))}return function(o,c,{lang:u,fonts:h=[],style:m="normal",weight:x="normal",unicodeFontsURL:g}={}){const b=new Uint8Array(o.length),S=[];o.length||R();const C=new Map,M=[];if(m!=="italic"&&(m="normal"),typeof x!="number"&&(x=x==="bold"?700:400),h&&!Array.isArray(h)&&(h=[h]),h=h.slice().filter(B=>!B.lang||B.lang.test(u)).reverse(),h.length){let z=0;(function P(L=0){for(let O=L,ee=o.length;O<ee;O++){const Q=o.codePointAt(O);if(z===1&&S[b[O-1]].supportsCodePoint(Q)||O>0&&/\s/.test(o[O]))b[O]=b[O-1],z===2&&(M[M.length-1][1]=O);else for(let te=b[O],ne=h.length;te<=ne;te++)if(te===ne){const re=z===2?M[M.length-1]:M[M.length]=[O,O];re[1]=O,z=2}else{b[O]=te;const{src:re,unicodeRange:j}=h[te];if(!j||N(Q,j)){const ae=t[re];if(!ae){a(re,()=>{P(O)});return}if(ae.supportsCodePoint(Q)){let J=C.get(ae);typeof J!="number"&&(J=S.length,S.push(ae),C.set(ae,J)),b[O]=J,z=1;break}}}Q>65535&&O+1<ee&&(b[O+1]=b[O],O++,z===2&&(M[M.length-1][1]=O))}A()})()}else M.push([0,o.length-1]),A();function A(){if(M.length){const B=M.map(F=>o.substring(F[0],F[1]+1)).join(`
`);e.getFontsForString(B,{lang:u||void 0,style:m,weight:x,dataUrl:g}).then(({fontUrls:F,chars:U})=>{const z=S.length;let P=0;M.forEach(O=>{for(let ee=0,Q=O[1]-O[0];ee<=Q;ee++)b[O[0]+ee]=U[P++]+z;P++});let L=0;F.forEach((O,ee)=>{a(O,Q=>{S[ee+z]=Q,++L===F.length&&R()})})})}else R()}function R(){c({chars:b,fonts:S})}function N(B,F){for(let U=0;U<F.length;U++){const[z,P=z]=F[U];if(z<=B&&B<=P)return!0}return!1}}}const x9=u0({name:"FontResolver",dependencies:[m9,d9,p9],init(s,e,t){return s(e,t())}});function g9(s,e){const n=/[\u00AD\u034F\u061C\u115F-\u1160\u17B4-\u17B5\u180B-\u180E\u200B-\u200F\u202A-\u202E\u2060-\u206F\u3164\uFE00-\uFE0F\uFEFF\uFFA0\uFFF0-\uFFF8]/,i="[^\\S\\u00A0]",a=new RegExp(`${i}|[\\-\\u007C\\u00AD\\u2010\\u2012-\\u2014\\u2027\\u2056\\u2E17\\u2E40]`);function o({text:S,lang:C,fonts:M,style:A,weight:R,preResolvedFonts:N,unicodeFontsURL:B},F){const U=({chars:z,fonts:P})=>{let L,O;const ee=[];for(let Q=0;Q<z.length;Q++)z[Q]!==O?(O=z[Q],ee.push(L={start:Q,end:Q,fontObj:P[z[Q]]})):L.end=Q;F(ee)};N?U(N):s(S,U,{lang:C,fonts:M,style:A,weight:R,unicodeFontsURL:B})}function c({text:S="",font:C,lang:M,sdfGlyphSize:A=64,fontSize:R=400,fontWeight:N=1,fontStyle:B="normal",letterSpacing:F=0,lineHeight:U="normal",maxWidth:z=1/0,direction:P,textAlign:L="left",textIndent:O=0,whiteSpace:ee="normal",overflowWrap:Q="normal",anchorX:te=0,anchorY:ne=0,metricsOnly:re=!1,unicodeFontsURL:j,preResolvedFonts:ae=null,includeCaretPositions:J=!1,chunkedBoundsSize:ie=8192,colorRanges:se=null},I){const W=x(),fe={fontLoad:0,typesetting:0};S.indexOf("\r")>-1&&(console.info("Typesetter: got text with \\r chars; normalizing to \\n"),S=S.replace(/\r\n/g,`
`).replace(/\r/g,`
`)),R=+R,F=+F,z=+z,U=U||"normal",O=+O,o({text:S,lang:M,style:B,weight:N,fonts:typeof C=="string"?[{src:C}]:C,unicodeFontsURL:j,preResolvedFonts:ae},Z=>{fe.fontLoad=x()-W;const me=isFinite(z);let $=null,pe=null,ve=null,ze=null,Ge=null,Fe=null,Qe=null,lt=null,De=0,le=0,Ye=ee!=="nowrap";const Ze=new Map,je=x();let He=O,et=0,Ne=new g;const st=[Ne];Z.forEach(Ue=>{const{fontObj:Be}=Ue,{ascender:bt,descender:vt,unitsPerEm:It,lineGap:zt,capHeight:qe,xHeight:We}=Be;let ft=Ze.get(Be);if(!ft){const Re=R/It,pt=U==="normal"?(bt-vt+zt)*Re:U*R,Rt=(pt-(bt-vt)*Re)/2,dt=Math.min(pt,(bt-vt)*Re),Ke=(bt+vt)/2*Re+dt/2;ft={index:Ze.size,src:Be.src,fontObj:Be,fontSizeMult:Re,unitsPerEm:It,ascender:bt*Re,descender:vt*Re,capHeight:qe*Re,xHeight:We*Re,lineHeight:pt,baseline:-Rt-bt*Re,caretTop:Ke,caretBottom:Ke-dt},Ze.set(Be,ft)}const{fontSizeMult:ge}=ft,Ie=S.slice(Ue.start,Ue.end+1);let ht,ye;Be.forEachGlyph(Ie,R,F,(Re,pt,Rt,dt)=>{pt+=et,dt+=Ue.start,ht=pt,ye=Re;const Ke=S.charAt(dt),Lt=Re.advanceWidth*ge,Vt=Ne.count;let Kt;if("isEmpty"in Re||(Re.isWhitespace=!!Ke&&new RegExp(i).test(Ke),Re.canBreakAfter=!!Ke&&a.test(Ke),Re.isEmpty=Re.xMin===Re.xMax||Re.yMin===Re.yMax||n.test(Ke)),!Re.isWhitespace&&!Re.isEmpty&&le++,Ye&&me&&!Re.isWhitespace&&pt+Lt+He>z&&Vt){if(Ne.glyphAt(Vt-1).glyphObj.canBreakAfter)Kt=new g,He=-pt;else for(let Gn=Vt;Gn--;)if(Gn===0&&Q==="break-word"){Kt=new g,He=-pt;break}else if(Ne.glyphAt(Gn).glyphObj.canBreakAfter){Kt=Ne.splitAt(Gn+1);const En=Kt.glyphAt(0).x;He-=En;for(let li=Kt.count;li--;)Kt.glyphAt(li).x-=En;break}Kt&&(Ne.isSoftWrapped=!0,Ne=Kt,st.push(Ne),De=z)}let on=Ne.glyphAt(Ne.count);on.glyphObj=Re,on.x=pt+He,on.y=Rt,on.width=Lt,on.charIndex=dt,on.fontData=ft,Ke===`
`&&(Ne=new g,st.push(Ne),He=-(pt+Lt+F*R)+O)}),et=ht+ye.advanceWidth*ge+F*R});let oe=0;st.forEach(Ue=>{let Be=!0;for(let bt=Ue.count;bt--;){const vt=Ue.glyphAt(bt);Be&&!vt.glyphObj.isWhitespace&&(Ue.width=vt.x+vt.width,Ue.width>De&&(De=Ue.width),Be=!1);let{lineHeight:It,capHeight:zt,xHeight:qe,baseline:We}=vt.fontData;It>Ue.lineHeight&&(Ue.lineHeight=It);const ft=We-Ue.baseline;ft<0&&(Ue.baseline+=ft,Ue.cap+=ft,Ue.ex+=ft),Ue.cap=Math.max(Ue.cap,Ue.baseline+zt),Ue.ex=Math.max(Ue.ex,Ue.baseline+qe)}Ue.baseline-=oe,Ue.cap-=oe,Ue.ex-=oe,oe+=Ue.lineHeight});let X=0,Ae=0;if(te&&(typeof te=="number"?X=-te:typeof te=="string"&&(X=-De*(te==="left"?0:te==="center"?.5:te==="right"?1:h(te)))),ne&&(typeof ne=="number"?Ae=-ne:typeof ne=="string"&&(Ae=ne==="top"?0:ne==="top-baseline"?-st[0].baseline:ne==="top-cap"?-st[0].cap:ne==="top-ex"?-st[0].ex:ne==="middle"?oe/2:ne==="bottom"?oe:ne==="bottom-baseline"?-st[st.length-1].baseline:h(ne)*oe)),!re){const Ue=e.getEmbeddingLevels(S,P);$=new Uint16Array(le),pe=new Uint8Array(le),ve=new Float32Array(le*2),ze={},Qe=[1/0,1/0,-1/0,-1/0],lt=[],J&&(Fe=new Float32Array(S.length*4)),se&&(Ge=new Uint8Array(le*3));let Be=0,bt=-1,vt=-1,It,zt;if(st.forEach((qe,We)=>{let{count:ft,width:ge}=qe;if(ft>0){let Ie=0;for(let dt=ft;dt--&&qe.glyphAt(dt).glyphObj.isWhitespace;)Ie++;let ht=0,ye=0;if(L==="center")ht=(De-ge)/2;else if(L==="right")ht=De-ge;else if(L==="justify"&&qe.isSoftWrapped){let dt=0;for(let Ke=ft-Ie;Ke--;)qe.glyphAt(Ke).glyphObj.isWhitespace&&dt++;ye=(De-ge)/dt}if(ye||ht){let dt=0;for(let Ke=0;Ke<ft;Ke++){let Lt=qe.glyphAt(Ke);const Vt=Lt.glyphObj;Lt.x+=ht+dt,ye!==0&&Vt.isWhitespace&&Ke<ft-Ie&&(dt+=ye,Lt.width+=ye)}}const Re=e.getReorderSegments(S,Ue,qe.glyphAt(0).charIndex,qe.glyphAt(qe.count-1).charIndex);for(let dt=0;dt<Re.length;dt++){const[Ke,Lt]=Re[dt];let Vt=1/0,Kt=-1/0;for(let on=0;on<ft;on++)if(qe.glyphAt(on).charIndex>=Ke){let Gn=on,En=on;for(;En<ft;En++){let li=qe.glyphAt(En);if(li.charIndex>Lt)break;En<ft-Ie&&(Vt=Math.min(Vt,li.x),Kt=Math.max(Kt,li.x+li.width))}for(let li=Gn;li<En;li++){const qi=qe.glyphAt(li);qi.x=Kt-(qi.x+qi.width-Vt)}break}}let pt;const Rt=dt=>pt=dt;for(let dt=0;dt<ft;dt++){const Ke=qe.glyphAt(dt);pt=Ke.glyphObj;const Lt=pt.index,Vt=Ue.levels[Ke.charIndex]&1;if(Vt){const Kt=e.getMirroredCharacter(S[Ke.charIndex]);Kt&&Ke.fontData.fontObj.forEachGlyph(Kt,0,0,Rt)}if(J){const{charIndex:Kt,fontData:on}=Ke,Gn=Ke.x+X,En=Ke.x+Ke.width+X;Fe[Kt*4]=Vt?En:Gn,Fe[Kt*4+1]=Vt?Gn:En,Fe[Kt*4+2]=qe.baseline+on.caretBottom+Ae,Fe[Kt*4+3]=qe.baseline+on.caretTop+Ae;const li=Kt-bt;li>1&&m(Fe,bt,li),bt=Kt}if(se){const{charIndex:Kt}=Ke;for(;Kt>vt;)vt++,se.hasOwnProperty(vt)&&(zt=se[vt])}if(!pt.isWhitespace&&!pt.isEmpty){const Kt=Be++,{fontSizeMult:on,src:Gn,index:En}=Ke.fontData,li=ze[Gn]||(ze[Gn]={});li[Lt]||(li[Lt]={path:pt.path,pathBounds:[pt.xMin,pt.yMin,pt.xMax,pt.yMax]});const qi=Ke.x+X,la=Ke.y+qe.baseline+Ae;ve[Kt*2]=qi,ve[Kt*2+1]=la;const di=qi+pt.xMin*on,Qi=la+pt.yMin*on,Mi=qi+pt.xMax*on,mn=la+pt.yMax*on;di<Qe[0]&&(Qe[0]=di),Qi<Qe[1]&&(Qe[1]=Qi),Mi>Qe[2]&&(Qe[2]=Mi),mn>Qe[3]&&(Qe[3]=mn),Kt%ie===0&&(It={start:Kt,end:Kt,rect:[1/0,1/0,-1/0,-1/0]},lt.push(It)),It.end++;const jn=It.rect;if(di<jn[0]&&(jn[0]=di),Qi<jn[1]&&(jn[1]=Qi),Mi>jn[2]&&(jn[2]=Mi),mn>jn[3]&&(jn[3]=mn),$[Kt]=Lt,pe[Kt]=En,se){const bn=Kt*3;Ge[bn]=zt>>16&255,Ge[bn+1]=zt>>8&255,Ge[bn+2]=zt&255}}}}}),Fe){const qe=S.length-bt;qe>1&&m(Fe,bt,qe)}}const Pe=[];Ze.forEach(({index:Ue,src:Be,unitsPerEm:bt,ascender:vt,descender:It,lineHeight:zt,capHeight:qe,xHeight:We})=>{Pe[Ue]={src:Be,unitsPerEm:bt,ascender:vt,descender:It,lineHeight:zt,capHeight:qe,xHeight:We}}),fe.typesetting=x()-je,I({glyphIds:$,glyphFontIndices:pe,glyphPositions:ve,glyphData:ze,fontData:Pe,caretPositions:Fe,glyphColors:Ge,chunkedBounds:lt,fontSize:R,topBaseline:Ae+st[0].baseline,blockBounds:[X,Ae-oe,X+De,Ae],visibleBounds:Qe,timings:fe})})}function u(S,C){c({...S,metricsOnly:!0},M=>{const[A,R,N,B]=M.blockBounds;C({width:N-A,height:B-R})})}function h(S){let C=S.match(/^([\d.]+)%$/),M=C?parseFloat(C[1]):NaN;return isNaN(M)?0:M/100}function m(S,C,M){const A=S[C*4],R=S[C*4+1],N=S[C*4+2],B=S[C*4+3],F=(R-A)/M;for(let U=0;U<M;U++){const z=(C+U)*4;S[z]=A+F*U,S[z+1]=A+F*(U+1),S[z+2]=N,S[z+3]=B}}function x(){return(self.performance||Date).now()}function g(){this.data=[]}const b=["glyphObj","x","y","width","charIndex","fontData"];return g.prototype={width:0,lineHeight:0,baseline:0,cap:0,ex:0,isSoftWrapped:!1,get count(){return Math.ceil(this.data.length/b.length)},glyphAt(S){let C=g.flyweight;return C.data=this.data,C.index=S,C},splitAt(S){let C=new g;return C.data=this.data.splice(S*b.length),C}},g.flyweight=b.reduce((S,C,M,A)=>(Object.defineProperty(S,C,{get(){return this.data[this.index*b.length+M]},set(R){this.data[this.index*b.length+M]=R}}),S),{data:null,index:0}),{typeset:c,measure:u}}const ed=()=>(self.performance||Date).now(),jy=WT();let ZE;function v9(s,e,t,n,i,a,o,c,u,h,m=!0){return m?b9(s,e,t,n,i,a,o,c,u,h).then(null,x=>(ZE||(console.warn("WebGL SDF generation failed, falling back to JS",x),ZE=!0),QE(s,e,t,n,i,a,o,c,u,h))):QE(s,e,t,n,i,a,o,c,u,h)}const e1=[],y9=5;let tS=0;function JT(){const s=ed();for(;e1.length&&ed()-s<y9;)e1.shift()();tS=e1.length?setTimeout(JT,0):0}const b9=(...s)=>new Promise((e,t)=>{e1.push(()=>{const n=ed();try{jy.webgl.generateIntoCanvas(...s),e({timing:ed()-n})}catch(i){t(i)}}),tS||(tS=setTimeout(JT,0))}),_9=4,S9=2e3,KE={};let A9=0;function QE(s,e,t,n,i,a,o,c,u,h){const m="TroikaTextSDFGenerator_JS_"+A9++%_9;let x=KE[m];return x||(x=KE[m]={workerModule:u0({name:m,workerId:m,dependencies:[WT,ed],init(g,b){const S=g().javascript.generate;return function(...C){const M=b();return{textureData:S(...C),timing:b()-M}}},getTransferables(g){return[g.textureData.buffer]}}),requests:0,idleTimer:null}),x.requests++,clearTimeout(x.idleTimer),x.workerModule(s,e,t,n,i,a).then(({textureData:g,timing:b})=>{const S=ed(),C=new Uint8Array(g.length*4);for(let M=0;M<g.length;M++)C[M*4+h]=g[M];return jy.webglUtils.renderImageData(o,C,c,u,s,e,1<<3-h),b+=ed()-S,--x.requests===0&&(x.idleTimer=setTimeout(()=>{e9(m)},S9)),{timing:b}})}function M9(s){s._warm||(jy.webgl.isSupported(s),s._warm=!0)}const w9=jy.webglUtils.resizeWebGLCanvasWithoutClearing,km={unicodeFontsURL:null,sdfGlyphSize:64,sdfMargin:1/16,sdfExponent:9,textureWidth:2048},E9=new qt;function Tp(){return(self.performance||Date).now()}const $E=Object.create(null);function ZT(s,e){s=R9({},s);const t=Tp(),n=[];if(s.font&&n.push({label:"user",src:N9(s.font)}),s.font=n,s.text=""+s.text,s.sdfGlyphSize=s.sdfGlyphSize||km.sdfGlyphSize,s.unicodeFontsURL=s.unicodeFontsURL||km.unicodeFontsURL,s.colorRanges!=null){let g={};for(let b in s.colorRanges)if(s.colorRanges.hasOwnProperty(b)){let S=s.colorRanges[b];typeof S!="number"&&(S=E9.set(S).getHex()),g[b]=S}s.colorRanges=g}Object.freeze(s);const{textureWidth:i,sdfExponent:a}=km,{sdfGlyphSize:o}=s,c=i/o*4;let u=$E[o];if(!u){const g=document.createElement("canvas");g.width=i,g.height=o*256/c,u=$E[o]={glyphCount:0,sdfGlyphSize:o,sdfCanvas:g,sdfTexture:new Wi(g,void 0,void 0,void 0,bi,bi),contextLost:!1,glyphsByFont:new Map},u.sdfTexture.generateMipmaps=!1,C9(u)}const{sdfTexture:h,sdfCanvas:m}=u;$T(s).then(g=>{const{glyphIds:b,glyphFontIndices:S,fontData:C,glyphPositions:M,fontSize:A,timings:R}=g,N=[],B=new Float32Array(b.length*4);let F=0,U=0;const z=Tp(),P=C.map(te=>{let ne=u.glyphsByFont.get(te.src);return ne||u.glyphsByFont.set(te.src,ne=new Map),ne});b.forEach((te,ne)=>{const re=S[ne],{src:j,unitsPerEm:ae}=C[re];let J=P[re].get(te);if(!J){const{path:fe,pathBounds:Z}=g.glyphData[j][te],me=Math.max(Z[2]-Z[0],Z[3]-Z[1])/o*(km.sdfMargin*o+.5),$=u.glyphCount++,pe=[Z[0]-me,Z[1]-me,Z[2]+me,Z[3]+me];P[re].set(te,J={path:fe,atlasIndex:$,sdfViewBox:pe}),N.push(J)}const{sdfViewBox:ie}=J,se=M[U++],I=M[U++],W=A/ae;B[F++]=se+ie[0]*W,B[F++]=I+ie[1]*W,B[F++]=se+ie[2]*W,B[F++]=I+ie[3]*W,b[ne]=J.atlasIndex}),R.quads=(R.quads||0)+(Tp()-z);const L=Tp();R.sdf={};const O=m.height,ee=Math.ceil(u.glyphCount/c),Q=Math.pow(2,Math.ceil(Math.log2(ee*o)));Q>O&&(console.info(`Increasing SDF texture size ${O}->${Q}`),w9(m,i,Q),h.dispose()),Promise.all(N.map(te=>KT(te,u,s.gpuAccelerateSDF).then(({timing:ne})=>{R.sdf[te.atlasIndex]=ne}))).then(()=>{N.length&&!u.contextLost&&(QT(u),h.needsUpdate=!0),R.sdfTotal=Tp()-L,R.total=Tp()-t,e(Object.freeze({parameters:s,sdfTexture:h,sdfGlyphSize:o,sdfExponent:a,glyphBounds:B,glyphAtlasIndices:b,glyphColors:g.glyphColors,caretPositions:g.caretPositions,chunkedBounds:g.chunkedBounds,ascender:g.ascender,descender:g.descender,lineHeight:g.lineHeight,capHeight:g.capHeight,xHeight:g.xHeight,topBaseline:g.topBaseline,blockBounds:g.blockBounds,visibleBounds:g.visibleBounds,timings:g.timings}))})}),Promise.resolve().then(()=>{u.contextLost||M9(m)})}function KT({path:s,atlasIndex:e,sdfViewBox:t},{sdfGlyphSize:n,sdfCanvas:i,contextLost:a},o){if(a)return Promise.resolve({timing:-1});const{textureWidth:c,sdfExponent:u}=km,h=Math.max(t[2]-t[0],t[3]-t[1]),m=Math.floor(e/4),x=m%(c/n)*n,g=Math.floor(m/(c/n))*n,b=e%4;return v9(n,n,s,t,h,u,i,x,g,b,o)}function C9(s){const e=s.sdfCanvas;e.addEventListener("webglcontextlost",t=>{console.log("Context Lost",t),t.preventDefault(),s.contextLost=!0}),e.addEventListener("webglcontextrestored",t=>{console.log("Context Restored",t),s.contextLost=!1;const n=[];s.glyphsByFont.forEach(i=>{i.forEach(a=>{n.push(KT(a,s,!0))})}),Promise.all(n).then(()=>{QT(s),s.sdfTexture.needsUpdate=!0})})}function T9({font:s,characters:e,sdfGlyphSize:t},n){let i=Array.isArray(e)?e.join(`
`):""+e;ZT({font:s,sdfGlyphSize:t,text:i},n)}function R9(s,e){for(let t in e)e.hasOwnProperty(t)&&(s[t]=e[t]);return s}let Gv;function N9(s){return Gv||(Gv=typeof document>"u"?{}:document.createElement("a")),Gv.href=s,Gv.href}function QT(s){if(typeof createImageBitmap!="function"){console.info("Safari<15: applying SDF canvas workaround");const{sdfCanvas:e,sdfTexture:t}=s,{width:n,height:i}=e,a=s.sdfCanvas.getContext("webgl");let o=t.image.data;(!o||o.length!==n*i*4)&&(o=new Uint8Array(n*i*4),t.image={width:n,height:i,data:o},t.flipY=!1,t.isDataTexture=!0),a.readPixels(0,0,n,i,a.RGBA,a.UNSIGNED_BYTE,o)}}const B9=u0({name:"Typesetter",dependencies:[g9,x9,n9],init(s,e,t){return s(e,t())}}),$T=u0({name:"Typesetter",dependencies:[B9],init(s){return function(e){return new Promise(t=>{s.typeset(e,t)})}},getTransferables(s){const e=[];for(let t in s)s[t]&&s[t].buffer&&e.push(s[t].buffer);return e}});$T.onMainThread;const e3={};function D9(s){let e=e3[s];return e||(e=e3[s]=new is(1,1,s,s).translate(.5,.5,0)),e}const U9="aTroikaGlyphBounds",t3="aTroikaGlyphIndex",L9="aTroikaGlyphColor";class O9 extends Oy{constructor(){super(),this.detail=1,this.curveRadius=0,this.groups=[{start:0,count:1/0,materialIndex:0},{start:0,count:1/0,materialIndex:1}],this.boundingSphere=new rs,this.boundingBox=new Yi}computeBoundingSphere(){}computeBoundingBox(){}set detail(e){if(e!==this._detail){this._detail=e,(typeof e!="number"||e<1)&&(e=1);let t=D9(e);["position","normal","uv"].forEach(n=>{this.attributes[n]=t.attributes[n].clone()}),this.setIndex(t.getIndex().clone())}}get detail(){return this._detail}set curveRadius(e){e!==this._curveRadius&&(this._curveRadius=e,this._updateBounds())}get curveRadius(){return this._curveRadius}updateGlyphs(e,t,n,i,a){this.updateAttributeData(U9,e,4),this.updateAttributeData(t3,t,1),this.updateAttributeData(L9,a,3),this._blockBounds=n,this._chunkedBounds=i,this.instanceCount=t.length,this._updateBounds()}_updateBounds(){const e=this._blockBounds;if(e){const{curveRadius:t,boundingBox:n}=this;if(t){const{PI:i,floor:a,min:o,max:c,sin:u,cos:h}=Math,m=i/2,x=i*2,g=Math.abs(t),b=e[0]/g,S=e[2]/g,C=a((b+m)/x)!==a((S+m)/x)?-g:o(u(b)*g,u(S)*g),M=a((b-m)/x)!==a((S-m)/x)?g:c(u(b)*g,u(S)*g),A=a((b+i)/x)!==a((S+i)/x)?g*2:c(g-h(b)*g,g-h(S)*g);n.min.set(C,e[1],t<0?-A:0),n.max.set(M,e[3],t<0?0:A)}else n.min.set(e[0],e[1],0),n.max.set(e[2],e[3],0);n.getBoundingSphere(this.boundingSphere)}}applyClipRect(e){let t=this.getAttribute(t3).count,n=this._chunkedBounds;if(n)for(let i=n.length;i--;){t=n[i].end;let a=n[i].rect;if(a[1]<e.w&&a[3]>e.y&&a[0]<e.z&&a[2]>e.x)break}this.instanceCount=t}updateAttributeData(e,t,n){const i=this.getAttribute(e);t?i&&i.array.length===t.length?(i.array.set(t),i.needsUpdate=!0):(this.setAttribute(e,new Ff(t,n)),delete this._maxInstanceCount,this.dispose()):i&&this.deleteAttribute(e)}}const I9=`
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform vec4 uTroikaTotalBounds;
uniform vec4 uTroikaClipRect;
uniform mat3 uTroikaOrient;
uniform bool uTroikaUseGlyphColors;
uniform float uTroikaEdgeOffset;
uniform float uTroikaBlurRadius;
uniform vec2 uTroikaPositionOffset;
uniform float uTroikaCurveRadius;
attribute vec4 aTroikaGlyphBounds;
attribute float aTroikaGlyphIndex;
attribute vec3 aTroikaGlyphColor;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec3 vTroikaGlyphColor;
varying vec2 vTroikaGlyphDimensions;
`,z9=`
vec4 bounds = aTroikaGlyphBounds;
bounds.xz += uTroikaPositionOffset.x;
bounds.yw -= uTroikaPositionOffset.y;

vec4 outlineBounds = vec4(
  bounds.xy - uTroikaEdgeOffset - uTroikaBlurRadius,
  bounds.zw + uTroikaEdgeOffset + uTroikaBlurRadius
);
vec4 clippedBounds = vec4(
  clamp(outlineBounds.xy, uTroikaClipRect.xy, uTroikaClipRect.zw),
  clamp(outlineBounds.zw, uTroikaClipRect.xy, uTroikaClipRect.zw)
);

vec2 clippedXY = (mix(clippedBounds.xy, clippedBounds.zw, position.xy) - bounds.xy) / (bounds.zw - bounds.xy);

position.xy = mix(bounds.xy, bounds.zw, clippedXY);

uv = (position.xy - uTroikaTotalBounds.xy) / (uTroikaTotalBounds.zw - uTroikaTotalBounds.xy);

float rad = uTroikaCurveRadius;
if (rad != 0.0) {
  float angle = position.x / rad;
  position.xz = vec2(sin(angle) * rad, rad - cos(angle) * rad);
  normal.xz = vec2(sin(angle), cos(angle));
}
  
position = uTroikaOrient * position;
normal = uTroikaOrient * normal;

vTroikaGlyphUV = clippedXY.xy;
vTroikaGlyphDimensions = vec2(bounds[2] - bounds[0], bounds[3] - bounds[1]);


float txCols = uTroikaSDFTextureSize.x / uTroikaSDFGlyphSize;
vec2 txUvPerSquare = uTroikaSDFGlyphSize / uTroikaSDFTextureSize;
vec2 txStartUV = txUvPerSquare * vec2(
  mod(floor(aTroikaGlyphIndex / 4.0), txCols),
  floor(floor(aTroikaGlyphIndex / 4.0) / txCols)
);
vTroikaTextureUVBounds = vec4(txStartUV, vec2(txStartUV) + txUvPerSquare);
vTroikaTextureChannel = mod(aTroikaGlyphIndex, 4.0);
`,F9=`
uniform sampler2D uTroikaSDFTexture;
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform float uTroikaSDFExponent;
uniform float uTroikaEdgeOffset;
uniform float uTroikaFillOpacity;
uniform float uTroikaBlurRadius;
uniform vec3 uTroikaStrokeColor;
uniform float uTroikaStrokeWidth;
uniform float uTroikaStrokeOpacity;
uniform bool uTroikaSDFDebug;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec2 vTroikaGlyphDimensions;

float troikaSdfValueToSignedDistance(float alpha) {
  // Inverse of exponential encoding in webgl-sdf-generator
  
  float maxDimension = max(vTroikaGlyphDimensions.x, vTroikaGlyphDimensions.y);
  float absDist = (1.0 - pow(2.0 * (alpha > 0.5 ? 1.0 - alpha : alpha), 1.0 / uTroikaSDFExponent)) * maxDimension;
  float signedDist = absDist * (alpha > 0.5 ? -1.0 : 1.0);
  return signedDist;
}

float troikaGlyphUvToSdfValue(vec2 glyphUV) {
  vec2 textureUV = mix(vTroikaTextureUVBounds.xy, vTroikaTextureUVBounds.zw, glyphUV);
  vec4 rgba = texture2D(uTroikaSDFTexture, textureUV);
  float ch = floor(vTroikaTextureChannel + 0.5); //NOTE: can't use round() in WebGL1
  return ch == 0.0 ? rgba.r : ch == 1.0 ? rgba.g : ch == 2.0 ? rgba.b : rgba.a;
}

float troikaGlyphUvToDistance(vec2 uv) {
  return troikaSdfValueToSignedDistance(troikaGlyphUvToSdfValue(uv));
}

float troikaGetAADist() {
  
  #if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300
  return length(fwidth(vTroikaGlyphUV * vTroikaGlyphDimensions)) * 0.5;
  #else
  return vTroikaGlyphDimensions.x / 64.0;
  #endif
}

float troikaGetFragDistValue() {
  vec2 clampedGlyphUV = clamp(vTroikaGlyphUV, 0.5 / uTroikaSDFGlyphSize, 1.0 - 0.5 / uTroikaSDFGlyphSize);
  float distance = troikaGlyphUvToDistance(clampedGlyphUV);
 
  // Extrapolate distance when outside bounds:
  distance += clampedGlyphUV == vTroikaGlyphUV ? 0.0 : 
    length((vTroikaGlyphUV - clampedGlyphUV) * vTroikaGlyphDimensions);

  

  return distance;
}

float troikaGetEdgeAlpha(float distance, float distanceOffset, float aaDist) {
  #if defined(IS_DEPTH_MATERIAL) || defined(IS_DISTANCE_MATERIAL)
  float alpha = step(-distanceOffset, -distance);
  #else

  float alpha = smoothstep(
    distanceOffset + aaDist,
    distanceOffset - aaDist,
    distance
  );
  #endif

  return alpha;
}
`,P9=`
float aaDist = troikaGetAADist();
float fragDistance = troikaGetFragDistValue();
float edgeAlpha = uTroikaSDFDebug ?
  troikaGlyphUvToSdfValue(vTroikaGlyphUV) :
  troikaGetEdgeAlpha(fragDistance, uTroikaEdgeOffset, max(aaDist, uTroikaBlurRadius));

#if !defined(IS_DEPTH_MATERIAL) && !defined(IS_DISTANCE_MATERIAL)
vec4 fillRGBA = gl_FragColor;
fillRGBA.a *= uTroikaFillOpacity;
vec4 strokeRGBA = uTroikaStrokeWidth == 0.0 ? fillRGBA : vec4(uTroikaStrokeColor, uTroikaStrokeOpacity);
if (fillRGBA.a == 0.0) fillRGBA.rgb = strokeRGBA.rgb;
gl_FragColor = mix(fillRGBA, strokeRGBA, smoothstep(
  -uTroikaStrokeWidth - aaDist,
  -uTroikaStrokeWidth + aaDist,
  fragDistance
));
gl_FragColor.a *= edgeAlpha;
#endif

if (edgeAlpha == 0.0) {
  discard;
}
`;function G9(s){const e=eS(s,{chained:!0,extensions:{derivatives:!0},uniforms:{uTroikaSDFTexture:{value:null},uTroikaSDFTextureSize:{value:new gt},uTroikaSDFGlyphSize:{value:0},uTroikaSDFExponent:{value:0},uTroikaTotalBounds:{value:new oi(0,0,0,0)},uTroikaClipRect:{value:new oi(0,0,0,0)},uTroikaEdgeOffset:{value:0},uTroikaFillOpacity:{value:1},uTroikaPositionOffset:{value:new gt},uTroikaCurveRadius:{value:0},uTroikaBlurRadius:{value:0},uTroikaStrokeWidth:{value:0},uTroikaStrokeColor:{value:new qt},uTroikaStrokeOpacity:{value:1},uTroikaOrient:{value:new Qn},uTroikaUseGlyphColors:{value:!0},uTroikaSDFDebug:{value:!1}},vertexDefs:I9,vertexTransform:z9,fragmentDefs:F9,fragmentColorTransform:P9,customRewriter({vertexShader:t,fragmentShader:n}){let i=/\buniform\s+vec3\s+diffuse\b/;return i.test(n)&&(n=n.replace(i,"varying vec3 vTroikaGlyphColor").replace(/\bdiffuse\b/g,"vTroikaGlyphColor"),i.test(t)||(t=t.replace(qT,`uniform vec3 diffuse;
$&
vTroikaGlyphColor = uTroikaUseGlyphColors ? aTroikaGlyphColor / 255.0 : diffuse;
`))),{vertexShader:t,fragmentShader:n}}});return e.transparent=!0,e.forceSinglePass=!0,Object.defineProperties(e,{isTroikaTextMaterial:{value:!0},shadowSide:{get(){return this.side},set(){}}}),e}const sA=new ur({color:16777215,side:Oi,transparent:!0}),n3=8421504,i3=new wn,jv=new k,p_=new k,Fm=[],j9=new k,m_="+x+y";function a3(s){return Array.isArray(s)?s[0]:s}let eR=()=>{const s=new sn(new is(1,1),sA);return eR=()=>s,s},tR=()=>{const s=new sn(new is(1,1,32,1),sA);return tR=()=>s,s};const H9={type:"syncstart"},k9={type:"synccomplete"},nR=["font","fontSize","fontStyle","fontWeight","lang","letterSpacing","lineHeight","maxWidth","overflowWrap","text","direction","textAlign","textIndent","whiteSpace","anchorX","anchorY","colorRanges","sdfGlyphSize"],V9=nR.concat("material","color","depthOffset","clipRect","curveRadius","orientation","glyphGeometryDetail");let iR=class extends sn{constructor(){const e=new O9;super(e,null),this.text="",this.anchorX=0,this.anchorY=0,this.curveRadius=0,this.direction="auto",this.font=null,this.unicodeFontsURL=null,this.fontSize=.1,this.fontWeight="normal",this.fontStyle="normal",this.lang=null,this.letterSpacing=0,this.lineHeight="normal",this.maxWidth=1/0,this.overflowWrap="normal",this.textAlign="left",this.textIndent=0,this.whiteSpace="normal",this.material=null,this.color=null,this.colorRanges=null,this.outlineWidth=0,this.outlineColor=0,this.outlineOpacity=1,this.outlineBlur=0,this.outlineOffsetX=0,this.outlineOffsetY=0,this.strokeWidth=0,this.strokeColor=n3,this.strokeOpacity=1,this.fillOpacity=1,this.depthOffset=0,this.clipRect=null,this.orientation=m_,this.glyphGeometryDetail=1,this.sdfGlyphSize=null,this.gpuAccelerateSDF=!0,this.debugSDF=!1}sync(e){this._needsSync&&(this._needsSync=!1,this._isSyncing?(this._queuedSyncs||(this._queuedSyncs=[])).push(e):(this._isSyncing=!0,this.dispatchEvent(H9),ZT({text:this.text,font:this.font,lang:this.lang,fontSize:this.fontSize||.1,fontWeight:this.fontWeight||"normal",fontStyle:this.fontStyle||"normal",letterSpacing:this.letterSpacing||0,lineHeight:this.lineHeight||"normal",maxWidth:this.maxWidth,direction:this.direction||"auto",textAlign:this.textAlign,textIndent:this.textIndent,whiteSpace:this.whiteSpace,overflowWrap:this.overflowWrap,anchorX:this.anchorX,anchorY:this.anchorY,colorRanges:this.colorRanges,includeCaretPositions:!0,sdfGlyphSize:this.sdfGlyphSize,gpuAccelerateSDF:this.gpuAccelerateSDF,unicodeFontsURL:this.unicodeFontsURL},t=>{this._isSyncing=!1,this._textRenderInfo=t,this.geometry.updateGlyphs(t.glyphBounds,t.glyphAtlasIndices,t.blockBounds,t.chunkedBounds,t.glyphColors);const n=this._queuedSyncs;n&&(this._queuedSyncs=null,this._needsSync=!0,this.sync(()=>{n.forEach(i=>i&&i())})),this.dispatchEvent(k9),e&&e()})))}onBeforeRender(e,t,n,i,a,o){this.sync(),a.isTroikaTextMaterial&&this._prepareForRender(a)}dispose(){this.geometry.dispose()}get textRenderInfo(){return this._textRenderInfo||null}createDerivedMaterial(e){return G9(e)}get material(){let e=this._derivedMaterial;const t=this._baseMaterial||this._defaultMaterial||(this._defaultMaterial=sA.clone());if((!e||!e.isDerivedFrom(t))&&(e=this._derivedMaterial=this.createDerivedMaterial(t),t.addEventListener("dispose",function n(){t.removeEventListener("dispose",n),e.dispose()})),this.hasOutline()){let n=e._outlineMtl;return n||(n=e._outlineMtl=Object.create(e,{id:{value:e.id+.1}}),n.isTextOutlineMaterial=!0,n.depthWrite=!1,n.map=null,e.addEventListener("dispose",function i(){e.removeEventListener("dispose",i),n.dispose()})),[n,e]}else return e}set material(e){e&&e.isTroikaTextMaterial?(this._derivedMaterial=e,this._baseMaterial=e.baseMaterial):this._baseMaterial=e}hasOutline(){return!!(this.outlineWidth||this.outlineBlur||this.outlineOffsetX||this.outlineOffsetY)}get glyphGeometryDetail(){return this.geometry.detail}set glyphGeometryDetail(e){this.geometry.detail=e}get curveRadius(){return this.geometry.curveRadius}set curveRadius(e){this.geometry.curveRadius=e}get customDepthMaterial(){return a3(this.material).getDepthMaterial()}set customDepthMaterial(e){}get customDistanceMaterial(){return a3(this.material).getDistanceMaterial()}set customDistanceMaterial(e){}_prepareForRender(e){const t=e.isTextOutlineMaterial,n=e.uniforms,i=this.textRenderInfo;if(i){const{sdfTexture:c,blockBounds:u}=i;n.uTroikaSDFTexture.value=c,n.uTroikaSDFTextureSize.value.set(c.image.width,c.image.height),n.uTroikaSDFGlyphSize.value=i.sdfGlyphSize,n.uTroikaSDFExponent.value=i.sdfExponent,n.uTroikaTotalBounds.value.fromArray(u),n.uTroikaUseGlyphColors.value=!t&&!!i.glyphColors;let h=0,m=0,x=0,g,b,S,C=0,M=0;if(t){let{outlineWidth:R,outlineOffsetX:N,outlineOffsetY:B,outlineBlur:F,outlineOpacity:U}=this;h=this._parsePercent(R)||0,m=Math.max(0,this._parsePercent(F)||0),g=U,C=this._parsePercent(N)||0,M=this._parsePercent(B)||0}else x=Math.max(0,this._parsePercent(this.strokeWidth)||0),x&&(S=this.strokeColor,n.uTroikaStrokeColor.value.set(S??n3),b=this.strokeOpacity,b==null&&(b=1)),g=this.fillOpacity;n.uTroikaEdgeOffset.value=h,n.uTroikaPositionOffset.value.set(C,M),n.uTroikaBlurRadius.value=m,n.uTroikaStrokeWidth.value=x,n.uTroikaStrokeOpacity.value=b,n.uTroikaFillOpacity.value=g??1,n.uTroikaCurveRadius.value=this.curveRadius||0;let A=this.clipRect;if(A&&Array.isArray(A)&&A.length===4)n.uTroikaClipRect.value.fromArray(A);else{const R=(this.fontSize||.1)*100;n.uTroikaClipRect.value.set(u[0]-R,u[1]-R,u[2]+R,u[3]+R)}this.geometry.applyClipRect(n.uTroikaClipRect.value)}n.uTroikaSDFDebug.value=!!this.debugSDF,e.polygonOffset=!!this.depthOffset,e.polygonOffsetFactor=e.polygonOffsetUnits=this.depthOffset||0;const a=t?this.outlineColor||0:this.color;if(a==null)delete e.color;else{const c=e.hasOwnProperty("color")?e.color:e.color=new qt;(a!==c._input||typeof a=="object")&&c.set(c._input=a)}let o=this.orientation||m_;if(o!==e._orientation){let c=n.uTroikaOrient.value;o=o.replace(/[^-+xyz]/g,"");let u=o!==m_&&o.match(/^([-+])([xyz])([-+])([xyz])$/);if(u){let[,h,m,x,g]=u;jv.set(0,0,0)[m]=h==="-"?1:-1,p_.set(0,0,0)[g]=x==="-"?-1:1,i3.lookAt(j9,jv.cross(p_),p_),c.setFromMatrix4(i3)}else c.identity();e._orientation=o}}_parsePercent(e){if(typeof e=="string"){let t=e.match(/^(-?[\d.]+)%$/),n=t?parseFloat(t[1]):NaN;e=(isNaN(n)?0:n/100)*this.fontSize}return e}localPositionToTextCoords(e,t=new gt){t.copy(e);const n=this.curveRadius;return n&&(t.x=Math.atan2(e.x,Math.abs(n)-Math.abs(e.z))*Math.abs(n)),t}worldPositionToTextCoords(e,t=new gt){return jv.copy(e),this.localPositionToTextCoords(this.worldToLocal(jv),t)}raycast(e,t){const{textRenderInfo:n,curveRadius:i}=this;if(n){const a=n.blockBounds,o=i?tR():eR(),c=o.geometry,{position:u,uv:h}=c.attributes;for(let m=0;m<h.count;m++){let x=a[0]+h.getX(m)*(a[2]-a[0]);const g=a[1]+h.getY(m)*(a[3]-a[1]);let b=0;i&&(b=i-Math.cos(x/i)*i,x=Math.sin(x/i)*i),u.setXYZ(m,x,g,b)}c.boundingSphere=this.geometry.boundingSphere,c.boundingBox=this.geometry.boundingBox,o.matrixWorld=this.matrixWorld,o.material.side=this.material.side,Fm.length=0,o.raycast(e,Fm);for(let m=0;m<Fm.length;m++)Fm[m].object=this,t.push(Fm[m])}}copy(e){const t=this.geometry;return super.copy(e),this.geometry=t,V9.forEach(n=>{this[n]=e[n]}),this}clone(){return new this.constructor().copy(this)}};nR.forEach(s=>{const e="_private_"+s;Object.defineProperty(iR.prototype,s,{get(){return this[e]},set(t){t!==this[e]&&(this[e]=t,this._needsSync=!0)}})});new Yi;new qt;const s3=Y.forwardRef(({sdfGlyphSize:s=64,anchorX:e="center",anchorY:t="middle",font:n,fontSize:i=1,children:a,characters:o,onSync:c,...u},h)=>{const m=ti(({invalidate:S})=>S),[x]=Y.useState(()=>new iR),[g,b]=Y.useMemo(()=>{const S=[];let C="";return Y.Children.forEach(a,M=>{typeof M=="string"||typeof M=="number"?C+=M:S.push(M)}),[S,C]},[a]);return pT(()=>new Promise(S=>T9({font:n,characters:o},S)),["troika-text",n,o]),Y.useLayoutEffect(()=>void x.sync(()=>{m(),c&&c(x)})),Y.useEffect(()=>()=>x.dispose(),[x]),Y.createElement("primitive",fo({object:x,ref:h,font:n,text:b,anchorX:e,anchorY:t,fontSize:i,sdfGlyphSize:s},u),g)});function X9(s,e,t,n){var i;return i=class extends Ys{constructor(a){super({vertexShader:e,fragmentShader:t,...a});for(const o in s)this.uniforms[o]=new Iy(s[o]),Object.defineProperty(this,o,{get(){return this.uniforms[o].value},set(c){this.uniforms[o].value=c}});this.uniforms=Zp.clone(this.uniforms)}},i.key=zf.generateUUID(),i}const Y9=()=>parseInt(n0.replace(/\D+/g,"")),aR=Y9();let Hv=null,sR="https://www.gstatic.com/draco/versioned/decoders/1.5.5/";function rR(s=!0,e=!0,t){return n=>{t&&t(n),s&&(Hv||(Hv=new XP),Hv.setDecoderPath(typeof s=="string"?s:sR),n.setDRACOLoader(Hv)),e&&n.setMeshoptDecoder(typeof h_=="function"?h_():h_)}}const Hy=(s,e,t,n)=>$c(nA,s,rR(e,t,n));Hy.preload=(s,e,t,n)=>$c.preload(nA,s,rR(e,t,n));Hy.clear=s=>$c.clear(nA,s);Hy.setDecoderPath=s=>{sR=s};function W9(s,e,t){const n=ti(b=>b.size),i=ti(b=>b.viewport),a=typeof s=="number"?s:n.width*i.dpr,o=n.height*i.dpr,c=(typeof s=="number"?t:s)||{},{samples:u=0,depth:h,...m}=c,x=h??c.depthBuffer,g=Y.useMemo(()=>{const b=new qo(a,o,{minFilter:bi,magFilter:bi,type:xs,...m});return x&&(b.depthTexture=new _y(a,o,Da)),b.samples=u,b},[]);return Y.useLayoutEffect(()=>{g.setSize(a,o),u&&(g.samples=u)},[u,g,a,o]),Y.useEffect(()=>()=>g.dispose(),[]),g}const q9=s=>typeof s=="function",J9=Y.forwardRef(({envMap:s,resolution:e=256,frames:t=1/0,children:n,makeDefault:i,...a},o)=>{const c=ti(({set:M})=>M),u=ti(({camera:M})=>M),h=ti(({size:M})=>M),m=Y.useRef(null);Y.useImperativeHandle(o,()=>m.current,[]);const x=Y.useRef(null),g=W9(e);Y.useLayoutEffect(()=>{a.manual||m.current.updateProjectionMatrix()},[h,a]),Y.useLayoutEffect(()=>{m.current.updateProjectionMatrix()}),Y.useLayoutEffect(()=>{if(i){const M=u;return c(()=>({camera:m.current})),()=>c(()=>({camera:M}))}},[m,i,c]);let b=0,S=null;const C=q9(n);return Rl(M=>{C&&(t===1/0||b<t)&&(x.current.visible=!1,M.gl.setRenderTarget(g),S=M.scene.background,s&&(M.scene.background=s),M.gl.render(M.scene,m.current),M.scene.background=S,M.gl.setRenderTarget(null),x.current.visible=!0,b++)}),Y.createElement(Y.Fragment,null,Y.createElement("orthographicCamera",fo({left:h.width/-2,right:h.width/2,top:h.height/2,bottom:h.height/-2,ref:m},a),!C&&n),Y.createElement("group",{ref:x},C&&n(g.texture)))}),Z9=Y.forwardRef(({makeDefault:s,camera:e,regress:t,domElement:n,enableDamping:i=!0,keyEvents:a=!1,onChange:o,onStart:c,onEnd:u,...h},m)=>{const x=ti(U=>U.invalidate),g=ti(U=>U.camera),b=ti(U=>U.gl),S=ti(U=>U.events),C=ti(U=>U.setEvents),M=ti(U=>U.set),A=ti(U=>U.get),R=ti(U=>U.performance),N=e||g,B=n||S.connected||b.domElement,F=Y.useMemo(()=>new oP(N),[N]);return Rl(()=>{F.enabled&&F.update()},-1),Y.useEffect(()=>(a&&F.connect(a===!0?B:a),F.connect(B),()=>void F.dispose()),[a,B,t,F,x]),Y.useEffect(()=>{const U=L=>{x(),t&&R.regress(),o&&o(L)},z=L=>{c&&c(L)},P=L=>{u&&u(L)};return F.addEventListener("change",U),F.addEventListener("start",z),F.addEventListener("end",P),()=>{F.removeEventListener("start",z),F.removeEventListener("end",P),F.removeEventListener("change",U)}},[o,c,u,F,x,C]),Y.useEffect(()=>{if(s){const U=A().controls;return M({controls:F}),()=>M({controls:U})}},[s,F]),Y.createElement("primitive",fo({ref:m,object:F,enableDamping:i},h))}),lc=Y.forwardRef(({children:s,domElement:e,onChange:t,onMouseDown:n,onMouseUp:i,onObjectChange:a,object:o,makeDefault:c,camera:u,enabled:h,axis:m,mode:x,translationSnap:g,rotationSnap:b,scaleSnap:S,space:C,size:M,showX:A,showY:R,showZ:N,...B},F)=>{const U=ti(I=>I.controls),z=ti(I=>I.gl),P=ti(I=>I.events),L=ti(I=>I.camera),O=ti(I=>I.invalidate),ee=ti(I=>I.get),Q=ti(I=>I.set),te=u||L,ne=e||P.connected||z.domElement,re=Y.useMemo(()=>new tP(te,ne),[te,ne]),j=Y.useRef(null);Y.useLayoutEffect(()=>(o?re.attach(o instanceof ai?o:o.current):j.current instanceof ai&&re.attach(j.current),()=>void re.detach()),[o,s,re]),Y.useEffect(()=>{if(U){const I=W=>U.enabled=!W.value;return re.addEventListener("dragging-changed",I),()=>re.removeEventListener("dragging-changed",I)}},[re,U]);const ae=Y.useRef(void 0),J=Y.useRef(void 0),ie=Y.useRef(void 0),se=Y.useRef(void 0);return Y.useLayoutEffect(()=>void(ae.current=t),[t]),Y.useLayoutEffect(()=>void(J.current=n),[n]),Y.useLayoutEffect(()=>void(ie.current=i),[i]),Y.useLayoutEffect(()=>void(se.current=a),[a]),Y.useEffect(()=>{const I=me=>{O(),ae.current==null||ae.current(me)},W=me=>J.current==null?void 0:J.current(me),fe=me=>ie.current==null?void 0:ie.current(me),Z=me=>se.current==null?void 0:se.current(me);return re.addEventListener("change",I),re.addEventListener("mouseDown",W),re.addEventListener("mouseUp",fe),re.addEventListener("objectChange",Z),()=>{re.removeEventListener("change",I),re.removeEventListener("mouseDown",W),re.removeEventListener("mouseUp",fe),re.removeEventListener("objectChange",Z)}},[O,re]),Y.useEffect(()=>{if(c){const I=ee().controls;return Q({controls:re}),()=>Q({controls:I})}},[c,re]),Y.createElement(Y.Fragment,null,Y.createElement("primitive",{ref:F,object:re,enabled:h,axis:m,mode:x,translationSnap:g,rotationSnap:b,scaleSnap:S,space:C,size:M,showX:A,showY:R,showZ:N}),Y.createElement("group",fo({ref:j},B),s))});function K9({defaultScene:s,defaultCamera:e,renderPriority:t=1}){const{gl:n,scene:i,camera:a}=ti();let o;return Rl(()=>{o=n.autoClear,t===1&&(n.autoClear=!0,n.render(s,e)),n.autoClear=!1,n.clearDepth(),n.render(i,a),n.autoClear=o},t),Y.createElement("group",{onPointerOver:()=>null})}function Q9({children:s,renderPriority:e=1}){const{scene:t,camera:n}=ti(),[i]=Y.useState(()=>new a0);return Y.createElement(Y.Fragment,null,BT(Y.createElement(Y.Fragment,null,s,Y.createElement(K9,{defaultScene:t,defaultCamera:n,renderPriority:e})),i,{events:{priority:e+1}}))}const oR=Y.createContext({}),lR=()=>Y.useContext(oR),$9=2*Math.PI,x_=new ai,r3=new wn,[Rp,g_]=[new Fn,new Fn],o3=new k,l3=new k,eG=s=>"minPolarAngle"in s,c3=s=>"getTarget"in s,tG=({alignment:s="bottom-right",margin:e=[80,80],renderPriority:t=1,onUpdate:n,onTarget:i,children:a})=>{const o=ti(U=>U.size),c=ti(U=>U.camera),u=ti(U=>U.controls),h=ti(U=>U.invalidate),m=Y.useRef(null),x=Y.useRef(null),g=Y.useRef(!1),b=Y.useRef(0),S=Y.useRef(new k(0,0,0)),C=Y.useRef(new k(0,0,0));Y.useEffect(()=>{C.current.copy(c.up),x_.up.copy(c.up)},[c]);const M=Y.useCallback(U=>{g.current=!0,(u||i)&&(S.current=(i==null?void 0:i())||(c3(u)?u.getTarget(S.current):u==null?void 0:u.target)),b.current=c.position.distanceTo(o3),Rp.copy(c.quaternion),l3.copy(U).multiplyScalar(b.current).add(o3),x_.lookAt(l3),g_.copy(x_.quaternion),h()},[u,c,i,h]);Rl((U,z)=>{if(x.current&&m.current){var P;if(g.current)if(Rp.angleTo(g_)<.01)g.current=!1,eG(u)&&c.up.copy(C.current);else{const L=z*$9;Rp.rotateTowards(g_,L),c.position.set(0,0,1).applyQuaternion(Rp).multiplyScalar(b.current).add(S.current),c.up.set(0,1,0).applyQuaternion(Rp).normalize(),c.quaternion.copy(Rp),c3(u)&&u.setPosition(c.position.x,c.position.y,c.position.z),n?n():u&&u.update(z),h()}r3.copy(c.matrix).invert(),(P=m.current)==null||P.quaternion.setFromRotationMatrix(r3)}});const A=Y.useMemo(()=>({tweenCamera:M}),[M]),[R,N]=e,B=s.endsWith("-center")?0:s.endsWith("-left")?-o.width/2+R:o.width/2-R,F=s.startsWith("center-")?0:s.startsWith("top-")?o.height/2-N:-o.height/2+N;return Y.createElement(Q9,{renderPriority:t},Y.createElement(oR.Provider,{value:A},Y.createElement(J9,{makeDefault:!0,ref:x,position:[0,0,200]}),Y.createElement("group",{ref:m,position:[B,F,0]},a)))},Vm={bg:"#f0f0f0",hover:"#999",text:"black",stroke:"black"},nG=["Right","Left","Top","Bottom","Front","Back"],cR=s=>new k(...s).multiplyScalar(.38),iG=[[1,1,1],[1,1,-1],[1,-1,1],[1,-1,-1],[-1,1,1],[-1,1,-1],[-1,-1,1],[-1,-1,-1]].map(cR),aG=[.25,.25,.25],uR=[[1,1,0],[1,0,1],[1,0,-1],[1,-1,0],[0,1,1],[0,1,-1],[0,-1,1],[0,-1,-1],[-1,1,0],[-1,0,1],[-1,0,-1],[-1,-1,0]].map(cR),sG=uR.map(s=>s.toArray().map(e=>e==0?.5:.25)),rG=({hover:s,index:e,font:t="20px Inter var, Arial, sans-serif",faces:n=nG,color:i=Vm.bg,hoverColor:a=Vm.hover,textColor:o=Vm.text,strokeColor:c=Vm.stroke,opacity:u=1})=>{const h=ti(x=>x.gl),m=Y.useMemo(()=>{const x=document.createElement("canvas");x.width=128,x.height=128;const g=x.getContext("2d");return g.fillStyle=i,g.fillRect(0,0,x.width,x.height),g.strokeStyle=c,g.strokeRect(0,0,x.width,x.height),g.font=t,g.textAlign="center",g.fillStyle=o,g.fillText(n[e].toUpperCase(),64,76),new yC(x)},[e,n,t,i,o,c]);return Y.createElement("meshBasicMaterial",{map:m,"map-anisotropy":h.capabilities.getMaxAnisotropy()||1,attach:`material-${e}`,color:s?a:"white",transparent:!0,opacity:u})},oG=s=>{const{tweenCamera:e}=lR(),[t,n]=Y.useState(null),i=c=>{c.stopPropagation(),n(null)},a=c=>{c.stopPropagation(),e(c.face.normal)},o=c=>{c.stopPropagation(),n(Math.floor(c.faceIndex/2))};return Y.createElement("mesh",{onPointerOut:i,onPointerMove:o,onClick:s.onClick||a},[...Array(6)].map((c,u)=>Y.createElement(rG,fo({key:u,index:u,hover:t===u},s))),Y.createElement("boxGeometry",null))},u3=({onClick:s,dimensions:e,position:t,hoverColor:n=Vm.hover})=>{const{tweenCamera:i}=lR(),[a,o]=Y.useState(!1),c=m=>{m.stopPropagation(),o(!1)},u=m=>{m.stopPropagation(),o(!0)},h=m=>{m.stopPropagation(),i(t)};return Y.createElement("mesh",{scale:1.01,position:t,onPointerOver:u,onPointerOut:c,onClick:s||h},Y.createElement("meshBasicMaterial",{color:a?n:"white",transparent:!0,opacity:.6,visible:a}),Y.createElement("boxGeometry",{args:e}))},lG=s=>Y.createElement("group",{scale:[60,60,60]},Y.createElement(oG,s),uR.map((e,t)=>Y.createElement(u3,fo({key:t,position:e,dimensions:sG[t]},s))),iG.map((e,t)=>Y.createElement(u3,fo({key:t,position:e,dimensions:aG},s)))),cG=X9({cellSize:.5,sectionSize:1,fadeDistance:100,fadeStrength:1,fadeFrom:1,cellThickness:.5,sectionThickness:1,cellColor:new qt,sectionColor:new qt,infiniteGrid:!1,followCamera:!1,worldCamProjPosition:new k,worldPlanePosition:new k},`
    varying vec3 localPosition;
    varying vec4 worldPosition;

    uniform vec3 worldCamProjPosition;
    uniform vec3 worldPlanePosition;
    uniform float fadeDistance;
    uniform bool infiniteGrid;
    uniform bool followCamera;

    void main() {
      localPosition = position.xzy;
      if (infiniteGrid) localPosition *= 1.0 + fadeDistance;
      
      worldPosition = modelMatrix * vec4(localPosition, 1.0);
      if (followCamera) {
        worldPosition.xyz += (worldCamProjPosition - worldPlanePosition);
        localPosition = (inverse(modelMatrix) * worldPosition).xyz;
      }

      gl_Position = projectionMatrix * viewMatrix * worldPosition;
    }
  `,`
    varying vec3 localPosition;
    varying vec4 worldPosition;

    uniform vec3 worldCamProjPosition;
    uniform float cellSize;
    uniform float sectionSize;
    uniform vec3 cellColor;
    uniform vec3 sectionColor;
    uniform float fadeDistance;
    uniform float fadeStrength;
    uniform float fadeFrom;
    uniform float cellThickness;
    uniform float sectionThickness;

    float getGrid(float size, float thickness) {
      vec2 r = localPosition.xz / size;
      vec2 grid = abs(fract(r - 0.5) - 0.5) / fwidth(r);
      float line = min(grid.x, grid.y) + 1.0 - thickness;
      return 1.0 - min(line, 1.0);
    }

    void main() {
      float g1 = getGrid(cellSize, cellThickness);
      float g2 = getGrid(sectionSize, sectionThickness);

      vec3 from = worldCamProjPosition*vec3(fadeFrom);
      float dist = distance(from, worldPosition.xyz);
      float d = 1.0 - min(dist / fadeDistance, 1.0);
      vec3 color = mix(cellColor, sectionColor, min(1.0, sectionThickness * g2));

      gl_FragColor = vec4(color, (g1 + g2) * pow(d, fadeStrength));
      gl_FragColor.a = mix(0.75 * gl_FragColor.a, gl_FragColor.a, g2);
      if (gl_FragColor.a <= 0.0) discard;

      #include <tonemapping_fragment>
      #include <${aR>=154?"colorspace_fragment":"encodings_fragment"}>
    }
  `),fR=Y.forwardRef(({args:s,cellColor:e="#000000",sectionColor:t="#2080ff",cellSize:n=.5,sectionSize:i=1,followCamera:a=!1,infiniteGrid:o=!1,fadeDistance:c=100,fadeStrength:u=1,fadeFrom:h=1,cellThickness:m=.5,sectionThickness:x=1,side:g=fr,...b},S)=>{QS({GridMaterial:cG});const C=Y.useRef(null);Y.useImperativeHandle(S,()=>C.current,[]);const M=new rc,A=new k(0,1,0),R=new k(0,0,0);Rl(F=>{M.setFromNormalAndCoplanarPoint(A,R).applyMatrix4(C.current.matrixWorld);const U=C.current.material,z=U.uniforms.worldCamProjPosition,P=U.uniforms.worldPlanePosition;M.projectPoint(F.camera.position,z.value),P.value.set(0,0,0).applyMatrix4(C.current.matrixWorld)});const N={cellSize:n,sectionSize:i,cellColor:e,sectionColor:t,cellThickness:m,sectionThickness:x},B={fadeDistance:c,fadeStrength:u,fadeFrom:h,infiniteGrid:o,followCamera:a};return Y.createElement("mesh",fo({ref:C,frustumCulled:!1},b),Y.createElement("gridMaterial",fo({transparent:!0,"extensions-derivatives":!0,side:g},N,B)),Y.createElement("planeGeometry",{args:s}))}),hR=(s,e,t)=>{let n;switch(s){case uo:n=new Uint8ClampedArray(e*t*4);break;case xs:n=new Uint16Array(e*t*4);break;case Qc:n=new Uint32Array(e*t*4);break;case sy:n=new Int8Array(e*t*4);break;case ry:n=new Int16Array(e*t*4);break;case _x:n=new Int32Array(e*t*4);break;case Da:n=new Float32Array(e*t*4);break;default:throw new Error("Unsupported data type")}return n};let kv;const uG=(s,e,t,n)=>{if(kv!==void 0)return kv;const i=new qo(1,1,n);e.setRenderTarget(i);const a=new sn(new is,new ur({color:16777215}));e.render(a,t),e.setRenderTarget(null);const o=hR(s,i.width,i.height);return e.readRenderTargetPixels(i,0,0,i.width,i.height,o),i.dispose(),a.geometry.dispose(),a.material.dispose(),kv=o[0]!==0,kv};class rA{constructor(e){Ja(this,"_renderer");Ja(this,"_rendererIsDisposable",!1);Ja(this,"_material");Ja(this,"_scene");Ja(this,"_camera");Ja(this,"_quad");Ja(this,"_renderTarget");Ja(this,"_width");Ja(this,"_height");Ja(this,"_type");Ja(this,"_colorSpace");Ja(this,"_supportsReadPixels",!0);Ja(this,"render",()=>{this._renderer.setRenderTarget(this._renderTarget);try{this._renderer.render(this._scene,this._camera)}catch(e){throw this._renderer.setRenderTarget(null),e}this._renderer.setRenderTarget(null)});var n,i,a,o,c,u,h,m,x,g,b,S,C,M,A,R;this._width=e.width,this._height=e.height,this._type=e.type,this._colorSpace=e.colorSpace;const t={format:ss,depthBuffer:!1,stencilBuffer:!1,type:this._type,colorSpace:this._colorSpace,anisotropy:((n=e.renderTargetOptions)==null?void 0:n.anisotropy)!==void 0?(i=e.renderTargetOptions)==null?void 0:i.anisotropy:1,generateMipmaps:((a=e.renderTargetOptions)==null?void 0:a.generateMipmaps)!==void 0?(o=e.renderTargetOptions)==null?void 0:o.generateMipmaps:!1,magFilter:((c=e.renderTargetOptions)==null?void 0:c.magFilter)!==void 0?(u=e.renderTargetOptions)==null?void 0:u.magFilter:bi,minFilter:((h=e.renderTargetOptions)==null?void 0:h.minFilter)!==void 0?(m=e.renderTargetOptions)==null?void 0:m.minFilter:bi,samples:((x=e.renderTargetOptions)==null?void 0:x.samples)!==void 0?(g=e.renderTargetOptions)==null?void 0:g.samples:void 0,wrapS:((b=e.renderTargetOptions)==null?void 0:b.wrapS)!==void 0?(S=e.renderTargetOptions)==null?void 0:S.wrapS:Pa,wrapT:((C=e.renderTargetOptions)==null?void 0:C.wrapT)!==void 0?(M=e.renderTargetOptions)==null?void 0:M.wrapT:Pa};if(this._material=e.material,e.renderer?this._renderer=e.renderer:(this._renderer=rA.instantiateRenderer(),this._rendererIsDisposable=!0),this._scene=new a0,this._camera=new El,this._camera.position.set(0,0,10),this._camera.left=-.5,this._camera.right=.5,this._camera.top=.5,this._camera.bottom=-.5,this._camera.updateProjectionMatrix(),!uG(this._type,this._renderer,this._camera,t)){let N;switch(this._type){case xs:N=this._renderer.extensions.has("EXT_color_buffer_float")?Da:void 0;break}N!==void 0?(console.warn(`This browser does not support reading pixels from ${this._type} RenderTargets, switching to ${Da}`),this._type=N):(this._supportsReadPixels=!1,console.warn("This browser dos not support toArray or toDataTexture, calls to those methods will result in an error thrown"))}this._quad=new sn(new is,this._material),this._quad.geometry.computeBoundingBox(),this._scene.add(this._quad),this._renderTarget=new qo(this.width,this.height,t),this._renderTarget.texture.mapping=((A=e.renderTargetOptions)==null?void 0:A.mapping)!==void 0?(R=e.renderTargetOptions)==null?void 0:R.mapping:Uf}static instantiateRenderer(){const e=new YS;return e.setSize(128,128),e}toArray(){if(!this._supportsReadPixels)throw new Error("Can't read pixels in this browser");const e=hR(this._type,this._width,this._height);return this._renderer.readRenderTargetPixels(this._renderTarget,0,0,this._width,this._height,e),e}toDataTexture(e){const t=new wl(this.toArray(),this.width,this.height,ss,this._type,(e==null?void 0:e.mapping)||Uf,(e==null?void 0:e.wrapS)||Pa,(e==null?void 0:e.wrapT)||Pa,(e==null?void 0:e.magFilter)||bi,(e==null?void 0:e.minFilter)||bi,(e==null?void 0:e.anisotropy)||1,uc);return t.generateMipmaps=(e==null?void 0:e.generateMipmaps)!==void 0?e==null?void 0:e.generateMipmaps:!1,t}disposeOnDemandRenderer(){this._renderer.setRenderTarget(null),this._rendererIsDisposable&&(this._renderer.dispose(),this._renderer.forceContextLoss())}dispose(e){this.disposeOnDemandRenderer(),e&&this.renderTarget.dispose(),this.material instanceof Ys&&Object.values(this.material.uniforms).forEach(t=>{t.value instanceof Wi&&t.value.dispose()}),Object.values(this.material).forEach(t=>{t instanceof Wi&&t.dispose()}),this.material.dispose(),this._quad.geometry.dispose()}get width(){return this._width}set width(e){this._width=e,this._renderTarget.setSize(this._width,this._height)}get height(){return this._height}set height(e){this._height=e,this._renderTarget.setSize(this._width,this._height)}get renderer(){return this._renderer}get renderTarget(){return this._renderTarget}set renderTarget(e){this._renderTarget=e,this._width=e.width,this._height=e.height}get material(){return this._material}get type(){return this._type}get colorSpace(){return this._colorSpace}}class dR extends Error{}class pR extends Error{}const Pm=(s,e,t)=>{const n=new RegExp(`${e}="([^"]*)"`,"i").exec(s);if(n)return n[1];const i=new RegExp(`<${e}[^>]*>([\\s\\S]*?)</${e}>`,"i").exec(s);if(i){const a=i[1].match(/<rdf:li>([^<]*)<\/rdf:li>/g);return a&&a.length===3?a.map(o=>o.replace(/<\/?rdf:li>/g,"")):i[1].trim()}if(t!==void 0)return t;throw new Error(`Can't find ${e} in gainmap metadata`)},fG=s=>{let e;typeof TextDecoder<"u"?e=new TextDecoder().decode(s):e=s.toString();let t=e.indexOf("<x:xmpmeta");for(;t!==-1;){const n=e.indexOf("x:xmpmeta>",t),i=e.slice(t,n+10);try{const a=Pm(i,"hdrgm:GainMapMin","0"),o=Pm(i,"hdrgm:GainMapMax"),c=Pm(i,"hdrgm:Gamma","1"),u=Pm(i,"hdrgm:OffsetSDR","0.015625"),h=Pm(i,"hdrgm:OffsetHDR","0.015625"),m=/hdrgm:HDRCapacityMin="([^"]*)"/.exec(i),x=m?m[1]:"0",g=/hdrgm:HDRCapacityMax="([^"]*)"/.exec(i);if(!g)throw new Error("Incomplete gainmap metadata");const b=g[1];return{gainMapMin:Array.isArray(a)?a.map(S=>parseFloat(S)):[parseFloat(a),parseFloat(a),parseFloat(a)],gainMapMax:Array.isArray(o)?o.map(S=>parseFloat(S)):[parseFloat(o),parseFloat(o),parseFloat(o)],gamma:Array.isArray(c)?c.map(S=>parseFloat(S)):[parseFloat(c),parseFloat(c),parseFloat(c)],offsetSdr:Array.isArray(u)?u.map(S=>parseFloat(S)):[parseFloat(u),parseFloat(u),parseFloat(u)],offsetHdr:Array.isArray(h)?h.map(S=>parseFloat(S)):[parseFloat(h),parseFloat(h),parseFloat(h)],hdrCapacityMin:parseFloat(x),hdrCapacityMax:parseFloat(b)}}catch{}t=e.indexOf("<x:xmpmeta",n)}};class hG{constructor(e){Ja(this,"options");this.options={debug:e&&e.debug!==void 0?e.debug:!1,extractFII:e&&e.extractFII!==void 0?e.extractFII:!0,extractNonFII:e&&e.extractNonFII!==void 0?e.extractNonFII:!0}}extract(e){return new Promise((t,n)=>{const i=this.options.debug,a=new DataView(e.buffer);if(a.getUint16(0)!==65496){n(new Error("Not a valid jpeg"));return}const o=a.byteLength;let c=2,u=0,h;for(;c<o;){if(++u>250){n(new Error(`Found no marker after ${u} loops `));return}if(a.getUint8(c)!==255){n(new Error(`Not a valid marker at offset 0x${c.toString(16)}, found: 0x${a.getUint8(c).toString(16)}`));return}if(h=a.getUint8(c+1),i&&console.log(`Marker: ${h.toString(16)}`),h===226){i&&console.log("Found APP2 marker (0xffe2)");const m=c+4;if(a.getUint32(m)===1297106432){const x=m+4;let g;if(a.getUint16(x)===18761)g=!1;else if(a.getUint16(x)===19789)g=!0;else{n(new Error("No valid endianness marker found in TIFF header"));return}if(a.getUint16(x+2,!g)!==42){n(new Error("Not valid TIFF data! (no 0x002A marker)"));return}const b=a.getUint32(x+4,!g);if(b<8){n(new Error("Not valid TIFF data! (First offset less than 8)"));return}const S=x+b,C=a.getUint16(S,!g),M=S+2;let A=0;for(let F=M;F<M+12*C;F+=12)a.getUint16(F,!g)===45057&&(A=a.getUint32(F+8,!g));const N=S+2+C*12+4,B=[];for(let F=N;F<N+A*16;F+=16){const U={MPType:a.getUint32(F,!g),size:a.getUint32(F+4,!g),dataOffset:a.getUint32(F+8,!g),dependantImages:a.getUint32(F+12,!g),start:-1,end:-1,isFII:!1};U.dataOffset?(U.start=x+U.dataOffset,U.isFII=!1):(U.start=0,U.isFII=!0),U.end=U.start+U.size,B.push(U)}if(this.options.extractNonFII&&B.length){const F=new Blob([a]),U=[];for(const z of B){if(z.isFII&&!this.options.extractFII)continue;const P=F.slice(z.start,z.end+1,"image/jpeg");U.push(P)}t(U)}}}c+=2+a.getUint16(c+2)}})}}const dG=async s=>{const e=fG(s);if(!e)throw new pR("Gain map XMP metadata not found");const n=await new hG({extractFII:!0,extractNonFII:!0}).extract(s);if(n.length!==2)throw new dR("Gain map recovery image not found");return{sdr:new Uint8Array(await n[0].arrayBuffer()),gainMap:new Uint8Array(await n[1].arrayBuffer()),metadata:e}},f3=s=>new Promise((e,t)=>{const n=document.createElement("img");n.onload=()=>{e(n)},n.onerror=i=>{t(i)},n.src=URL.createObjectURL(s)});class pG extends Ws{constructor(t,n){super(n);Ja(this,"_renderer");Ja(this,"_renderTargetOptions");Ja(this,"_internalLoadingManager");Ja(this,"_config");this._config=t,t.renderer&&(this._renderer=t.renderer),this._internalLoadingManager=new Uy}setRenderer(t){return this._renderer=t,this}setRenderTargetOptions(t){return this._renderTargetOptions=t,this}prepareQuadRenderer(){this._renderer||console.warn("WARNING: A Renderer was not passed to this Loader constructor or in setRenderer, the result of this Loader will need to be converted to a Data Texture with toDataTexture() before you can use it in your renderer.");const t=this._config.createMaterial({gainMapMax:[1,1,1],gainMapMin:[0,0,0],gamma:[1,1,1],offsetHdr:[1,1,1],offsetSdr:[1,1,1],hdrCapacityMax:1,hdrCapacityMin:0,maxDisplayBoost:1,gainMap:new Wi,sdr:new Wi});return this._config.createQuadRenderer({width:16,height:16,type:xs,colorSpace:uc,material:t,renderer:this._renderer,renderTargetOptions:this._renderTargetOptions})}async processImages(t,n,i){const a=n?new Blob([n],{type:"image/jpeg"}):void 0,o=new Blob([t],{type:"image/jpeg"});let c,u,h=!1;if(typeof createImageBitmap>"u"){const m=await Promise.all([a?f3(a):Promise.resolve(void 0),f3(o)]);u=m[0],c=m[1],h=i==="flipY"}else{const m=await Promise.all([a?createImageBitmap(a,{imageOrientation:i||"flipY"}):Promise.resolve(void 0),createImageBitmap(o,{imageOrientation:i||"flipY"})]);u=m[0],c=m[1]}return{sdrImage:c,gainMapImage:u,needsFlip:h}}createTextures(t,n,i){const a=new Wi(n||new ImageData(2,2),Uf,Pa,Pa,bi,C_,ss,uo,1,uc);a.flipY=i,a.needsUpdate=!0;const o=new Wi(t,Uf,Pa,Pa,bi,C_,ss,uo,1,Hs);return o.flipY=i,o.needsUpdate=!0,{gainMap:a,sdr:o}}updateQuadRenderer(t,n,i,a,o){t.width=n.width,t.height=n.height,t.material.gainMap=i,t.material.sdr=a,t.material.gainMapMin=o.gainMapMin,t.material.gainMapMax=o.gainMapMax,t.material.offsetHdr=o.offsetHdr,t.material.offsetSdr=o.offsetSdr,t.material.gamma=o.gamma,t.material.hdrCapacityMin=o.hdrCapacityMin,t.material.hdrCapacityMax=o.hdrCapacityMax,t.material.maxDisplayBoost=Math.pow(2,o.hdrCapacityMax),t.material.needsUpdate=!0}}const mG=`
varying vec2 vUv;

void main() {
  vUv = uv;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
`,xG=`
// min half float value
#define HALF_FLOAT_MIN vec3( -65504, -65504, -65504 )
// max half float value
#define HALF_FLOAT_MAX vec3( 65504, 65504, 65504 )

uniform sampler2D sdr;
uniform sampler2D gainMap;
uniform vec3 gamma;
uniform vec3 offsetHdr;
uniform vec3 offsetSdr;
uniform vec3 gainMapMin;
uniform vec3 gainMapMax;
uniform float weightFactor;

varying vec2 vUv;

void main() {
  vec3 rgb = texture2D( sdr, vUv ).rgb;
  vec3 recovery = texture2D( gainMap, vUv ).rgb;
  vec3 logRecovery = pow( recovery, gamma );
  vec3 logBoost = gainMapMin * ( 1.0 - logRecovery ) + gainMapMax * logRecovery;
  vec3 hdrColor = (rgb + offsetSdr) * exp2( logBoost * weightFactor ) - offsetHdr;
  vec3 clampedHdrColor = max( HALF_FLOAT_MIN, min( HALF_FLOAT_MAX, hdrColor ));
  gl_FragColor = vec4( clampedHdrColor , 1.0 );
}
`;class gG extends Ys{constructor({gamma:t,offsetHdr:n,offsetSdr:i,gainMapMin:a,gainMapMax:o,maxDisplayBoost:c,hdrCapacityMin:u,hdrCapacityMax:h,sdr:m,gainMap:x}){super({name:"GainMapDecoderMaterial",vertexShader:mG,fragmentShader:xG,uniforms:{sdr:{value:m},gainMap:{value:x},gamma:{value:new k(1/t[0],1/t[1],1/t[2])},offsetHdr:{value:new k().fromArray(n)},offsetSdr:{value:new k().fromArray(i)},gainMapMin:{value:new k().fromArray(a)},gainMapMax:{value:new k().fromArray(o)},weightFactor:{value:(Math.log2(c)-u)/(h-u)}},blending:cc,depthTest:!1,depthWrite:!1});Ja(this,"_maxDisplayBoost");Ja(this,"_hdrCapacityMin");Ja(this,"_hdrCapacityMax");this._maxDisplayBoost=c,this._hdrCapacityMin=u,this._hdrCapacityMax=h,this.needsUpdate=!0,this.uniformsNeedUpdate=!0}get sdr(){return this.uniforms.sdr.value}set sdr(t){this.uniforms.sdr.value=t}get gainMap(){return this.uniforms.gainMap.value}set gainMap(t){this.uniforms.gainMap.value=t}get offsetHdr(){return this.uniforms.offsetHdr.value.toArray()}set offsetHdr(t){this.uniforms.offsetHdr.value.fromArray(t)}get offsetSdr(){return this.uniforms.offsetSdr.value.toArray()}set offsetSdr(t){this.uniforms.offsetSdr.value.fromArray(t)}get gainMapMin(){return this.uniforms.gainMapMin.value.toArray()}set gainMapMin(t){this.uniforms.gainMapMin.value.fromArray(t)}get gainMapMax(){return this.uniforms.gainMapMax.value.toArray()}set gainMapMax(t){this.uniforms.gainMapMax.value.fromArray(t)}get gamma(){const t=this.uniforms.gamma.value;return[1/t.x,1/t.y,1/t.z]}set gamma(t){const n=this.uniforms.gamma.value;n.x=1/t[0],n.y=1/t[1],n.z=1/t[2]}get hdrCapacityMin(){return this._hdrCapacityMin}set hdrCapacityMin(t){this._hdrCapacityMin=t,this.calculateWeight()}get hdrCapacityMax(){return this._hdrCapacityMax}set hdrCapacityMax(t){this._hdrCapacityMax=t,this.calculateWeight()}get maxDisplayBoost(){return this._maxDisplayBoost}set maxDisplayBoost(t){this._maxDisplayBoost=Math.max(1,Math.min(65504,t)),this.calculateWeight()}calculateWeight(){const t=(Math.log2(this._maxDisplayBoost)-this._hdrCapacityMin)/(this._hdrCapacityMax-this._hdrCapacityMin);this.uniforms.weightFactor.value=Math.max(0,Math.min(1,t))}}class mR extends pG{constructor(e,t){super({renderer:e,createMaterial:n=>new gG(n),createQuadRenderer:n=>new rA(n)},t)}async render(e,t,n,i){const{sdrImage:a,gainMapImage:o,needsFlip:c}=await this.processImages(n,i,"flipY"),{gainMap:u,sdr:h}=this.createTextures(a,o,c);this.updateQuadRenderer(e,a,u,h,t),e.render()}}class vG extends mR{load([e,t,n],i,a,o){const c=this.prepareQuadRenderer();let u,h,m;const x=async()=>{if(u&&h&&m){try{await this.render(c,m,u,h)}catch(L){this.manager.itemError(e),this.manager.itemError(t),this.manager.itemError(n),typeof o=="function"&&o(L),c.disposeOnDemandRenderer();return}typeof i=="function"&&i(c),this.manager.itemEnd(e),this.manager.itemEnd(t),this.manager.itemEnd(n),c.disposeOnDemandRenderer()}};let g=!0,b=0,S=0,C=!0,M=0,A=0,R=!0,N=0,B=0;const F=()=>{if(typeof a=="function"){const L=b+M+N,O=S+A+B,ee=g&&C&&R;a(new ProgressEvent("progress",{lengthComputable:ee,loaded:O,total:L}))}};this.manager.itemStart(e),this.manager.itemStart(t),this.manager.itemStart(n);const U=new Xs(this._internalLoadingManager);U.setResponseType("arraybuffer"),U.setRequestHeader(this.requestHeader),U.setPath(this.path),U.setWithCredentials(this.withCredentials),U.load(e,async L=>{if(typeof L=="string")throw new Error("Invalid sdr buffer");u=L,await x()},L=>{g=L.lengthComputable,S=L.loaded,b=L.total,F()},L=>{this.manager.itemError(e),typeof o=="function"&&o(L)});const z=new Xs(this._internalLoadingManager);z.setResponseType("arraybuffer"),z.setRequestHeader(this.requestHeader),z.setPath(this.path),z.setWithCredentials(this.withCredentials),z.load(t,async L=>{if(typeof L=="string")throw new Error("Invalid gainmap buffer");h=L,await x()},L=>{C=L.lengthComputable,A=L.loaded,M=L.total,F()},L=>{this.manager.itemError(t),typeof o=="function"&&o(L)});const P=new Xs(this._internalLoadingManager);return P.setRequestHeader(this.requestHeader),P.setPath(this.path),P.setWithCredentials(this.withCredentials),P.load(n,async L=>{if(typeof L!="string")throw new Error("Invalid metadata string");m=JSON.parse(L),await x()},L=>{R=L.lengthComputable,B=L.loaded,N=L.total,F()},L=>{this.manager.itemError(n),typeof o=="function"&&o(L)}),c}}class yG extends mR{load(e,t,n,i){const a=this.prepareQuadRenderer(),o=new Xs(this._internalLoadingManager);return o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.setWithCredentials(this.withCredentials),this.manager.itemStart(e),o.load(e,async c=>{if(typeof c=="string")throw new Error("Invalid buffer, received [string], was expecting [ArrayBuffer]");const u=new Uint8Array(c);let h,m,x;try{const g=await dG(u);h=g.sdr,m=g.gainMap,x=g.metadata}catch(g){if(g instanceof pR||g instanceof dR)console.warn(`Failure to reconstruct an HDR image from ${e}: Gain map metadata not found in the file, HDRJPGLoader will render the SDR jpeg`),x={gainMapMin:[0,0,0],gainMapMax:[1,1,1],gamma:[1,1,1],hdrCapacityMin:0,hdrCapacityMax:1,offsetHdr:[0,0,0],offsetSdr:[0,0,0]},h=u;else throw g}try{await this.render(a,x,h.buffer,m==null?void 0:m.buffer)}catch(g){this.manager.itemError(e),typeof i=="function"&&i(g),a.disposeOnDemandRenderer();return}typeof t=="function"&&t(a),this.manager.itemEnd(e),a.disposeOnDemandRenderer()},n,c=>{this.manager.itemError(e),typeof i=="function"&&i(c)}),a}}const xx={apartment:"lebombo_1k.hdr",city:"potsdamer_platz_1k.hdr",dawn:"kiara_1_dawn_1k.hdr",forest:"forest_slope_1k.hdr",lobby:"st_fagans_interior_1k.hdr",night:"dikhololo_night_1k.hdr",park:"rooitou_park_1k.hdr",studio:"studio_small_03_1k.hdr",sunset:"venice_sunset_1k.hdr",warehouse:"empty_warehouse_01_1k.hdr"},xR="https://raw.githack.com/pmndrs/drei-assets/456060a26bbeb8fdf79326f224b6d99b8bcce736/hdri/",Ip=s=>Array.isArray(s),oA=["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"];function ky({files:s=oA,path:e="",preset:t=void 0,colorSpace:n=void 0,extensions:i}={}){t&&(lA(t),s=xx[t],e=xR);const a=Ip(s),{extension:o,isCubemap:c}=cA(s),u=uA(o);if(!u)throw new Error("useEnvironment: Unrecognized file extension: "+s);const h=ti(b=>b.gl);Y.useLayoutEffect(()=>{if(o!=="webp"&&o!=="jpg"&&o!=="jpeg")return;function b(){$c.clear(u,a?[s]:s)}h.domElement.addEventListener("webglcontextlost",b,{once:!0})},[s,h.domElement]);const m=$c(u,a?[s]:s,b=>{(o==="webp"||o==="jpg"||o==="jpeg")&&b.setRenderer(h),b.setPath==null||b.setPath(e),i&&i(b)});let x=a?m[0]:m;if(o==="jpg"||o==="jpeg"||o==="webp"){var g;x=(g=x.renderTarget)==null?void 0:g.texture}return x.mapping=c?Kc:zp,x.colorSpace=n??(c?"srgb":"srgb-linear"),x}const bG={files:oA,path:"",preset:void 0,extensions:void 0};ky.preload=s=>{const e={...bG,...s};let{files:t,path:n=""}=e;const{preset:i,extensions:a}=e;i&&(lA(i),t=xx[i],n=xR);const{extension:o}=cA(t);if(o==="webp"||o==="jpg"||o==="jpeg")throw new Error("useEnvironment: Preloading gainmaps is not supported");const c=uA(o);if(!c)throw new Error("useEnvironment: Unrecognized file extension: "+t);$c.preload(c,Ip(t)?[t]:t,u=>{u.setPath==null||u.setPath(n),a&&a(u)})};const _G={files:oA,preset:void 0};ky.clear=s=>{const e={..._G,...s};let{files:t}=e;const{preset:n}=e;n&&(lA(n),t=xx[n]);const{extension:i}=cA(t),a=uA(i);if(!a)throw new Error("useEnvironment: Unrecognized file extension: "+t);$c.clear(a,Ip(t)?[t]:t)};function lA(s){if(!(s in xx))throw new Error("Preset must be one of: "+Object.keys(xx).join(", "))}function cA(s){var e;const t=Ip(s)&&s.length===6,n=Ip(s)&&s.length===3&&s.some(o=>o.endsWith("json")),i=Ip(s)?s[0]:s;return{extension:t?"cube":n?"webp":i.startsWith("data:application/exr")?"exr":i.startsWith("data:application/hdr")?"hdr":i.startsWith("data:image/jpeg")?"jpg":(e=i.split(".").pop())==null||(e=e.split("?"))==null||(e=e.shift())==null?void 0:e.toLowerCase(),isCubemap:t,isGainmap:n}}function uA(s){return s==="cube"?HC:s==="hdr"?kP:s==="exr"?VP:s==="jpg"||s==="jpeg"?yG:s==="webp"?vG:null}const SG=s=>s.current&&s.current.isScene,AG=s=>SG(s)?s.current:s;function fA(s,e,t,n,i={}){var a,o,c,u;i={backgroundBlurriness:0,backgroundIntensity:1,backgroundRotation:[0,0,0],environmentIntensity:1,environmentRotation:[0,0,0],...i};const h=AG(e||t),m=h.background,x=h.environment,g={backgroundBlurriness:h.backgroundBlurriness,backgroundIntensity:h.backgroundIntensity,backgroundRotation:(a=(o=h.backgroundRotation)==null||o.clone==null?void 0:o.clone())!==null&&a!==void 0?a:[0,0,0],environmentIntensity:h.environmentIntensity,environmentRotation:(c=(u=h.environmentRotation)==null||u.clone==null?void 0:u.clone())!==null&&c!==void 0?c:[0,0,0]};return s!=="only"&&(h.environment=n),s&&(h.background=n),Vc(h,i),()=>{s!=="only"&&(h.environment=x),s&&(h.background=m),Vc(h,g)}}function hA({scene:s,background:e=!1,map:t,...n}){const i=ti(a=>a.scene);return Y.useLayoutEffect(()=>{if(t)return fA(e,s,i,t,n)}),null}function gR({background:s=!1,scene:e,blur:t,backgroundBlurriness:n,backgroundIntensity:i,backgroundRotation:a,environmentIntensity:o,environmentRotation:c,...u}){const h=ky(u),m=ti(x=>x.scene);return Y.useLayoutEffect(()=>fA(s,e,m,h,{backgroundBlurriness:t??n,backgroundIntensity:i,backgroundRotation:a,environmentIntensity:o,environmentRotation:c})),Y.useEffect(()=>()=>{h.dispose()},[h]),null}function MG({children:s,near:e=.1,far:t=1e3,resolution:n=256,frames:i=1,map:a,background:o=!1,blur:c,backgroundBlurriness:u,backgroundIntensity:h,backgroundRotation:m,environmentIntensity:x,environmentRotation:g,scene:b,files:S,path:C,preset:M=void 0,extensions:A}){const R=ti(P=>P.gl),N=ti(P=>P.scene),B=Y.useRef(null),[F]=Y.useState(()=>new a0),U=Y.useMemo(()=>{const P=new vS(n);return P.texture.type=xs,P},[n]);Y.useEffect(()=>()=>{U.dispose()},[U]),Y.useLayoutEffect(()=>{if(i===1){const P=R.autoClear;R.autoClear=!0,B.current.update(R,F),R.autoClear=P}return fA(o,b,N,U.texture,{backgroundBlurriness:c??u,backgroundIntensity:h,backgroundRotation:m,environmentIntensity:x,environmentRotation:g})},[s,F,U.texture,b,N,o,i,R]);let z=1;return Rl(()=>{if(i===1/0||z<i){const P=R.autoClear;R.autoClear=!0,B.current.update(R,F),R.autoClear=P,z++}}),Y.createElement(Y.Fragment,null,BT(Y.createElement(Y.Fragment,null,s,Y.createElement("cubeCamera",{ref:B,args:[e,t,U]}),S||M?Y.createElement(gR,{background:!0,files:S,preset:M,path:C,extensions:A}):a?Y.createElement(hA,{background:!0,map:a,extensions:A}):null),F))}function wG(s){var e,t,n,i;const a=ky(s),o=s.map||a;Y.useMemo(()=>QS({GroundProjectedEnvImpl:q8}),[]),Y.useEffect(()=>()=>{a.dispose()},[a]);const c=Y.useMemo(()=>[o],[o]),u=(e=s.ground)==null?void 0:e.height,h=(t=s.ground)==null?void 0:t.radius,m=(n=(i=s.ground)==null?void 0:i.scale)!==null&&n!==void 0?n:1e3;return Y.createElement(Y.Fragment,null,Y.createElement(hA,fo({},s,{map:o})),Y.createElement("groundProjectedEnvImpl",{args:c,scale:m,height:u,radius:h}))}function EG(s){return s.ground?Y.createElement(wG,s):s.map?Y.createElement(hA,s):s.children?Y.createElement(MG,s):Y.createElement(gR,s)}class CG extends Ys{constructor(){super({uniforms:{time:{value:0},fade:{value:1}},vertexShader:`
      uniform float time;
      attribute float size;
      varying vec3 vColor;
      void main() {
        vColor = color;
        vec4 mvPosition = modelViewMatrix * vec4(position, 0.5);
        gl_PointSize = size * (30.0 / -mvPosition.z) * (3.0 + sin(time + 100.0));
        gl_Position = projectionMatrix * mvPosition;
      }`,fragmentShader:`
      uniform sampler2D pointTexture;
      uniform float fade;
      varying vec3 vColor;
      void main() {
        float opacity = 1.0;
        if (fade == 1.0) {
          float d = distance(gl_PointCoord, vec2(0.5, 0.5));
          opacity = 1.0 / (1.0 + exp(16.0 * (d - 0.25)));
        }
        gl_FragColor = vec4(vColor, opacity);

        #include <tonemapping_fragment>
	      #include <${aR>=154?"colorspace_fragment":"encodings_fragment"}>
      }`})}}const TG=s=>new k().setFromSpherical(new X1(s,Math.acos(1-Math.random()*2),Math.random()*2*Math.PI)),RG=Y.forwardRef(({radius:s=100,depth:e=50,count:t=5e3,saturation:n=0,factor:i=4,fade:a=!1,speed:o=1},c)=>{const u=Y.useRef(null),[h,m,x]=Y.useMemo(()=>{const b=[],S=[],C=Array.from({length:t},()=>(.5+.5*Math.random())*i),M=new qt;let A=s+e;const R=e/t;for(let N=0;N<t;N++)A-=R*Math.random(),b.push(...TG(A).toArray()),M.setHSL(N/t,n,.9),S.push(M.r,M.g,M.b);return[new Float32Array(b),new Float32Array(S),new Float32Array(C)]},[t,e,i,s,n]);Rl(b=>u.current&&(u.current.uniforms.time.value=b.clock.elapsedTime*o));const[g]=Y.useState(()=>new CG);return Y.createElement("points",{ref:c},Y.createElement("bufferGeometry",null,Y.createElement("bufferAttribute",{attach:"attributes-position",args:[h,3]}),Y.createElement("bufferAttribute",{attach:"attributes-color",args:[m,3]}),Y.createElement("bufferAttribute",{attach:"attributes-size",args:[x,1]})),Y.createElement("primitive",{ref:u,object:g,attach:"material",blending:t1,"uniforms-fade-value":a,depthWrite:!1,transparent:!0,vertexColors:!0}))}),NG=/^[og]\s*(.+)?/,BG=/^mtllib /,DG=/^usemtl /,UG=/^usemap /,h3=/\s+/,d3=new k,v_=new k,p3=new k,m3=new k,vl=new k,Vv=new qt;function LG(){const s={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(e,t){if(this.object&&this.object.fromDeclaration===!1){this.object.name=e,this.object.fromDeclaration=t!==!1;return}const n=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;if(this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object={name:e||"",fromDeclaration:t!==!1,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(i,a){const o=this._finalize(!1);o&&(o.inherited||o.groupCount<=0)&&this.materials.splice(o.index,1);const c={index:this.materials.length,name:i||"",mtllib:Array.isArray(a)&&a.length>0?a[a.length-1]:"",smooth:o!==void 0?o.smooth:this.smooth,groupStart:o!==void 0?o.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(u){const h={index:typeof u=="number"?u:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return h.clone=this.clone.bind(h),h}};return this.materials.push(c),c},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(i){const a=this.currentMaterial();if(a&&a.groupEnd===-1&&(a.groupEnd=this.geometry.vertices.length/3,a.groupCount=a.groupEnd-a.groupStart,a.inherited=!1),i&&this.materials.length>1)for(let o=this.materials.length-1;o>=0;o--)this.materials[o].groupCount<=0&&this.materials.splice(o,1);return i&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),a}},n&&n.name&&typeof n.clone=="function"){const i=n.clone(0);i.inherited=!0,this.object.materials.push(i)}this.objects.push(this.object)},finalize:function(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)},parseVertexIndex:function(e,t){const n=parseInt(e,10);return(n>=0?n-1:n+t/3)*3},parseNormalIndex:function(e,t){const n=parseInt(e,10);return(n>=0?n-1:n+t/3)*3},parseUVIndex:function(e,t){const n=parseInt(e,10);return(n>=0?n-1:n+t/2)*2},addVertex:function(e,t,n){const i=this.vertices,a=this.object.geometry.vertices;a.push(i[e+0],i[e+1],i[e+2]),a.push(i[t+0],i[t+1],i[t+2]),a.push(i[n+0],i[n+1],i[n+2])},addVertexPoint:function(e){const t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addVertexLine:function(e){const t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addNormal:function(e,t,n){const i=this.normals,a=this.object.geometry.normals;a.push(i[e+0],i[e+1],i[e+2]),a.push(i[t+0],i[t+1],i[t+2]),a.push(i[n+0],i[n+1],i[n+2])},addFaceNormal:function(e,t,n){const i=this.vertices,a=this.object.geometry.normals;d3.fromArray(i,e),v_.fromArray(i,t),p3.fromArray(i,n),vl.subVectors(p3,v_),m3.subVectors(d3,v_),vl.cross(m3),vl.normalize(),a.push(vl.x,vl.y,vl.z),a.push(vl.x,vl.y,vl.z),a.push(vl.x,vl.y,vl.z)},addColor:function(e,t,n){const i=this.colors,a=this.object.geometry.colors;i[e]!==void 0&&a.push(i[e+0],i[e+1],i[e+2]),i[t]!==void 0&&a.push(i[t+0],i[t+1],i[t+2]),i[n]!==void 0&&a.push(i[n+0],i[n+1],i[n+2])},addUV:function(e,t,n){const i=this.uvs,a=this.object.geometry.uvs;a.push(i[e+0],i[e+1]),a.push(i[t+0],i[t+1]),a.push(i[n+0],i[n+1])},addDefaultUV:function(){const e=this.object.geometry.uvs;e.push(0,0),e.push(0,0),e.push(0,0)},addUVLine:function(e){const t=this.uvs;this.object.geometry.uvs.push(t[e+0],t[e+1])},addFace:function(e,t,n,i,a,o,c,u,h){const m=this.vertices.length;let x=this.parseVertexIndex(e,m),g=this.parseVertexIndex(t,m),b=this.parseVertexIndex(n,m);if(this.addVertex(x,g,b),this.addColor(x,g,b),c!==void 0&&c!==""){const S=this.normals.length;x=this.parseNormalIndex(c,S),g=this.parseNormalIndex(u,S),b=this.parseNormalIndex(h,S),this.addNormal(x,g,b)}else this.addFaceNormal(x,g,b);if(i!==void 0&&i!==""){const S=this.uvs.length;x=this.parseUVIndex(i,S),g=this.parseUVIndex(a,S),b=this.parseUVIndex(o,S),this.addUV(x,g,b),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(e){this.object.geometry.type="Points";const t=this.vertices.length;for(let n=0,i=e.length;n<i;n++){const a=this.parseVertexIndex(e[n],t);this.addVertexPoint(a),this.addColor(a)}},addLineGeometry:function(e,t){this.object.geometry.type="Line";const n=this.vertices.length,i=this.uvs.length;for(let a=0,o=e.length;a<o;a++)this.addVertexLine(this.parseVertexIndex(e[a],n));for(let a=0,o=t.length;a<o;a++)this.addUVLine(this.parseUVIndex(t[a],i))}};return s.startObject("",!1),s}class OG extends Ws{constructor(e){super(e),this.materials=null}load(e,t,n,i){const a=this,o=new Xs(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(c){try{t(a.parse(c))}catch(u){i?i(u):console.error(u),a.manager.itemError(e)}},n,i)}setMaterials(e){return this.materials=e,this}parse(e){const t=new LG;e.indexOf(`\r
`)!==-1&&(e=e.replace(/\r\n/g,`
`)),e.indexOf(`\\
`)!==-1&&(e=e.replace(/\\\n/g,""));const n=e.split(`
`);let i=[];for(let c=0,u=n.length;c<u;c++){const h=n[c].trimStart();if(h.length===0)continue;const m=h.charAt(0);if(m!=="#")if(m==="v"){const x=h.split(h3);switch(x[0]){case"v":t.vertices.push(parseFloat(x[1]),parseFloat(x[2]),parseFloat(x[3])),x.length>=7?(Vv.setRGB(parseFloat(x[4]),parseFloat(x[5]),parseFloat(x[6]),Hs),t.colors.push(Vv.r,Vv.g,Vv.b)):t.colors.push(void 0,void 0,void 0);break;case"vn":t.normals.push(parseFloat(x[1]),parseFloat(x[2]),parseFloat(x[3]));break;case"vt":t.uvs.push(parseFloat(x[1]),parseFloat(x[2]));break}}else if(m==="f"){const g=h.slice(1).trim().split(h3),b=[];for(let C=0,M=g.length;C<M;C++){const A=g[C];if(A.length>0){const R=A.split("/");b.push(R)}}const S=b[0];for(let C=1,M=b.length-1;C<M;C++){const A=b[C],R=b[C+1];t.addFace(S[0],A[0],R[0],S[1],A[1],R[1],S[2],A[2],R[2])}}else if(m==="l"){const x=h.substring(1).trim().split(" ");let g=[];const b=[];if(h.indexOf("/")===-1)g=x;else for(let S=0,C=x.length;S<C;S++){const M=x[S].split("/");M[0]!==""&&g.push(M[0]),M[1]!==""&&b.push(M[1])}t.addLineGeometry(g,b)}else if(m==="p"){const g=h.slice(1).trim().split(" ");t.addPointGeometry(g)}else if((i=NG.exec(h))!==null){const x=(" "+i[0].slice(1).trim()).slice(1);t.startObject(x)}else if(DG.test(h))t.object.startMaterial(h.substring(7).trim(),t.materialLibraries);else if(BG.test(h))t.materialLibraries.push(h.substring(7).trim());else if(UG.test(h))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if(m==="s"){if(i=h.split(" "),i.length>1){const g=i[1].trim().toLowerCase();t.object.smooth=g!=="0"&&g!=="off"}else t.object.smooth=!0;const x=t.object.currentMaterial();x&&(x.smooth=t.object.smooth)}else{if(h==="\0")continue;console.warn('THREE.OBJLoader: Unexpected line: "'+h+'"')}}t.finalize();const a=new Yc;if(a.materialLibraries=[].concat(t.materialLibraries),!(t.objects.length===1&&t.objects[0].geometry.vertices.length===0)===!0)for(let c=0,u=t.objects.length;c<u;c++){const h=t.objects[c],m=h.geometry,x=h.materials,g=m.type==="Line",b=m.type==="Points";let S=!1;if(m.vertices.length===0)continue;const C=new Rn;C.setAttribute("position",new $t(m.vertices,3)),m.normals.length>0&&C.setAttribute("normal",new $t(m.normals,3)),m.colors.length>0&&(S=!0,C.setAttribute("color",new $t(m.colors,3))),m.hasUVIndices===!0&&C.setAttribute("uv",new $t(m.uvs,2));const M=[];for(let R=0,N=x.length;R<N;R++){const B=x[R],F=B.name+"_"+B.smooth+"_"+S;let U=t.materials[F];if(this.materials!==null){if(U=this.materials.create(B.name),g&&U&&!(U instanceof gs)){const z=new gs;os.prototype.copy.call(z,U),z.color.copy(U.color),U=z}else if(b&&U&&!(U instanceof Tf)){const z=new Tf({size:10,sizeAttenuation:!1});os.prototype.copy.call(z,U),z.color.copy(U.color),z.map=U.map,U=z}}U===void 0&&(g?U=new gs:b?U=new Tf({size:1,sizeAttenuation:!1}):U=new BS,U.name=B.name,U.flatShading=!B.smooth,U.vertexColors=S,t.materials[F]=U),M.push(U)}let A;if(M.length>1){for(let R=0,N=x.length;R<N;R++){const B=x[R];C.addGroup(B.groupStart,B.groupCount,R)}g?A=new Jo(C,M):b?A=new Lp(C,M):A=new sn(C,M)}else g?A=new Jo(C,M[0]):b?A=new Lp(C,M[0]):A=new sn(C,M[0]);A.name=h.name,a.add(A)}else if(t.vertices.length>0){const c=new Tf({size:1,sizeAttenuation:!1}),u=new Rn;u.setAttribute("position",new $t(t.vertices,3)),t.colors.length>0&&t.colors[0]!==void 0&&(u.setAttribute("color",new $t(t.colors,3)),c.vertexColors=!0);const h=new Lp(u,c);a.add(h)}return a}}function IG(s,e,t=2){const n=s.length;let i=zG(s,0,n,t,!0);const a=[];if(!i||i.next===i.prev)return a;let o,c,u;if(s.length>80*t){o=s[0],c=s[1];let h=o,m=c;for(let x=t;x<n;x+=t){const g=s[x],b=s[x+1];g<o&&(o=g),b<c&&(c=b),g>h&&(h=g),b>m&&(m=b)}u=Math.max(h-o,m-c),u=u!==0?32767/u:0}return vx(i,a,t,o,c,u,0),a}function zG(s,e,t,n,i){let a;if(i===JG(s,e,t,n)>0)for(let o=e;o<t;o+=n)a=x3(o/n|0,s[o],s[o+1],a);else for(let o=t-n;o>=e;o-=n)a=x3(o/n|0,s[o],s[o+1],a);return a&&Vy(a,a.next)&&(yx(a),a=a.next),a}function gx(s,e){if(!s)return s;e||(e=s);let t=s,n;do if(n=!1,!t.steiner&&(Vy(t,t.next)||as(t.prev,t,t.next)===0)){if(yx(t),t=e=t.prev,t===t.next)break;n=!0}else t=t.next;while(n||t!==e);return e}function vx(s,e,t,n,i,a,o){if(!s)return;!o&&a&&HG(s,n,i,a);let c=s;for(;s.prev!==s.next;){const u=s.prev,h=s.next;if(a?PG(s,n,i,a):FG(s)){e.push(u.i,s.i,h.i),yx(s),s=h.next,c=h.next;continue}if(s=h,s===c){o?o===1?(s=GG(gx(s),e),vx(s,e,t,n,i,a,2)):o===2&&jG(s,e,t,n,i,a):vx(gx(s),e,t,n,i,a,1);break}}}function FG(s){const e=s.prev,t=s,n=s.next;if(as(e,t,n)>=0)return!1;const i=e.x,a=t.x,o=n.x,c=e.y,u=t.y,h=n.y,m=Math.min(i,a,o),x=Math.min(c,u,h),g=Math.max(i,a,o),b=Math.max(c,u,h);let S=n.next;for(;S!==e;){if(S.x>=m&&S.x<=g&&S.y>=x&&S.y<=b&&Xm(i,c,a,u,o,h,S.x,S.y)&&as(S.prev,S,S.next)>=0)return!1;S=S.next}return!0}function PG(s,e,t,n){const i=s.prev,a=s,o=s.next;if(as(i,a,o)>=0)return!1;const c=i.x,u=a.x,h=o.x,m=i.y,x=a.y,g=o.y,b=Math.min(c,u,h),S=Math.min(m,x,g),C=Math.max(c,u,h),M=Math.max(m,x,g),A=nS(b,S,e,t,n),R=nS(C,M,e,t,n);let N=s.prevZ,B=s.nextZ;for(;N&&N.z>=A&&B&&B.z<=R;){if(N.x>=b&&N.x<=C&&N.y>=S&&N.y<=M&&N!==i&&N!==o&&Xm(c,m,u,x,h,g,N.x,N.y)&&as(N.prev,N,N.next)>=0||(N=N.prevZ,B.x>=b&&B.x<=C&&B.y>=S&&B.y<=M&&B!==i&&B!==o&&Xm(c,m,u,x,h,g,B.x,B.y)&&as(B.prev,B,B.next)>=0))return!1;B=B.nextZ}for(;N&&N.z>=A;){if(N.x>=b&&N.x<=C&&N.y>=S&&N.y<=M&&N!==i&&N!==o&&Xm(c,m,u,x,h,g,N.x,N.y)&&as(N.prev,N,N.next)>=0)return!1;N=N.prevZ}for(;B&&B.z<=R;){if(B.x>=b&&B.x<=C&&B.y>=S&&B.y<=M&&B!==i&&B!==o&&Xm(c,m,u,x,h,g,B.x,B.y)&&as(B.prev,B,B.next)>=0)return!1;B=B.nextZ}return!0}function GG(s,e){let t=s;do{const n=t.prev,i=t.next.next;!Vy(n,i)&&vR(n,t,t.next,i)&&Q1(n,i)&&Q1(i,n)&&(e.push(n.i,t.i,i.i),yx(t),yx(t.next),t=s=i),t=t.next}while(t!==s);return gx(t)}function jG(s,e,t,n,i,a){let o=s;do{let c=o.next.next;for(;c!==o.prev;){if(o.i!==c.i&&XG(o,c)){let u=qG(o,c);o=gx(o,o.next),u=gx(u,u.next),vx(o,e,t,n,i,a,0),vx(u,e,t,n,i,a,0);return}c=c.next}o=o.next}while(o!==s)}function HG(s,e,t,n){let i=s;do i.z===0&&(i.z=nS(i.x,i.y,e,t,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==s);i.prevZ.nextZ=null,i.prevZ=null,kG(i)}function kG(s){let e,t=1;do{let n=s,i;s=null;let a=null;for(e=0;n;){e++;let o=n,c=0;for(let h=0;h<t&&(c++,o=o.nextZ,!!o);h++);let u=t;for(;c>0||u>0&&o;)c!==0&&(u===0||!o||n.z<=o.z)?(i=n,n=n.nextZ,c--):(i=o,o=o.nextZ,u--),a?a.nextZ=i:s=i,i.prevZ=a,a=i;n=o}a.nextZ=null,t*=2}while(e>1);return s}function nS(s,e,t,n,i){return s=(s-t)*i|0,e=(e-n)*i|0,s=(s|s<<8)&16711935,s=(s|s<<4)&252645135,s=(s|s<<2)&858993459,s=(s|s<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,s|e<<1}function VG(s,e,t,n,i,a,o,c){return(i-o)*(e-c)>=(s-o)*(a-c)&&(s-o)*(n-c)>=(t-o)*(e-c)&&(t-o)*(a-c)>=(i-o)*(n-c)}function Xm(s,e,t,n,i,a,o,c){return!(s===o&&e===c)&&VG(s,e,t,n,i,a,o,c)}function XG(s,e){return s.next.i!==e.i&&s.prev.i!==e.i&&!YG(s,e)&&(Q1(s,e)&&Q1(e,s)&&WG(s,e)&&(as(s.prev,s,e.prev)||as(s,e.prev,e))||Vy(s,e)&&as(s.prev,s,s.next)>0&&as(e.prev,e,e.next)>0)}function as(s,e,t){return(e.y-s.y)*(t.x-e.x)-(e.x-s.x)*(t.y-e.y)}function Vy(s,e){return s.x===e.x&&s.y===e.y}function vR(s,e,t,n){const i=Yv(as(s,e,t)),a=Yv(as(s,e,n)),o=Yv(as(t,n,s)),c=Yv(as(t,n,e));return!!(i!==a&&o!==c||i===0&&Xv(s,t,e)||a===0&&Xv(s,n,e)||o===0&&Xv(t,s,n)||c===0&&Xv(t,e,n))}function Xv(s,e,t){return e.x<=Math.max(s.x,t.x)&&e.x>=Math.min(s.x,t.x)&&e.y<=Math.max(s.y,t.y)&&e.y>=Math.min(s.y,t.y)}function Yv(s){return s>0?1:s<0?-1:0}function YG(s,e){let t=s;do{if(t.i!==s.i&&t.next.i!==s.i&&t.i!==e.i&&t.next.i!==e.i&&vR(t,t.next,s,e))return!0;t=t.next}while(t!==s);return!1}function Q1(s,e){return as(s.prev,s,s.next)<0?as(s,e,s.next)>=0&&as(s,s.prev,e)>=0:as(s,e,s.prev)<0||as(s,s.next,e)<0}function WG(s,e){let t=s,n=!1;const i=(s.x+e.x)/2,a=(s.y+e.y)/2;do t.y>a!=t.next.y>a&&t.next.y!==t.y&&i<(t.next.x-t.x)*(a-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next;while(t!==s);return n}function qG(s,e){const t=iS(s.i,s.x,s.y),n=iS(e.i,e.x,e.y),i=s.next,a=e.prev;return s.next=e,e.prev=s,t.next=i,i.prev=t,n.next=t,t.prev=n,a.next=n,n.prev=a,n}function x3(s,e,t,n){const i=iS(s,e,t);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function yx(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function iS(s,e,t){return{i:s,x:e,y:t,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function JG(s,e,t,n){let i=0;for(let a=e,o=t-n;a<t;a+=n)i+=(s[o]-s[a])*(s[a+1]+s[o+1]),o=a;return i}function dA(s,e=!0){var c;const t=new Rn,n=[],i=[];let a=0;const o=[];s.vertexIndexMap.clear();for(let u of s.faces.values()){let h=u.vertexIds.map(g=>s.vertices.get(g)).filter(g=>g!==void 0);e&&(h=QG(h));const m=a;for(let g of h)n.push(g.position.x,g.position.y,g.position.z),s.vertexIndexMap.has(g.id)||s.vertexIndexMap.set(g.id,[]),(c=s.vertexIndexMap.get(g.id))==null||c.push(a),a++;let x=0;if(e&&h.length>=3){const g=ZG(h),b=KG(h,g),S=IG(b);for(let C=0;C<S.length;C+=3)i.push(m+S[C],m+S[C+1],m+S[C+2]),x++}else for(let g=1;g<h.length-1;g++)i.push(m,m+g,m+g+1),x++;for(let g=0;g<x;g++)o.push(u.id)}for(let u of s.vertices.values())s.vertexIndexMap.has(u.id);s.bufferIndexToVertexId=new Map;for(let[u,h]of s.vertexIndexMap)for(let m of h)s.bufferIndexToVertexId.set(m,u);return t.setAttribute("position",new $t(n,3)),t.setIndex(i),t.computeVertexNormals(),t.computeBoundingBox(),t.computeBoundingSphere(),t.userData.triangleToFaceId=o,t}function ZG(s){if(s.length<3)return new k(0,0,1);const e=s[0].position,t=s[1].position,n=s[2].position,i=new k().subVectors(t,e),a=new k().subVectors(n,e);return new k().crossVectors(i,a).normalize()}function KG(s,e){if(s.length===0)return[];let t=new k(1,0,0);Math.abs(e.dot(t))>.99&&t.set(0,1,0);const n=new k().crossVectors(e,t).normalize(),i=new k().crossVectors(e,n).normalize(),a=s[0].position,o=[];for(let c of s){const u=new k().subVectors(c.position,a);o.push(u.dot(n),u.dot(i))}return o}function QG(s,e=1e-6){if(s.length<=3)return s.slice();const t=i=>new k(i.position.x,i.position.y,i.position.z),n=[];for(let i=0;i<s.length;i++){const a=t(s[(i-1+s.length)%s.length]),o=t(s[i]),c=t(s[(i+1)%s.length]),u=o.clone().sub(a),h=c.clone().sub(o);u.clone().cross(h).lengthSq()>e&&n.push(s[i])}return n}class $1{constructor(e,t){this.id=e,this.position=t,this.edgeIds=new Set,this.faceIds=new Set}clone(){const e=new $1(this.id,this.position.clone());return e.edgeIds=new Set(this.edgeIds),e.faceIds=new Set(this.faceIds),e}toJSON(){return{id:this.id,position:this.position,edgeIds:Array.from(this.edgeIds),faceIds:Array.from(this.faceIds)}}}class ey{constructor(e,t,n){this.id=e,this.v1Id=t,this.v2Id=n,this.faceIds=new Set}clone(){const e=new ey(this.id,this.v1Id,this.v2Id);return e.faceIds=new Set(this.faceIds),e}toJSON(){return{id:this.id,v1Id:this.v1Id,v2Id:this.v2Id,faceIds:Array.from(this.faceIds)}}}class ty{constructor(e,t){this.id=e,this.vertexIds=t,this.edgeIds=new Set}clone(){const e=new ty(this.id,[...this.vertexIds]);return e.edgeIds=new Set(this.edgeIds),e}toJSON(){return{id:this.id,vertexIds:this.vertexIds,edgeIds:Array.from(this.edgeIds)}}}class Pf{constructor(){this.vertices=new Map,this.edges=new Map,this.faces=new Map,this.vertexIndexMap=new Map,this.bufferIndexToVertexId=new Map,this.nextVertexId=0,this.nextEdgeId=0,this.nextFaceId=0}addVertex(e){const t=new $1(this.nextVertexId++,e);return this.vertices.set(t.id,t),t}addEdge(e,t){const n=this.getEdge(e.id,t.id);if(n)return n;const i=new ey(this.nextEdgeId++,e.id,t.id);return this.edges.set(i.id,i),e.edgeIds.add(i.id),t.edgeIds.add(i.id),i}addFace(e){const t=e.map(o=>o.id),n=this.getFace(t);if(n)return n;const i=new ty(this.nextFaceId++,t);this.faces.set(i.id,i);const a=t.length;for(let o=0;o<a;o++){const c=e[o],u=e[(o+1)%a];let h=this.getEdge(c.id,u.id);h||(h=this.addEdge(c,u)),i.edgeIds.add(h.id),h.faceIds.add(i.id)}for(let o of e)o.faceIds.add(i.id);return i}getVertex(e){return this.vertices.get(e)}getEdge(e,t){const n=this.vertices.get(e);if(!n)return null;for(let i of n.edgeIds){const a=this.edges.get(i);if(a&&(a.v1Id===e&&a.v2Id===t||a.v1Id===t&&a.v2Id===e))return a}return null}getFace(e){if(!e||e.length===0)return null;const t=this.getVertex(e[0]);if(!t)return null;let n=new Set(t.faceIds);for(let i=1;i<e.length;i++){const a=this.getVertex(e[i]);if(!a||(n=new Set([...n].filter(o=>a.faceIds.has(o))),n.size===0))return null}for(let i of n){const a=this.faces.get(i);if(!a||a.vertexIds.length!==e.length)continue;const o=new Set(a.vertexIds);if(e.every(c=>o.has(c)))return a}return null}deleteVertex(e){if(!(!e||!this.vertices.has(e.id))){for(const t of[...e.faceIds]){const n=this.faces.get(t);n&&n.vertexIds.includes(e.id)&&this.deleteFace(n)}for(const t of[...e.edgeIds]){const n=this.edges.get(t);n&&(n.v1Id===e.id||n.v2Id===e.id)&&this.deleteEdge(n)}this.vertices.delete(e.id)}}deleteEdge(e){if(!e||!this.edges.has(e.id))return;for(let i of e.faceIds){const a=this.faces.get(i);a&&a.edgeIds.delete(e.id)}const t=this.getVertex(e.v1Id),n=this.getVertex(e.v2Id);t&&t.edgeIds.delete(e.id),n&&n.edgeIds.delete(e.id),this.edges.delete(e.id)}deleteFace(e){if(!(!e||!this.faces.has(e.id))){for(let t=0;t<e.vertexIds.length;t++){const n=e.vertexIds[t],i=e.vertexIds[(t+1)%e.vertexIds.length],a=this.getEdge(n,i);a&&a.faceIds.delete(e.id)}for(let t of e.vertexIds){const n=this.vertices.get(t);n&&n.faceIds.delete(e.id)}this.faces.delete(e.id)}}toDuplicatedVertexGeometry(e=!0){return dA(this,e)}clone(){const e=new Pf;return e.nextVertexId=this.nextVertexId,e.nextEdgeId=this.nextEdgeId,e.nextFaceId=this.nextFaceId,this.vertices.forEach(t=>e.vertices.set(t.id,t.clone())),this.edges.forEach(t=>e.edges.set(t.id,t.clone())),this.faces.forEach(t=>e.faces.set(t.id,t.clone())),this.vertexIndexMap.forEach((t,n)=>e.vertexIndexMap.set(n,[...t])),this.bufferIndexToVertexId.forEach((t,n)=>e.bufferIndexToVertexId.set(n,t)),e}toJSON(){return{vertices:Array.from(this.vertices.values()),edges:Array.from(this.edges.values()),faces:Array.from(this.faces.values()),nextVertexId:this.nextVertexId,nextEdgeId:this.nextEdgeId,nextFaceId:this.nextFaceId}}static fromJSON(e){const t=new Pf;return e.vertices&&Array.isArray(e.vertices)&&e.vertices.forEach(n=>{const i=new $1(n.id,new k(n.position.x,n.position.y,n.position.z));n.edgeIds&&(i.edgeIds=new Set(n.edgeIds)),n.faceIds&&(i.faceIds=new Set(n.faceIds)),t.vertices.set(i.id,i)}),e.edges&&Array.isArray(e.edges)&&e.edges.forEach(n=>{const i=new ey(n.id,n.v1Id,n.v2Id);n.faceIds&&(i.faceIds=new Set(n.faceIds)),t.edges.set(i.id,i)}),e.faces&&Array.isArray(e.faces)&&e.faces.forEach(n=>{const i=new ty(n.id,n.vertexIds||[]);n.edgeIds&&(i.edgeIds=new Set(n.edgeIds)),t.faces.set(i.id,i)}),e.nextVertexId&&(t.nextVertexId=e.nextVertexId),e.nextEdgeId&&(t.nextEdgeId=e.nextEdgeId),e.nextFaceId&&(t.nextFaceId=e.nextFaceId),t}}function $G(s){const e=new Pf,t=s.getAttribute("position"),n=s.getIndex(),i=new Map,a=(o,c,u)=>{const h=`${o.toFixed(4)},${c.toFixed(4)},${u.toFixed(4)}`;if(i.has(h))return i.get(h);const m=e.addVertex(new k(o,c,u));return i.set(h,m.id),m.id};if(n)for(let o=0;o<n.count;o+=3){const c=n.getX(o),u=n.getX(o+1),h=n.getX(o+2),m=a(t.getX(c),t.getY(c),t.getZ(c)),x=a(t.getX(u),t.getY(u),t.getZ(u)),g=a(t.getX(h),t.getY(h),t.getZ(h));if(m===x||x===g||g===m)continue;const b=e.getVertex(m),S=e.getVertex(x),C=e.getVertex(g);b&&S&&C&&e.addFace([b,S,C])}else for(let o=0;o<t.count;o+=3){const c=a(t.getX(o),t.getY(o),t.getZ(o)),u=a(t.getX(o+1),t.getY(o+1),t.getZ(o+1)),h=a(t.getX(o+2),t.getY(o+2),t.getZ(o+2));if(c===u||u===h||h===c)continue;const m=e.getVertex(c),x=e.getVertex(u),g=e.getVertex(h);m&&x&&g&&e.addFace([m,x,g])}return e}function g3(s){const e=new k;return s.length===0?e:(s.forEach(t=>e.add(t.position)),e.divideScalar(s.length))}function ej(s,e,t){const n=new Set(e),i=[];e.forEach(c=>{const u=s.faces.get(c);if(u)for(let h=0;h<u.vertexIds.length;h++){const m=u.vertexIds[h],x=u.vertexIds[(h+1)%u.vertexIds.length],g=s.getEdge(m,x);if(!g)continue;let b=0;g.faceIds.forEach(S=>{n.has(S)&&b++}),b===1&&i.push({edge:g,reversed:g.v1Id!==m})}});const a=new Map,o=new Set;e.forEach(c=>{const u=s.faces.get(c);if(!u)return;const h=[];u.vertexIds.forEach(m=>{if(!o.has(m)){const g=s.vertices.get(m);if(g){const b=s.addVertex(g.position.clone().add(t));a.set(m,b),o.add(m)}}const x=a.get(m);x&&h.push(x.id)}),u.vertexIds.forEach(m=>{const x=s.vertices.get(m);x&&x.faceIds.delete(c)}),u.edgeIds.forEach(m=>{const x=s.edges.get(m);x&&x.faceIds.delete(c)}),u.vertexIds=h,u.edgeIds.clear(),h.forEach((m,x)=>{const g=s.vertices.get(m);g&&g.faceIds.add(c);const b=h[(x+1)%h.length];let S=s.getEdge(m,b);if(!S){const C=s.vertices.get(m),M=s.vertices.get(b);S=s.addEdge(C,M)}u.edgeIds.add(S.id),S.faceIds.add(u.id)})}),i.forEach(({edge:c,reversed:u})=>{const h=s.vertices.get(c.v1Id),m=s.vertices.get(c.v2Id),x=a.get(c.v1Id),g=a.get(c.v2Id);if(h&&m&&x&&g){let b;u?b=[h,m,g,x]:b=[m,h,x,g],s.addFace(b)}})}function tj(s,e){const t=e.map(c=>s.edges.get(c)).filter(c=>c!==void 0);if(t.length===0)return;const n=new Map;t.forEach(c=>{const u=s.vertices.get(c.v1Id),h=s.vertices.get(c.v2Id);if(u&&h){const m=new k().addVectors(u.position,h.position).multiplyScalar(.5),x=s.addVertex(m);n.set(c.id,x)}});const i=new Set;t.forEach(c=>{c.faceIds.forEach(u=>{const h=s.faces.get(u);h&&i.add(h)})});const a=[],o=[];i.forEach(c=>{a.push(c);const u=c.vertexIds,h=[];for(let m=0;m<u.length;m++){const x=u[m],g=u[(m+1)%u.length],b=s.getEdge(x,g);b&&n.has(b.id)&&h.push(m)}if(u.length===4&&h.length===2){const m=h[0],x=h[1];if(Math.abs(m-x)===2){const b=F=>s.vertices.get(u[F]),S=b(0),C=b(1),M=b(2),A=b(3),R=F=>{const U=b(F),z=b((F+1)%4),P=s.getEdge(U.id,z.id);return P?n.get(P.id):void 0},N=R(m),B=R(x);N&&B?m===0&&x===2?(o.push([N,C,M,B]),o.push([B,A,S,N])):(o.push([S,C,N,B]),o.push([B,N,M,A])):y_(s,c,n,o)}else y_(s,c,n,o)}else y_(s,c,n,o)}),a.forEach(c=>s.deleteFace(c)),o.forEach(c=>s.addFace(c)),t.forEach(c=>s.deleteEdge(c))}function y_(s,e,t,n){const i=[];for(let a=0;a<e.vertexIds.length;a++){const o=e.vertexIds[a],c=e.vertexIds[(a+1)%e.vertexIds.length],u=s.vertices.get(o);u&&i.push(u);const h=s.getEdge(o,c);h&&t.has(h.id)&&i.push(t.get(h.id))}n.push(i)}function nj(s,e){const t=new Set,n=[e];for(;n.length>0;){const i=n.pop();if(t.has(i))continue;t.add(i);const a=s.faces.get(i);a&&a.vertexIds.forEach(o=>{const c=s.vertices.get(o);c&&c.faceIds.forEach(u=>{t.has(u)||n.push(u)})})}return t}const ij=({mode:s,setMode:e,onOperation:t,onExit:n})=>y.jsxs("div",{className:"absolute bottom-10 left-1/2 transform -translate-x-1/2 bg-[#1a1a1a] border border-[#333] rounded-lg p-2 flex gap-4 shadow-xl text-white pointer-events-auto backdrop-blur-md bg-opacity-90",onPointerDown:i=>i.stopPropagation(),onPointerUp:i=>i.stopPropagation(),onClick:i=>i.stopPropagation(),children:[y.jsxs("div",{className:"flex gap-1 border-r border-[#333] pr-4",children:[y.jsx("button",{onClick:()=>e("vertex"),className:`px-3 py-1 rounded text-sm font-medium transition-colors ${s==="vertex"?"bg-blue-600":"hover:bg-[#333]"}`,children:"Vertex"}),y.jsx("button",{onClick:()=>e("edge"),className:`px-3 py-1 rounded text-sm font-medium transition-colors ${s==="edge"?"bg-blue-600":"hover:bg-[#333]"}`,children:"Edge"}),y.jsx("button",{onClick:()=>e("face"),className:`px-3 py-1 rounded text-sm font-medium transition-colors ${s==="face"?"bg-blue-600":"hover:bg-[#333]"}`,children:"Face"}),y.jsx("button",{onClick:()=>e("object"),className:`px-3 py-1 rounded text-sm font-medium transition-colors ${s==="object"?"bg-blue-600":"hover:bg-[#333]"}`,children:"Island"})]}),y.jsxs("div",{className:"flex gap-2 items-center",children:[s==="face"&&y.jsx("button",{onClick:()=>t("extrude"),className:"px-3 py-1 bg-[#333] hover:bg-[#444] rounded text-sm",children:"Extrude"}),s==="edge"&&y.jsx("button",{onClick:()=>t("subdivide"),className:"px-3 py-1 bg-[#333] hover:bg-[#444] rounded text-sm",children:"Loop Cut"}),y.jsx("button",{onClick:()=>t("delete"),className:"px-3 py-1 bg-red-900/50 hover:bg-red-900/80 text-red-100 rounded text-sm ml-2",children:"Delete"})]}),y.jsx("div",{className:"border-l border-[#333] pl-4 flex items-center",children:y.jsx("button",{onClick:n,className:"px-3 py-1 bg-gray-700 hover:bg-gray-600 rounded text-sm",children:"Exit"})})]}),aj=({selectedModelId:s,objectRegistry:e,onUpdateModel:t,onExit:n})=>{const{camera:i,raycaster:a,gl:o,scene:c}=ti(),[u,h]=Y.useState("face"),[m,x]=Y.useState(null),[g,b]=Y.useState(new Set),[S,C]=Y.useState(!1),M=Y.useMemo(()=>new ai,[]),A=Y.useRef(new k),R=Y.useRef(new Map),[N,B]=Y.useState(null),F=Y.useRef(null);Y.useEffect(()=>{if(!s){x(null);return}const te=e.get(s);if(!te)return;let ne=null;if(te.traverse(j=>{j.isMesh&&(ne=j)}),!ne)return;let re;ne.userData.meshData&&ne.userData.meshData instanceof Pf?re=ne.userData.meshData.clone():ne.userData.meshData?re=Pf.fromJSON(ne.userData.meshData):(re=$G(ne.geometry),te.userData.meshData=re),M.position.set(0,0,0),M.rotation.set(0,0,0),M.scale.set(1,1,1),M.updateMatrix(),x(re),b(new Set),C(!1)},[s,e]),Y.useEffect(()=>{if(!m)return;const te=[],ne=[];m.vertices.forEach(se=>{te.push(se.position.x,se.position.y,se.position.z),ne.push(se.id)});const re=new Rn;re.setAttribute("position",new $t(te,3)),re.userData.idMap=ne;const j=[],ae=[];m.edges.forEach(se=>{const I=m.getVertex(se.v1Id),W=m.getVertex(se.v2Id);I&&W&&(j.push(I.position.x,I.position.y,I.position.z),j.push(W.position.x,W.position.y,W.position.z),ae.push(se.id))});const J=new Rn;J.setAttribute("position",new $t(j,3)),J.userData.idMap=ae;const ie=dA(m);B({points:re,lines:J,faces:ie}),U()},[m]);const U=Y.useCallback(()=>{if(!F.current||!m)return;const te=[],ne=[];g.forEach(j=>{if(u==="vertex"){const ae=m.vertices.get(j);if(ae){ne.push(ae);const J=.02;te.push(ae.position.x-J,ae.position.y,ae.position.z),te.push(ae.position.x+J,ae.position.y,ae.position.z),te.push(ae.position.x,ae.position.y-J,ae.position.z),te.push(ae.position.x,ae.position.y+J,ae.position.z),te.push(ae.position.x,ae.position.y,ae.position.z-J),te.push(ae.position.x,ae.position.y,ae.position.z+J)}}else if(u==="edge"){const ae=m.edges.get(j);if(ae){const J=m.getVertex(ae.v1Id),ie=m.getVertex(ae.v2Id);J&&ie&&(ne.push(J,ie),te.push(J.position.x,J.position.y,J.position.z),te.push(ie.position.x,ie.position.y,ie.position.z))}}else{const ae=m.faces.get(j);if(ae){const J=ae.vertexIds.map(se=>m.getVertex(se));J.forEach(se=>ne.push(se));const ie=g3(J);for(let se=0;se<J.length;se++){const I=J[se].position,W=J[(se+1)%J.length].position;te.push(ie.x,ie.y,ie.z),te.push(I.x,I.y,I.z),te.push(W.x,W.y,W.z)}}}});const re=new Rn;if(re.setAttribute("position",new $t(te,3)),F.current.geometry.dispose(),F.current.geometry=re,ne.length>0){const j=g3(ne);M.position.copy(j),M.updateMatrix(),C(!0)}else C(!1)},[g,m,u,M]);Y.useEffect(()=>{U()},[g,U]);const z=()=>{if(!m)return;A.current.copy(M.position),R.current.clear();const te=new Set;g.forEach(ne=>{if(u==="vertex")te.add(m.vertices.get(ne));else if(u==="edge"){const re=m.edges.get(ne);re&&(te.add(m.getVertex(re.v1Id)),te.add(m.getVertex(re.v2Id)))}else{const re=m.faces.get(ne);re&&re.vertexIds.forEach(j=>te.add(m.getVertex(j)))}}),te.forEach(ne=>{ne&&R.current.set(ne.id,ne.position.clone())})},P=()=>{if(!m)return;const te=m.clone();x(te),s&&t(s,te.toJSON())},L=()=>{if(!m)return;const te=new k().subVectors(M.position,A.current);if(R.current.forEach((ne,re)=>{const j=m.vertices.get(re);j&&j.position.copy(ne).add(te)}),N){const ne=N.points.getAttribute("position"),re=N.points.userData.idMap;for(let J=0;J<re.length;J++){const ie=m.vertices.get(re[J]);ie&&ne.setXYZ(J,ie.position.x,ie.position.y,ie.position.z)}ne.needsUpdate=!0;const j=N.lines.getAttribute("position"),ae=N.lines.userData.idMap;for(let J=0;J<ae.length;J++){const ie=m.edges.get(ae[J]);if(ie){const se=m.getVertex(ie.v1Id),I=m.getVertex(ie.v2Id);se&&I&&(j.setXYZ(J*2,se.position.x,se.position.y,se.position.z),j.setXYZ(J*2+1,I.position.x,I.position.y,I.position.z))}}if(j.needsUpdate=!0,m.bufferIndexToVertexId){const J=N.faces.getAttribute("position");m.bufferIndexToVertexId.forEach((ie,se)=>{const I=m.getVertex(ie);I&&J.setXYZ(se,I.position.x,I.position.y,I.position.z)}),J.needsUpdate=!0,N.faces.computeVertexNormals()}U()}},O=(te,ne)=>{if(!m||g.size===0)return;const re=m.clone();te==="extrude"?ej(re,Array.from(g),new k(0,.5,0)):te==="subdivide"?tj(re,Array.from(g)):te==="delete"&&(g.forEach(j=>{if(u==="vertex"){const ae=re.getVertex(j);ae&&re.deleteVertex(ae)}else if(u==="edge"){const ae=re.edges.get(j);ae&&re.deleteEdge(ae)}else if(u==="face"){const ae=re.faces.get(j);ae&&re.deleteFace(ae)}}),b(new Set)),x(re),s&&t(s,re.toJSON())};if(!s||!m||!N)return null;const ee=e.get(s);let Q=new wn;return ee&&(ee.updateMatrixWorld(),Q.copy(ee.matrixWorld)),y.jsxs("group",{matrixAutoUpdate:!1,matrix:Q,children:[u==="vertex"&&y.jsx("points",{geometry:N.points,renderOrder:1,onClick:te=>{te.stopPropagation();const ne=te.index;if(ne!==void 0){const re=N.points.userData.idMap[ne];b(j=>{const ae=new Set(te.shiftKey?j:[]);return ae.has(re)?ae.delete(re):ae.add(re),ae})}},children:y.jsx("pointsMaterial",{size:.15,color:"orange",sizeAttenuation:!0,depthTest:!1})}),u==="edge"&&y.jsx("lineSegments",{geometry:N.lines,renderOrder:1,onClick:te=>{te.stopPropagation();const ne=te.index;if(ne!==void 0){const re=Math.floor(ne/2),j=N.lines.userData.idMap[re];b(ae=>{const J=new Set(te.shiftKey?ae:[]);return J.has(j)?J.delete(j):J.add(j),J})}},children:y.jsx("lineBasicMaterial",{color:"#00ff00",depthTest:!1})}),(u==="face"||u==="object")&&y.jsx("mesh",{geometry:N.faces,onClick:te=>{te.stopPropagation();const ne=te.faceIndex;if(ne!==void 0){const re=N.faces.userData.triangleToFaceId[ne];if(re!==void 0)if(u==="object"){const j=nj(m,re);b(ae=>{const J=new Set(te.shiftKey?ae:[]);return j.forEach(ie=>J.add(ie)),J})}else b(j=>{const ae=new Set(te.shiftKey?j:[]);return ae.has(re)?ae.delete(re):ae.add(re),ae})}},children:y.jsx("meshBasicMaterial",{color:"white",transparent:!0,opacity:0,side:Oi,depthWrite:!1,polygonOffset:!0,polygonOffsetFactor:-1,polygonOffsetUnits:-1})}),y.jsx("mesh",{ref:F,renderOrder:2,children:u==="edge"?y.jsx("lineBasicMaterial",{color:"red",depthTest:!1,linewidth:3}):y.jsx("meshBasicMaterial",{color:u==="vertex"?"orange":"red",depthTest:!1,transparent:!0,opacity:.6,side:Oi,polygonOffset:!0,polygonOffsetFactor:-2,polygonOffsetUnits:-2})}),y.jsx("primitive",{object:M}),S&&y.jsx(lc,{makeDefault:!0,object:M,mode:"translate",onMouseDown:z,onMouseUp:P,onChange:L,size:.8}),y.jsx(tA,{children:y.jsx(ij,{mode:u,setMode:h,onOperation:O,onExit:n})})]})},sj=({active:s,onSelect:e,lines:t,models:n,layers:i,onChangeMode:a})=>{const{camera:o,size:c,gl:u}=ti(),[h,m]=Y.useState(null),[x,g]=Y.useState(null),[b,S]=Y.useState(!1);if(Y.useEffect(()=>{if(!s||!e)return;const N=z=>{if(z.button!==0||z.target!==u.domElement)return;const P=u.domElement.getBoundingClientRect();m({x:z.clientX-P.left,y:z.clientY-P.top}),g({x:z.clientX-P.left,y:z.clientY-P.top}),S(!0)},B=z=>{if(!b)return;const P=u.domElement.getBoundingClientRect();g({x:z.clientX-P.left,y:z.clientY-P.top})},F=z=>{if(!b||!h||!x)return;S(!1);const P=Math.min(h.x,x.x),L=Math.max(h.x,x.x),O=Math.min(h.y,x.y),ee=Math.max(h.y,x.y);if(Math.abs(L-P)<5&&Math.abs(ee-O)<5){m(null),g(null);return}const Q=[],te=new Set(i.filter(re=>re.visible&&!re.locked).map(re=>re.id)),ne=re=>{const j=re.clone();return j.project(o),{x:(j.x*.5+.5)*c.width,y:(-(j.y*.5)+.5)*c.height}};t.forEach(re=>{if(!te.has(re.layerId))return;let j=!1;for(const ae of re.points){const J=ne(ae);if(J.x>=P&&J.x<=L&&J.y>=O&&J.y<=ee){j=!0;break}}j&&Q.push(re.id)}),n.forEach(re=>{if(!te.has(re.layerId))return;const j=ne(re.position);j.x>=P&&j.x<=L&&j.y>=O&&j.y<=ee&&Q.push(re.id)}),e(Q,z.shiftKey),m(null),g(null)},U=u.domElement;return U.addEventListener("pointerdown",N),window.addEventListener("pointermove",B),window.addEventListener("pointerup",F),()=>{U.removeEventListener("pointerdown",N),window.removeEventListener("pointermove",B),window.removeEventListener("pointerup",F)}},[s,b,h,x,e,u.domElement,o,c,t,n,i]),!b||!h||!x)return null;const C=Math.min(h.x,x.x),M=Math.min(h.y,x.y),A=Math.abs(x.x-h.x),R=Math.abs(x.y-h.y);return y.jsx(tA,{fullscreen:!0,style:{pointerEvents:"none",zIndex:100},children:y.jsx("div",{style:{position:"absolute",left:C,top:M,width:A,height:R,backgroundColor:"rgba(59, 130, 246, 0.2)",border:"1px solid #3b82f6",pointerEvents:"none"}})})},rj=({view:s})=>{const{camera:e,controls:t}=ti();return Y.useEffect(()=>{if(!s||!t)return;const n=t,i=10,a=new k(0,0,0);let o=new k;switch(s){case"FRONT":o.set(0,0,i);break;case"BACK":o.set(0,0,-i);break;case"LEFT":o.set(-i,0,0);break;case"RIGHT":o.set(i,0,0);break;case"TOP":o.set(0,i,0);break;case"BOTTOM":o.set(0,-i,0);break}e.position.copy(o),e.lookAt(a),n.target&&(n.target.copy(a),n.update())},[s,e,t]),null},oj=({settings:s,onUpdateTarget:e})=>{const{controls:t}=ti(),n=Y.useRef(null),[i,a]=Y.useState(!1),o=Y.useRef({angle:0,direction:1}),c=Y.useRef(0);Y.useEffect(()=>{if(t&&s.target){const h=t;h.target.set(...s.target),h.update()}},[s.target,t]),Y.useEffect(()=>{if(s.active&&t){const h=t;c.current=h.getAzimuthalAngle(),o.current.angle=0,o.current.direction=1}},[s.active,t]),Rl((h,m)=>{if(!s.active||!t)return;const x=t,g=m*s.speed*.5;if(s.range===360){const b=g*s.direction;x.setAzimuthalAngle(x.getAzimuthalAngle()+b)}else{const b=zf.degToRad(s.range),S=g*s.direction*o.current.direction;o.current.angle+=S,o.current.angle>=b?s.loop?(o.current.angle=b,o.current.direction=-1):o.current.angle=b:o.current.angle<=0&&(s.loop?(o.current.angle=0,o.current.direction=1):o.current.angle=0),x.setAzimuthalAngle(c.current+o.current.angle)}x.update()});const u=()=>{if(n.current&&e){const h=n.current.position;e([h.x,h.y,h.z])}};return y.jsx(y.Fragment,{children:s.showGizmo&&y.jsxs(y.Fragment,{children:[y.jsxs("group",{ref:n,position:s.target,children:[y.jsxs("mesh",{children:[y.jsx("sphereGeometry",{args:[.2,16,16]}),y.jsx("meshBasicMaterial",{color:"#ffaa00",wireframe:!0})]}),y.jsx("axesHelper",{args:[1]}),y.jsx(tA,{position:[0,.3,0],center:!0,children:y.jsx("div",{className:"bg-black/80 text-white px-2 py-1 text-[10px] rounded border border-white/20 whitespace-nowrap backdrop-blur-sm",children:"Turntable Center"})})]}),y.jsx(lc,{object:n,mode:"translate",onMouseDown:()=>a(!0),onMouseUp:()=>{a(!1),u()}})]})})},lj=({exposure:s})=>{const{gl:e}=ti();return Y.useEffect(()=>{e.toneMappingExposure=s},[s,e]),null},cj=({animationsRef:s})=>(Rl((e,t)=>{s.current.length>0&&s.current.forEach(n=>{try{n(e.clock.elapsedTime,t)}catch(i){console.error(i)}})}),null),uj=({size:s,color:e,setHovered:t,onAction:n,gridSettings:i})=>{const a=Y.useRef(null),[o,c]=Y.useState(new k(0,0,0)),[u,h]=Y.useState(!1),{raycaster:m,camera:x,scene:g,gl:b}=ti(),[S,C]=Y.useState(!1);return Y.useEffect(()=>{const M=R=>R.shiftKey&&C(!0),A=R=>!R.shiftKey&&C(!1);return window.addEventListener("keydown",M),window.addEventListener("keyup",A),()=>{window.removeEventListener("keydown",M),window.removeEventListener("keyup",A)}},[]),Rl(M=>{m.setFromCamera(M.pointer,x);const A=(i==null?void 0:i.position[1])||-2,R=new k(0,1,0),N=new rc(R,-A),B=new k,U=m.intersectObjects(g.children,!0).filter(L=>L.object!==a.current&&L.object.type==="Mesh"&&!L.object.name.includes("Helper")&&L.object.visible);let z=new k,P=!1;if(U.length>0){const L=U[0];if(L.face){if(S)L.object.getWorldPosition(z);else{const O=L.point.clone().add(L.face.normal.clone().multiplyScalar(s*.1));z.x=Math.floor(O.x/s)*s+s/2,z.y=Math.floor(O.y/s)*s+s/2,z.z=Math.floor(O.z/s)*s+s/2}P=!0}}else{const L=m.ray.intersectPlane(N,B);L&&(z.x=Math.floor(L.x/s)*s+s/2,z.y=Math.floor(L.y/s)*s+s/2,z.z=Math.floor(L.z/s)*s+s/2,z.y<A+s/2&&(z.y=A+s/2),P=!0)}P?(c(z),h(!0),t(!0)):(h(!1),t(!1))}),Y.useEffect(()=>{const M=b.domElement,A=R=>{u&&(R.target.closest(".absolute")||R.button===0&&n(o,R.shiftKey?"remove":"add"))};return M.addEventListener("click",A),()=>M.removeEventListener("click",A)},[b,u,o,n]),y.jsxs("group",{position:o,visible:u,children:[y.jsxs("mesh",{ref:a,children:[y.jsx("boxGeometry",{args:[s,s,s]}),y.jsx("meshBasicMaterial",{color:S?"#ff0000":e,transparent:!0,opacity:.5,wireframe:S})]}),y.jsxs("lineSegments",{children:[y.jsx("edgesGeometry",{args:[new ks(s,s,s)]}),y.jsx("lineBasicMaterial",{color:S?"#ff0000":"#ffffff",transparent:!0,opacity:.8})]})]})},fj=({start:s,end:e,color:t})=>{const n=Y.useMemo(()=>new Yi().setFromPoints([s,e]),[s,e]),i=Y.useMemo(()=>{const o=new k;return n.getCenter(o),o},[n]),a=Y.useMemo(()=>{const o=new k;return n.getSize(o),o},[n]);return y.jsxs("group",{position:i,children:[y.jsxs("mesh",{children:[y.jsx("boxGeometry",{args:[Math.max(.01,a.x),Math.max(.01,a.y),Math.max(.01,a.z)]}),y.jsx("meshBasicMaterial",{color:t,transparent:!0,opacity:.3,depthTest:!1})]}),y.jsxs("lineSegments",{children:[y.jsx("edgesGeometry",{args:[new ks(Math.max(.01,a.x),Math.max(.01,a.y),Math.max(.01,a.z))]}),y.jsx("lineBasicMaterial",{color:t,transparent:!0,opacity:.8})]})]})},yR=({path:s,tubularSegments:e,radiusStart:t,radiusMid:n,radiusEnd:i,radialSegments:a,materialProps:o,interactionProps:c})=>{const u=Y.useMemo(()=>{const h=new Rn,m=s.computeFrenetFrames(e,!1),x=new k,g=new k,b=new gt;let S=new k;const C=[],M=[],A=[],R=[],N=B=>{if(B<=.5){const F=B*2;return zf.lerp(t,n,F)}else{const F=(B-.5)*2;return zf.lerp(n,i,F)}};for(let B=0;B<=e;B++){const F=B/e;s.getPointAt(F,S);const U=m.normals[B],z=m.binormals[B],P=N(F);for(let L=0;L<=a;L++){const O=L/a*Math.PI*2,ee=Math.sin(O),Q=-Math.cos(O);g.x=Q*U.x+ee*z.x,g.y=Q*U.y+ee*z.y,g.z=Q*U.z+ee*z.z,g.normalize(),M.push(g.x,g.y,g.z),x.x=S.x+P*g.x,x.y=S.y+P*g.y,x.z=S.z+P*g.z,C.push(x.x,x.y,x.z),b.x=B/e,b.y=L/a,A.push(b.x,b.y)}}for(let B=1;B<=e;B++)for(let F=1;F<=a;F++){const U=(a+1)*(B-1)+(F-1),z=(a+1)*B+(F-1),P=(a+1)*B+F,L=(a+1)*(B-1)+F;R.push(U,z,L),R.push(z,P,L)}return h.setIndex(R),h.setAttribute("position",new $t(C,3)),h.setAttribute("normal",new $t(M,3)),h.setAttribute("uv",new $t(A,2)),h},[s,e,t,n,i,a]);return y.jsx("mesh",{geometry:u,...c,children:y.jsx("meshStandardMaterial",{...o})})},hj=s=>{var Z;const{model:e,isSelected:t,isLocked:n,transformMode:i,onSelect:a,onUpdate:o,setDragging:c,onRegisterObject:u,mode:h,onDrawMove:m,onDrawStart:x,isWireframe:g}=s,b=Y.useRef(null),S=e.url.startsWith("primitive:"),C=e.url==="generated:extrude",M=e.url==="generated:lathe",A=e.url==="generated:loft",R=e.url==="generated:sweep",N=e.url==="generated:revolve",B=e.url==="generated:meshdata",F=C||M||A||R||N||B,U=e.url.startsWith("blob:")&&!e.url.includes("gltf")&&!e.url.includes("glb")&&!((Z=e.name)!=null&&Z.toLowerCase().endsWith(".glb")),z=!S&&!U&&!F&&e.url?Hy(e.url):null,P=U?$c(OG,e.url):null,L=Y.useMemo(()=>z?z.scene.clone():P?P.clone():null,[z,P]),O=Y.useMemo(()=>{if(!C||!e.extrudeSettings)return null;const{shapePoints:me,depth:$,bevelEnabled:pe,bevelThickness:ve,bevelSize:ze,bevelSegments:Ge}=e.extrudeSettings;if(!me||me.length<3)return null;try{const Fe=me.map(De=>new gt(De.x,De.y)),Qe=new Jc(Fe),lt=new id(Qe,{depth:$,bevelEnabled:pe,bevelThickness:ve,bevelSize:ze,bevelSegments:Ge});return lt.translate(0,0,-$/2),lt}catch(Fe){return console.error("Extrude geometry creation failed:",Fe),null}},[C,e.extrudeSettings]),ee=Y.useMemo(()=>{if(!M||!e.latheSettings)return null;const{points:me,segments:$,phiStart:pe,phiLength:ve}=e.latheSettings;if(!me||me.length<2)return null;try{return new Qp(me,$,pe,ve)}catch(ze){return console.error("Lathe geometry creation failed:",ze),null}},[M,e.latheSettings]),Q=Y.useMemo(()=>{if(!A||!e.loftSettings)return null;const{profiles:me,divisions:$}=e.loftSettings;if(!me||me.length<2)return null;try{const pe=me.length,ve=$,ze=[],Ge=[],Fe=[];for(let lt=0;lt<pe;lt++)for(let De=0;De<ve;De++){const le=me[lt][De];ze.push(le.x,le.y,le.z),Ge.push(De/(ve-1),lt/(pe-1))}for(let lt=0;lt<pe-1;lt++)for(let De=0;De<ve-1;De++){const le=lt*ve+De,Ye=(lt+1)*ve+De,Ze=(lt+1)*ve+(De+1),je=lt*ve+(De+1);Fe.push(le,Ye,je),Fe.push(Ye,Ze,je)}const Qe=new Rn;return Qe.setAttribute("position",new $t(ze,3)),Qe.setAttribute("uv",new $t(Ge,2)),Qe.setIndex(Fe),Qe.computeVertexNormals(),Qe}catch(pe){return console.error("Loft geometry creation failed:",pe),null}},[A,e.loftSettings]),te=Y.useMemo(()=>{if(!R||!e.sweepSettings)return null;const{profilePoints:me,pathPoints:$,steps:pe,scale:ve,twist:ze}=e.sweepSettings;if(!me||me.length<3||!$||$.length<2)return null;try{const Ge=new _l($),Fe=me.map(De=>new gt(De.x,De.y)),Qe=new Jc(Fe),lt=new id(Qe,{steps:pe,bevelEnabled:!1,extrudePath:Ge});if(ve!==1||ze!==0){const De=lt.attributes.position;for(let le=0;le<De.count;le++){const Ye=le/De.count,Ze=1+(ve-1)*Ye,je=ze*Ye,He=De.getX(le),et=De.getY(le),Ne=Math.cos(je),st=Math.sin(je),oe=He*Ne-et*st,X=He*st+et*Ne;De.setX(le,oe*Ze),De.setY(le,X*Ze)}lt.attributes.position.needsUpdate=!0,lt.computeVertexNormals()}return lt}catch(Ge){return console.error("Sweep geometry creation failed:",Ge),null}},[R,e.sweepSettings]),ne=Y.useMemo(()=>{if(!N||!e.revolveSettings)return null;const{profilePoints:me,segments:$,angle:pe,offset:ve}=e.revolveSettings;if(!me||me.length<2)return null;try{const ze=me.map(Fe=>new gt(Math.max(0,Fe.x+ve),Fe.y));return new Qp(ze,$,0,pe)}catch(ze){return console.error("Revolve geometry creation failed:",ze),null}},[N,e.revolveSettings]),re=Y.useMemo(()=>{if(!e.meshData)return null;try{let me;return e.meshData instanceof Pf?me=e.meshData:me=Pf.fromJSON(e.meshData),dA(me)}catch(me){return console.error("Polygonal geometry creation failed:",me),null}},[e.meshData]);Y.useEffect(()=>(b.current&&u(e.id,b.current),()=>u(e.id,null)),[e.id,u]),Y.useEffect(()=>{b.current&&(b.current.position.copy(e.position),b.current.rotation.copy(e.rotation),b.current.scale.copy(e.scale))},[e.position,e.rotation,e.scale]);const j=()=>{b.current&&o(b.current.position.clone(),b.current.rotation.clone(),b.current.scale.clone())},ae=me=>{if(h!=="voxel-paint"){if((h.startsWith("draw")||h.startsWith("create"))&&!n){if(me.stopPropagation(),x){let $;if(me.face&&b.current){const pe=me.face.normal.clone().transformDirection(b.current.matrixWorld).normalize(),ve=me.point.clone().add(pe),ze=new wn().lookAt(ve,me.point,new k(0,1,0));$=new Fn().setFromRotationMatrix(ze)}x(me.point,$)}return}n||(me.stopPropagation(),a(me,me.shiftKey))}},J=me=>{h!=="voxel-paint"&&(h.startsWith("draw")||h.startsWith("create"))&&!n&&(me.stopPropagation(),m&&m(me.point))},ie=e.segments||32,se=e.opacity!==void 0?e.opacity:1;let I;e.url==="primitive:sphere"?I=y.jsx("sphereGeometry",{args:[.5,ie,ie]}):e.url==="primitive:cylinder"?I=y.jsx("cylinderGeometry",{args:[.5,.5,1,ie]}):e.url==="primitive:plane"?I=y.jsx("planeGeometry",{args:[1,1,ie,ie]}):I=y.jsx("boxGeometry",{args:[1,1,1,Math.min(10,Math.ceil(ie/4)),Math.min(10,Math.ceil(ie/4)),Math.min(10,Math.ceil(ie/4))]}),Y.useEffect(()=>{L&&e.color&&L.traverse(me=>{me.isMesh&&(me.userData.originalMaterial||(me.userData.originalMaterial=me.material.clone()),me.material=me.userData.originalMaterial.clone(),me.material.color.set(e.color),me.material.transparent=se<1,me.material.opacity=se,me.material.wireframe=g)})},[L,e.color,se,g]);const fe=h==="polygonal-modeling"&&t?{raycast:null}:{};return y.jsxs(y.Fragment,{children:[y.jsxs("group",{ref:b,onPointerDown:ae,onPointerMove:J,children:[S?y.jsxs("mesh",{...fe,children:[I,y.jsx("meshStandardMaterial",{color:e.color||"#ffffff",roughness:.3,metalness:.1,side:Oi,transparent:se<1,opacity:se,wireframe:g}),!g&&e.url!=="primitive:sphere"&&e.url!=="primitive:cylinder"&&se>.1&&y.jsxs("lineSegments",{children:[y.jsx("edgesGeometry",{args:[new ks(1,1,1)]}),y.jsx("lineBasicMaterial",{color:"#000000",transparent:!0,opacity:.2*se})]})]}):C&&O?y.jsx("mesh",{geometry:O,...fe,children:y.jsx("meshStandardMaterial",{color:e.color||"#ffffff",roughness:.3,metalness:.1,side:Oi,transparent:se<1,opacity:se,wireframe:g})}):M&&ee?y.jsx("mesh",{geometry:ee,...fe,children:y.jsx("meshStandardMaterial",{color:e.color||"#ffffff",roughness:.3,metalness:.1,side:Oi,transparent:se<1,opacity:se,wireframe:g})}):A&&Q?y.jsx("mesh",{geometry:Q,...fe,children:y.jsx("meshStandardMaterial",{color:e.color||"#ffffff",roughness:.3,metalness:.1,side:Oi,transparent:se<1,opacity:se,wireframe:g})}):R&&te?y.jsx("mesh",{geometry:te,...fe,children:y.jsx("meshStandardMaterial",{color:e.color||"#ffffff",roughness:.3,metalness:.1,side:Oi,transparent:se<1,opacity:se,wireframe:g})}):N&&ne?y.jsx("mesh",{geometry:ne,...fe,children:y.jsx("meshStandardMaterial",{color:e.color||"#ffffff",roughness:.3,metalness:.1,side:Oi,transparent:se<1,opacity:se,wireframe:g})}):e.meshData&&re?y.jsx("mesh",{geometry:re,...fe,children:y.jsx("meshStandardMaterial",{color:e.color||"#ffffff",roughness:.3,metalness:.1,side:Oi,transparent:se<1,opacity:se,wireframe:g})}):L&&y.jsx("primitive",{object:L,...fe}),t&&h!=="polygonal-modeling"&&y.jsx("mesh",{visible:!1,children:y.jsx("boxGeometry",{args:[1.05,1.05,1.05]})}),t&&h!=="polygonal-modeling"&&y.jsxs("lineSegments",{children:[y.jsx("edgesGeometry",{args:[new ks(1,1,1)]}),y.jsx("lineBasicMaterial",{color:"#ffff00",depthTest:!1,linewidth:2})]})]}),t&&!n&&h!=="polygonal-modeling"&&y.jsx(lc,{object:b,mode:i,onMouseDown:()=>c(!0),onMouseUp:()=>{j(),c(!1)},size:1})]})},dj=s=>{const{line:e,isSelected:t,mode:n,transformMode:i,customPlane:a,isLocked:o,activePointIndex:c,onSelect:u,onUpdate:h,onHover:m,onUnhover:x,setDragging:g,onPointSelect:b,onAddPoint:S,onRegisterObject:C,isWireframe:M}=s,A=Y.useRef(null),R=Y.useRef([]),{camera:N}=ti();Y.useEffect(()=>(A.current&&C(e.id,A.current),()=>C(e.id,null)),[e.id,C]);const{localPoints:B,initialPosition:F}=Y.useMemo(()=>{if(e.points.length===0)return{localPoints:[],initialPosition:new k};if(n==="edit-points")return{localPoints:e.points.map(W=>W.clone()),initialPosition:new k(0,0,0)};const ie=new Yi().setFromPoints(e.points),se=new k;return ie.getCenter(se),{localPoints:e.points.map(W=>W.clone().sub(se)),initialPosition:se}},[e.points,n]),U=Y.useMemo(()=>{if(B.some(ie=>!Number.isFinite(ie.x)||!Number.isFinite(ie.y)||!Number.isFinite(ie.z)))return[];if(e.type==="catmull"&&B.length>1)try{return new _l(B).getPoints(B.length*10)}catch{return B}return B},[B,e.type]),z=Y.useMemo(()=>{if(e.color==="rainbow"&&U.length>0)return U.map((ie,se)=>{const I=se/(U.length-1),W=new qt().setHSL(I,1,.5);return W.multiplyScalar(e.intensity??1.5),[W.r,W.g,W.b]})},[e.color,U,e.intensity]),P=Y.useMemo(()=>{if(e.color==="rainbow")return"#ffffff";const ie=new qt(e.color);return ie.multiplyScalar(e.intensity??1.5),ie},[e.color,e.intensity]),L=Y.useMemo(()=>e.type==="tube"&&B.length>1?new _l(B):null,[e.type,B]),O=Y.useMemo(()=>{if(!e.filled||B.length<3)return null;try{const ie=new Yi().setFromPoints(B),se=new k;ie.getSize(se);let I="xy";se.z<se.x&&se.z<se.y?I="xy":se.y<se.x&&se.y<se.z?I="xz":I="yz";const W=B.map($=>I==="xy"?new gt($.x,$.y):I==="xz"?new gt($.x,$.z):new gt($.y,$.z)),fe=Ml.triangulateShape(W,[]),Z=new Rn,me=[];return fe.forEach($=>{$.forEach(pe=>{const ve=B[pe];me.push(ve.x,ve.y,ve.z)})}),Z.setAttribute("position",new $t(me,3)),Z.computeVertexNormals(),Z}catch(ie){return console.error("Triangulation failed",ie),null}},[e.filled,B]);Y.useLayoutEffect(()=>{A.current&&(A.current.position.copy(F),A.current.rotation.set(0,0,0),A.current.scale.set(1,1,1),A.current.updateMatrix())},[F]);const ee=()=>{if(A.current){A.current.updateMatrixWorld();const ie=A.current.matrixWorld,se=B.map(I=>I.clone().applyMatrix4(ie));h(se)}},Q=()=>{if(c==null||!R.current[c]||!A.current)return;const ie=R.current[c];if(!ie)return;const se=ie.position.clone(),I=[...B];I[c]=se,A.current.updateMatrixWorld();const W=A.current.matrixWorld,fe=I.map(Z=>Z.clone().applyMatrix4(W));h(fe)},te=ie=>{if(ie.stopPropagation(),n==="edit-points"&&S&&A.current){const se=ie.point;A.current.updateMatrixWorld();const I=A.current.matrixWorld,W=B.map(me=>me.clone().applyMatrix4(I));let fe=0,Z=1/0;for(let me=0;me<W.length-1;me++){const $=W[me],pe=W[me+1],ve=new XS($,pe),ze=new k;ve.closestPointToPoint(se,!0,ze);const Ge=ze.distanceTo(se);Ge<Z&&(Z=Ge,fe=me)}S(se,fe),b&&b(fe+1);return}u(ie,ie.shiftKey),b&&b(null)},ne=t&&n==="edit-points"&&!o,re=t&&n==="select-object"&&!o,j=t&&n==="edit-points"&&c!==null&&c!==void 0&&!o,J=n.startsWith("draw")||n.startsWith("create")||o?{raycast:null}:{onPointerMove:m,onPointerOut:x,onClick:te};if(n==="erase"&&(J.onClick=u,J.onPointerMove=ie=>{document.body.style.cursor="crosshair"}),U.length===0)return null;if(R.current.length!==B.length&&(R.current=Array(B.length).fill(null)),e.type==="text")return y.jsxs("group",{ref:A,...J,children:[y.jsx(s3,{position:[0,0,0],fontSize:e.fontSize||1,color:t?"#ffffff":P,anchorX:"center",anchorY:"middle",outlineWidth:t?.05:0,outlineColor:"#ffffff",children:e.text||"Text"}),t&&y.jsx("mesh",{visible:!1,children:y.jsx("boxGeometry",{args:[1,1,1]})})," ",re&&y.jsx(lc,{object:A,mode:i,onMouseDown:()=>g(!0),onMouseUp:()=>{ee(),g(!1)},size:1,space:"local"})]});if(e.type==="dimension"&&B.length>=2){const ie=B[0],se=B[1],I=ie.distanceTo(se),W=ie.clone().add(se).multiplyScalar(.5);return y.jsxs("group",{ref:A,...J,children:[y.jsx(nx,{points:[ie,se],color:t?"#ffffff":P,lineWidth:2,dashed:!0}),y.jsxs("mesh",{position:ie,children:[y.jsx("sphereGeometry",{args:[.05]}),y.jsx("meshBasicMaterial",{color:P})]}),y.jsxs("mesh",{position:se,children:[y.jsx("sphereGeometry",{args:[.05]}),y.jsx("meshBasicMaterial",{color:P})]}),y.jsxs(s3,{position:W.clone().add(new k(0,.2,0)),fontSize:.3,color:t?"#ffffff":P,anchorX:"center",anchorY:"bottom",children:[I.toFixed(2),"m"]}),re&&y.jsx(lc,{object:A,mode:i,onMouseDown:()=>g(!0),onMouseUp:()=>{ee(),g(!1)},size:1,space:"local"})]})}return y.jsxs(y.Fragment,{children:[y.jsxs("group",{ref:A,children:[e.filled&&O&&y.jsx("mesh",{geometry:O,...J,children:y.jsx("meshStandardMaterial",{color:P,side:Oi,transparent:!0,opacity:(e.opacity??1)*.5,roughness:.8,wireframe:M})}),e.type==="tube"&&L?y.jsx(yR,{path:L,tubularSegments:e.tubularSegments||64,radiusStart:(e.startWidth||e.width)*.1,radiusMid:e.width*.1,radiusEnd:(e.endWidth||e.width)*.1,radialSegments:e.radialSegments||8,interactionProps:J,materialProps:{color:P,emissive:P,emissiveIntensity:.5,transparent:!0,opacity:n==="define-plane"?.5:t?1:e.opacity??1,roughness:.2,metalness:.8,wireframe:M}}):y.jsx(nx,{points:U,color:t?"#ffffff":P,vertexColors:e.color==="rainbow"?z:void 0,lineWidth:e.width*5,dashed:!!e.dashed,dashScale:e.dashScale||1,dashSize:e.dashSize||1,gapSize:e.gapSize||1,transparent:!0,opacity:n==="define-plane"?.5:t?1:e.opacity??1,toneMapped:!1,frustumCulled:!1,segments:e.type==="segments",...J}),t&&y.jsx(nx,{points:B,color:"#ffff00",lineWidth:1,transparent:!0,opacity:.3,toneMapped:!1,frustumCulled:!1,segments:e.type==="segments"}),ne&&B.map((ie,se)=>y.jsxs("mesh",{ref:I=>R.current[se]=I,position:ie,onClick:I=>{I.stopPropagation(),b&&b(se)},onPointerOver:()=>document.body.style.cursor="move",onPointerOut:()=>document.body.style.cursor="auto",children:[y.jsx("boxGeometry",{args:[c===se?.2:.1,c===se?.2:.1,c===se?.2:.1]}),y.jsx("meshBasicMaterial",{color:c===se?"#ff0000":"#ffff00",depthTest:!1,transparent:!0,opacity:.9})]},se)),j&&c!==null&&c!==void 0&&R.current[c]&&y.jsx(lc,{object:R.current[c],mode:"translate",size:.6,space:"local",onMouseDown:()=>g(!0),onMouseUp:()=>g(!1),onObjectChange:Q})]}),re&&y.jsx(lc,{object:A,mode:i,onMouseDown:()=>g(!0),onMouseUp:()=>{ee(),g(!1)},size:1,space:"local"})]})},b_=(s,e,t)=>{if(e.length<2)return e;const n=e[0],i=e[e.length-1],a=t.clone().invert(),o=i.clone().sub(n).applyQuaternion(a);let c=[];if(s==="draw-line")c.push(new k(0,0,0)),c.push(o);else if(s==="draw-rectangle"||s==="draw-golden-rect"){let u=o.x,h=o.y;if(s==="draw-golden-rect"){const m=1.61803398875,x=Math.sign(h)||1;h=Math.abs(u)/m*x}c.push(new k(0,0,0)),c.push(new k(u,0,0)),c.push(new k(u,h,0)),c.push(new k(0,h,0)),c.push(new k(0,0,0))}else if(s==="draw-golden-spiral"){const h=Math.log(1.61803398875)/(Math.PI/2),m=4*Math.PI,x=o.length(),g=Math.atan2(o.y,o.x);for(let b=0;b<m;b+=.1){const S=x*Math.exp(h*(b-m)),C=g-(m-b);c.push(new k(Math.cos(C)*S,Math.sin(C)*S,0))}}else if(s==="draw-rhombus"){const u=o.x,h=o.y;c.push(new k(0,-h,0)),c.push(new k(u,0,0)),c.push(new k(0,h,0)),c.push(new k(-u,0,0)),c.push(new k(0,-h,0))}else if(s==="draw-teardrop"){const u=o.length(),h=Math.atan2(o.y,o.x)-Math.PI/2;for(let m=0;m<=64;m++){const x=m/64*Math.PI*2,g=Math.cos(x),b=Math.sin(x)*Math.pow(Math.sin(x/2),4),S=g*Math.cos(h)-b*Math.sin(h),C=g*Math.sin(h)+b*Math.cos(h);c.push(new k(S*u*2,C*u*2,0))}}else if(s==="draw-heart"){const u=o.length()*.05;for(let h=0;h<=64;h++){const m=h/64*Math.PI*2,x=16*Math.pow(Math.sin(m),3),g=13*Math.cos(m)-5*Math.cos(2*m)-2*Math.cos(3*m)-Math.cos(4*m);c.push(new k(x*u,g*u,0))}}else if(s==="draw-semicircle"){const u=o.length()/2,h=o.clone().multiplyScalar(.5),m=Math.atan2(o.y,o.x);for(let x=0;x<=32;x++){const g=x/32*Math.PI+m+Math.PI;c.push(new k(h.x+Math.cos(g)*u,h.y+Math.sin(g)*u,0))}c.push(new k(0,0,0)),c.push(o),c.push(c[0])}else if(s==="draw-quartercircle"){const u=o.length(),h=Math.atan2(o.y,o.x);c.push(new k(0,0,0));for(let m=0;m<=16;m++){const x=m/16*(Math.PI/2);c.push(new k(u*Math.cos(h+x-Math.PI/4),u*Math.sin(h+x-Math.PI/4),0))}c.push(new k(0,0,0))}else if(s==="draw-circle"||s==="draw-triangle"||s==="draw-hexagon"){const u=o.length(),h=s==="draw-triangle"?3:s==="draw-hexagon"?6:64,m=s==="draw-triangle"?-Math.PI/2:0;for(let x=0;x<=h;x++){const g=x/h*Math.PI*2+m;c.push(new k(Math.cos(g)*u,Math.sin(g)*u,0))}}else if(s==="draw-circle-2pt"){const u=o.clone().multiplyScalar(.5),h=o.length()/2,m=64;for(let x=0;x<=m;x++){const g=x/m*Math.PI*2;c.push(new k(u.x+Math.cos(g)*h,u.y+Math.sin(g)*h,0))}}else if(s==="draw-star"){const u=o.length(),h=u*.4,m=5;for(let x=0;x<=m*2;x++){const g=x%2===0?u:h,b=x/(m*2)*Math.PI*2-Math.PI/2;c.push(new k(Math.cos(b)*g,Math.sin(b)*g,0))}}else if(s==="draw-ellipse"){const u=Math.abs(o.x/2),h=Math.abs(o.y/2),m=new k(o.x/2,o.y/2,0),x=64;for(let g=0;g<=x;g++){const b=g/x*Math.PI*2;c.push(new k(m.x+u*Math.cos(b),m.y+h*Math.sin(b),0))}}return c.length>0&&(c=c.map(u=>u.applyQuaternion(t).add(n))),c.some(u=>!Number.isFinite(u.x)||!Number.isFinite(u.y)||!Number.isFinite(u.z))?[n,i]:c},pj=({mode:s,customPlane:e,drawingAids:t,lines:n,models:i,currentPoints:a,layers:o,onDrawStart:c,onDrawMove:u,onDrawEnd:h,onFinishShape:m,drawingPlaneMode:x,gridSettings:g,selectedLineIds:b})=>{const{camera:S,size:C}=ti(),M=Y.useRef(null),A=Y.useRef(!1),[R,N]=Y.useState(null),B=Y.useRef({onDrawStart:c,onDrawMove:u,onDrawEnd:h,onFinishShape:m});B.current={onDrawStart:c,onDrawMove:u,onDrawEnd:h,onFinishShape:m};const F=Y.useRef(new Fn);Rl(()=>{if(M.current&&(s.startsWith("draw")||s.startsWith("create")||s.startsWith("place-primitive-"))){if(e)M.current.position.copy(e.position),M.current.quaternion.copy(e.quaternion);else if(x==="ground")if(g){M.current.position.set(...g.position);const ne=new Fn().setFromEuler(new hi(...g.rotation)),re=new Fn().setFromAxisAngle(new k(1,0,0),-Math.PI/2);M.current.quaternion.copy(ne).multiply(re)}else M.current.position.set(0,0,0),M.current.rotation.set(-Math.PI/2,0,0);else M.current.position.set(0,0,0),M.current.quaternion.copy(S.quaternion);F.current.copy(M.current.quaternion)}});const U=ne=>{let re=ne.clone(),j=!1;if(t.snap){let J=1/0,ie=null;const se=t.snapOptions,I=(W,fe)=>{const Z=W.distanceTo(ne);Z<1&&Z<J&&(J=Z,ie={pos:W.clone(),type:fe})};n.forEach(W=>{const fe=o.find(Z=>Z.id===W.layerId);if(!(fe&&!fe.visible)&&W.points.length>0){if(se.endpoint&&(I(W.points[0],"endpoint"),I(W.points[W.points.length-1],"endpoint")),se.midpoint)for(let Z=0;Z<W.points.length-1;Z++){const me=new k().addVectors(W.points[Z],W.points[Z+1]).multiplyScalar(.5);I(me,"midpoint")}if(se.center&&W.points.length>0){let Z=0,me=0,$=0;W.points.forEach(pe=>{Z+=pe.x,me+=pe.y,$+=pe.z}),I(new k(Z/W.points.length,me/W.points.length,$/W.points.length),"center")}}}),ie&&(re.copy(ie.pos),N(ie),j=!0)}if(!j&&(N(null),a.length>0&&(t.ortho||t.polar))){const ae=a[a.length-1],J=F.current.clone().invert(),ie=re.clone().sub(ae).applyQuaternion(J);if(t.ortho)Math.abs(ie.x)>Math.abs(ie.y)?ie.y=0:ie.x=0;else if(t.polar){const I=Math.atan2(ie.y,ie.x),W=Math.PI/4,fe=Math.round(I/W)*W,Z=ie.length();ie.x=Math.cos(fe)*Z,ie.y=Math.sin(fe)*Z}const se=ie.applyQuaternion(F.current).add(ae);re.copy(se)}return re},[z,P]=Y.useState(null),L=["draw-rectangle","draw-circle","draw-circle-2pt","draw-triangle","draw-hexagon","draw-line","draw-star","draw-ellipse","draw-rhombus","draw-semicircle","draw-quartercircle","draw-teardrop","draw-heart","draw-golden-spiral","draw-golden-rect","draw-dimension","draw-dimension-radius"].includes(s),O=Y.useMemo(()=>a.length===0&&!z?[]:L?a.length===1&&z?b_(s,[a[0],z],F.current):b_(s,a,F.current):z?[...a,z]:a,[a,z,s,L]),ee=ne=>{ne.stopPropagation(),A.current=!0;const re=U(ne.point);P(re),M.current&&B.current.onDrawStart(re,F.current)},Q=ne=>{const re=U(ne.point);P(re),(A.current||s.startsWith("draw")||s.startsWith("create"))&&M.current&&B.current.onDrawMove(re)},te=ne=>{if(A.current){if(s==="draw-text"||s.startsWith("place-primitive-")){A.current=!1;return}if(L){A.current=!1;const re=U(ne.point);if(a.length>=1){const j=s==="draw-dimension"?[a[0],re]:b_(s,[a[0],re],F.current);B.current.onFinishShape(j);return}}else A.current=!1,B.current.onDrawEnd()}};return!s.startsWith("draw")&&!s.startsWith("create")&&!s.startsWith("place-primitive-")?null:y.jsxs(y.Fragment,{children:[y.jsxs("mesh",{ref:M,onPointerDown:ee,onPointerMove:Q,onPointerUp:te,children:[y.jsx("planeGeometry",{args:[1e4,1e4]}),y.jsx("meshBasicMaterial",{side:Oi,transparent:!0,opacity:0,depthWrite:!1})]}),e&&y.jsxs("group",{position:e.position,quaternion:e.quaternion,children:[y.jsx("group",{rotation:[Math.PI/2,0,0],children:y.jsx(fR,{args:[20,20],cellSize:1,cellThickness:.5,cellColor:"#444",sectionSize:5,sectionThickness:1,sectionColor:"#888",fadeDistance:30,infiniteGrid:!0})}),y.jsx("axesHelper",{args:[2]})]}),R&&y.jsx("group",{position:R.pos,children:y.jsxs("mesh",{children:[y.jsx("boxGeometry",{args:[.3,.3,.3]}),y.jsx("meshBasicMaterial",{color:"#fbbf24",depthTest:!1,transparent:!0,opacity:.5})]})}),O.length>0&&y.jsx(nx,{points:O,color:"#ffff00",lineWidth:2,dashed:!1,transparent:!0,opacity:.7}),z&&s.startsWith("draw")&&!L&&y.jsxs("mesh",{position:z,children:[y.jsx("sphereGeometry",{args:[.1]}),y.jsx("meshBasicMaterial",{color:"#ffff00"})]})]})},mj=({settings:s,lines:e,onUpdate:t,setDragging:n})=>{const i=Y.useRef(null);Y.useEffect(()=>{i.current&&(i.current.position.set(...s.position),i.current.rotation.set(...s.rotation),i.current.scale.set(...s.scale))},[s.position,s.rotation,s.scale]);const a=()=>{i.current&&t([i.current.position.x,i.current.position.y,i.current.position.z],[i.current.rotation.x,i.current.rotation.y,i.current.rotation.z],[i.current.scale.x,i.current.scale.y,i.current.scale.z]),n(!1)};return!s.enabled||!s.visible?null:y.jsxs(y.Fragment,{children:[y.jsxs("group",{ref:i,children:[s.mode==="mirror"&&y.jsxs(y.Fragment,{children:[s.mirrorX&&y.jsxs("mesh",{rotation:[0,Math.PI/2,0],children:[y.jsx("planeGeometry",{args:[20,20]}),y.jsx("meshBasicMaterial",{color:"#ef4444",transparent:!0,opacity:.1,side:Oi,depthWrite:!1}),y.jsxs("lineSegments",{children:[y.jsx("edgesGeometry",{args:[new is(20,20)]}),y.jsx("lineBasicMaterial",{color:"#ef4444",transparent:!0,opacity:.3})]})]}),s.mirrorY&&y.jsxs("mesh",{rotation:[Math.PI/2,0,0],children:[y.jsx("planeGeometry",{args:[20,20]}),y.jsx("meshBasicMaterial",{color:"#22c55e",transparent:!0,opacity:.1,side:Oi,depthWrite:!1}),y.jsxs("lineSegments",{children:[y.jsx("edgesGeometry",{args:[new is(20,20)]}),y.jsx("lineBasicMaterial",{color:"#22c55e",transparent:!0,opacity:.3})]})]}),s.mirrorZ&&y.jsxs("mesh",{children:[y.jsx("planeGeometry",{args:[20,20]}),y.jsx("meshBasicMaterial",{color:"#3b82f6",transparent:!0,opacity:.1,side:Oi,depthWrite:!1}),y.jsxs("lineSegments",{children:[y.jsx("edgesGeometry",{args:[new is(20,20)]}),y.jsx("lineBasicMaterial",{color:"#3b82f6",transparent:!0,opacity:.3})]})]})]}),s.mode==="radial"&&y.jsxs("group",{children:[y.jsxs("mesh",{rotation:s.radialAxis==="y"?[Math.PI/2,0,0]:s.radialAxis==="z"?[0,0,0]:[0,Math.PI/2,0],children:[y.jsx("ringGeometry",{args:[4.9,5,64]}),y.jsx("meshBasicMaterial",{color:"#06b6d4",side:Oi,transparent:!0,opacity:.5})]}),y.jsxs("mesh",{rotation:s.radialAxis==="x"?[0,0,Math.PI/2]:s.radialAxis==="z"?[Math.PI/2,0,0]:[0,0,0],children:[y.jsx("cylinderGeometry",{args:[.05,.05,10,8]}),y.jsx("meshBasicMaterial",{color:"#06b6d4",transparent:!0,opacity:.5})]}),Array.from({length:s.radialCount}).map((o,c)=>y.jsx("mesh",{rotation:s.radialAxis==="y"?[0,c*Math.PI*2/s.radialCount,0]:s.radialAxis==="x"?[c*Math.PI*2/s.radialCount,0,0]:[0,0,c*Math.PI*2/s.radialCount],children:y.jsxs("mesh",{position:s.radialAxis==="y"?[2.5,0,0]:s.radialAxis==="x"?[0,2.5,0]:[2.5,0,0],children:[y.jsx("boxGeometry",{args:s.radialAxis==="y"?[5,.05,.05]:s.radialAxis==="x"?[.05,5,.05]:[5,.05,.05]}),y.jsx("meshBasicMaterial",{color:"#06b6d4",transparent:!0,opacity:.3})]})},c))]}),s.mode==="array"&&y.jsxs("group",{children:[(()=>{const o=[],{arrayCountX:c,arrayCountY:u,arrayCountZ:h,arraySpacingX:m,arraySpacingY:x,arraySpacingZ:g}=s,b=1e3;let S=0;for(let C=0;C<c;C++)for(let M=0;M<u;M++)for(let A=0;A<h;A++)if(!(C===0&&M===0&&A===0)){if(S>b)break;o.push(y.jsxs("mesh",{position:[C*m,M*x,A*g],children:[y.jsx("boxGeometry",{args:[.2,.2,.2]}),y.jsx("meshBasicMaterial",{color:"#14b8a6",wireframe:!0,transparent:!0,opacity:.5})]},`${C}-${M}-${A}`)),S++}return o})(),y.jsxs("mesh",{position:[(s.arrayCountX-1)*s.arraySpacingX/2,(s.arrayCountY-1)*s.arraySpacingY/2,(s.arrayCountZ-1)*s.arraySpacingZ/2],children:[y.jsx("boxGeometry",{args:[Math.max(.5,(s.arrayCountX-1)*s.arraySpacingX+.5),Math.max(.5,(s.arrayCountY-1)*s.arraySpacingY+.5),Math.max(.5,(s.arrayCountZ-1)*s.arraySpacingZ+.5)]}),y.jsx("meshBasicMaterial",{color:"#14b8a6",wireframe:!0,transparent:!0,opacity:.2})]})]}),s.mode==="path"&&s.pathId&&y.jsx("group",{children:(()=>{const o=e.find(m=>m.id===s.pathId);if(!o||o.points.length<2)return null;const c=new _l(o.points,!1),u=Math.max(2,s.pathCount),h=[];for(let m=0;m<u;m++){const x=m/(u-1),g=c.getPointAt(x);h.push(y.jsxs("mesh",{position:g,children:[y.jsx("sphereGeometry",{args:[.2]}),y.jsx("meshBasicMaterial",{color:"#14b8a6",wireframe:!0,transparent:!0,opacity:.5})]},m))}return h})()})]}),s.gizmoTranslate&&y.jsx(lc,{object:i,mode:"translate",onMouseDown:()=>n(!0),onMouseUp:a,size:1}),s.gizmoRotate&&y.jsx(lc,{object:i,mode:"rotate",showX:!0,showY:!0,showZ:!0,onMouseDown:()=>n(!0),onMouseUp:a,size:.8}),s.gizmoScale&&y.jsx(lc,{object:i,mode:"scale",onMouseDown:()=>n(!0),onMouseUp:a,size:.6})]})},xj=({lines:s,models:e=[],currentPoints:t,color:n,width:i,mode:a,activeView:o,customPlane:c,transformMode:u,selectedLineId:h,selectedModelId:m,isViewLocked:x,drawingAids:g,layers:b,onDrawStart:S,onDrawMove:C,onDrawEnd:M,onSnapPointSelected:A,onSelectLine:R,onSelectModel:N,onUpdateLine:B,onUpdateModel:F,onUpdateModelGeometry:U,onFinishShape:z,activePointIndex:P,onPointSelect:L,onAddPoint:O,animationsRef:ee,onRegisterObject:Q,objectRegistry:te,onDeleteObject:ne,cameraFov:re,exposure:j,bgColor:ae,drawingPlaneMode:J,gridSettings:ie,isGridSelected:se,onUpdateGrid:I,isWireframe:W,hdriUrl:fe,showHdriBackground:Z,showStars:me,starSettings:$,voxelSize:pe,onVoxelAction:ve,objectColor:ze,symmetrySettings:Ge,onUpdateSymmetry:Fe,turntableSettings:Qe,onUpdateTurntableTarget:lt,selectedLineIds:De,onBoxSelect:le,onAddCube:Ye,onChangeMode:Ze})=>{const[je,He]=Y.useState(!1),[et,Ne]=Y.useState(!1);U8(et,"pointer","auto");const[st,oe]=Y.useState(!1);Y.useEffect(()=>(a==="voxel-paint"?document.body.style.cursor=st?"none":"crosshair":a.startsWith("draw")||a.startsWith("create")||a.startsWith("place")?document.body.style.cursor="crosshair":a==="edit-points"&&et?document.body.style.cursor="move":document.body.style.cursor=et?"pointer":"auto",()=>{document.body.style.cursor="auto"}),[a,et,st]);const X=Y.useRef(null),Ae=Y.useCallback(()=>{X.current&&I&&I([X.current.position.x,X.current.position.y,X.current.position.z],[X.current.rotation.x,X.current.rotation.y,X.current.rotation.z],[X.current.scale.x,X.current.scale.y,X.current.scale.z])},[I]);return y.jsx("div",{className:"w-full h-full relative",children:y.jsxs(A8,{shadows:!0,camera:{position:[10,10,10],fov:re},gl:{preserveDrawingBuffer:!0,antialias:!0,toneMapping:aS,toneMappingExposure:j},style:{background:ae},onPointerMissed:Pe=>{Pe.type==="click"&&(R(null),N==null||N(null))},children:[y.jsx(lj,{exposure:j}),y.jsx(rj,{view:o}),y.jsx(cj,{animationsRef:ee}),y.jsx(Z9,{makeDefault:!0,enabled:!je&&!x&&(a==="polygonal-modeling"||a==="view"||a==="select-object"||a==="voxel-paint"||a.startsWith("draw")||a.startsWith("create")||a.startsWith("place"))}),Qe&&y.jsx(oj,{settings:Qe,onUpdateTarget:lt}),y.jsx("ambientLight",{intensity:.5}),y.jsx("pointLight",{position:[10,10,10],intensity:1,castShadow:!0}),y.jsx("pointLight",{position:[-10,-10,-10],intensity:.5}),me&&$&&y.jsx(RG,{radius:100,depth:$.depth,count:$.count,factor:$.factor,saturation:0,fade:!0,speed:1}),fe&&y.jsx(EG,{files:fe,background:Z}),y.jsxs("group",{ref:X,position:ie==null?void 0:ie.position,rotation:ie==null?void 0:ie.rotation,scale:ie==null?void 0:ie.scale,children:[(ie==null?void 0:ie.visible)&&y.jsx(fR,{args:[100,100],cellSize:ie.cellSize,cellThickness:ie.cellThickness,cellColor:ie.cellColor,sectionSize:ie.sectionSize,sectionThickness:ie.sectionThickness,sectionColor:ie.sectionColor,fadeDistance:ie.fadeDistance,fadeStrength:ie.fadeStrength,infiniteGrid:!0,side:ie.doubleSide?Oi:fr}),J==="ground"&&(a.startsWith("draw")||a.startsWith("create")||a.startsWith("place"))&&y.jsxs("mesh",{rotation:[-Math.PI/2,0,0],position:[0,.01,0],children:[y.jsx("planeGeometry",{args:[100,100]}),y.jsx("meshBasicMaterial",{color:"#ffffff",transparent:!0,opacity:.05,depthWrite:!1,side:Oi})]})]}),se&&(ie==null?void 0:ie.visible)&&I&&y.jsx(lc,{object:X,mode:u,onMouseDown:()=>He(!0),onMouseUp:()=>{He(!1),Ae()}}),s.map(Pe=>{const Ue=b.find(vt=>vt.id===Pe.layerId);if(Ue&&!Ue.visible)return null;const Be=Ue&&Ue.locked,bt=De?De.has(Pe.id):!1;return y.jsx(dj,{line:Pe,isSelected:h===Pe.id||bt,mode:a,transformMode:u,customPlane:c,isLocked:Be,activePointIndex:P,onSelect:(vt,It)=>R(Pe.id,It),onUpdate:vt=>B(Pe.id,vt),onHover:vt=>{!Be&&(a==="select-object"||a==="edit-points")&&(vt.stopPropagation(),Ne(!0))},onUnhover:vt=>Ne(!1),setDragging:He,onPointSelect:L,onAddPoint:O,onRegisterObject:Q,isWireframe:W},Pe.id)}),e==null?void 0:e.map(Pe=>{const Ue=b.find(bt=>bt.id===Pe.layerId);if(Ue&&!Ue.visible)return null;const Be=Ue&&Ue.locked;return y.jsx(hj,{model:Pe,isSelected:m===Pe.id,isLocked:Be,transformMode:u,onSelect:(bt,vt)=>N==null?void 0:N(Pe.id,vt),onUpdate:(bt,vt,It)=>F==null?void 0:F(Pe.id,bt,vt,It),setDragging:He,onRegisterObject:Q,mode:a,onDrawMove:C,onDrawStart:S,isWireframe:W},Pe.id)}),y.jsx(pj,{mode:a,customPlane:c,drawingAids:g,lines:s,models:e||[],currentPoints:t,layers:b,onDrawStart:S,onDrawMove:C,onDrawEnd:M,onFinishShape:z,drawingPlaneMode:J,gridSettings:ie}),t.length>0&&y.jsxs(y.Fragment,{children:[a==="draw-tube"&&t.length>1?y.jsx(yR,{path:new _l(t),tubularSegments:64,radiusStart:i*.1,radiusMid:i*.1,radiusEnd:i*.1,radialSegments:8,interactionProps:{},materialProps:{color:n,transparent:!0,opacity:.5}}):y.jsx(nx,{points:t,color:n,lineWidth:i*5,transparent:!0,opacity:.5,depthTest:!1}),t.map((Pe,Ue)=>y.jsxs("mesh",{position:Pe,children:[y.jsx("sphereGeometry",{args:[.05]}),y.jsx("meshBasicMaterial",{color:n})]},Ue)),a==="create-cube-2pt"&&t.length===2&&y.jsx(fj,{start:t[0],end:t[1],color:n})]}),Ge&&Fe&&y.jsx(mj,{settings:Ge,lines:s,onUpdate:Fe,setDragging:He}),a==="voxel-paint"&&ve&&y.jsx(uj,{size:pe||1,color:ze||"#ffffff",setHovered:oe,onAction:ve,gridSettings:ie}),a==="box-select"&&le&&y.jsx(sj,{active:!0,onSelect:le,lines:s,models:e||[],layers:b}),a==="polygonal-modeling"&&y.jsx(aj,{selectedModelId:m||null,objectRegistry:te,onUpdateModel:(Pe,Ue)=>{U&&U(Pe,Ue)},onExit:()=>{Ze&&Ze("view")}}),y.jsx(tG,{alignment:"top-right",margin:[80,80],children:y.jsx(lG,{color:"#202020",strokeColor:"#505050",textColor:"#ffffff",hoverColor:"#404040"})})]})})},gj=({onStart:s,onStartVoxel:e})=>y.jsxs("div",{className:"w-full h-full bg-[#050505] text-white flex flex-col items-center justify-center relative overflow-hidden select-none",children:[y.jsxs("div",{className:"absolute top-0 left-0 w-full h-full overflow-hidden pointer-events-none z-0",children:[y.jsx("div",{className:"absolute top-1/4 left-1/4 w-96 h-96 bg-blue-600/20 rounded-full blur-[100px] animate-pulse"}),y.jsx("div",{className:"absolute bottom-1/4 right-1/4 w-96 h-96 bg-cyan-500/10 rounded-full blur-[100px] animate-pulse delay-1000"}),y.jsx("div",{className:"absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-20"})]}),y.jsxs("div",{className:"z-10 flex flex-col items-center space-y-8 max-w-4xl px-6 text-center",children:[y.jsxs("div",{className:"space-y-2 animate-fade-in-down",children:[y.jsx("h1",{className:"text-7xl md:text-9xl font-black tracking-tighter",children:y.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-green-400 via-cyan-500 to-blue-600 drop-shadow-[0_0_30px_rgba(34,211,238,0.5)]",children:"NeonFlow"})}),y.jsx("p",{className:"text-xl md:text-2xl text-gray-400 font-light tracking-wide",children:"The Next Generation of 3D Voxel & Vector Design"})]}),y.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 w-full max-w-2xl mt-8",children:[y.jsx(Wv,{icon:y.jsx(kc,{size:24}),label:"Voxel Engine",color:"border-green-500/50 text-green-400",onClick:e}),y.jsx(Wv,{icon:y.jsx(lF,{size:24}),label:"Fast Rendering",color:"border-yellow-500/50 text-yellow-400"}),y.jsx(Wv,{icon:y.jsx(uT,{size:24}),label:"Layer System",color:"border-purple-500/50 text-purple-400"}),y.jsx(Wv,{icon:y.jsx(F_,{size:24}),label:"Precise Tools",color:"border-pink-500/50 text-pink-400"})]}),y.jsxs("button",{onClick:s,className:"group relative px-8 py-4 bg-transparent border border-cyan-500/50 text-cyan-400 text-lg font-semibold rounded-full overflow-hidden transition-all duration-300 hover:border-cyan-400 hover:text-white hover:shadow-[0_0_20px_rgba(34,211,238,0.6)] mt-12",children:[y.jsx("div",{className:"absolute inset-0 w-0 bg-cyan-500 transition-all duration-[250ms] ease-out group-hover:w-full opacity-20"}),y.jsxs("span",{className:"relative flex items-center gap-3",children:["Enter Workspace ",y.jsx(JI,{size:20,className:"group-hover:translate-x-1 transition-transform"})]})]}),y.jsx("div",{className:"absolute bottom-8 text-gray-600 text-sm",children:"v1.0.0  Professional Edition"})]})]}),Wv=({icon:s,label:e,color:t,onClick:n})=>y.jsxs("div",{onClick:n,className:`flex flex-col items-center justify-center p-4 border rounded-2xl bg-white/5 backdrop-blur-sm ${t} transition-transform hover:scale-105 ${n?"cursor-pointer hover:bg-white/10":""}`,children:[y.jsx("div",{className:"mb-2",children:s}),y.jsx("span",{className:"text-xs font-medium uppercase tracking-wider",children:e})]}),__=.05,S_={id:"layer-1",name:"Layer 1",visible:!0,locked:!1},vj=()=>{const[s,e]=Y.useState(!0),[t,n]=Y.useState([]),[i,a]=Y.useState([]),[o,c]=Y.useState([S_]),[u,h]=Y.useState("layer-1"),[m,x]=Y.useState([]),[g,b]=Y.useState("view"),[S,C]=Y.useState("Sample Text"),[M,A]=Y.useState(null),[R,N]=Y.useState([]),[B,F]=Y.useState("view"),[U,z]=Y.useState("#808080"),[P,L]=Y.useState(1),[O,ee]=Y.useState(32),[Q,te]=Y.useState([1,1,1]),[ne,re]=Y.useState(1),[j,ae]=Y.useState({visible:!0,cellSize:1,cellThickness:.5,cellColor:"#333333",sectionSize:5,sectionThickness:1,sectionColor:"#666666",fadeDistance:50,fadeStrength:1,doubleSide:!1,position:[0,-2,0],rotation:[0,0,0],scale:[1,1,1]}),[J,ie]=Y.useState({enabled:!1,visible:!0,mode:"mirror",position:[0,0,0],rotation:[0,0,0],scale:[1,1,1],mirrorX:!0,mirrorY:!1,mirrorZ:!1,radialCount:6,radialAxis:"y",arrayCountX:3,arrayCountY:3,arrayCountZ:1,arraySpacingX:2,arraySpacingY:2,arraySpacingZ:2,pathCount:10,pathAlign:!0,gizmoTranslate:!0,gizmoRotate:!1,gizmoScale:!1}),[se,I]=Y.useState({active:!1,speed:.5,direction:1,range:360,loop:!0,target:[0,0,0],showGizmo:!1}),[W,fe]=Y.useState(!1),[Z,me]=Y.useState({ortho:!1,polar:!1,snap:!1,snapOptions:{endpoint:!0,midpoint:!0,nearest:!0,center:!0,grid:!1}}),[$,pe]=Y.useState(null),[ve,ze]=Y.useState(new Set),[Ge,Fe]=Y.useState(null),[Qe,lt]=Y.useState(null),[De,le]=Y.useState("translate"),[Ye,Ze]=Y.useState(null),[je,He]=Y.useState(null),[et,Ne]=Y.useState(!1),[st,oe]=Y.useState("#3b82f6"),[X,Ae]=Y.useState(1.5),[Pe,Ue]=Y.useState(1),[Be,bt]=Y.useState(1.5),[vt,It]=Y.useState(64),[zt,qe]=Y.useState(8),[We,ft]=Y.useState(1.5),[ge,Ie]=Y.useState(1.5),[ht,ye]=Y.useState(!1),[Re,pt]=Y.useState(!1),[Rt,dt]=Y.useState(1),[Ke,Lt]=Y.useState("1:1"),[Vt,Kt]=Y.useState(2),[on,Gn]=Y.useState(!1),[En,li]=Y.useState(.2),[qi,la]=Y.useState(.1),[di,Qi]=Y.useState(3),[Mi,mn]=Y.useState(32),[jn,bn]=Y.useState(360),[q,he]=Y.useState("y"),[we,Je]=Y.useState(0),[ot,ct]=Y.useState(100),[Ot,Dt]=Y.useState(!1),[Nt,K]=Y.useState(!0),[be,xe]=Y.useState(50),[Oe,Me]=Y.useState(0),[$e,yt]=Y.useState(1),[Mt,Ft]=Y.useState(0),[mt,Pt]=Y.useState(1),[en,Qt]=Y.useState(!0),[yn,ln]=Y.useState(32),[xn,Un]=Y.useState(360),[an,Bn]=Y.useState("y"),[tn,Hn]=Y.useState(0),[kn,hn]=Y.useState(0),[Ni,Yn]=Y.useState(!1),[Wn,xi]=Y.useState(45),[ki,Di]=Y.useState(1.5),[Ga,Ka]=Y.useState("#050505"),[hr,To]=Y.useState(!1),[vs,Nl]=Y.useState(null),[dr,ys]=Y.useState(!0),[da,qs]=Y.useState(!0),[ho,bs]=Y.useState({count:5e3,depth:50,factor:4}),[ja,Or]=Y.useState(()=>{const ce=localStorage.getItem("neonflow_custom_brushes");return ce?JSON.parse(ce):[]});Y.useEffect(()=>{localStorage.setItem("neonflow_custom_brushes",JSON.stringify(ja))},[ja]),Y.useRef(null),Y.useRef(null);const Ir=Y.useRef([]),pr=Y.useRef(new Map),Ha=Y.useRef([{lines:[],models:[],layers:[S_]}]),pa=Y.useRef(0),gn=(ce,Se,_e)=>{const Ee=Ha.current.slice(0,pa.current+1);Ee.push({lines:ce,models:Se,layers:_e}),Ha.current=Ee,pa.current=Ee.length-1},zr=Y.useCallback(()=>{var ce;if(pa.current>0){pa.current-=1;const Se=Ha.current[pa.current];n(Se.lines),a(Se.models),c(Se.layers),Se.layers.find(_e=>_e.id===u)||h(((ce=Se.layers[0])==null?void 0:ce.id)||"layer-1")}},[u]),_s=Y.useCallback(()=>{var ce;if(pa.current<Ha.current.length-1){pa.current+=1;const Se=Ha.current[pa.current];n(Se.lines),a(Se.models),c(Se.layers),Se.layers.find(_e=>_e.id===u)||h(((ce=Se.layers[0])==null?void 0:ce.id)||"layer-1")}},[u]),Ro=(ce,Se)=>{ce.computeVertexNormals();let _e=`# NeonFlow Generated
`;const Ee=ce.attributes.position;for(let Ut=0;Ut<Ee.count;Ut++)_e+=`v ${Ee.getX(Ut)} ${Ee.getY(Ut)} ${Ee.getZ(Ut)}
`;if(ce.index)for(let Ut=0;Ut<ce.index.count;Ut+=3)_e+=`f ${ce.index.getX(Ut)+1} ${ce.index.getX(Ut+1)+1} ${ce.index.getX(Ut+2)+1}
`;else for(let Ut=0;Ut<Ee.count;Ut+=3)_e+=`f ${Ut+1} ${Ut+2} ${Ut+3}
`;const tt=new Blob([_e],{type:"text/plain"}),St=URL.createObjectURL(tt);return{id:oa(),url:St,name:Se,position:new k(0,0,0),rotation:new hi(0,0,0),scale:new k(1,1,1),layerId:u,color:st,opacity:1}},Ns=Y.useCallback(()=>{const ce=Array.from(ve);if($&&!ve.has($)&&ce.push($),ce.length===0)return;const Se=[];if(ce.forEach(_e=>{const Ee=t.find(Gt=>Gt.id===_e);if(!Ee||Ee.points.length<3)return;const tt=new k;Ee.points.forEach(Gt=>tt.add(Gt)),tt.divideScalar(Ee.points.length);const St=Ee.points[0].clone().sub(tt),Ut=Ee.points[Math.floor(Ee.points.length/3)].clone().sub(tt),wt=Ee.points[Math.floor(Ee.points.length*2/3)].clone().sub(tt),fn=new k().crossVectors(Ut.sub(St),wt.sub(St)).normalize(),Ht=new Fn().setFromUnitVectors(fn,new k(0,0,1)),Et=Ee.points.map(Gt=>{const _n=Gt.clone().sub(tt);return _n.applyQuaternion(Ht),_n}),dn=Ht.clone().invert(),Xt=new hi().setFromQuaternion(dn),Zt={id:oa(),url:"generated:extrude",name:"Extruded Shape",position:tt,rotation:Xt,scale:new k(1,1,1),layerId:u,color:Ee.color,opacity:Ee.opacity,extrudeSettings:{shapePoints:Et,depth:Vt,bevelEnabled:on,bevelThickness:En,bevelSize:qi,bevelSegments:di}};Se.push(Zt)}),Se.length>0){const _e=[...i,...Se];a(_e),gn(t,_e,o),pe(null),ze(new Set),Fe(Se[0].id),b("select-object")}},[$,ve,t,i,o,u,Vt,on,En,qi,di]),No=Y.useCallback(()=>{const ce=Array.from(ve);if($&&!ve.has($)&&ce.push($),ce.length===0)return;const Se=[];if(ce.forEach(_e=>{const Ee=t.find(Ht=>Ht.id===_e);if(!Ee||Ee.points.length<2)return;const tt=new k;new Yi().setFromPoints(Ee.points).getCenter(tt);let Ut=new hi(0,0,0);const wt=Ee.points.map(Ht=>{const Et=Ht.clone().sub(tt);let dn=0,Xt=0;return q==="y"?(dn=Math.hypot(Et.x,Et.z),Xt=Et.y):q==="x"?(dn=Math.hypot(Et.y,Et.z),Xt=Et.x,Ut=new hi(0,0,-Math.PI/2)):(dn=Math.hypot(Et.x,Et.y),Xt=Et.z,Ut=new hi(Math.PI/2,0,0)),new gt(dn,Xt)}),fn={id:oa(),url:"generated:lathe",name:"Lathe Shape",position:tt,rotation:Ut,scale:new k(1,1,1),layerId:u,color:Ee.color,opacity:Ee.opacity,latheSettings:{points:wt,segments:Mi,phiStart:we*Math.PI/180,phiLength:jn*Math.PI/180}};Se.push(fn)}),Se.length>0){const _e=[...i,...Se];a(_e),gn(t,_e,o),pe(null),ze(new Set),Fe(Se[0].id),b("select-object")}},[$,ve,t,i,o,u,Mi,jn,q,we]),mr=Y.useCallback(()=>{const ce=Array.from(ve);if($&&!ve.has($)&&ce.push($),ce.length<2){alert("Select at least 2 shapes for Loft (Shift+Click)");return}const Se=ce.map(Ht=>t.find(Et=>Et.id===Ht)).filter(Boolean),_e=100,Ee=[];Se.forEach(Ht=>{let Et;Ht.type==="catmull"&&Ht.points.length>1?Et=new _l(Ht.points).getSpacedPoints(_e):Et=new _l(Ht.points,!1,"centripetal",0).getSpacedPoints(_e),Ee.push(Et)});const tt=new k;let St=0;Ee.forEach(Ht=>Ht.forEach(Et=>{tt.add(Et),St++})),tt.divideScalar(St);const Ut=Ee.map(Ht=>Ht.map(Et=>Et.clone().sub(tt))),wt={id:oa(),url:"generated:loft",name:"Loft Shape",position:tt,rotation:new hi(0,0,0),scale:new k(1,1,1),layerId:u,color:Se[0].color,opacity:Se[0].opacity??1,loftSettings:{divisions:ot,closed:Ot,profiles:Ut,smooth:Nt}},fn=[...i,wt];a(fn),gn(t,fn,o),pe(null),ze(new Set),Fe(wt.id),b("select-object")},[$,ve,t,i,o,u,ot,Ot,Nt]);Y.useCallback(ce=>{if(!Ge)return;const Se=i.map(_e=>_e.id===Ge?{..._e,extrudeSettings:ce}:_e);a(Se),gn(t,Se,o)},[Ge,i,t,o]),Y.useCallback(ce=>{if(!Ge)return;const Se=i.map(_e=>_e.id===Ge?{..._e,latheSettings:ce}:_e);a(Se),gn(t,Se,o)},[Ge,i,t,o]);const Js=Y.useCallback((ce,Se)=>{const _e=i.map(Ee=>Ee.id===ce?{...Ee,meshData:Se,url:"generated:meshdata"}:Ee);a(_e),gn(t,_e,o)},[i,t,o]),Fr=Y.useCallback(()=>{const ce=Array.from(ve);if(ce.length!==2){alert("Select exactly 2 lines: 1 Profile (Shape) and 1 Path.");return}const Se=t.find(Et=>Et.id===ce[0]),_e=t.find(Et=>Et.id===ce[1]);if(!Se||!_e)return;const Ee=new k;new Yi().setFromPoints(Se.points).getCenter(Ee);const tt=Se.points.map(Et=>new gt(Et.x-Ee.x,Et.y-Ee.y)),St=new Jc(tt),Ut=new _l(_e.points),wt=new id(St,{extrudePath:Ut,steps:_e.points.length*5}),fn=Ro(wt,"Flow_Object"),Ht=[...i,fn];a(Ht),gn(t,Ht,o)},[ve,t,u,st,o,i]),Vi=Y.useCallback(()=>{const ce=Array.from(ve);if($&&!ve.has($)&&ce.push($),ce.length!==2){alert("Select exactly 2 lines: 1 Profile (cross-section) and 1 Path (Shift+Click)");return}const Se=t.find(Xt=>Xt.id===ce[0]),_e=t.find(Xt=>Xt.id===ce[1]);if(!Se||!_e)return;let Ee,tt;const St=Se.points.reduce((Xt,Zt,Gt)=>Gt===0?0:Xt+Zt.distanceTo(Se.points[Gt-1]),0),Ut=_e.points.reduce((Xt,Zt,Gt)=>Gt===0?0:Xt+Zt.distanceTo(_e.points[Gt-1]),0);St<Ut?(Ee=Se,tt=_e):(Ee=_e,tt=Se);const wt=new k;Ee.points.forEach(Xt=>wt.add(Xt)),wt.divideScalar(Ee.points.length);const fn=Ee.points.map(Xt=>Xt.clone().sub(wt)),Ht=tt.points,Et={id:oa(),url:"generated:sweep",name:"Sweep Shape",position:Ht[0].clone(),rotation:new hi(0,0,0),scale:new k(1,1,1),layerId:u,color:Ee.color,opacity:Ee.opacity??1,sweepSettings:{profilePoints:fn,pathPoints:Ht,steps:be,closed:!1,scale:$e,twist:Oe*Math.PI/180,rotation:Mt*Math.PI/180,taper:mt,alignToPath:en}},dn=[...i,Et];a(dn),gn(t,dn,o),pe(null),ze(new Set),Fe(Et.id),b("select-object")},[$,ve,t,i,o,u,be,$e,Oe,Mt,mt,en]),Bs=Y.useCallback(()=>{const ce=Array.from(ve);if($&&!ve.has($)&&ce.push($),ce.length===0)return;const Se=[];if(ce.forEach(_e=>{const Ee=t.find(Ht=>Ht.id===_e);if(!Ee||Ee.points.length<2)return;const tt=new k;new Yi().setFromPoints(Ee.points).getCenter(tt);const Ut=Ee.points.map(Ht=>{const Et=Ht.clone().sub(tt);let dn=0,Xt=0;return an==="y"?(dn=Math.hypot(Et.x,Et.z)+tn,Xt=Et.y):an==="x"?(dn=Math.hypot(Et.y,Et.z)+tn,Xt=Et.x):(dn=Math.hypot(Et.x,Et.y)+tn,Xt=Et.z),new gt(Math.max(0,dn),Xt)});let wt=new hi(0,0,0);an==="x"&&(wt=new hi(0,0,-Math.PI/2)),an==="z"&&(wt=new hi(Math.PI/2,0,0));const fn={id:oa(),url:"generated:revolve",name:"Revolve Shape",position:tt,rotation:wt,scale:new k(1,1,1),layerId:u,color:Ee.color,opacity:Ee.opacity,revolveSettings:{profilePoints:Ut,axis:an,segments:yn,angle:xn*Math.PI/180,offset:tn,startAngle:kn*Math.PI/180,capEnds:Ni}};Se.push(fn)}),Se.length>0){const _e=[...i,...Se];a(_e),gn(t,_e,o),pe(null),ze(new Set),Fe(Se[0].id),b("select-object")}},[$,ve,t,i,o,u,yn,xn,an,tn,kn,Ni]),ma=Y.useCallback((ce,Se)=>{const _e=[];if(!J.enabled)return[];const Ee=new k(...J.position),tt=new hi(...J.rotation),St=new Fn().setFromEuler(tt),Ut=St.clone().invert(),wt=ce.clone().sub(Ee).applyQuaternion(Ut);let fn=new Fn;if(Se&&(fn.setFromEuler(Se),fn.premultiply(Ut)),J.mode==="mirror"){const Ht=[];if(J.mirrorX&&Ht.push("x"),J.mirrorY&&Ht.push("y"),J.mirrorZ&&Ht.push("z"),Ht.length===0)return[];const Et=1<<Ht.length;for(let dn=1;dn<Et;dn++){const Xt=wt.clone(),Zt=fn.clone();for(let nn=0;nn<Ht.length;nn++)if(dn>>nn&1){const kt=Ht[nn];kt==="x"&&(Xt.x=-Xt.x),kt==="y"&&(Xt.y=-Xt.y),kt==="z"&&(Xt.z=-Xt.z)}const Gt=Xt.applyQuaternion(St).add(Ee),_n=new hi().setFromQuaternion(Zt.premultiply(St));_e.push({position:Gt,rotation:_n})}}else if(J.mode==="radial"){const Ht=Math.max(1,J.radialCount),Et=J.radialAxis,dn=Math.PI*2/Ht;for(let Xt=1;Xt<Ht;Xt++){const Zt=dn*Xt,Gt=wt.clone();if(Et==="x"){const Zn=Math.cos(Zt),ya=Math.sin(Zt),ls=Gt.y*Zn-Gt.z*ya,Vr=Gt.y*ya+Gt.z*Zn;Gt.y=ls,Gt.z=Vr}else if(Et==="y"){const Zn=Math.cos(Zt),ya=Math.sin(Zt),ls=Gt.x*Zn-Gt.z*ya,Vr=Gt.x*ya+Gt.z*Zn;Gt.x=ls,Gt.z=Vr}else if(Et==="z"){const Zn=Math.cos(Zt),ya=Math.sin(Zt),ls=Gt.x*Zn-Gt.y*ya,Vr=Gt.x*ya+Gt.y*Zn;Gt.x=ls,Gt.y=Vr}const _n=new Fn;Et==="x"&&_n.setFromAxisAngle(new k(1,0,0),Zt),Et==="y"&&_n.setFromAxisAngle(new k(0,1,0),Zt),Et==="z"&&_n.setFromAxisAngle(new k(0,0,1),Zt);const nn=fn.clone().premultiply(_n),kt=Gt.applyQuaternion(St).add(Ee),An=new hi().setFromQuaternion(nn.premultiply(St));_e.push({position:kt,rotation:An})}}else if(J.mode==="array"){const{arrayCountX:Ht,arrayCountY:Et,arrayCountZ:dn,arraySpacingX:Xt,arraySpacingY:Zt,arraySpacingZ:Gt}=J;for(let _n=0;_n<Ht;_n++)for(let nn=0;nn<Et;nn++)for(let kt=0;kt<dn;kt++){if(_n===0&&nn===0&&kt===0)continue;const An=new k(_n*Xt,nn*Zt,kt*Gt),ya=wt.clone().add(An).applyQuaternion(St).add(Ee),ls=new hi().setFromQuaternion(fn.clone().premultiply(St));_e.push({position:ya,rotation:ls})}}else if(J.mode==="path"&&J.pathId){const Ht=t.find(Et=>Et.id===J.pathId);if(Ht&&Ht.points.length>1){const Et=new _l(Ht.points,!1),dn=Math.max(2,J.pathCount);for(let Xt=0;Xt<dn;Xt++){const Zt=Xt/(dn-1),Gt=Et.getPointAt(Zt),_n=Et.getTangentAt(Zt).normalize(),nn=new k(0,1,0),kt=new k().crossVectors(nn,_n).normalize(),An=Math.acos(nn.dot(_n)),Zn=new Fn().setFromAxisAngle(kt,An),ya=Gt.clone(),ls=new hi().setFromQuaternion(J.pathAlign?Zn.multiply(fn):fn);_e.push({position:ya,rotation:ls})}}}return _e},[J,t]),ka=Y.useCallback(()=>{const ce={id:oa(),name:`Layer ${o.length+1}`,visible:!0,locked:!1},Se=[...o,ce];c(Se),h(ce.id),gn(t,i,Se)},[o,t,i]),xr=Y.useCallback(ce=>{if(o.length<=1)return;const Se=o.filter(tt=>tt.id!==ce),_e=t.filter(tt=>tt.layerId!==ce),Ee=i.filter(tt=>tt.layerId!==ce);c(Se),n(_e),a(Ee),u===ce&&h(Se[0].id),gn(_e,Ee,Se)},[o,t,i,u]),Pr=Y.useCallback(ce=>{const Se=o.map(_e=>_e.id===ce?{..._e,visible:!_e.visible}:_e);c(Se),gn(t,i,Se)},[o,t,i]),Zs=Y.useCallback(ce=>{const Se=o.map(_e=>_e.id===ce?{..._e,locked:!_e.locked}:_e);c(Se),gn(t,i,Se)},[o,t,i]),gr=Y.useCallback((ce,Se)=>{const _e=o.map(Ee=>Ee.id===ce?{...Ee,name:Se}:Ee);c(_e),gn(t,i,_e)},[o,t,i]),xa=Y.useCallback(()=>{if(t.length===0&&i.length===0)return;const ce=[],Se=[];n(ce),a(Se),gn(ce,Se,o),A(null),pe(null),ze(new Set),Fe(null),lt(null),fe(!1),Ir.current=[]},[t,i,o]),hc=Y.useCallback(()=>{if(W){ae(ce=>({...ce,position:[0,-2,0],rotation:[0,0,0],scale:[1,1,1]}));return}if(g==="edit-points"&&Qe!==null&&$){const ce=t.find(Se=>Se.id===$);if(ce&&ce.points.length>2){const Se=[...ce.points];Se.splice(Qe,1);const _e=t.map(Ee=>Ee.id===$?{...Ee,points:Se}:Ee);n(_e),gn(_e,i,o),lt(null);return}}if(ve.size>0){const ce=t.filter(Se=>!ve.has(Se.id));n(ce),gn(ce,i,o),pe(null),ze(new Set),lt(null)}else if(Ge){const ce=i.filter(Se=>Se.id!==Ge);a(ce),gn(t,ce,o),Fe(null)}},[t,i,$,ve,Ge,o,g,Qe,W]),na=Y.useCallback(()=>{ae(ce=>({...ce,position:[0,-2,0],rotation:[0,0,0],scale:[1,1,1]}))},[]),Gr=Y.useCallback((ce,Se)=>{if(ce==="line"){const _e=t.filter(Ee=>Ee.id!==Se);n(_e),gn(_e,i,o)}else{const _e=i.filter(Ee=>Ee.id!==Se);a(_e),gn(t,_e,o)}if(ve.has(Se)){const _e=new Set(ve);_e.delete(Se),ze(_e),$===Se&&pe(null)}Ge===Se&&Fe(null),$===Se&&lt(null)},[t,i,o,$,ve,Ge]),Bl=Y.useCallback((ce,Se)=>{if(!$)return;const _e=t.find(St=>St.id===$);if(!_e)return;const Ee=[..._e.points];Ee.splice(Se+1,0,ce);const tt=t.map(St=>St.id===$?{...St,points:Ee}:St);n(tt),gn(tt,i,o),lt(Se+1)},[t,$,i,o]),jr=Y.useCallback(ce=>{Ze(ce),He(ce),setTimeout(()=>Ze(null),100)},[]),ga=Y.useCallback(()=>{A(null)},[]),Qa=Y.useCallback(()=>{J.enabled&&(ae(ce=>({...ce,visible:!0,position:[...J.position],rotation:[...J.rotation]})),F("ground"),A(null),b("draw"))},[J]),ca=Y.useCallback((ce,Se)=>{if(g==="pick-symmetry-path"&&ce){ie(_e=>({..._e,pathId:ce})),b("select-object");return}if(Se&&ce){ze(_e=>{const Ee=new Set(_e);return Ee.has(ce)?Ee.delete(ce):Ee.add(ce),Ee.size>0?pe(ce):pe(null),Ee}),Fe(null),fe(!1),lt(null);return}if(g==="erase"&&ce){Gr("line",ce);return}if(pe(ce),ce?(ze(new Set([ce])),Fe(null),fe(!1)):ze(new Set),lt(null),ce){const _e=t.find(Ee=>Ee.id===ce);_e&&(oe(_e.color),Ae(_e.width),Ue(_e.opacity??1),bt(_e.intensity??1.5),It(_e.tubularSegments??64),qe(_e.radialSegments??8),ft(_e.startWidth??_e.width),Ie(_e.endWidth??_e.width),ye(!!_e.filled),pt(!!_e.dashed),dt(_e.dashScale||1),_e.dashSize===2&&_e.gapSize===1?Lt("2:1"):_e.dashSize===1&&_e.gapSize===2?Lt("1:2"):Lt("1:1"))}},[t]),Ds=Y.useCallback((ce,Se)=>{ze(_e=>{const Ee=Se?new Set(_e):new Set;if(ce.forEach(tt=>Ee.add(tt)),Ee.size>0){const tt=Array.from(Ee),St=tt[tt.length-1];St&&pe(St)}else Se||pe(null);return Ee}),Se||Fe(null)},[]),Zo=Y.useCallback((ce,Se)=>{if(g==="erase"&&ce){Gr("model",ce);return}if(Fe(ce),ce&&(pe(null),ze(new Set),fe(!1)),lt(null),ce){const _e=i.find(Ee=>Ee.id===ce);_e&&(z(_e.color||"#808080"),L(_e.opacity??1),ee(_e.segments??32),te([_e.scale.x,_e.scale.y,_e.scale.z])),b("select-object")}},[i]),tu=Y.useCallback(()=>{const ce=!W;fe(ce),ce&&(pe(null),ze(new Set),Fe(null),lt(null),b("select-object"))},[W]),vr=Y.useCallback((ce,Se)=>{const _e=t.map(Ee=>Ee.id===ce?{...Ee,points:Se}:Ee);n(_e),gn(_e,i,o)},[t,i,o]),nu=Y.useCallback((ce,Se,_e,Ee)=>{const tt=i.map(St=>St.id===ce?(Ge===ce&&te([Ee.x,Ee.y,Ee.z]),{...St,position:Se,rotation:_e,scale:Ee}):St);a(tt),gn(t,tt,o)},[t,i,o,Ge]),zi=Y.useCallback(ce=>{if(g!=="define-plane")return;const Se=[...R,ce];if(N(Se),Se.length===3){const _e=Se[0],Ee=Se[1],tt=Se[2],St=new k().subVectors(Ee,_e).normalize(),Ut=new k().subVectors(tt,_e),wt=new k().crossVectors(St,Ut).normalize(),fn=new k().crossVectors(wt,St).normalize(),Ht=new wn().makeBasis(St,fn,wt),Et=new Fn().setFromRotationMatrix(Ht);A({position:_e.clone(),quaternion:Et}),N([]),b("draw")}},[g,R]),Ss=Y.useCallback((ce,Se=new k(1,1,1),_e=st)=>({id:oa(),url:"primitive:cube",name:"Cube",position:ce,rotation:new hi(0,0,0),scale:Se,layerId:u,color:_e,opacity:P,segments:O}),[u,st,P,O]),Bo=Y.useCallback((ce,Se)=>{const _e=[ce];if(ma(ce).forEach(tt=>_e.push(tt.position)),Se==="add"){let tt=[];_e.forEach(Ut=>{const wt=Ss(Ut,new k(ne,ne,ne),U);wt.opacity=P,tt.push(wt)});const St=[...i,...tt];a(St),gn(t,St,o)}else{const tt=ne*.1,St=new Set;if(_e.forEach(Ut=>{const wt=i.find(fn=>fn.url==="primitive:cube"&&fn.position.distanceTo(Ut)<tt);wt&&St.add(wt.id)}),St.size>0){const Ut=i.filter(wt=>!St.has(wt.id));a(Ut),gn(t,Ut,o)}}},[Ss,i,t,o,ne,U,P,ma]),iu=Y.useCallback(ce=>{let Se=[];const _e=Ee=>{Se.push(Ee),ma(Ee.position,Ee.rotation).forEach(St=>{Se.push({...Ee,id:oa(),position:St.position,rotation:St.rotation})})};if(ce==="basic")_e(Ss(new k(0,0,0)));else if(ce==="random")for(let Ee=0;Ee<50;Ee++){const tt=new k((Math.random()-.5)*20,(Math.random()-.5)*20,(Math.random()-.5)*20),St=new k(.2+Math.random(),.2+Math.random(),.2+Math.random()),Ut=j_[Math.floor(Math.random()*j_.length)];_e(Ss(tt,St,Ut))}else if(ce==="grid")for(let Ee=0;Ee<10;Ee++)for(let tt=0;tt<10;tt++){const St=new k(Ee*2-10,0,tt*2-10);_e(Ss(St))}if(Se.length>0){const Ee=[...i,...Se];a(Ee),gn(t,Ee,o)}},[i,t,o,Ss,ma]),Dl=Y.useCallback((ce,Se)=>{const _e=o.find(Ee=>Ee.id===u);if(!(_e&&(_e.locked||!_e.visible))){if(g.startsWith("place-primitive-")){let Ee="primitive:cube",tt="Cube";const St=Se?new hi().setFromQuaternion(Se):new hi(0,0,0);g==="place-primitive-plane"?(Ee="primitive:plane",tt="Plane",St.x-=Math.PI/2):g==="place-primitive-sphere"?(Ee="primitive:sphere",tt="Sphere"):g==="place-primitive-cylinder"&&(Ee="primitive:cylinder",tt="Cylinder");const Ut={id:oa(),url:Ee,name:tt,position:ce,rotation:St,scale:new k(Q[0],Q[1],Q[2]),layerId:u,color:U,opacity:P,segments:O};let wt=[Ut];ma(ce,St).forEach(Et=>{wt.push({...Ut,id:oa(),position:Et.position,rotation:Et.rotation})});const Ht=[...i,...wt];a(Ht),gn(t,Ht,o);return}if(g==="create-cube-click"){let tt=[Ss(ce)];ma(ce).forEach(wt=>{tt.push(Ss(wt.position))});const Ut=[...i,...tt];a(Ut),gn(t,Ut,o);return}if(g==="draw-text"){const Ee=S.trim()||"Text",tt={id:oa(),points:[ce],type:"text",layerId:u,color:st,width:X,text:Ee,fontSize:1};let St=[tt];ma(ce).forEach(fn=>{St.push({...tt,id:oa(),points:[fn.position]})});const wt=[...t,...St];n(wt),gn(wt,i,o);return}if(g==="create-cube-2pt"){x([ce]);return}if(g==="draw"||g==="draw-rectangle"||g==="draw-circle"||g==="draw-circle-2pt"||g==="draw-triangle"||g==="draw-hexagon"||g==="draw-line"||g==="draw-star"||g==="draw-ellipse"||g==="draw-rhombus"||g==="draw-semicircle"||g==="draw-quartercircle"||g==="draw-teardrop"||g==="draw-heart"||g==="draw-golden-spiral"||g==="draw-golden-rect"||g==="draw-dimension"||g==="draw-dimension-radius"){x([ce]);return}if(g==="draw-dimension-angle"){x(Ee=>[...Ee,ce]);return}(g==="draw-spline"||g==="draw-polyline"||g==="draw-tube")&&x(Ee=>[...Ee,ce])}},[g,u,o,i,t,Ss,st,X,S,U,P,O,Q,ma]),qn=Y.useRef(new k),Ko=Y.useCallback(ce=>{qn.current.copy(ce);const Se=o.find(_e=>_e.id===u);if(!(Se&&(Se.locked||!Se.visible))){if(g==="create-cube-2pt"){x(_e=>_e.length===0?_e:[_e[0],ce]);return}g==="draw"?x(_e=>_e.length===0?_e:_e[_e.length-1].distanceTo(ce)>__?[..._e,ce]:_e):["draw-rectangle","draw-circle","draw-circle-2pt","draw-triangle","draw-hexagon","draw-line","draw-star","draw-ellipse","draw-rhombus","draw-semicircle","draw-quartercircle","draw-teardrop","draw-heart","draw-golden-spiral","draw-golden-rect","draw-dimension","draw-dimension-radius"].includes(g)?x(_e=>_e.length===0?_e:[_e[0],ce]):g==="draw-dimension-angle"&&x(_e=>_e.length===0?_e:_e.length===1?[_e[0],ce]:_e.length===2?[_e[0],_e[1],ce]:_e)}},[g,u,o]),fi=Y.useCallback(()=>{let ce=1,Se=1;return Ke==="2:1"&&(ce=2,Se=1),Ke==="1:2"&&(ce=1,Se=2),{dashed:Re,dashScale:Rt,dashSize:ce,gapSize:Se}},[Re,Rt,Ke]),Va=Y.useCallback(()=>({color:st,width:X,opacity:Pe,intensity:Be,tubularSegments:vt,radialSegments:zt,startWidth:We,endWidth:ge,filled:ht,...fi()}),[st,X,Pe,Be,vt,zt,We,ge,ht,fi]),po=Y.useCallback(ce=>{let Se="polyline";g==="draw-dimension"&&(Se="dimension"),g==="draw-dimension-radius"&&(Se="dimension-radius"),g==="draw-dimension-angle"&&(Se="dimension-angle");const _e={id:oa(),points:ce,type:Se,layerId:u,...Va()};let Ee=[_e];if(J.enabled){const St=new k(...J.position),Ut=new hi(...J.rotation),wt=new Fn().setFromEuler(Ut),fn=wt.clone().invert(),Ht=Et=>{const dn=ce.map(Xt=>{const Zt=Xt.clone().sub(St).applyQuaternion(fn);return Et(Zt),Zt.applyQuaternion(wt).add(St)});Ee.push({..._e,id:oa(),points:dn})};if(J.mode==="mirror"){const Et=[];J.mirrorX&&Et.push("x"),J.mirrorY&&Et.push("y"),J.mirrorZ&&Et.push("z");const dn=1<<Et.length;for(let Xt=1;Xt<dn;Xt++)Ht(Zt=>{for(let Gt=0;Gt<Et.length;Gt++)Xt>>Gt&1&&(Et[Gt]==="x"&&(Zt.x=-Zt.x),Et[Gt]==="y"&&(Zt.y=-Zt.y),Et[Gt]==="z"&&(Zt.z=-Zt.z))})}else if(J.mode==="radial"){const Et=Math.max(1,J.radialCount),dn=J.radialAxis,Xt=Math.PI*2/Et;for(let Zt=1;Zt<Et;Zt++){const Gt=Xt*Zt,_n=Math.cos(Gt),nn=Math.sin(Gt);Ht(kt=>{if(dn==="x"){const An=kt.y*_n-kt.z*nn,Zn=kt.y*nn+kt.z*_n;kt.y=An,kt.z=Zn}else if(dn==="y"){const An=kt.x*_n-kt.z*nn,Zn=kt.x*nn+kt.z*_n;kt.x=An,kt.z=Zn}else if(dn==="z"){const An=kt.x*_n-kt.y*nn,Zn=kt.x*nn+kt.y*_n;kt.x=An,kt.y=Zn}})}}else if(J.mode==="array"){const{arrayCountX:Et,arrayCountY:dn,arrayCountZ:Xt,arraySpacingX:Zt,arraySpacingY:Gt,arraySpacingZ:_n}=J;for(let nn=0;nn<Et;nn++)for(let kt=0;kt<dn;kt++)for(let An=0;An<Xt;An++)nn===0&&kt===0&&An===0||Ht(Zn=>{Zn.x+=nn*Zt,Zn.y+=kt*Gt,Zn.z+=An*_n})}}const tt=[...t,...Ee];n(tt),gn(tt,i,o),x([])},[Va,t,i,u,o,g,J]),kf=Y.useCallback(()=>{if(!J.enabled)return;const ce=[],Se=[];if(Ge){const Ee=i.find(tt=>tt.id===Ge);Ee&&ma(Ee.position,Ee.rotation).forEach(St=>{Se.push({...Ee,id:oa(),position:St.position,rotation:St.rotation})})}const _e=Array.from(ve);if($&&!ve.has($)&&_e.push($),_e.length>0){const Ee=new k(...J.position),tt=new hi(...J.rotation),St=new Fn().setFromEuler(tt),Ut=St.clone().invert();if(J.mode==="path"&&J.pathId){const wt=t.find(fn=>fn.id===J.pathId);if(wt&&wt.points.length>1){const fn=new _l(wt.points,!1),Ht=Math.max(2,J.pathCount);_e.forEach(Et=>{const dn=t.find(Zt=>Zt.id===Et);if(!dn)return;const Xt=new k;dn.points.forEach(Zt=>Xt.add(Zt)),Xt.divideScalar(dn.points.length);for(let Zt=0;Zt<Ht;Zt++){const Gt=Zt/(Ht-1),_n=fn.getPointAt(Gt),nn=fn.getTangentAt(Gt).normalize(),kt=new k(0,1,0),An=new k().crossVectors(kt,nn).normalize(),Zn=Math.acos(kt.dot(nn)),ya=new Fn().setFromAxisAngle(An,Zn),ls=dn.points.map(Vr=>{const cs=Vr.clone().sub(Xt);return J.pathAlign&&cs.applyQuaternion(ya),cs.add(_n)});ce.push({...dn,id:oa(),points:ls})}})}}J.mode!=="path"&&_e.forEach(wt=>{const fn=t.find(Et=>Et.id===wt);if(!fn)return;const Ht=Et=>{const dn=fn.points.map(Xt=>{const Zt=Xt.clone().sub(Ee).applyQuaternion(Ut);return Et(Zt),Zt.applyQuaternion(St).add(Ee)});ce.push({...fn,id:oa(),points:dn})};if(J.mode==="mirror"){const Et=[];J.mirrorX&&Et.push("x"),J.mirrorY&&Et.push("y"),J.mirrorZ&&Et.push("z");const dn=1<<Et.length;for(let Xt=1;Xt<dn;Xt++)Ht(Zt=>{for(let Gt=0;Gt<Et.length;Gt++)Xt>>Gt&1&&(Et[Gt]==="x"&&(Zt.x=-Zt.x),Et[Gt]==="y"&&(Zt.y=-Zt.y),Et[Gt]==="z"&&(Zt.z=-Zt.z))})}else if(J.mode==="radial"){const Et=Math.max(1,J.radialCount),dn=J.radialAxis,Xt=Math.PI*2/Et;for(let Zt=1;Zt<Et;Zt++)Ht(Gt=>{const _n=Xt*Zt;if(dn==="x"){const nn=Math.cos(_n),kt=Math.sin(_n),An=Gt.y*nn-Gt.z*kt,Zn=Gt.y*kt+Gt.z*nn;Gt.y=An,Gt.z=Zn}else if(dn==="y"){const nn=Math.cos(_n),kt=Math.sin(_n),An=Gt.x*nn-Gt.z*kt,Zn=Gt.x*kt+Gt.z*nn;Gt.x=An,Gt.z=Zn}else if(dn==="z"){const nn=Math.cos(_n),kt=Math.sin(_n),An=Gt.x*nn-Gt.y*kt,Zn=Gt.x*kt+Gt.y*nn;Gt.x=An,Gt.y=Zn}})}else if(J.mode==="array"){const{arrayCountX:Et,arrayCountY:dn,arrayCountZ:Xt,arraySpacingX:Zt,arraySpacingY:Gt,arraySpacingZ:_n}=J;for(let nn=0;nn<Et;nn++)for(let kt=0;kt<dn;kt++)for(let An=0;An<Xt;An++)nn===0&&kt===0&&An===0||Ht(Zn=>{Zn.x+=nn*Zt,Zn.y+=kt*Gt,Zn.z+=An*_n})}})}if(ce.length>0||Se.length>0){const Ee=[...t,...ce],tt=[...i,...Se];n(Ee),a(tt),gn(Ee,tt,o)}},[J,Ge,$,ve,t,i,o,ma]),dc=Y.useCallback(()=>{if(g==="create-cube-2pt"&&m.length>=2){const ce=m[0],Se=m[m.length-1],_e=new Yi().setFromPoints([ce,Se]),Ee=new k;_e.getCenter(Ee);const tt=new k;_e.getSize(tt),tt.x=Math.max(tt.x,.01),tt.y=Math.max(tt.y,.01),tt.z=Math.max(tt.z,.01);let Ut=[Ss(Ee,tt)];ma(Ee).forEach(Ht=>{Ut.push(Ss(Ht.position,tt));const Et=Ut[Ut.length-1];Et.rotation=Ht.rotation});const fn=[...i,...Ut];a(fn),gn(t,fn,o),x([]);return}g==="draw"&&(m.length>1&&po(m),x([]))},[g,m,Ss,i,t,o,u,Va,J,ma,po]),mo=Y.useCallback(()=>{if(m.length<2)return;const ce=g==="draw-spline"?"catmull":g==="draw-tube"?"tube":"polyline",Se={id:oa(),points:m,type:ce,layerId:u,...Va()};let _e=[Se];if(J.enabled){const tt=new k(...J.position),St=new hi(...J.rotation),Ut=new Fn().setFromEuler(St),wt=Ut.clone().invert(),fn=Ht=>{const Et=m.map(dn=>{const Xt=dn.clone().sub(tt).applyQuaternion(wt);return Ht(Xt),Xt.applyQuaternion(Ut).add(tt)});_e.push({...Se,id:oa(),points:Et})};if(J.mode==="mirror"){const Ht=[];J.mirrorX&&Ht.push("x"),J.mirrorY&&Ht.push("y"),J.mirrorZ&&Ht.push("z");const Et=1<<Ht.length;for(let dn=1;dn<Et;dn++)fn(Xt=>{for(let Zt=0;Zt<Ht.length;Zt++)dn>>Zt&1&&(Ht[Zt]==="x"&&(Xt.x=-Xt.x),Ht[Zt]==="y"&&(Xt.y=-Xt.y),Ht[Zt]==="z"&&(Xt.z=-Xt.z))})}else if(J.mode==="radial"){const Ht=Math.max(1,J.radialCount),Et=J.radialAxis,dn=Math.PI*2/Ht;for(let Xt=1;Xt<Ht;Xt++){const Zt=dn*Xt,Gt=Math.cos(Zt),_n=Math.sin(Zt);fn(nn=>{if(Et==="x"){const kt=nn.y*Gt-nn.z*_n,An=nn.y*_n+nn.z*Gt;nn.y=kt,nn.z=An}else if(Et==="y"){const kt=nn.x*Gt-nn.z*_n,An=nn.x*_n+nn.z*Gt;nn.x=kt,nn.z=An}else if(Et==="z"){const kt=nn.x*Gt-nn.y*_n,An=nn.x*_n+nn.y*Gt;nn.x=kt,nn.y=An}})}}else if(J.mode==="array"){const{arrayCountX:Ht,arrayCountY:Et,arrayCountZ:dn,arraySpacingX:Xt,arraySpacingY:Zt,arraySpacingZ:Gt}=J;for(let _n=0;_n<Ht;_n++)for(let nn=0;nn<Et;nn++)for(let kt=0;kt<dn;kt++)_n===0&&nn===0&&kt===0||fn(An=>{An.x+=_n*Xt,An.y+=nn*Zt,An.z+=kt*Gt})}}const Ee=[...t,..._e];n(Ee),gn(Ee,i,o),x([])},[m,g,u,Va,t,i,o,J]),Ks=Y.useCallback(ce=>{if(m.length===0&&!g.startsWith("draw"))return;let Se=m.length>0?m[m.length-1]:new k(0,0,0),_e=new k,Ee=!1;if(ce.includes("<")){const tt=ce.split("<"),St=parseFloat(tt[0]),Ut=parseFloat(tt[1]);if(!isNaN(St)&&!isNaN(Ut)){const wt=zf.degToRad(Ut);_e.set(Se.x+St*Math.cos(wt),Se.y,Se.z-St*Math.sin(wt)),Ee=!0}}else{const tt=parseFloat(ce);if(!isNaN(tt)){const St=new k().subVectors(qn.current,Se);St.lengthSq()>0&&(St.normalize(),_e.copy(Se).add(St.multiplyScalar(tt)),Ee=!0)}}Ee&&(g==="draw-polyline"||g==="draw-spline"||g==="draw-tube"||g==="draw-dimension-angle"?x(tt=>[...tt,_e]):["draw-line","draw-rectangle","draw-circle","draw-triangle","draw-hexagon","draw-star","draw-ellipse","draw-rhombus","draw-semicircle","draw-quartercircle","draw-teardrop","draw-heart","draw-golden-spiral","draw-golden-rect","draw-dimension","draw-dimension-radius"].includes(g)?m.length===0?x([_e]):po([m[0],_e]):g==="draw"&&x(tt=>[...tt,_e]))},[m,g,po]),ua=Y.useCallback((ce,Se,_e,Ee,tt,St,Ut,wt,fn,Ht,Et,dn,Xt,Zt,Gt)=>{const _n=ve.size>0?Array.from(ve):$?[$]:[];if(_n.length>0){const nn=t.map(kt=>{if(_n.includes(kt.id)){let An=kt.dashSize,Zn=kt.gapSize;return tt&&(tt==="1:1"?(An=1,Zn=1):tt==="2:1"?(An=2,Zn=1):tt==="1:2"&&(An=1,Zn=2)),{...kt,color:ce??kt.color,width:Se??kt.width,dashed:_e??kt.dashed,dashScale:Ee??kt.dashScale,dashSize:An,gapSize:Zn,opacity:St??kt.opacity,intensity:Ut??kt.intensity,tubularSegments:wt??kt.tubularSegments,radialSegments:fn??kt.radialSegments,startWidth:Ht??kt.startWidth,endWidth:Et??kt.endWidth,filled:dn??kt.filled}}return kt});n(nn),gn(nn,i,o)}if(Ge){const nn=i.map(kt=>kt.id===Ge?{...kt,color:ce??kt.color,opacity:Xt??kt.opacity,segments:Zt??kt.segments,scale:Gt?new k(Gt[0],Gt[1],Gt[2]):kt.scale}:kt);a(nn),gn(t,nn,o),ce&&z(ce),Xt!==void 0&&L(Xt),Zt!==void 0&&ee(Zt),Gt!==void 0&&te(Gt)}ce!==void 0&&(oe(ce),Ge||z(ce)),Se!==void 0&&Ae(Se),_e!==void 0&&pt(_e),Ee!==void 0&&dt(Ee),tt!==void 0&&Lt(tt),St!==void 0&&Ue(St),Ut!==void 0&&bt(Ut),wt!==void 0&&It(wt),fn!==void 0&&qe(fn),Ht!==void 0&&ft(Ht),Et!==void 0&&Ie(Et),dn!==void 0&&ye(dn),Ge||(Xt!==void 0&&L(Xt),Zt!==void 0&&ee(Zt),Gt!==void 0&&te(Gt))},[t,i,$,ve,Ge,o]),Qo=ce=>{const Se={id:oa(),name:ce,color:st,width:X,mode:g,type:g==="draw-tube"?"tube":g==="draw-spline"?"catmull":"polyline",opacity:Pe,intensity:Be,dashed:Re,dashScale:Rt,dashSize:Ke==="2:1"?2:1,gapSize:Ke==="1:2"?2:1,tubularSegments:vt,radialSegments:zt,startWidth:We,endWidth:ge,filled:ht};Or(_e=>[..._e,Se])},xo=ce=>{Or(Se=>Se.filter(_e=>_e.id!==ce))},Hr=Y.useCallback(()=>{const ce="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(ja)),Se=document.createElement("a");Se.setAttribute("href",ce),Se.setAttribute("download","neonflow_brushes.json"),document.body.appendChild(Se),Se.click(),Se.remove()},[ja]),Do=Y.useCallback(()=>{const ce=document.createElement("input");ce.type="file",ce.accept="application/json",ce.onchange=Se=>{const _e=Se.target.files[0];if(_e){const Ee=new FileReader;Ee.onload=tt=>{var St;try{const Ut=JSON.parse((St=tt.target)==null?void 0:St.result);if(Array.isArray(Ut)){const fn=Ut.filter(Ht=>Ht.id&&Ht.name).map(Ht=>({...Ht,id:oa()}));Or(Ht=>[...Ht,...fn])}else alert("Invalid brush file format.")}catch(Ut){console.error("Failed to load brushes",Ut)}},Ee.readAsText(_e)}},ce.click()},[]),va=ce=>{ce.mode?b(ce.mode):ce.type==="tube"?b("draw-tube"):ce.type==="catmull"?b("draw-spline"):b("draw-polyline"),oe(ce.color),Ae(ce.width),Ue(ce.opacity??1),bt(ce.intensity??1.5),ye(!!ce.filled),pt(ce.dashed),dt(ce.dashScale);let Se="1:1";ce.dashSize===2&&ce.gapSize===1?Se="2:1":ce.dashSize===1&&ce.gapSize===2&&(Se="1:2"),Lt(Se),It(ce.tubularSegments??64),qe(ce.radialSegments??8),ft(ce.startWidth??ce.width),Ie(ce.endWidth??ce.width)},$o=Y.useCallback(()=>{if($){const ce=t.find(Se=>Se.id===$);if(ce){const Se={...ce,id:oa(),points:ce.points.map(Ee=>Ee.clone().add(new k(.5,.5,0))),layerId:u},_e=[...t,Se];n(_e),gn(_e,i,o),pe(Se.id),ze(new Set([Se.id]))}}else if(Ge){const ce=i.find(Se=>Se.id===Ge);if(ce){const Se={...ce,id:oa(),position:ce.position.clone().add(new k(1,0,0)),layerId:u},_e=[...i,Se];a(_e),gn(t,_e,o),Fe(Se.id)}}},[t,i,$,Ge,u,o]),au=Y.useCallback(ce=>{const Se=ve.size>0?Array.from(ve):$?[$]:[];if(Se.length>0){const _e=t.map(Ee=>{if(Se.includes(Ee.id)&&Ee.points.length>0){const tt=new Yi().setFromPoints(Ee.points),St=new k;tt.getCenter(St);const Ut=Ee.points.map(wt=>{const fn=wt.clone().sub(St);return ce==="horizontal"?fn.x=-fn.x:fn.z=-fn.z,fn.add(St)});return{...Ee,points:Ut}}return Ee});n(_e),gn(_e,i,o)}},[ve,$,t,o,i]),Ul=Y.useCallback(ce=>{if(!$)return;const Se=t.find(wt=>wt.id===$);if(!Se)return;const _e=new Yi().setFromPoints(Se.points),Ee=new k;_e.getCenter(Ee);const tt=Se.points.map(wt=>{const fn=wt.clone().sub(Ee).normalize();return wt.clone().add(fn.multiplyScalar(ce))}),St={...Se,id:oa(),points:tt,layerId:u},Ut=[...t,St];n(Ut),gn(Ut,i,o)},[t,$,u,i,o]),Uo=Y.useCallback(()=>{if(!$)return;const ce=t.find(St=>St.id===$);if(!ce||ce.points.length<2)return;const Se=ce.points[0],_e=ce.points[ce.points.length-1],Ee=Se.distanceTo(_e)<__;let tt;Ee?tt=ce.points.slice(0,-1):tt=[...ce.points,Se.clone()],vr($,tt)},[t,$,vr]),kr=Y.useCallback(()=>{const ce=ve.size>0?Array.from(ve):$?[$]:[];if(ce.length>0){const Se=t.find(Ee=>Ee.id===ce[0]),_e=!(Se!=null&&Se.filled);ua(void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,_e)}else ye(!ht)},[ve,$,t,ua,ht]),Xa=Y.useCallback(()=>{if(!$)return;const ce=t.find(_e=>_e.id===$);if(!ce||ce.points.length<2)return;const Se=[];for(let _e=0;_e<ce.points.length-1;_e++){Se.push(ce.points[_e]);const Ee=new k().addVectors(ce.points[_e],ce.points[_e+1]).multiplyScalar(.5);Se.push(Ee)}Se.push(ce.points[ce.points.length-1]),vr($,Se)},[t,$,vr]),su=Y.useCallback(()=>{if(!$)return;const ce=t.find(_e=>_e.id===$);if(!ce)return;const Se=[...ce.points].reverse();vr($,Se)},[t,$,vr]),V=Y.useCallback(()=>{if(!$)return;const ce=t.find(St=>St.id===$);if(!ce)return;const Se=["polyline","catmull","tube","segments"],_e=Se.indexOf(ce.type),Ee=Se[(_e+1)%Se.length],tt=t.map(St=>St.id===$?{...St,type:Ee}:St);n(tt),gn(tt,i,o)},[t,$,i,o]),Wt=Y.useCallback(()=>{if(!$)return;const ce=t.find(tt=>tt.id===$);if(!ce||ce.points.length<2)return;const Se=[];for(let tt=0;tt<ce.points.length-1;tt++)Se.push({...ce,id:oa(),points:[ce.points[tt],ce.points[tt+1]],type:"polyline"});const Ee=[...t.filter(tt=>tt.id!==$),...Se];n(Ee),gn(Ee,i,o),pe(null),ze(new Set)},[t,$,i,o]),Ui=Y.useCallback(()=>{if(!$)return;const ce=t.find(St=>St.id===$);if(!ce||ce.points.length<3)return;const Se=[],_e=.2,Ee=ce.points[0].distanceTo(ce.points[ce.points.length-1])<__,tt=ce.points.length;for(let St=0;St<tt;St++){const Ut=ce.points[St],wt=ce.points[(St-1+tt)%tt],fn=ce.points[(St+1)%tt];if(!Ee&&(St===0||St===tt-1)){Se.push(Ut);continue}const Ht=new k().subVectors(wt,Ut).normalize().multiplyScalar(_e),Et=new k().subVectors(fn,Ut).normalize().multiplyScalar(_e);Se.push(Ut.clone().add(Ht)),Se.push(Ut.clone().add(Et))}vr($,Se)},[t,$,vr]),Ji=Y.useCallback(()=>{if(Ui(),$){const ce=t.find(Se=>Se.id===$);ce&&ce.type==="polyline"&&setTimeout(()=>{n(Se=>Se.map(_e=>_e.id===$?{..._e,type:"catmull"}:_e))},50)}},[Ui,t,$]),pc=Y.useCallback(()=>{const ce={lines:t,models:i.map(tt=>({...tt,url:tt.url.startsWith("blob:")?"primitive:cube":tt.url})),layers:o},Se=new Blob([JSON.stringify(ce)],{type:"application/json"}),_e=URL.createObjectURL(Se),Ee=document.createElement("a");Ee.href=_e,Ee.download="neonflow_project.json",Ee.click(),URL.revokeObjectURL(_e)},[t,i,o]),Vf=Y.useCallback(()=>{const ce=document.createElement("input");ce.type="file",ce.accept="application/json",ce.onchange=Se=>{const _e=Se.target.files[0];if(_e){const Ee=new FileReader;Ee.onload=tt=>{var St;try{const Ut=JSON.parse((St=tt.target)==null?void 0:St.result);Ut.lines&&n(Ut.lines.map(wt=>({...wt,points:wt.points.map(fn=>new k(fn.x,fn.y,fn.z))}))),Ut.models&&a(Ut.models.map(wt=>({...wt,position:new k(wt.position.x,wt.position.y,wt.position.z),rotation:new hi(wt.rotation._x,wt.rotation._y,wt.rotation._z),scale:new k(wt.scale.x,wt.scale.y,wt.scale.z),opacity:wt.opacity,segments:wt.segments}))),Ut.layers&&c(Ut.layers),gn(Ut.lines||[],Ut.models||[],Ut.layers||[S_])}catch(Ut){console.error("Failed to load project",Ut)}},Ee.readAsText(_e)}},ce.click()},[]),mc=Y.useCallback(()=>{const ce=document.createElement("input");ce.type="file",ce.accept=".gltf,.glb,.obj",ce.onchange=Se=>{const _e=Se.target.files[0];if(_e){const Ee=URL.createObjectURL(_e),tt={id:oa(),url:Ee,name:_e.name,position:new k(0,0,0),rotation:new hi(0,0,0),scale:new k(1,1,1),layerId:u},St=[...i,tt];a(St),gn(t,St,o)}},ce.click()},[i,t,o,u]),Xf=Y.useCallback(()=>{let ce=`# NeonFlow Export
`,Se=1;t.forEach(St=>{var Ut;if((Ut=o.find(wt=>wt.id===St.layerId))!=null&&Ut.visible){ce+=`o ${St.id}
`,St.points.forEach(wt=>{ce+=`v ${wt.x} ${wt.y} ${wt.z}
`}),ce+="l";for(let wt=0;wt<St.points.length;wt++)ce+=` ${Se+wt}`;ce+=`
`,Se+=St.points.length}});const _e=new Blob([ce],{type:"text/plain"}),Ee=URL.createObjectURL(_e),tt=document.createElement("a");tt.href=Ee,tt.download="neonflow_export.obj",tt.click(),URL.revokeObjectURL(Ee)},[t,o]),ru=Y.useCallback(ce=>{try{new Function("lines","setLines","THREE",ce)(t,_e=>{n(_e),gn(_e,i,o)},lT)}catch(Se){console.error("Script Error:",Se),alert("Script Error: "+Se)}},[t,i,o]),Ll=Y.useCallback(()=>{if(m.length>0){x([]);return}if($||Ge||W||ve.size>0){pe(null),ze(new Set),Fe(null),lt(null),fe(!1),g==="edit-points"&&b("select-object");return}g!=="view"&&b("view")},[m,$,ve,Ge,W,g]),$i=Y.useCallback(ce=>{if(ce.target.files&&ce.target.files[0]){const Se=ce.target.files[0];let _e=URL.createObjectURL(Se);const Ee=Se.name.toLowerCase();Ee.endsWith(".hdr")?_e+="#.hdr":Ee.endsWith(".exr")?_e+="#.exr":Ee.endsWith(".jpg")||Ee.endsWith(".jpeg")?_e+="#.jpg":Ee.endsWith(".png")?_e+="#.png":_e+="#.hdr",Nl(_e),ys(!0)}},[]),fd=Y.useMemo(()=>{if(!$)return 0;const ce=t.find(_e=>_e.id===$);if(!ce||ce.points.length<2)return 0;let Se=0;for(let _e=0;_e<ce.points.length-1;_e++)Se+=ce.points[_e].distanceTo(ce.points[_e+1]);return Se},[t,$]);return s?y.jsx(gj,{onStart:()=>e(!1),onStartVoxel:()=>{b("voxel-paint"),ie(Se=>({...Se,enabled:!0,visible:!0}));const ce={tools:!0,properties:!1,layers:!1,view:!0,script:!1,brushes:!1,layout:!1,cubes:!1,camera:!0,grid:!1,shapes:!1,annotations:!1,objects:!1,voxelPainter:!0,colorLibrary:!1,modifiers:!1};localStorage.setItem("neonflow_ui_windows",JSON.stringify(ce)),e(!1)}}):y.jsxs("div",{className:"w-full h-screen bg-[#050505] text-white overflow-hidden relative select-none",children:[y.jsx(xj,{lines:t,models:i,currentPoints:m,color:st,width:X,mode:g,onChangeMode:b,activeView:Ye,customPlane:M,transformMode:De,selectedLineId:$,selectedModelId:Ge,onAddCube:()=>{const ce={id:oa(),url:"primitive:cube",name:"Cube",position:new k(0,0,0),rotation:new hi(0,0,0),scale:new k(1,1,1),layerId:u,color:U,opacity:P,segments:O};a(Se=>[...Se,ce]),Fe(ce.id)},isViewLocked:et,drawingAids:Z,layers:o,onDrawStart:Dl,onDrawMove:Ko,onDrawEnd:dc,onSnapPointSelected:zi,onSelectLine:ca,onSelectModel:Zo,onUpdateLine:vr,onUpdateModel:nu,onUpdateModelGeometry:Js,objectRegistry:pr.current,onFinishShape:po,activePointIndex:Qe,onPointSelect:lt,onAddPoint:Bl,animationsRef:Ir,onRegisterObject:(ce,Se)=>{Se?pr.current.set(ce,Se):pr.current.delete(ce)},onDeleteObject:Gr,cameraFov:Wn,exposure:ki,bgColor:Ga,drawingPlaneMode:B,gridSettings:j,isGridSelected:W,onUpdateGrid:(ce,Se,_e)=>ae(Ee=>({...Ee,position:ce,rotation:Se,scale:_e})),isWireframe:hr,hdriUrl:vs,showHdriBackground:dr,showStars:da,starSettings:ho,voxelSize:ne,onVoxelAction:Bo,objectColor:U,symmetrySettings:J,onUpdateSymmetry:(ce,Se,_e)=>ie(Ee=>({...Ee,position:ce,rotation:Se,scale:_e||Ee.scale})),turntableSettings:se,onUpdateTurntableTarget:ce=>I(Se=>({...Se,target:ce})),selectedLineIds:ve,onBoxSelect:Ds}),y.jsx(fF,{color:st,setColor:ce=>ua(ce),width:X,setWidth:ce=>ua(void 0,ce),isDashed:Re,setIsDashed:ce=>ua(void 0,void 0,ce),dashScale:Rt,setDashScale:ce=>ua(void 0,void 0,void 0,ce),dashRatio:Ke,setDashRatio:ce=>ua(void 0,void 0,void 0,void 0,ce),opacity:Pe,setOpacity:ce=>ua(void 0,void 0,void 0,void 0,void 0,ce),intensity:Be,setIntensity:ce=>ua(void 0,void 0,void 0,void 0,void 0,void 0,ce),tubularSegments:vt,setTubularSegments:ce=>ua(void 0,void 0,void 0,void 0,void 0,void 0,void 0,ce),radialSegments:zt,setRadialSegments:ce=>ua(void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,ce),startWidth:We,setStartWidth:ce=>ua(void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,ce),endWidth:ge,setEndWidth:ce=>ua(void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,ce),mode:g,setMode:b,transformMode:De,setTransformMode:le,onClear:xa,onUndo:zr,onRedo:_s,onDeleteSelected:hc,onChangeView:jr,lineCount:t.length,planePointsCount:R.length,onResetPlane:ga,hasCustomPlane:!!M,selectedLineId:$,selectedModelId:Ge,onFinishPath:mo,isDrawingPath:m.length>0&&["draw-polyline","draw-spline","draw-tube"].includes(g),isViewLocked:et,onToggleViewLock:()=>Ne(!et),drawingAids:Z,setDrawingAids:me,layers:o,activeLayerId:u,setActiveLayerId:h,onAddLayer:ka,onDeleteLayer:xr,onToggleLayerVisibility:Pr,onToggleLayerLock:Zs,onRenameLayer:gr,onOffset:Ul,onDuplicate:$o,onMirror:au,onToggleCloseLoop:Uo,onToggleFill:kr,onSubdivide:Xa,onReverse:su,onToggleType:V,onExplode:Wt,selectedLength:fd,onSave:pc,onLoad:Vf,onImportModel:mc,onExportOBJ:Xf,onChamfer:Ui,onFillet:Ji,activePointIndex:Qe,onRunScript:ru,onCreateCube:iu,customBrushes:ja,onSaveBrush:Qo,onDeleteBrush:xo,onSelectCustomBrush:va,onExportBrushes:Hr,onImportBrushes:Do,cameraFov:Wn,setCameraFov:xi,exposure:ki,setExposure:Di,bgColor:Ga,setBgColor:Ka,drawingPlaneMode:B,setDrawingPlaneMode:F,gridSettings:j,setGridSettings:ae,isGridSelected:W,onToggleGridSelection:tu,onResetGrid:na,annotationText:S,setAnnotationText:C,filled:ht,setFilled:ce=>ua(void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,ce),objectColor:U,setObjectColor:ce=>ua(ce),objectOpacity:P,setObjectOpacity:ce=>ua(void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,ce),objectDensity:O,setObjectDensity:ce=>ua(void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,ce),objectScale:Q,setObjectScale:ce=>ua(void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,ce),onCancel:Ll,isWireframe:hr,setIsWireframe:To,onUploadHDRI:$i,hdriUrl:vs,showHdriBackground:dr,setShowHdriBackground:ys,showStars:da,setShowStars:qs,starSettings:ho,setStarSettings:bs,voxelSize:ne,setVoxelSize:re,symmetrySettings:J,setSymmetrySettings:ie,onSetPlaneToSymmetry:Qa,onApplySymmetryToSelection:kf,turntableSettings:se,setTurntableSettings:I,extrudeDepth:Vt,setExtrudeDepth:Kt,bevelEnabled:on,setBevelEnabled:Gn,bevelThickness:En,setBevelThickness:li,bevelSize:qi,setBevelSize:la,bevelSegments:di,setBevelSegments:Qi,latheSegments:Mi,setLatheSegments:mn,latheAngle:jn,setLatheAngle:bn,latheAxis:q,setLatheAxis:he,latheStartAngle:we,setLatheStartAngle:Je,loftDivisions:ot,setLoftDivisions:ct,loftClosed:Ot,setLoftClosed:Dt,loftSmooth:Nt,setLoftSmooth:K,sweepSteps:be,setSweepSteps:xe,sweepTwist:Oe,setSweepTwist:Me,sweepScale:$e,setSweepScale:yt,sweepRotation:Mt,setSweepRotation:Ft,sweepTaper:mt,setSweepTaper:Pt,sweepAlignToPath:en,setSweepAlignToPath:Qt,revolveSegments:yn,setRevolveSegments:ln,revolveAngle:xn,setRevolveAngle:Un,revolveAxis:an,setRevolveAxis:Bn,revolveOffset:tn,setRevolveOffset:Hn,revolveStartAngle:kn,setRevolveStartAngle:hn,revolveCapEnds:Ni,setRevolveCapEnds:Yn,onExtrude:Ns,onLathe:No,onLoft:mr,onSweep:Vi,onRevolve:Bs,onFlow:Fr,selectedLineIds:ve,onCommand:Ks})]})},bR=document.getElementById("root");if(!bR)throw new Error("Could not find root element to mount to");const yj=SN.createRoot(bR);yj.render(y.jsx(v3.StrictMode,{children:y.jsx(vj,{})}));
